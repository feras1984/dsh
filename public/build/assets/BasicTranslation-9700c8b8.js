import{R as Bt,j as Y,C as Yn,r as Si,ab as D,as as x,an as O,af as h,ag as Te,am as R,au as vt,aH as ot,ah as S,aj as g,ax as W,aC as Ii,aw as T,az as H,aP as Wr,ap as ce,ae as b,ay as Q,b0 as Nn,aK as $n,aB as X,av as N,ak as Ct,al as $t,ao as jt,ac as st,aq as Rn,aL as A,aM as Ue,aN as Mn,b1 as Ut,aG as ve,aA as rl,aF as hn,ar as sl,b2 as Ws,at as Qr,ai as An,b3 as mt,b4 as Qs,b5 as ol,aI as ht,b6 as Gr,b7 as al,b8 as ll,ad as hl,J as cl,F as pl}from"./app-29790f36.js";import{b as ra,C as sa,I as dl,V as ul}from"./ValidatedInput-9a95dfd3.js";import{F as Pn}from"./FileService-c182dbca.js";import{C as fl}from"./CardMedia-951a62d1.js";import{I as ml}from"./Icon-506d581c.js";import{B as Ot}from"./Box-dc1b2ccf.js";import{I as gl}from"./Send-0fc77969.js";import{T as Qt,g as cn,c as rr,s as sr,h as Mt,P as Hi,B as zs,i as Kr,N as Vi,a as J,b as vl,d as Xr,C as oa,D as bl,e as yl,f as Cl,I as Tl}from"./template-1eb4ecfb.js";const Sl={image:"",classes:"",className:"",callback:()=>{},imageChanged:()=>{},inputRef:Bt.createRef(),error:"",iconClasses:""},aa=Bt.createContext(Sl),El=({value:o,children:t})=>Y.jsx(aa.Provider,{value:o,children:t}),Jn=()=>{const o=Bt.useContext(aa);if(o===void 0)throw new Error("The context must be inside the provider");return o},Ll=()=>{const{inputRef:o,callback:t}=Jn(),e=i=>{var n,r;t(((r=(n=i==null?void 0:i.target)==null?void 0:n.files)==null?void 0:r[0])||null)};return Y.jsx("input",{type:"file",id:"hidden-input",className:"hidden",ref:o,onChange:e})},wl=()=>{Yn.get(Pn);const{image:o,classes:t,className:e}=Jn();return Y.jsx(fl,{classes:{img:t},component:"img",src:o||"/file/users/default.png",alt:"photo",className:e})},kl=()=>{const{inputRef:o,iconClasses:t}=Jn(),e=()=>{var i;(i=o==null?void 0:o.current)==null||i.click()};return Y.jsx(Ot,{className:`absolute bg-white rounded-full ${t||"right-[16px] bottom-[16px]"}`,children:Y.jsx(gl,{onClick:e,className:"",children:Y.jsx(ml,{name:"edit",size:24})})})},xl=()=>{const{error:o}=Jn();return o&&Y.jsx(ra,{sx:{color:"error.main",marginLeft:"8px",marginRight:"8px",textWrap:"nowrap"},children:o})},Dl=({image:o,onChange:t,iconClasses:e="",classes:i})=>{const n=Yn.get(Pn),[r,s]=Bt.useState(o),[a,l]=Bt.useState(""),c=Bt.useRef(null),p=u=>{u&&(n.assertSize(u)?n.assertImage(u)?(l(""),s(URL.createObjectURL(u)),t(u)):l("Please upload an image!"):l(`Image Size must be less than ${Pn.MAX_FILE_SIZE}KB!`))},d=()=>{};return Y.jsx(El,{value:{image:r,callback:p,imageChanged:d,inputRef:c,error:a,iconClasses:e,classes:i},children:Y.jsxs(Ot,{children:[Y.jsxs(Ot,{className:"relative",children:[Y.jsx(wl,{}),Y.jsx(kl,{})]}),Y.jsx(Ll,{}),Y.jsx(xl,{})]})})},iu=({controllerName:o="",methods:t,image:e=null,onUpload:i=null})=>{const n=Yn.get(Pn),[r,s]=Si.useState(!1);Si.useState(!1);const a=l=>{s(!0),t.setValue("image",l),l?t.clearErrors("image"):t.setError("image",{message:"image is required"}),!l&&r?t.setError("image",{message:"Select a valid image"}):(t.clearErrors("image"),i!==null&&i())};return Y.jsx(sa,{name:o,control:t.control,render:({field:{value:l,onChange:c,onBlur:p,ref:d},fieldState:{error:u}})=>Y.jsx(Y.Fragment,{children:Y.jsx(Ot,{className:"w-[250px] relative",children:Y.jsx(Dl,{image:e||n.DefaultImage,iconClasses:"right-[16px] bottom-[16px]",classes:"bg-center bg-cover object-cover relative h-[195px] rounded-lg border-2 border-state-500",onChange:a})})})})};var Ei="tableclass",Bl="load",Yr="initial-load",gi="content-changed",Me="initial-end",pt="iframe-click",j="destroy",Li="toolbarClick",_t="toolbar-refresh",In="refresh-begin",ct="toolbar-updated",$r="bind-on-end",Hn="render-color-picker",Jr="html-toolbar-click",Ol="markdown-toolbar-click",Zr="destroy-color-picker",be="model-changed",Nl="tableModulekeyUp",at="keyUp",Ne="keyDown",es="mouseUp",Rl="toolbarCreated",Gs="toolbarRenderComplete",ts="enableFullScreen",is="disableFullScreen",wi="dropDownSelect",ns="beforeDropDownItemRender",rs="execCommandCallBack",ss="image-toolbar-action",Ml="audio-toolbar-action",Al="video-toolbar-action",os="link-toolbar-action",as="resize",Pl="resizeStart",Il="resizing",Hl="resizeStop",ls="insertLink",pn="unLink",or="editLink",Ui="openLink",Ae="actionBegin",Ge="actionComplete",Fl="updatedToolbarStatus",vi="updateToolbarItem",dn="insertImage",zl="insertAudio",ql="insertVideo",ki="insertCompleted",ar="insertImgLink",lr="imgAltText",hr="delete",cr="caption",pr="imageSize",Gt="sourceCode",xi="updateSource",Fn="beforeDropDownOpen",nt="selection-save",rt="selection-restore",Ks="expandPopupClick",hs="count",_e="mouseDown",Di="sourceCodeMouseDown",Kt="editAreaClick",xt="scroll",pi="contentscroll",bi="colorPickerChanged",dr="tableColorPickerChanged",Bi="focusChange",cs="selectAll",zn="selectRange",ps="getSelectedHtml",ds="renderInlineToolbar",Oi="paste-content",dt="rtl-mode",Vl="createTable",Ul="docClick",jl="table-toolbar-action",us="checkUndoStack",fs="readOnlyMode",fe="moduleDestroy",_l="pasteClean",ms="enterHandler",Wl="beforeDialogOpen",Ni="clearDialogObj",Ql="dialogOpen",Gl="beforeDialogClose",Kl="dialogClose",Xl="beforeQuickToolbarOpen",Yl="quickToolbarOpen",$l="quickToolbarClose",Jl="imageSelected",Xs="imageUploading",Ys="imageUploadSuccess",$s="imageUploadFailed",Zl="imageRemoving",Js="afterImageDelete",gs="drop",Ri="xhtmlValidation",Zs="beforeImageUpload",eo="resizeInitialized",la="renderFileManager",eh="beforeImageDrop",vs="dynamicModule",bs="updateTbItemsStatus",ys="showLinkDialog",Cs="closeLinkDialog",Ts="showImageDialog",th="showAudioDialog",ih="showVideoDialog",Ss="closeImageDialog",nh="closeAudioDialog",rh="closeVideoDialog",sh="showTableDialog",oh="closeTableDialog",we="closeTableDialog",ah="formatPainterClick",lh="formatPainterDoubleClick",ha="emojiPicker",Mi="destroyTooltip",Es="hidePopup",to="cleanupResizeElements",hh="afterKeyDown",Ls="updateValueOnIdle",qn="documentClickClosedBy",ch=`address:empty, article:empty, aside:empty, blockquote:empty,
 details:empty, dd:empty, div:empty, dl:empty, dt:empty, fieldset:empty, footer:empty,form:empty, h1:empty,
 h2:empty, h3:empty, h4:empty, h5:empty, h6:empty, header:empty, hgroup:empty, li:empty, main:empty, nav:empty,
 noscript:empty, output:empty, p:empty, pre:empty, section:empty, td:empty, th:empty`,ph=`a:empty, abbr:empty, acronym:empty, b:empty, bdi:empty, bdo:empty, big:empty, button:empty,
canvas:empty, cite:empty, code:empty, data:empty, datalist:empty, del:empty, dfn:empty, em:empty, font:empty, i:empty, iframe:empty,
ins:empty, kbd:empty, label:empty, map:empty, mark:empty, meter:empty, noscript:empty, object:empty, output:empty, picture:empty, progress:empty,
q:empty, ruby:empty, s:empty, samp:empty, script:empty, select:empty, slot:empty, small:empty, span:empty, strong:empty, strike:empty, sub:empty, sup:empty, svg:empty,
template:empty, textarea:empty, time:empty, u:empty, tt:empty, var:empty, wbr:empty`,io=["px","em","rem","pt","cm","mm","in","pc","vw","vh","vmin","vmax"],dh={px:{px:1,em:.0625,rem:.0625,pt:.75,cm:.0264583,mm:.0026458,in:.0104167,pc:.0625,vw:.00625,vh:.00625,vmin:.00625,vmax:.00625},em:{px:16,em:1,rem:1,pt:12,cm:.423333,mm:.0423333,in:.166667,pc:.0625,vw:1,vh:1,vmin:1,vmax:1},rem:{px:16,em:1,rem:1,pt:12,cm:.423333,mm:.0423333,in:.166667,pc:.0625,vw:1,vh:1,vmin:1,vmax:1},pt:{px:1.33333,em:.0833333,rem:.0833333,pt:1,cm:.0352778,mm:.0035278,in:.0138889,pc:.0416667,vw:.00416667,vh:.00416667,vmin:.00416667,vmax:.00416667},cm:{px:37.7953,em:2.3622,rem:2.3622,pt:28.3465,cm:1,mm:.1,in:.393701,pc:.148148,vw:.0377953,vh:.0377953,vmin:.0377953,vmax:.0377953},mm:{px:3.77953,em:.23622,rem:.23622,pt:2.83465,cm:10,mm:1,in:.0393701,pc:.0148148,vw:.00377953,vh:.00377953,vmin:.00377953,vmax:.00377953},in:{px:96,em:6,rem:6,pt:72,cm:2.54,mm:25.4,in:1,pc:.375,vw:.09375,vh:.09375,vmin:.09375,vmax:.09375},pc:{px:16,em:1,rem:1,pt:12,cm:.423333,mm:.0423333,in:.166667,pc:1,vw:.0625,vh:.0625,vmin:.0625,vmax:.0625},vw:{px:160,em:10,rem:10,pt:120,cm:4.23333,mm:.423333,in:1.66667,pc:.625,vw:1,vh:1,vmin:1,vmax:1},vh:{px:160,em:10,rem:10,pt:120,cm:4.23333,mm:.423333,in:1.66667,pc:.625,vw:1,vh:1,vmin:1,vmax:1},vmin:{px:160,em:10,rem:10,pt:120,cm:4.23333,mm:.423333,in:1.66667,pc:.625,vw:1,vh:1,vmin:1,vmax:1},vmax:{px:160,em:10,rem:10,pt:120,cm:4.23333,mm:.423333,in:1.66667,pc:.625,vw:1,vh:1,vmin:1,vmax:1}},ca="onHandleFontsizeChange",Vn="e-richtexteditor",wt="e-rtl",ur="e-disabled",no="rte-iframe-script-sheet",ro="rte-iframe-style-sheet",un="e-rte-toolbar",so="e-rte-tb-fixed",ws="e-rte-tb-float",ks="e-rte-tb-abs-float",fr="e-rte-inline",oo="e-rte-tb-expand",ei="e-rte-full-screen",fn="e-rte-quick-toolbar",uh="e-rte-text-quicktoolbar",ao="e-rte-pop",fh="e-tb-static",mh="e-rte-quick-popup",Tt="e-quick-dropdown",gh="e-rte-image-popup",lo="e-rte-text-popup",di="e-rte-inline-popup",mr="e-rte-inline-dropdown",Ie="e-rte-dropdown-popup",gr="e-rte-dropdown-icons",Xe="e-rte-dropdown-items",ke="e-rte-dropdown-btn",pa="e-rte-content",gt="e-toolbar-item",vr="e-toolbar-wrapper",ho="e-show",ui="e-hide",co="e-visible",br="e-focused",po="e-remove-white-space",uo="e-imgright",fo="e-imgleft",mo="e-imgcenter",ft="e-imgbreak",fi="e-clickelem",da="e-video-clickelem",mn="e-audio-wrap",yr="e-video-wrap",He="e-img-caption",vh="e-rte-img-caption",ti="e-caption-inline",kt="e-imginline",bh="e-audio-inline",yh="e-video-inline",go="e-rte-character-count",Cr="e-warning",Tr="e-error",Un="e-icons",Wt="e-active",Dt="e-expand-open",Ce="e-rte-elements",Sr="e-tbar-btn",Ch="e-rte-horizontal-separator",vo="e-tbar-ios-fixed",Er="e-rte-list-primary-content",Th="e-rte-numberformatlist-dropdown",Sh="e-rte-bulletformatlist-dropdown",Eh="e-formats-tbar-btn",Lh="e-font-name-tbar-btn",wh="e-font-size-tbar-btn",kh="e-alignment-tbar-btn",xh="e-rte-fontcolor-element",Dh="e-rte-backgroundcolor-element",ii="e-rte-color-content",Bh="e-rte-fontcolor-dropdown",Oh="e-rte-backgroundcolor-dropdown",Nh="e-rte-square-palette",Rh="e-rte-fontcolor-colorpicker",Mh="e-rte-backgroundcolor-colorpicker",xs="e-rte-readonly",Ah="e-cell-select",bo="e-rte-hidden",Ph="e-resize-handle",Ds="e-rte-image",Ih="e-resize",gn="e-img-focus",Hh="e-audio-focus",Fh="e-video-focus",ji="e-rte-drag-image",zh="e-rte-upload-popup",yo="e-popup-open",qh="e-img-resize",Vh="e-droparea",Uh="e-img-inner",jh="e-upload-files",_h="e-rte-dialog-upload",Wh="e-custom-tile",Qh="e-nocolor-item",Co="e-rte-fixed-tb-expand",To="e-rte-toolbar-enabled",bt="e-rte-srctextarea",U;(function(o){o[o.Toolbar=0]="Toolbar",o[o.Content=1]="Content",o[o.Popup=2]="Popup",o[o.LinkToolbar=3]="LinkToolbar",o[o.TextToolbar=4]="TextToolbar",o[o.ImageToolbar=5]="ImageToolbar",o[o.AudioToolbar=6]="AudioToolbar",o[o.VideoToolbar=7]="VideoToolbar",o[o.InlineToolbar=8]="InlineToolbar",o[o.TableToolbar=9]="TableToolbar"})(U||(U={}));var Le;(function(o){o.Expand="Expand",o.MultiRow="MultiRow",o.Scrollable="Scrollable"})(Le||(Le={}));var Ve;(function(o){o.InsertLink="InsertLink",o.InsertImage="InsertImage",o.InsertAudio="InsertAudio",o.InsertVideo="InsertVideo",o.InsertTable="InsertTable"})(Ve||(Ve={}));var qs=["alignments","formats","fontname","fontsize","fontcolor","backgroundcolor","align","display","audiolayoutoption","videolayoutoption","videoalign","tablerows","tablecolumns","tablecell","tablecellhorizontalalign","tablecellverticalalign","styles","numberformatlist","bulletformatlist"],Xt={alignments:{id:"Alignments",icon:"e-alignments",tooltip:"Alignments",command:"Alignments",subCommand:"Alignments"},justifyleft:{id:"JustifyLeft",icon:"e-justify-left",tooltip:"JustifyLeft",command:"Alignments",subCommand:"JustifyLeft"},justifycenter:{id:"JustifyCenter",icon:"e-justify-center",tooltip:"JustifyCenter",command:"Alignments",subCommand:"JustifyCenter"},justifyright:{id:"JustifyRight",icon:"e-justify-right",tooltip:"JustifyRight",command:"Alignments",subCommand:"JustifyRight"},justifyfull:{id:"JustifyFull",icon:"e-justify-full",tooltip:"JustifyFull",command:"Alignments",subCommand:"JustifyFull"},fontname:{id:"FontName",icon:"e-font-name",tooltip:"Font Name",command:"Font",subCommand:"FontName"},fontsize:{id:"FontSize",icon:"e-font-size",tooltip:"Font Size",command:"Font",subCommand:"FontSize"},fontcolor:{id:"FontColor",icon:"e-rte-font-color",tooltip:"Font Color",command:"Font",subCommand:"FontColor",value:"#ff0000ff"},backgroundcolor:{id:"BackgroundColor",icon:"e-background-color",tooltip:"Background Color",command:"Font",subCommand:"BackgroundColor",value:"#ffff00ff"},bold:{id:"Bold",icon:"e-bold",tooltip:"Bold",command:"Style",subCommand:"Bold"},italic:{id:"Italic",icon:"e-italic",tooltip:"Italic",command:"Style",subCommand:"Italic"},underline:{id:"Underline",icon:"e-underline",tooltip:"Underline",command:"Style",subCommand:"Underline"},strikethrough:{id:"StrikeThrough",icon:"e-strike-through",tooltip:"StrikeThrough",command:"Style",subCommand:"StrikeThrough"},clearformat:{id:"ClearFormat",icon:"e-clear-format",tooltip:"Clear Format",command:"Clear",subCommand:"ClearFormat"},clearall:{id:"ClearAll",icon:"e-clear-all",tooltip:"Clear All",command:"Clear",subCommand:"ClearAll"},cut:{id:"Cut",icon:"e-cut",tooltip:"Cut",command:"ClipBoard",subCommand:"Cut"},copy:{id:"Copy",icon:"e-copy",tooltip:"Copy",command:"ClipBoard",subCommand:"Copy"},paste:{id:"Paste",icon:"e-paste",tooltip:"Paste",command:"ClipBoard",subCommand:"Paste"},unorderedlist:{id:"UnorderedList",icon:"e-unorder-list",tooltip:"Bulleted List",command:"Lists",subCommand:"UL"},orderedlist:{id:"OrderedList",icon:"e-order-list",tooltip:"Numbered List",command:"Lists",subCommand:"OL"},numberformatlist:{id:"NumberFormatList",icon:"e-order-list",tooltip:"Number Format List",command:"NumberFormatList",subCommand:"NumberFormatList"},bulletformatlist:{id:"BulletFormatList",icon:"e-unorder-list",tooltip:"Bullet Format List",command:"BulletFormatList",subCommand:"BulletFormatList"},indent:{id:"Indent",icon:"e-indent",tooltip:"Increase Indent",command:"Indents",subCommand:"Indent"},outdent:{id:"Outdent",icon:"e-outdent",tooltip:"Decrease Indent",command:"Indents",subCommand:"Outdent"},undo:{id:"Undo",icon:"e-undo",tooltip:"Undo",command:"Actions",subCommand:"Undo"},redo:{id:"Redo",icon:"e-redo",tooltip:"Redo",command:"Actions",subCommand:"Redo"},superscript:{id:"SuperScript",icon:"e-super-script",tooltip:"Superscript",command:"Effects",subCommand:"SuperScript"},subscript:{id:"SubScript",icon:"e-sub-script",tooltip:"Subscript",command:"Effects",subCommand:"SubScript"},createlink:{id:"CreateLink",icon:"e-create-link",tooltip:"Insert Hyperlink",command:"Links",subCommand:"CreateLink"},openlink:{id:"OpenLink",icon:"e-open-link",tooltip:"Open Link",command:"Links",subCommand:"OpenLink"},editlink:{id:"EditLink",icon:"e-edit-link",tooltip:"Edit Link",command:"Links",subCommand:"EditLink"},removelink:{id:"RemoveLink",icon:"e-remove-link",tooltip:"Remove Link",command:"Links",subCommand:"RemoveLink"},image:{id:"Image",icon:"e-image",tooltip:"Insert Image",command:"Images",subCommand:"Image"},audio:{id:"Audio",icon:"e-audio",tooltip:"Insert Audio",command:"Audios",subCommand:"Audio"},video:{id:"Video",icon:"e-video",tooltip:"Insert Video",command:"Videos",subCommand:"Video"},filemanager:{id:"FileManager",icon:"e-rte-file-manager",tooltip:"File Manager",command:"Files",subCommand:"File"},createtable:{id:"CreateTable",icon:"e-create-table",tooltip:"Create Table",command:"Table",subCommand:"CreateTable"},removetable:{id:"removeTable",icon:"e-remove-table",tooltip:"Remove Table",command:"removeTable",subCommand:"removeTable"},replace:{id:"Replace",icon:"e-replace",tooltip:"Replace",command:"Images",subCommand:"Replace"},audioreplace:{id:"AudioReplace",icon:"e-audio-replace",tooltip:"Audio Replace",command:"Audios",subCommand:"AudioReplace"},audioremove:{id:"AudioRemove",icon:"e-audio-remove",tooltip:"Audio Remove",command:"Audios",subCommand:"AudioRemove"},audiolayoutoption:{id:"AudioLayoutOption",icon:"e-audio-display",tooltip:"Audio LayoutOption",command:"Audios",subCommand:"AudioLayoutOption"},videoreplace:{id:"VideoReplace",icon:"e-video-replace",tooltip:"Video Replace",command:"Videos",subCommand:"VideoReplace"},videoalign:{id:"VideoAlign",icon:"e-video-align",tooltip:"Video Align",command:"Videos",subCommand:"VideoAlign"},videoremove:{id:"VideoRemove",icon:"e-video-remove",tooltip:"Video Remove",command:"Videos",subCommand:"VideoRemove"},videolayoutoption:{id:"VideoLayoutOption",icon:"e-video-display",tooltip:"Video LayoutOption",command:"Videos",subCommand:"VideoLayoutOption"},videodimension:{id:"VideoDimension",icon:"e-video-dimension",tooltip:"Video Dimension",command:"Videos",subCommand:"VideoDimension"},align:{id:"Align",icon:"e-align",tooltip:"Align",command:"Images",subCommand:"Align"},caption:{id:"Caption",icon:"e-caption",tooltip:"Image Caption",command:"Images",subCommand:"Caption"},remove:{id:"Remove",icon:"e-remove",tooltip:"Remove",command:"Images",subCommand:"Remove"},openimagelink:{id:"OpenImageLink",icon:"e-open-link",tooltip:"Open Link",command:"Images",subCommand:"OpenImageLink"},editimagelink:{id:"EditImageLink",icon:"e-edit-link",tooltip:"Edit Link",command:"Images",subCommand:"EditImageLink"},removeimagelink:{id:"RemoveImageLink",icon:"e-remove-link",tooltip:"Remove Link",command:"Images",subCommand:"RemoveImageLink"},insertlink:{id:"InsertLink",icon:"e-insert-link",tooltip:"Insert Link",command:"Images",subCommand:"InsertLink"},display:{id:"Display",icon:"e-display",tooltip:"Display",command:"Images",subCommand:"Display"},alttext:{id:"AltText",icon:"e-alt-text",tooltip:"Alternative Text",command:"Images",subCommand:"AltText"},dimension:{id:"Dimension",icon:"e-img-dimension",tooltip:"Change Size",command:"Images",subCommand:"Dimension"},fullscreen:{id:"Maximize",icon:"e-maximize",tooltip:"Maximize",command:"View",subCommand:"Maximize"},maximize:{id:"Maximize",icon:"e-maximize",tooltip:"Maximize",command:"FullScreen",subCommand:"Maximize"},minimize:{id:"Minimize",icon:"e-minimize",tooltip:"Minimize",command:"FullScreen",subCommand:"Minimize"},lowercase:{id:"LowerCase",icon:"e-lower-case",tooltip:"Lower Case",command:"Casing",subCommand:"LowerCase"},uppercase:{id:"UpperCase",icon:"e-upper-case",tooltip:"Upper Case",command:"Casing",subCommand:"UpperCase"},print:{id:"Print",icon:"e-print",tooltip:"Print",command:"Print",subCommand:"Print"},formats:{id:"Formats",icon:"e-formats",tooltip:"Formats",command:"Formats",subCommand:"Formats"},sourcecode:{id:"SourceCode",icon:"e-source-code",tooltip:"Code View (Ctrl+Shift+H)",command:"SourceCode",subCommand:"SourceCode"},preview:{id:"Preview",icon:"e-preview",tooltip:"Preview (Ctrl+Shift+H)",command:"Preview",subCommand:"Preview"},viewside:{id:"ViewSide",icon:"e-view-side",tooltip:"ViewSide",command:"ViewSide",subCommand:"ViewSide"},insertcode:{id:"InsertCode",icon:"e-insert-code",tooltip:"Insert Code",command:"Formats",subCommand:"Pre"},tableheader:{id:"TableHeader",icon:"e-table-header",tooltip:"Table Header",command:"Table",subCommand:"TableHeader"},tableremove:{id:"TableRemove",icon:"e-table-remove",tooltip:"Table Remove",command:"Table",subCommand:"TableRemove"},tablerows:{id:"TableRows",icon:"e-table-rows",tooltip:"Table Rows",command:"Table",subCommand:"TableRows"},tablecolumns:{id:"TableColumns",icon:"e-table-columns",tooltip:"Table Columns",command:"Table",subCommand:"TableColumns"},tablecell:{id:"TableCell",icon:"e-table-cell",tooltip:"Table Cell",command:"Table",subCommand:"TableCell"},tablecellbackground:{id:"TableCellBackground",icon:"e-table-cell-background",tooltip:"Table Cell Background",command:"Table",subCommand:"TableCellBackground"},tablecellhorizontalalign:{id:"TableCellHorizontalAlign",icon:"e-table-cell-horizontalAlign",tooltip:"Table Cell HorizontalAlign",command:"Table",subCommand:"TableCellHorizontalAlign"},tablecellverticalalign:{id:"TableCellVerticalAlign",icon:"e-table-cell-verticalAlign",tooltip:"Table Cell VerticalAlign",command:"Table",subCommand:"TableCellVerticalAlign"},tableeditproperties:{id:"TableEditProperties",icon:"e-table-edit-properties",tooltip:"Table Edit Properties",command:"Table",subCommand:"TableEditProperties"},styles:{id:"Styles",icon:"e-table-styles",tooltip:"Styles",command:"Table",subCommand:"Styles"},formatpainter:{id:"FormatPainter",icon:"e-rte-format-painter",tooltip:"Format Painter",command:"FormatPainter",subCommand:"FormatPainter"},emojipicker:{id:"EmojiPicker",icon:"e-emoji",tooltip:"Emoji Icon",command:"EmojiPicker",subCommand:"EmojiPicker"}},Gh=[{locale:"alignmentsDropDownLeft",value:"JustifyLeft"},{locale:"alignmentsDropDownCenter",value:"JustifyCenter"},{locale:"alignmentsDropDownRight",value:"JustifyRight"},{locale:"alignmentsDropDownJustify",value:"JustifyFull"}],yi=[{iconCss:"e-icons e-justify-left",text:"Align Left",command:"Alignments",subCommand:"JustifyLeft"},{iconCss:"e-icons e-justify-center",text:"Align Center",command:"Alignments",subCommand:"JustifyCenter"},{iconCss:"e-icons e-justify-right",text:"Align Right",command:"Alignments",subCommand:"JustifyRight"},{iconCss:"e-icons e-justify-full",text:"Align Justify",command:"Alignments",subCommand:"JustifyFull"}],Kh=[{iconCss:"e-icons e-justify-left",command:"Images",subCommand:"JustifyLeft"},{iconCss:"e-icons e-justify-center",command:"Images",subCommand:"JustifyCenter"},{iconCss:"e-icons e-justify-right",command:"Images",subCommand:"JustifyRight"}],Xh=[{iconCss:"e-icons e-justify-left",command:"Videos",subCommand:"JustifyLeft"},{iconCss:"e-icons e-justify-center",command:"Videos",subCommand:"JustifyCenter"},{iconCss:"e-icons e-justify-right",command:"Videos",subCommand:"JustifyRight"}],Yh=[{locale:"imageDisplayDropDownInline",value:"Inline"},{locale:"imageDisplayDropDownBreak",value:"Break"}],$h=[{locale:"audioLayoutOptionDropDownInline",value:"Inline"},{locale:"audioLayoutOptionDropDownBreak",value:"Break"}],Jh=[{locale:"videoLayoutOptionDropDownInline",value:"Inline"},{locale:"videoLayoutOptionDropDownBreak",value:"Break"}],vn=[{text:"Inline",cssClass:"e-inline",command:"Images",subCommand:"Inline"},{text:"Break",cssClass:"e-break",command:"Images",subCommand:"Break"}],bn=[{text:"Inline",cssClass:"e-audio-inline",command:"Audios",subCommand:"Inline"},{text:"Break",cssClass:"e-audio-break",command:"Audios",subCommand:"Break"}],yn=[{text:"Inline",cssClass:"e-video-inline",command:"Videos",subCommand:"Inline"},{text:"Break",cssClass:"e-video-break",command:"Videos",subCommand:"Break"}],Zh=[{iconCss:"e-icons e-cell-merge",text:"Merge cells",command:"Table",subCommand:"Merge"},{iconCss:"e-icons e-cell-horizontal-split",text:"Horizontal split",command:"Table",subCommand:"HorizontalSplit"},{iconCss:"e-icons e-cell-vertical-split",text:"Vertical split",command:"Table",subCommand:"VerticalSplit"}],ec=[{locale:"tableInsertRowDropDownBefore",value:"InsertRowBefore"},{locale:"tableInsertRowDropDownAfter",value:"InsertRowAfter"},{locale:"tableInsertRowDropDownDelete",value:"DeleteRow"}],Cn=[{iconCss:"e-icons e-insert-row-before",text:"Insert row before",command:"Table",subCommand:"InsertRowBefore"},{iconCss:"e-icons e-insert-row-after",text:"Insert row after",command:"Table",subCommand:"InsertRowAfter"},{iconCss:"e-icons e-delete-row",text:"Delete row",command:"Table",subCommand:"DeleteRow"}],tc=[{locale:"tableInsertColumnDropDownLeft",value:"InsertColumnLeft"},{locale:"tableInsertColumnDropDownRight",value:"InsertColumnRight"},{locale:"tableInsertColumnDropDownDelete",value:"DeleteColumn"}],Tn=[{iconCss:"e-icons e-insert-column-left",text:"Insert column left",command:"Table",subCommand:"InsertColumnLeft"},{iconCss:"e-icons e-insert-column-right",text:"Insert column right",command:"Table",subCommand:"InsertColumnRight"},{iconCss:"e-icons e-delete-column",text:"Delete column",command:"Table",subCommand:"DeleteColumn"}],ic=[{locale:"tableVerticalAlignDropDownTop",value:"AlignTop"},{locale:"tableVerticalAlignDropDownMiddle",value:"AlignMiddle"},{locale:"tableVerticalAlignDropDownBottom",value:"AlignBottom"}],Sn=[{iconCss:"e-icons e-align-top",text:"Align Top",command:"Table",subCommand:"AlignTop"},{iconCss:"e-icons e-align-middle",text:"Align Middle",command:"Table",subCommand:"AlignMiddle"},{iconCss:"e-icons e-align-bottom",text:"Align Bottom",command:"Table",subCommand:"AlignBottom"}],nc=[{locale:"tableStylesDropDownDashedBorder",value:"Dashed"},{locale:"tableStylesDropDownAlternateRows",value:"Alternate"}],En=[{text:"Dashed Borders",cssClass:"e-dashed-borders",command:"Table",subCommand:"Dashed"},{text:"Alternate Rows",cssClass:"e-alternate-rows",command:"Table",subCommand:"Alternate"}],rc=["Bold","Italic","Underline","|","Formats","Alignments","OrderedList","UnorderedList","|","CreateLink","Image","|","SourceCode","Undo","Redo"],Ln=[{cssClass:"e-segoe-ui",text:"Segoe UI",command:"Font",subCommand:"FontName",value:"Segoe UI"},{cssClass:"e-arial",text:"Arial",command:"Font",subCommand:"FontName",value:"Arial,Helvetica,sans-serif"},{cssClass:"e-georgia",text:"Georgia",command:"Font",subCommand:"FontName",value:"Georgia,serif"},{cssClass:"e-impact",text:"Impact",command:"Font",subCommand:"FontName",value:"Impact,Charcoal,sans-serif"},{cssClass:"e-tahoma",text:"Tahoma",command:"Font",subCommand:"FontName",value:"Tahoma,Geneva,sans-serif"},{cssClass:"e-times-new-roman",text:"Times New Roman",command:"Font",subCommand:"FontName",value:"Times New Roman,Times,serif"},{cssClass:"e-verdana",text:"Verdana",command:"Font",subCommand:"FontName",value:"Verdana,Geneva,sans-serif"}],sc=[{text:"8 pt",value:"8pt"},{text:"10 pt",value:"10pt"},{text:"12 pt",value:"12pt"},{text:"14 pt",value:"14pt"},{text:"18 pt",value:"18pt"},{text:"24 pt",value:"24pt"},{text:"36 pt",value:"36pt"}],wn=[{cssClass:"e-paragraph",text:"Paragraph",command:"Formats",subCommand:"P",value:"P"},{cssClass:"e-code",text:"Code",command:"Formats",subCommand:"Pre",value:"Pre"},{cssClass:"e-quote",text:"Quotation",command:"Formats",subCommand:"BlockQuote",value:"BlockQuote"},{cssClass:"e-h1",text:"Heading 1",command:"Formats",subCommand:"H1",value:"H1"},{cssClass:"e-h2",text:"Heading 2",command:"Formats",subCommand:"H2",value:"H2"},{cssClass:"e-h3",text:"Heading 3",command:"Formats",subCommand:"H3",value:"H3"},{cssClass:"e-h4",text:"Heading 4",command:"Formats",subCommand:"H4",value:"H4"}],oc={Custom:["","#000000","#e7e6e6","#44546a","#4472c4","#ed7d31","#a5a5a5","#ffc000","#70ad47","#ff0000","#f2f2f2","#808080","#cfcdcd","#d5dce4","#d9e2f3","#fbe4d5","#ededed","#fff2cc","#e2efd9","#ffcccc","#d9d9d9","#595959","#aeaaaa","#acb9ca","#b4c6e7","#f7caac","#dbdbdb","#ffe599","#c5e0b3","#ff8080","#bfbfbf","#404040","#747070","#8496b0","#8eaadb","#f4b083","#c9c9c9","#ffd966","#a8d08d","#ff3333","#a6a6a6","#262626","#3b3838","#323e4f","#2f5496","#c45911","#7b7b7b","#bf8f00","#538135","#b30000","#7f7f7f","#0d0d0d","#161616","#212934","#1f3763","#823b0b","#525252","#7f5f00","#375623","#660000"]},ac={Custom:["","#000000","#ffff00","#00ff00","#00ffff","#0000ff","#ff0000","#000080","#800080","#996633","#f2f2f2","#808080","#ffffcc","#b3ffb3","#ccffff","#ccccff","#ffcccc","#ccccff","#ff80ff","#f2e6d9","#d9d9d9","#595959","#ffff80","#80ff80","#b3ffff","#8080ff","#ff8080","#8080ff","#ff00ff","#dfbf9f","#bfbfbf","#404040","#ffff33","#33ff33","#33ffff","#3333ff","#ff3333","#0000b3","#b300b3","#c68c53","#a6a6a6","#262626","#e6e600","#00b300","#009999","#000099","#b30000","#000066","#660066","#86592d","#7f7f7f","#0d0d0d","#999900","#006600","#006666","#000066","#660000","#00004d","#4d004d","#734d26"]},kn=[{text:"None",command:"Lists",subCommand:"NumberFormatList",value:"none"},{text:"Number",command:"Lists",subCommand:"NumberFormatList",value:"decimal"},{text:"Lower Greek",command:"Lists",subCommand:"NumberFormatList",value:"lowerGreek"},{text:"Lower Roman",command:"Lists",subCommand:"NumberFormatList",value:"lowerRoman"},{text:"Upper Alpha",command:"Lists",subCommand:"NumberFormatList",value:"upperAlpha"},{text:"Lower Alpha",command:"Lists",subCommand:"NumberFormatList",value:"lowerAlpha"},{text:"Upper Roman",command:"Lists",subCommand:"NumberFormatList",value:"upperRoman"}],xn=[{text:"None",command:"Lists",subCommand:"BulletFormatList",value:"none"},{text:"Disc",command:"Lists",subCommand:"BulletFormatList",value:"disc"},{text:"Circle",command:"Lists",subCommand:"BulletFormatList",value:"circle"},{text:"Square",command:"Lists",subCommand:"BulletFormatList",value:"square"}];function ut(o,t,e){for(var i=0;t.length>i;i++)if(t[i].value===e.subCommand)return o.localeObj.getConstant(t[i].locale);return e.text}function lc(o){yi.forEach(function(t,e){yi[e].text=ut(o,Gh,yi[e])}),vn.forEach(function(t,e){vn[e].text=ut(o,Yh,vn[e])}),bn.forEach(function(t,e){bn[e].text=ut(o,$h,bn[e])}),yn.forEach(function(t,e){yn[e].text=ut(o,Jh,yn[e])}),Cn.forEach(function(t,e){Cn[e].text=ut(o,ec,Cn[e])}),Tn.forEach(function(t,e){Tn[e].text=ut(o,tc,Tn[e])}),Sn.forEach(function(t,e){Sn[e].text=ut(o,ic,Sn[e])}),En.forEach(function(t,e){En[e].text=ut(o,nc,En[e])})}var Lr={"Insert Link":"Ctrl+K","Insert Image":"Ctrl+Shift+I","Create Table":"Ctrl+Shift+E",Undo:"Ctrl+Z",Redo:"Ctrl+Y",Copy:"Ctrl+C",Cut:"Ctrl+X",Paste:"Ctrl+V",Bold:"Ctrl+B",Italic:"Ctrl+I",Underline:"Ctrl+U",Strikethrough:"Ctrl+Shift+S","Upper Case":"Ctrl+Shift+U","Lower Case":"Ctrl+Shift+L",Superscript:"Ctrl+Shift+=",Subscript:"Ctrl+=","Code View":"Ctrl+Shift+H",Maximize:"Ctrl+Shift+F",Minimize:"Esc","Clear Format":"Ctrl+Shift+R","Numbered List":"Ctrl+Shift+O","Bulleted List":"Ctrl+Alt+O","Number Format List":"Ctrl+Shift+O","Bullet Format List":"Ctrl+Alt+O","Insert Audio":"Ctrl+Shift+A","Insert Video":"Ctrl+Alt+V","Increase Indent":"Ctrl+]","Decrease Indent":"Ctrl+[","Decrease Fontsize":"Ctrl+Shift+<","Increase Fontsize":"Ctrl+Shift+>","Justify Center":"Ctrl+E","Justify Full":"Ctrl+J","Justify Left":"Ctrl+L","Justify Right":"Ctrl+R","Format Painter":"Alt+Shift+C, Alt+Shift+V"},hc=[{name:"Smilies & People",code:"1F600",iconCss:"e-emoji",icons:[{code:"1F600",desc:"Grinning face"},{code:"1F603",desc:"Grinning face with big eyes"},{code:"1F604",desc:"Grinning face with smiling eyes"},{code:"1F606",desc:"Grinning squinting face"},{code:"1F605",desc:"Grinning face with sweat"},{code:"1F602",desc:"Face with tears of joy"},{code:"1F923",desc:"Rolling on the floor laughing"},{code:"1F60A",desc:"Smiling face with smiling eyes"},{code:"1F607",desc:"Smiling face with halo"},{code:"1F642",desc:"Slightly smiling face"},{code:"1F643",desc:"Upside-down face"},{code:"1F60D",desc:"Smiling face with heart-eyes"},{code:"1F618",desc:"Face blowing a kiss"},{code:"1F61B",desc:"Face with tongue"},{code:"1F61C",desc:"Winking face with tongue"},{code:"1F604",desc:"Grinning face with smiling eyes"},{code:"1F469",desc:"Woman"},{code:"1F468",desc:"Man"},{code:"1F467",desc:"Girl"},{code:"1F466",desc:"Boy"},{code:"1F476",desc:"Baby"},{code:"1F475",desc:"Old woman"},{code:"1F474",desc:"Old man"},{code:"1F46E",desc:"Police officer"},{code:"1F477",desc:"Construction worker"},{code:"1F482",desc:"Guard"},{code:"1F575",desc:"Detective"},{code:"1F9D1",desc:"Cook"}]},{name:"Animals & Nature",code:"1F435",iconCss:"e-animals",icons:[{code:"1F436",desc:"Dog face"},{code:"1F431",desc:"Cat face"},{code:"1F42D",desc:"Mouse face"},{code:"1F439",desc:"Hamster face"},{code:"1F430",desc:"Rabbit face"},{code:"1F98A",desc:"Fox face"},{code:"1F43B",desc:"Bear face"},{code:"1F43C",desc:"Panda face"},{code:"1F428",desc:"Koala"},{code:"1F42F",desc:"Tiger face"},{code:"1F981",desc:"Lion face"},{code:"1F42E",desc:"Cow face"},{code:"1F437",desc:"Pig face"},{code:"1F43D",desc:"Pig nose"},{code:"1F438",desc:"Frog face"},{code:"1F435",desc:"Monkey face"},{code:"1F649",desc:"Hear-no-evil monkey"},{code:"1F64A",desc:"Speak-no-evil monkey"},{code:"1F412",desc:"Monkey"},{code:"1F414",desc:"Chicken"},{code:"1F427",desc:"Penguin"},{code:"1F426",desc:"Bird"},{code:"1F424",desc:"Baby chick"},{code:"1F986",desc:"Duck"},{code:"1F985",desc:"Eagle"}]},{name:"Food & Drink",code:"1F347",iconCss:"e-food-and-drinks",icons:[{code:"1F34E",desc:"Red apple"},{code:"1F34C",desc:"Banana"},{code:"1F347",desc:"Grapes"},{code:"1F353",desc:"Strawberry"},{code:"1F35E",desc:"Bread"},{code:"1F950",desc:"Croissant"},{code:"1F955",desc:"Carrot"},{code:"1F354",desc:"Hamburger"},{code:"1F355",desc:"Pizza"},{code:"1F32D",desc:"Hot dog"},{code:"1F35F",desc:"French fries"},{code:"1F37F",desc:"Popcorn"},{code:"1F366",desc:"Soft ice cream"},{code:"1F367",desc:"Shaved ice"},{code:"1F36A",desc:"Cookie"},{code:"1F382",desc:"Birthday cake"},{code:"1F370",desc:"Shortcake"},{code:"1F36B",desc:"Chocolate bar"},{code:"1F369",desc:"Donut"},{code:"1F36E",desc:"Custard"},{code:"1F36D",desc:"Lollipop"},{code:"1F36C",desc:"Candy"},{code:"1F377",desc:"Wine glass"},{code:"1F37A",desc:"Beer mug"},{code:"1F37E",desc:"Bottle with popping cork"}]},{name:"Activities",code:"1F383",iconCss:"e-activities",icons:[{code:"26BD",desc:"Soccer ball"},{code:"1F3C0",desc:"Basketball"},{code:"1F3C8",desc:"American football"},{code:"26BE",desc:"Baseball"},{code:"1F3BE",desc:"Tennis"},{code:"1F3D0",desc:"Volleyball"},{code:"1F3C9",desc:"Rugby football"},{code:"1F3B1",desc:"Pool 8 ball"},{code:"1F3D3",desc:"Ping pong"},{code:"1F3F8",desc:"Badminton"},{code:"1F94A",desc:"Boxing glove"},{code:"1F3CA",desc:"Swimmer"},{code:"1F3CB",desc:"Weightlifter"},{code:"1F6B4",desc:"Bicyclist"},{code:"1F6F9",desc:"Skateboard"},{code:"1F3AE",desc:"Video game"},{code:"1F579",desc:"Joystick"},{code:"1F3CF",desc:"Cricket"},{code:"1F3C7",desc:"Horse racing"},{code:"1F3AF",desc:"Direct hit"},{code:"1F3D1",desc:"Field hockey"},{code:"1F3B0",desc:"Slot machine"},{code:"1F3B3",desc:"Bowling"},{code:"1F3B2",desc:"Game die"},{code:"265F",desc:"Chess pawn"}]},{name:"Travel & Places",code:"1F30D",iconCss:"e-travel-and-places",icons:[{code:"2708",desc:"Airplane"},{code:"1F697",desc:"Automobile"},{code:"1F695",desc:"Taxi"},{code:"1F6B2",desc:"Bicycle"},{code:"1F68C",desc:"Bus"},{code:"1F682",desc:"Locomotive"},{code:"1F6F3",desc:"Passenger ship"},{code:"1F680",desc:"Rocket"},{code:"1F681",desc:"Helicopter"},{code:"1F6A2",desc:"Ship"},{code:"1F3DF",desc:"Stadium"},{code:"1F54C",desc:"Mosque"},{code:"26EA",desc:"Church"},{code:"1F6D5",desc:"Hindu Temple"},{code:"1F3D4",desc:"Snow-capped mountain"},{code:"1F3EB",desc:"School"},{code:"1F30B",desc:"Volcano"},{code:"1F3D6",desc:"Beach with umbrella"},{code:"1F3DD",desc:"Desert island"},{code:"1F3DE",desc:"National park"},{code:"1F3F0",desc:"Castle"},{code:"1F5FC",desc:"Tokyo tower"},{code:"1F5FD",desc:"Statue of liberty"},{code:"26E9",desc:"Shinto shrine"},{code:"1F3EF",desc:"Japanese castle"},{code:"1F3A2",desc:"Roller coaster"}]},{name:"Objects",code:"1F507",iconCss:"e-objects",icons:[{code:"1F4A1",desc:"Light bulb"},{code:"1F526",desc:"Flashlight"},{code:"1F4BB",desc:"Laptop computer"},{code:"1F5A5",desc:"Desktop computer"},{code:"1F5A8",desc:"Printer"},{code:"1F4F7",desc:"Camera"},{code:"1F4F8",desc:"Camera with flash"},{code:"1F4FD",desc:"Film projector"},{code:"1F3A5",desc:"Movie camera"},{code:"1F4FA",desc:"Television"},{code:"1F4FB",desc:"Radio"},{code:"1F50B",desc:"Battery"},{code:"231A",desc:"Watch"},{code:"1F4F1",desc:"Mobile phone"},{code:"260E",desc:"Telephone"},{code:"1F4BE",desc:"Floppy disk"},{code:"1F4BF",desc:"Optical disk"},{code:"1F4C0",desc:"Digital versatile disc"},{code:"1F4BD",desc:"Computer disk"},{code:"1F3A7",desc:"Headphone"},{code:"1F3A4",desc:"Microphone"},{code:"1F3B6",desc:"Multiple musical notes"},{code:"1F4DA",desc:"Books"}]},{name:"Symbols",code:"1F3E7",iconCss:"e-symbols",icons:[{code:"274C",desc:"Cross mark"},{code:"2714",desc:"Check mark"},{code:"26A0",desc:"Warning sign"},{code:"1F6AB",desc:"Prohibited"},{code:"2139",desc:"Information"},{code:"267B",desc:"Recycling symbol"},{code:"1F6AD",desc:"No smoking"},{code:"1F4F5",desc:"No mobile phones"},{code:"1F6AF",desc:"No littering"},{code:"1F6B3",desc:"No bicycles"},{code:"1F6B7",desc:"No pedestrians"},{code:"2795",desc:"Plus"},{code:"2796",desc:"Minus"},{code:"2797",desc:"Divide"},{code:"2716",desc:"Multiplication"},{code:"1F4B2",desc:"Dollar banknote"},{code:"1F4AC",desc:"Speech balloon"},{code:"2755",desc:"White exclamation mark"},{code:"2754",desc:"White question mark"},{code:"2764",desc:"Red heart"}]}],jn={alignments:"Alignments",justifyLeft:"Align Left",justifyCenter:"Align Center",justifyRight:"Align Right",justifyFull:"Align Justify",fontName:"Font Name",fontSize:"Font Size",fontColor:"Font Color",backgroundColor:"Background Color",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",clearFormat:"Clear Format",clearAll:"Clear All",cut:"Cut",copy:"Copy",paste:"Paste",unorderedList:"Bulleted List",orderedList:"Numbered List",indent:"Increase Indent",outdent:"Decrease Indent",undo:"Undo",redo:"Redo",superscript:"Superscript",subscript:"Subscript",createLink:"Insert Link",openLink:"Open Link",editLink:"Edit Link",removeLink:"Remove Link",image:"Insert Image",audio:"Insert Audio",video:"Insert Video",replace:"Replace",numberFormatList:"Number Format List",bulletFormatList:"Bullet Format List",audioReplace:"Replace",videoReplace:"Replace",videoAlign:"Align",videoDimension:"Dimension",audioRemove:"Remove",videoRemove:"Remove",audioLayoutOption:"Layout option",videoLayoutOption:"Layout option",align:"Align",caption:"Image Caption",remove:"Remove",insertLink:"Insert Link",display:"Display",altText:"Alternative text",dimension:"Change Size",fullscreen:"Maximize",maximize:"Maximize",minimize:"Minimize",lowerCase:"Lower Case",upperCase:"Upper Case",print:"Print",formats:"Formats",sourcecode:"Code View",preview:"Preview",viewside:"ViewSide",insertCode:"Insert Code",linkText:"Display text",linkTooltipLabel:"Title",linkWebUrl:"Web address",linkTitle:"Enter a title",linkurl:"http://example.com",linkOpenInNewWindow:"Open link in new window",linkHeader:"Insert Link",dialogInsert:"Insert",dialogCancel:"Cancel",dialogUpdate:"Update",imageHeader:"Insert Image",audioHeader:"Insert Audio",videoHeader:"Insert Video",imageLinkHeader:"You can also provide a link from the web",audioLinkHeader:"You can also provide a link from the web",videoLinkHeader:"Web URL",embedVideoLinkHeader:"Media Embed URL",mdimageLink:"Please provide a URL for your image",imageUploadMessage:"Drop image here or browse to upload",audioUploadMessage:"Drop an audio file or browse to upload",videoUploadMessage:"Drop a video file or browse to upload",imageDeviceUploadMessage:"Click here to upload",audioDeviceUploadMessage:"Click here to upload",videoDeviceUploadMessage:"Click here to upload",imageAlternateText:"Alternate Text",alternateHeader:"Alternative Text",browse:"Browse",imageUrl:"http://example.com/image.png",audioUrl:"http://example.com/audio.mp3",videoUrl:"http://example.com/video.mp3",webUrl:"Web URL",embedUrl:"Embed Code",imageCaption:"Caption",imageSizeHeader:"Image Size",videoSizeHeader:"Video Size",imageHeight:"Height",imageWidth:"Width",videoHeight:"Height",videoWidth:"Width",textPlaceholder:"Enter text",inserttablebtn:"Insert table",tabledialogHeader:"Insert Table",tableWidth:"Width",cellpadding:"Cell Padding",cellspacing:"Cell Spacing",columns:"Number of columns",rows:"Number of rows",tableRows:"Table Rows",tableColumns:"Table Columns",tableCellHorizontalAlign:"Table Cell Horizontal Align",tableCellVerticalAlign:"Table Vertical Align",createTable:"Create Table",removeTable:"Remove Table",tableHeader:"Table Header",tableRemove:"Table Remove",tableCellBackground:"Table Cell Background",tableEditProperties:"Table Edit Properties",styles:"Styles",insertColumnLeft:"Insert Column Left",insertColumnRight:"Insert Column Right",deleteColumn:"Delete Column",insertRowBefore:"Insert Row Before",insertRowAfter:"Insert Row After",deleteRow:"Delete Row",tableEditHeader:"Edit Table",TableHeadingText:"Heading",TableColText:"Col",imageInsertLinkHeader:"Insert Link",editImageHeader:"Edit Image",editAudioHeader:"Edit Audio",editVideoHeader:"Edit Video",alignmentsDropDownLeft:"Align Left",alignmentsDropDownCenter:"Align Center",alignmentsDropDownRight:"Align Right",alignmentsDropDownJustify:"Align Justify",imageDisplayDropDownInline:"Inline",imageDisplayDropDownBreak:"Break",audioLayoutOptionDropDownInline:"Inline",audioLayoutOptionDropDownBreak:"Break",videoLayoutOptionDropDownInline:"Inline",videoLayoutOptionDropDownBreak:"Break",tableInsertRowDropDownBefore:"Insert row before",tableInsertRowDropDownAfter:"Insert row after",tableInsertRowDropDownDelete:"Delete row",tableInsertColumnDropDownLeft:"Insert column left",tableInsertColumnDropDownRight:"Insert column right",tableInsertColumnDropDownDelete:"Delete column",tableVerticalAlignDropDownTop:"Align Top",tableVerticalAlignDropDownMiddle:"Align Middle",tableVerticalAlignDropDownBottom:"Align Bottom",tableStylesDropDownDashedBorder:"Dashed Borders",tableStylesDropDownAlternateRows:"Alternate Rows",pasteFormat:"Paste Format",pasteFormatContent:"Choose the formatting action",plainText:"Plain Text",cleanFormat:"Clean",keepFormat:"Keep",pasteDialogOk:"OK",pasteDialogCancel:"Cancel",fileManager:"File Manager",fileDialogHeader:"File Browser",formatsDropDownParagraph:"Paragraph",formatsDropDownCode:"Code",formatsDropDownQuotation:"Quotation",formatsDropDownHeading1:"Heading 1",formatsDropDownHeading2:"Heading 2",formatsDropDownHeading3:"Heading 3",formatsDropDownHeading4:"Heading 4",fontNameSegoeUI:"Segoe UI",fontNameArial:"Arial",fontNameGeorgia:"Georgia",fontNameImpact:"Impact",fontNameTahoma:"Tahoma",fontNameTimesNewRoman:"Times New Roman",fontNameVerdana:"Verdana",numberFormatListNumber:"Number",numberFormatListLowerAlpha:"LowerAlpha",numberFormatListUpperAlpha:"UpperAlpha",numberFormatListLowerRoman:"LowerRoman",numberFormatListUpperRoman:"UpperRoman",numberFormatListLowerGreek:"LowerGreek",bulletFormatListDisc:"Disc",bulletFormatListCircle:"Circle",bulletFormatListSquare:"Square",numberFormatListNone:"None",bulletFormatListNone:"None",formatPainter:"Format Painter",emojiPicker:"Emoji Picker",embeddedCode:"Embedded code",pasteEmbeddedCodeHere:"Paste embedded code here",emojiPickerTypeToFind:"Type to find",emojiPickerNoResultFound:"No results found",emojiPickerTrySomethingElse:"Try something else",linkAriaLabel:"Open in new window"},cc={alignments:"alignments",justifyleft:"justifyLeft",justifycenter:"justifyCenter",justifyright:"justifyRight",justifyfull:"justifyFull",fontname:"fontName",fontsize:"fontSize",fontcolor:"fontColor",backgroundcolor:"backgroundColor",bold:"bold",italic:"italic",underline:"underline",strikethrough:"strikethrough",clearformat:"clearFormat",clearall:"clearAll",cut:"cut",copy:"copy",paste:"paste",unorderedlist:"unorderedList",orderedlist:"orderedList",indent:"indent",outdent:"outdent",numberformatlist:"numberFormatList",bulletformatlist:"bulletFormatList",undo:"undo",redo:"redo",filemanager:"fileManager",superscript:"superscript",subscript:"subscript",createlink:"createLink",openlink:"openLink",editlink:"editLink",removelink:"removeLink",openimagelink:"openLink",editimagelink:"editLink",removeimagelink:"removeLink",image:"image",audio:"audio",video:"video",replace:"replace",audioreplace:"audioReplace",videoreplace:"videoReplace",videoalign:"videoAlign",videodimension:"videoDimension",audioremove:"audioRemove",videoremove:"videoRemove",audiolayoutoption:"audioLayoutOption",videolayoutoption:"videoLayoutOption",align:"align",caption:"caption",remove:"remove",insertlink:"insertLink",display:"display",alttext:"alternateHeader",dimension:"dimension",fullscreen:"fullscreen",maximize:"maximize",minimize:"minimize",lowercase:"lowerCase",uppercase:"upperCase",print:"print",formats:"formats",sourcecode:"sourcecode",preview:"preview",viewside:"viewside",insertcode:"insertCode",tablerows:"tableRows",tablecolumns:"tableColumns",tablecellhorizontalalign:"tableCellHorizontalAlign",tablecellverticalalign:"tableCellVerticalAlign",createtable:"createTable",removetable:"removeTable",tableheader:"tableHeader",tableremove:"tableRemove",tablecellbackground:"tableCellBackground",tableeditproperties:"tableEditProperties",styles:"styles",insertcolumnleft:"insertColumnLeft",insertcolumnright:"insertColumnRight",deletecolumn:"deleteColumn",aligntop:"AlignTop",alignmiddle:"AlignMiddle",alignbottom:"AlignBottom",insertrowbefore:"insertRowBefore",insertrowafter:"insertRowAfter",deleterow:"deleteRow",formatpainter:"formatPainter",emojipicker:"emojiPicker",embeddedCode:"Embedded code",pasteEmbeddedCodeHere:"Paste embedded code here",emojiPickerTypeToFind:"Type to find",emojiPickerNoResultFound:"No results found",emojiPickerTrySomethingElse:"Try something else",ImageLinkAriaLabel:"Open in new window"},ua=[{locale:"fontNameSegoeUI",value:"Segoe UI"},{locale:"fontNameArial",value:"Arial,Helvetica,sans-serif"},{locale:"fontNameGeorgia",value:"Georgia,serif"},{locale:"fontNameImpact",value:"Impact,Charcoal,sans-serif"},{locale:"fontNameTahoma",value:"Tahoma,Geneva,sans-serif"},{locale:"fontNameTimesNewRoman",value:"Times New Roman,Times,serif"},{locale:"fontNameVerdana",value:"Verdana,Geneva,sans-serif"}],fa=[{locale:"formatsDropDownParagraph",value:"P"},{locale:"formatsDropDownCode",value:"Pre"},{locale:"formatsDropDownQuotation",value:"BlockQuote"},{locale:"formatsDropDownHeading1",value:"H1"},{locale:"formatsDropDownHeading2",value:"H2"},{locale:"formatsDropDownHeading3",value:"H3"},{locale:"formatsDropDownHeading4",value:"H4"}],ma=[{locale:"numberFormatListNone",value:"none"},{locale:"numberFormatListNumber",value:"decimal"},{locale:"numberFormatListLowerAlpha",value:"lower-alpha"},{locale:"numberFormatListUpperAlpha",value:"upper-alpha"},{locale:"numberFormatListLowerRoman",value:"lower-roman"},{locale:"numberFormatListUpperRoman",value:"upper-roman"},{locale:"numberFormatListLowerGreek",value:"lower-greek"}],ga=[{locale:"bulletFormatListNone",value:"none"},{locale:"bulletFormatListDisc",value:"disc"},{locale:"bulletFormatListCircle",value:"circle"},{locale:"bulletFormatListSquare",value:"square"}],pc=["Undo","Redo"],dc=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","strike","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"];function Vs(o,t){var e=-1;return t.some(function(i,n){return typeof i=="string"&&o===i.toLocaleLowerCase()?(e=n,!0):!1}),e}function he(o,t){var e=!1;return o.classList.contains(t)&&(e=!0),e}function it(o,t,e,i){for(var n,r,s=0;s<o.length;s++)if(e==="value"&&o[s].value.toLocaleLowerCase()===t.toLocaleLowerCase()){n=o[s];break}else if(e==="text"&&o[s].text.toLocaleLowerCase()===t.toLocaleLowerCase()){n=o[s];break}else if(e==="subCommand"&&o[s].subCommand.toLocaleLowerCase()===t.toLocaleLowerCase()){n=o[s];break}if(!h(n))switch(i){case"text":r=n.text;break;case"value":r=n.value;break;case"iconCss":r=n.iconCss;break}return r}function ie(){var o=!1;return D.isDevice&&D.isIos&&(o=!0),o}function Bs(o){return h(o)?"":o}function So(o,t,e){var i=0;return e?i=window.pageYOffset+t.getBoundingClientRect().top+o.clientY:i=o.pageY,i}function _n(o,t){var e=t.getService("rteLocale"),i=cc[""+o],n=e.getConstant(i);return n}function ni(o,t,e,i){if(e)for(var n=t.getService("rteLocale"),r=0;r<e.length;r++){var s=e[r].value.toLocaleLowerCase(),a=e[r].locale,l=jn[""+a].toLocaleLowerCase();if(o===s||o===l){var c=e[r].locale;return n.getConstant(c)}}else for(var p=i.fontSize.items,r=0;r<p.length;r++)if(o===i.fontSize.items[r].value){var d=i.fontSize.items[r].text;return d}return""}function uc(o){for(var t=Object.keys(jn),e=0;e<t.length;e++){var i=jn[""+t[e]];if(o===i)return i}return""}function Os(o,t,e){ya(e);for(var i=o.dropDownModule,n=o.args,r=Object.keys(o.args),s=0,a=r;s<a.length;s++)for(var l=a[s],c=0;c<o.tbItems.length;c++){var p=o.tbItems[c].subCommand,d=p&&p.toLocaleLowerCase();if(p&&d===l||p==="UL"&&l==="unorderedlist"||p==="OL"&&l==="orderedlist"||d==="pre"&&l==="insertcode"||p==="NumberFormatList"&&l==="numberFormatList"||p==="BulletFormatList"&&l==="bulletFormatList"){if(typeof n[""+l]=="boolean")n[""+l]===!0?x([o.tbElements[c]],[Wt]):O([o.tbElements[c]],[Wt]);else if((typeof n[""+l]=="string"||n[""+l]===null)&&Vs(l,o.parent.toolbarSettings.items)>=-1){var u=n[""+l]?n[""+l]:"",f="";switch(l){case"formats":{if(h(i.formatDropDown)||t||!h(i.formatDropDown)&&i.formatDropDown.isDestroyed)break;var m=o.parent.format.types,v=h(o.parent.format.default)?m[0].text:o.parent.format.default;f=u==="empty"?"":it(m,u,"subCommand","text"),i.formatDropDown.content='<span style="display: inline-flex;width:'+o.parent.format.width+'" ><span class="e-rte-dropdown-btn-text'+(h(o.parent.cssClass)?"":" "+o.parent.cssClass)+'">'+(h(f)?v:f)+"</span></span>",i.formatDropDown.dataBind();break}case"alignments":{if(h(i.alignDropDown)||!h(i.alignDropDown)&&i.alignDropDown.isDestroyed)break;var y=yi;f=it(y,u,"subCommand","iconCss"),i.alignDropDown.iconCss=h(f)?"e-icons e-justify-left":f,i.alignDropDown.dataBind();break}case"fontname":{if(h(i.fontNameDropDown)||t||!h(i.fontNameDropDown)&&i.fontNameDropDown.isDestroyed)break;var L=o.parent.fontFamily.items;f=u==="empty"?"":it(L,u,"value","text");var C=h(o.parent.fontFamily.default)?L[0].text:o.parent.fontFamily.default,w=h(f)?C:f;i.fontNameDropDown.content='<span style="display: inline-flex;width:'+o.parent.fontFamily.width+'" ><span class="e-rte-dropdown-btn-text'+(h(o.parent.cssClass)?"":" "+o.parent.cssClass)+'">'+w+"</span></span>",i.fontNameDropDown.dataBind();break}case"fontsize":{if(h(i.fontSizeDropDown)||!h(i.fontSizeDropDown)&&i.fontSizeDropDown.isDestroyed)break;var k=o.parent.fontSize.items,I=h(o.parent.fontSize.default)?k[1].text:o.parent.fontSize.default;f=u==="empty"?"":it(k,u===""?I.replace(/\s/g,""):u,"value","text"),i.fontSizeDropDown.content='<span style="display: inline-flex;width:'+o.parent.fontSize.width+'" ><span class="e-rte-dropdown-btn-text'+(h(o.parent.cssClass)?"":" "+o.parent.cssClass)+'">'+Bs(f)+"</span></span>",i.fontSizeDropDown.dataBind();break}case"bulletFormatList":case"numberFormatList":O([o.tbElements[c]],[Wt])}}}}}function Dn(o){return typeof o=="object"?o:[o]}function Bn(o,t){for(var e=[],i=0;i<o.length;i++)for(var n=0;n<t.length;n++)if(t[n].type!=="Separator"){if((o[i]==="OrderedList"||o[i]==="NumberFormatList")&&t[n].subCommand==="OL"){e.push(n);break}else if((o[i]==="UnorderedList"||o[i]==="BulletFormatList")&&t[n].subCommand==="UL"){e.push(n);break}else if(o[i]==="InsertCode"&&t[n].subCommand==="Pre"){e.push(n);break}else if(o[i]==="FileManager"&&t[n].subCommand==="File"){e.push(n);break}else if(typeof o[i]=="object"&&o[i].command==="Custom"){e.push(i);break}else if(o[i]===t[n].subCommand){e.push(n);break}}return e}function Yt(o,t){for(var e=0,i=Bn(Dn(pc),o.toolbarObj.items),n=Te("."+gt,o.toolbarObj.element),r=Object.keys(t),s=0,a=r;s<a.length;s++){var l=a[s],c=n[i[e]];c&&o.toolbarObj.enableItems(c,t[""+l]),e++}}function Zn(o,t){var e=document.createEvent("HTMLEvents");e.initEvent(t,!1,!0),o.dispatchEvent(e)}function On(o){var t=R("template");return t.innerHTML=o,t.content instanceof DocumentFragment?t.content:document.createRange().createContextualFragment(o)}function va(o,t){var e=[];for(t=t.firstChild;t;t=t.nextSibling)t.nodeType===3?e.push(t):e=e.concat(va(o,t));return e}function Us(o){for(var t={},e=Object.keys(o),i=0;i<Object.keys(o).length;i++)t[e[i].toLocaleLowerCase()]=o[e[i]];return t}function Wn(o,t){var e;return o!==null&&o!==""?(e=t.enableHtmlEncode?Eo(et(o),t):Eo(o,t),t.setProperties({value:e},!0)):t.enterKey==="DIV"?e=t.enableHtmlEncode?"&lt;div&gt;&lt;br/&gt;&lt;/div&gt;":"<div><br/></div>":t.enterKey==="BR"?e=t.enableHtmlEncode?"&lt;br/&gt;":"<br/>":e=t.enableHtmlEncode?"&lt;p&gt;&lt;br/&gt;&lt;/p&gt;":"<p><br/></p>",e}function Eo(o,t){var e=document.createElement("div"),i=document.createElement("div"),n=e.childNodes;if(e.innerHTML=o,e.setAttribute("class","tempDiv"),n.length>0){for(var r=void 0,s=void 0,a=void 0;e.firstChild;){for(var l=e.querySelectorAll(ch),c=0;c<l.length;c++)l[c].innerHTML="<br>";for(var p=e.querySelectorAll("p"),c=0;c<p.length;c++)p[c].textContent.trim().length===0&&p[c].childNodes.length===1&&p[c].childNodes[0].nodeName==="#text"&&h(p[c].childNodes[0].textContent.match(/\u00a0/g))&&(p[c].innerHTML="<br>");for(var d=e.querySelectorAll(ph),c=0;c<d.length;c++)d[c].innerHTML="&ZeroWidthSpace;";t.enterKey!=="BR"&&(e.firstChild.nodeName==="#text"&&(e.firstChild.textContent.indexOf(`
`)<0||e.firstChild.textContent.trim()!=="")||dc.indexOf(e.firstChild.nodeName.toLocaleLowerCase())>=0)?(r?s.appendChild(e.firstChild):(t.enterKey==="DIV"?a=R("div"):a=R("p"),i.appendChild(a),a.appendChild(e.firstChild)),s=a,r=!0):e.firstChild.nodeName==="#text"&&(e.firstChild.textContent===`
`||e.firstChild.textContent.indexOf(`
`)>=0&&e.firstChild.textContent.trim()==="")?S(e.firstChild):(i.appendChild(e.firstChild),r=!1)}for(var u=i.querySelectorAll("img"),c=0;c<u.length;c++)u[c].classList.contains(Ds)||u[c].classList.add(Ds),u[c].classList.contains(kt)||u[c].classList.contains(ft)||u[c].classList.add(kt)}return i.innerHTML}function ba(o){var t;return o.enterKey==="DIV"?t=o.enableHtmlEncode?"&lt;div&gt;&lt;br/&gt;&lt;/div&gt;":"<div><br/></div>":o.enterKey==="BR"?t=o.enableHtmlEncode?"&lt;br/&gt;":"<br/>":t=o.enableHtmlEncode?"&lt;p&gt;&lt;br/&gt;&lt;/p&gt;":"<p><br/></p>",t}function fc(o){return o==="<p><br></p>"||o==="&lt;p&gt;&lt;br&gt;&lt;/p&gt;"||o==="<div><br></div>"||o==="&lt;div&gt;&lt;br&gt;&lt;/div&gt;"||o==="<br>"||o==="&lt;br&gt;"||o===""}function et(o){return o.replace(/&amp;/g,"&").replace(/&amp;lt;/g,"<").replace(/&lt;/g,"<").replace(/&amp;gt;/g,">").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&amp;nbsp;/g," ").replace(/&quot;/g,"")}function mc(o,t){if(t.enableHtmlSanitizer){var e=vt.beforeSanitize();e.selectors.tags[2]&&e.selectors.tags[2].indexOf("iframe")>-1&&(e.selectors.tags[2]="iframe:not(.e-rte-embed-url)");var i={cancel:!1,helper:null};ot(e,e,i),t.trigger("beforeSanitizeHtml",e),e.cancel&&!h(e.helper)?o=e.helper(o):e.cancel||(o=vt.serializeValue(e,o))}return o}function wr(o){for(var t=o.split(","),e=t[0].match(/:(.*?);/)[1],i=atob(t[1]),n=i.length,r=new Uint8Array(n);n--;)r[n]=i.charCodeAt(n);return new Blob([r],{type:e})}function _i(o,t,e){for(var i=0;t.length>i;i++)if(t[i].value===e.value||t[i].value===e.subCommand)return o.localeObj.getConstant(t[i].locale);return e.text}function ya(o){Ln.forEach(function(t,e){Ln[e].text=_i(o,ua,Ln[e])}),wn.forEach(function(t,e){wn[e].text=_i(o,fa,wn[e])}),kn.forEach(function(t,e){kn[e].text=_i(o,ma,kn[e])}),xn.forEach(function(t,e){xn[e].text=_i(o,ga,xn[e])})}var Fi=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),q=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},gc=function(o){Fi(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return q([g("None")],t.prototype,"placement",void 0),q([g(10)],t.prototype,"largeStep",void 0),q([g(1)],t.prototype,"smallStep",void 0),q([g(!1)],t.prototype,"showSmallTicks",void 0),q([g(null)],t.prototype,"format",void 0),t}(W),vc=function(o){Fi(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return q([g(null)],t.prototype,"color",void 0),q([g(null)],t.prototype,"start",void 0),q([g(null)],t.prototype,"end",void 0),t}(W),bc=function(o){Fi(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return q([g(!1)],t.prototype,"enabled",void 0),q([g(null)],t.prototype,"minStart",void 0),q([g(null)],t.prototype,"minEnd",void 0),q([g(null)],t.prototype,"maxStart",void 0),q([g(null)],t.prototype,"maxEnd",void 0),q([g(!1)],t.prototype,"startHandleFixed",void 0),q([g(!1)],t.prototype,"endHandleFixed",void 0),t}(W),yc=function(o){Fi(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return q([g("")],t.prototype,"cssClass",void 0),q([g("Before")],t.prototype,"placement",void 0),q([g("Focus")],t.prototype,"showOn",void 0),q([g(!1)],t.prototype,"isVisible",void 0),q([g(null)],t.prototype,"format",void 0),t}(W),Cc=6,Tc=3,E={root:"e-slider",rtl:"e-rtl",sliderHiddenInput:"e-slider-input",controlWrapper:"e-control-wrapper",sliderHandle:"e-handle",rangeBar:"e-range",sliderButton:"e-slider-button",firstButton:"e-first-button",secondButton:"e-second-button",scale:"e-scale",tick:"e-tick",large:"e-large",tickValue:"e-tick-value",sliderTooltip:"e-slider-tooltip",sliderHover:"e-slider-hover",sliderFirstHandle:"e-handle-first",sliderSecondHandle:"e-handle-second",sliderDisabled:"e-disabled",sliderContainer:"e-slider-container",horizontalTooltipBefore:"e-slider-horizontal-before",horizontalTooltipAfter:"e-slider-horizontal-after",verticalTooltipBefore:"e-slider-vertical-before",verticalTooltipAfter:"e-slider-vertical-after",materialTooltip:"e-material-tooltip",materialTooltipOpen:"e-material-tooltip-open",materialTooltipActive:"e-tooltip-active",materialSlider:"e-material-slider",sliderTrack:"e-slider-track",sliderHorizantalColor:"e-slider-horizantal-color",sliderVerticalColor:"e-slider-vertical-color",sliderHandleFocused:"e-handle-focused",verticalSlider:"e-vertical",horizontalSlider:"e-horizontal",sliderHandleStart:"e-handle-start",sliderTooltipStart:"e-material-tooltip-start",sliderTabHandle:"e-tab-handle",sliderButtonIcon:"e-button-icon",sliderSmallSize:"e-small-size",sliderTickPosition:"e-tick-pos",sliderFirstTick:"e-first-tick",sliderLastTick:"e-last-tick",sliderButtonClass:"e-slider-btn",sliderTooltipWrapper:"e-tooltip-wrap",sliderTabTrack:"e-tab-track",sliderTabRange:"e-tab-range",sliderActiveHandle:"e-handle-active",sliderMaterialHandle:"e-material-handle",sliderMaterialRange:"e-material-range",sliderMaterialDefault:"e-material-default",materialTooltipShow:"e-material-tooltip-show",materialTooltipHide:"e-material-tooltip-hide",readonly:"e-read-only",limits:"e-limits",limitBarDefault:"e-limit-bar",limitBarFirst:"e-limit-first",limitBarSecond:"e-limit-second",dragHorizontal:"e-drag-horizontal",dragVertical:"e-drag-vertical"},Lo=function(o){Fi(t,o);function t(e,i){var n=o.call(this,e,i)||this;return n.horDir="left",n.verDir="bottom",n.transition={handle:"left .4s cubic-bezier(.25, .8, .25, 1), right .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1) , bottom .4s cubic-bezier(.25, .8, .25, 1)",rangeBar:"all .4s cubic-bezier(.25, .8, .25, 1)"},n.transitionOnMaterialTooltip={handle:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, top 1ms ease-out",rangeBar:"left 1ms ease-out, right 1ms ease-out, bottom 1ms ease-out, width 1ms ease-out, height 1ms ease-out"},n.scaleTransform="transform .4s cubic-bezier(.25, .8, .25, 1)",n.customAriaText=null,n.drag=!0,n.isDragComplete=!1,n.initialTooltip=!0,n}return t.prototype.preRender=function(){var e={incrementTitle:"Increase",decrementTitle:"Decrease"};this.l10n=new Ii("slider",e,this.locale),this.isElementFocused=!1,this.tickElementCollection=[],this.tooltipFormatInfo={},this.ticksFormatInfo={},this.initCultureInfo(),this.initCultureFunc(),this.formChecker()},t.prototype.formChecker=function(){var e=T(this.element,"form");e?(this.isForm=!0,h(this.formResetValue)||this.setProperties({value:this.formResetValue},!0),this.formResetValue=this.value,this.type==="Range"&&(h(this.formResetValue)||typeof this.formResetValue!="object")?this.formResetValue=[parseFloat(H(this.min)),parseFloat(H(this.max))]:h(this.formResetValue)&&(this.formResetValue=parseFloat(H(this.min))),this.formElement=e):this.isForm=!1},t.prototype.initCultureFunc=function(){this.internationalization=new Wr(this.locale)},t.prototype.initCultureInfo=function(){this.tooltipFormatInfo.format=h(this.tooltip.format)?null:this.tooltip.format,this.ticksFormatInfo.format=h(this.ticks.format)?null:this.ticks.format},t.prototype.formatString=function(e,i){var n=null,r=null;if(e||e===0){n=this.formatNumber(e);var s=this.numberOfDecimals(e);r=this.internationalization.getNumberFormat(i)(this.makeRoundNumber(e,s))}return{elementVal:n,formatString:r}},t.prototype.formatNumber=function(e){var i=this.numberOfDecimals(e);return this.internationalization.getNumberFormat({maximumFractionDigits:i,minimumFractionDigits:i,useGrouping:!1})(e)},t.prototype.numberOfDecimals=function(e){var i=e.toString().split(".")[1],n=!i||!i.length?0:i.length;return n},t.prototype.makeRoundNumber=function(e,i){var n=i||0;return Number(e.toFixed(n))},t.prototype.fractionalToInteger=function(e){e=this.numberOfDecimals(e)===0?Number(e).toFixed(this.noOfDecimals):e;for(var i=1,n=0;n<this.noOfDecimals;n++)i*=10;return e=Number((e*i).toFixed(0)),e},t.prototype.render=function(){var e=this;this.initialize(),this.initRender(),this.wireEvents(),this.setZindex(),this.renderComplete(),this.element.tagName==="EJS-SLIDER"&&this.getTheme(this.sliderContainer)=="none"&&setTimeout(function(){e.refresh()},0)},t.prototype.initialize=function(){x([this.element],E.root),this.setCSSClass()},t.prototype.setElementWidth=function(e){!h(e)&&!h(this.sliderContainer)&&(typeof e=="number"?this.sliderContainer.style.width=H(e):typeof e=="string"&&(this.sliderContainer.style.width=e.match(/px|%|em/)?e:H(e)))},t.prototype.setCSSClass=function(e){e&&O([this.element],e.split(" ")),this.cssClass&&x([this.element],this.cssClass.split(" "))},t.prototype.setEnabled=function(){this.enabled?(O([this.sliderContainer],[E.sliderDisabled]),this.tooltip.isVisible&&this.tooltipElement&&this.tooltip.showOn==="Always"&&this.tooltipElement.classList.remove(E.sliderDisabled),this.wireEvents()):(x([this.sliderContainer],[E.sliderDisabled]),this.tooltip.isVisible&&this.tooltipElement&&this.tooltip.showOn==="Always"&&this.tooltipElement.classList.add(E.sliderDisabled),this.unwireEvents())},t.prototype.getTheme=function(e){var i=window.getComputedStyle(e,":after").getPropertyValue("content");return i.replace(/['"]+/g,"")},t.prototype.initRender=function(){this.sliderContainer=this.createElement("div",{className:E.sliderContainer+" "+E.controlWrapper}),this.element.parentNode.insertBefore(this.sliderContainer,this.element),this.sliderContainer.appendChild(this.element),this.sliderTrack=this.createElement("div",{className:E.sliderTrack}),this.element.appendChild(this.sliderTrack),this.setElementWidth(this.width),this.element.tabIndex=-1,this.getThemeInitialization(),this.setHandler(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setOrientClass(),this.hiddenInput=this.createElement("input",{attrs:{type:"hidden",value:h(this.value)?this.min.toString():this.value.toString(),name:this.element.getAttribute("name")||this.element.getAttribute("id")||"_"+(Math.random()*1e3).toFixed(0)+"slider",class:E.sliderHiddenInput}}),this.hiddenInput.tabIndex=-1,this.sliderContainer.appendChild(this.hiddenInput),this.showButtons&&this.setButtons(),this.setEnableRTL(),this.type==="Range"?this.rangeValueUpdate():this.value=h(this.value)?parseFloat(H(this.min.toString())):this.value,this.previousVal=this.type!=="Range"?this.checkHandleValue(parseFloat(H(this.value.toString()))):[this.checkHandleValue(parseFloat(H(this.value[0].toString()))),this.checkHandleValue(parseFloat(H(this.value[1].toString())))],this.previousChanged=this.previousVal,h(this.element.hasAttribute("name"))||this.element.removeAttribute("name"),this.setValue(),this.limits.enabled&&this.setLimitBar(),this.ticks.placement!=="None"&&this.renderScale(),this.tooltip.isVisible&&this.renderTooltip(),this.enabled?O([this.sliderContainer],[E.sliderDisabled]):x([this.sliderContainer],[E.sliderDisabled]),this.readonly?x([this.sliderContainer],[E.readonly]):O([this.sliderContainer],[E.readonly])},t.prototype.getThemeInitialization=function(){this.isMaterial=this.getTheme(this.sliderContainer)==="material"||this.getTheme(this.sliderContainer)==="material-dark",this.isMaterial3=this.getTheme(this.sliderContainer)==="Material3"||this.getTheme(this.sliderContainer)==="Material3-dark",this.isBootstrap=this.getTheme(this.sliderContainer)==="bootstrap"||this.getTheme(this.sliderContainer)==="bootstrap-dark",this.isBootstrap4=this.getTheme(this.sliderContainer)==="bootstrap4",this.isTailwind=this.getTheme(this.sliderContainer)==="tailwind"||this.getTheme(this.sliderContainer)==="tailwind-dark",this.isBootstrap5=this.getTheme(this.sliderContainer)==="bootstrap5",this.isFluent=this.getTheme(this.sliderContainer)==="FluentUI",this.isMaterialTooltip=(this.isMaterial||this.isMaterial3)&&this.type!=="Range"&&this.tooltip.isVisible},t.prototype.createRangeBar=function(){this.type!=="Default"&&(this.rangeBar=this.createElement("div",{attrs:{class:E.rangeBar}}),this.element.appendChild(this.rangeBar),this.drag&&this.type==="Range"&&(this.orientation==="Horizontal"?this.rangeBar.classList.add(E.dragHorizontal):this.rangeBar.classList.add(E.dragVertical)))},t.prototype.createLimitBar=function(){var e=this.type!=="Range"?E.limitBarDefault:E.limitBarFirst;e+=" "+E.limits,this.limitBarFirst=this.createElement("div",{attrs:{class:e}}),this.element.appendChild(this.limitBarFirst),this.type==="Range"&&(this.limitBarSecond=this.createElement("div",{attrs:{class:E.limitBarSecond+" "+E.limits}}),this.element.appendChild(this.limitBarSecond))},t.prototype.setOrientClass=function(){this.orientation!=="Vertical"?(this.sliderContainer.classList.remove(E.verticalSlider),this.sliderContainer.classList.add(E.horizontalSlider),this.firstHandle.setAttribute("aria-orientation","horizontal"),this.type==="Range"&&this.secondHandle.setAttribute("aria-orientation","horizontal")):(this.sliderContainer.classList.remove(E.horizontalSlider),this.sliderContainer.classList.add(E.verticalSlider),this.firstHandle.setAttribute("aria-orientation","vertical"),this.type==="Range"&&this.secondHandle.setAttribute("aria-orientation","vertical"))},t.prototype.setAriaAttributes=function(e){var i=this,n=this.min,r=this.max;if(!h(this.customValues)&&this.customValues.length>0&&(n=this.customValues[0],r=this.customValues[this.customValues.length-1]),this.type!=="Range")ce(e,{"aria-valuemin":n.toString(),"aria-valuemax":r.toString()});else{var s=!h(this.customValues)&&this.customValues.length>0?[[n.toString(),this.customValues[this.value[1]].toString()],[this.customValues[this.value[0]].toString(),r.toString()]]:[[n.toString(),this.value[1].toString()],[this.value[0].toString(),r.toString()]];s.forEach(function(a,l){var c=l===0?i.firstHandle:i.secondHandle;c&&ce(c,{"aria-valuemin":a[0],"aria-valuemax":a[1]})})}},t.prototype.createSecondHandle=function(){this.secondHandle=this.createElement("div",{attrs:{class:E.sliderHandle,role:"slider",tabIndex:"0","aria-label":"slider"}}),this.secondHandle.classList.add(E.sliderSecondHandle),this.element.appendChild(this.secondHandle)},t.prototype.createFirstHandle=function(){this.firstHandle=this.createElement("div",{attrs:{class:E.sliderHandle,role:"slider",tabIndex:"0","aria-label":"slider"}}),this.firstHandle.classList.add(E.sliderFirstHandle),this.element.appendChild(this.firstHandle),this.isMaterialTooltip&&(this.materialHandle=this.createElement("div",{attrs:{class:E.sliderHandle+" "+E.sliderMaterialHandle}}),this.element.appendChild(this.materialHandle))},t.prototype.wireFirstHandleEvt=function(e){e?(b.remove(this.firstHandle,"mousedown touchstart",this.handleFocus),b.remove(this.firstHandle,"transitionend",this.transitionEnd),b.remove(this.firstHandle,"mouseenter touchenter",this.handleOver),b.remove(this.firstHandle,"mouseleave touchend",this.handleLeave)):(b.add(this.firstHandle,"mousedown touchstart",this.handleFocus,this),b.add(this.firstHandle,"transitionend",this.transitionEnd,this),b.add(this.firstHandle,"mouseenter touchenter",this.handleOver,this),b.add(this.firstHandle,"mouseleave touchend",this.handleLeave,this))},t.prototype.wireSecondHandleEvt=function(e){e?(b.remove(this.secondHandle,"mousedown touchstart",this.handleFocus),b.remove(this.secondHandle,"transitionend",this.transitionEnd),b.remove(this.secondHandle,"mouseenter touchenter",this.handleOver),b.remove(this.secondHandle,"mouseleave touchend",this.handleLeave)):(b.add(this.secondHandle,"mousedown touchstart",this.handleFocus,this),b.add(this.secondHandle,"transitionend",this.transitionEnd,this),b.add(this.secondHandle,"mouseenter touchenter",this.handleOver,this),b.add(this.secondHandle,"mouseleave touchend",this.handleLeave,this))},t.prototype.handleStart=function(){this.type!=="Range"&&(this.firstHandle.classList[this.handlePos1===0?"add":"remove"](E.sliderHandleStart),this.isMaterialTooltip&&(this.materialHandle.classList[this.handlePos1===0?"add":"remove"](E.sliderHandleStart),this.tooltipElement&&this.tooltipElement.classList[this.handlePos1===0?"add":"remove"](E.sliderTooltipStart)))},t.prototype.transitionEnd=function(e){e.propertyName!=="transform"&&(this.handleStart(),this.enableAnimation||(this.getHandle().style.transition="none"),this.type!=="Default"&&(this.rangeBar.style.transition="none"),(this.isMaterial||this.isMaterial3)&&this.tooltip.isVisible&&this.type==="Default"&&(this.tooltipElement.style.transition=this.transition.handle),this.tooltipToggle(this.getHandle()),this.closeTooltip())},t.prototype.handleFocusOut=function(){this.firstHandle.classList.contains(E.sliderHandleFocused)&&this.firstHandle.classList.remove(E.sliderHandleFocused),this.type==="Range"&&this.secondHandle.classList.contains(E.sliderHandleFocused)&&this.secondHandle.classList.remove(E.sliderHandleFocused)},t.prototype.handleFocus=function(e){this.focusSliderElement(),this.sliderBarClick(e),e.currentTarget===this.firstHandle?(this.firstHandle.classList.add(E.sliderHandleFocused),this.firstHandle.classList.add(E.sliderTabHandle)):(this.secondHandle.classList.add(E.sliderHandleFocused),this.secondHandle.classList.add(E.sliderTabHandle)),b.add(document,"mousemove touchmove",this.sliderBarMove,this),b.add(document,"mouseup touchend",this.sliderBarUp,this)},t.prototype.handleOver=function(e){this.tooltip.isVisible&&this.tooltip.showOn==="Hover"&&this.tooltipToggle(e.currentTarget),this.type==="Default"&&this.tooltipToggle(this.getHandle())},t.prototype.handleLeave=function(e){this.tooltip.isVisible&&this.tooltip.showOn==="Hover"&&!e.currentTarget.classList.contains(E.sliderHandleFocused)&&!e.currentTarget.classList.contains(E.sliderTabHandle)&&this.closeTooltip()},t.prototype.setHandler=function(){this.createFirstHandle(),this.type==="Range"&&this.createSecondHandle()},t.prototype.setEnableRTL=function(){this.enableRtl&&this.orientation!=="Vertical"?x([this.sliderContainer],E.rtl):O([this.sliderContainer],E.rtl);var e=this.orientation!=="Vertical"?this.horDir:this.verDir;this.enableRtl?(this.horDir="right",this.verDir="bottom"):(this.horDir="left",this.verDir="bottom");var i=this.orientation!=="Vertical"?this.horDir:this.verDir;e!==i&&this.orientation==="Horizontal"&&(Q(this.firstHandle,{right:"",left:"auto"}),this.type==="Range"&&Q(this.secondHandle,{top:"",left:"auto"})),this.setBarColor()},t.prototype.tooltipValue=function(){var e=this,i,n={value:this.value,text:""};this.initialTooltip&&(this.initialTooltip=!1,this.setTooltipContent(),n.text=i=typeof this.tooltipObj.content=="function"?this.tooltipObj.content():this.tooltipObj.content,this.trigger("tooltipChange",n,function(r){if(e.addTooltipClass(r.text),i!==r.text){e.customAriaText=r.text,e.enableHtmlSanitizer?r.text=vt.sanitize(r.text.toString()):r.text=r.text.toString();var s=function(){return r.text};e.tooltipObj.content=Nn(s),e.setAriaAttrValue(e.firstHandle),e.type==="Range"&&e.setAriaAttrValue(e.secondHandle)}}),this.isMaterialTooltip&&this.setPreviousVal("change",this.value))},t.prototype.setTooltipContent=function(){var e;e=this.formatContent(this.tooltipFormatInfo,!1);var i=function(){return e};this.tooltipObj.content=Nn(i)},t.prototype.formatContent=function(e,i){var n="",r=this.handleVal1,s=this.handleVal2;return!h(this.customValues)&&this.customValues.length>0&&(r=this.customValues[this.handleVal1],s=this.customValues[this.handleVal2]),i?(this.type==="Range"?this.enableRtl&&this.orientation!=="Vertical"?n=!h(this.tooltip)&&!h(this.tooltip.format)?this.formatString(s,e).elementVal+" - "+this.formatString(r,e).elementVal:s.toString()+" - "+r.toString():n=!h(this.tooltip)&&!h(this.tooltip.format)?this.formatString(r,e).elementVal+" - "+this.formatString(s,e).elementVal:r.toString()+" - "+s.toString():h(r)||(n=!h(this.tooltip)&&!h(this.tooltip.format)?this.formatString(r,e).elementVal:r.toString()),n):(this.type==="Range"?this.enableRtl&&this.orientation!=="Vertical"?n=h(e.format)?s.toString()+" - "+r.toString():this.formatString(s,e).formatString+" - "+this.formatString(r,e).formatString:n=h(e.format)?r.toString()+" - "+s.toString():this.formatString(r,e).formatString+" - "+this.formatString(s,e).formatString:h(r)||(n=h(e.format)?r.toString():this.formatString(r,e).formatString),n)},t.prototype.addTooltipClass=function(e){if(this.isMaterialTooltip){var i=e.toString().length;if(this.tooltipElement){var n=i>4?{oldCss:E.sliderMaterialDefault,newCss:E.sliderMaterialRange}:{oldCss:E.sliderMaterialRange,newCss:E.sliderMaterialDefault};this.tooltipElement.classList.remove(n.oldCss),this.tooltipElement.classList.contains(n.newCss)||(this.tooltipElement.classList.add(n.newCss),this.tooltipElement.style.transform=i>4?"scale(1)":this.getTooltipTransformProperties(this.previousTooltipClass).rotate)}else{var n=i>4?E.sliderMaterialRange:E.sliderMaterialDefault;this.tooltipObj.cssClass=E.sliderTooltip+" "+n}}},t.prototype.tooltipPlacement=function(){return this.orientation==="Horizontal"?this.tooltip.placement==="Before"?"TopCenter":"BottomCenter":this.tooltip.placement==="Before"?"LeftCenter":"RightCenter"},t.prototype.tooltipBeforeOpen=function(e){this.tooltipElement=e.element,this.tooltip.cssClass&&x([this.tooltipElement],this.tooltip.cssClass.split(" ").filter(function(i){return i})),e.target.removeAttribute("aria-describedby"),this.isMaterialTooltip&&(this.tooltipElement.firstElementChild.classList.add(E.materialTooltipHide),this.handleStart(),this.setTooltipTransform())},t.prototype.tooltipCollision=function(e){if(this.isBootstrap||this.isBootstrap4||(this.isMaterial||this.isMaterial3)&&!this.isMaterialTooltip){var i=this.isBootstrap4?Tc:Cc;switch(e){case"TopCenter":this.tooltipObj.setProperties({offsetY:-i},!1);break;case"BottomCenter":this.tooltipObj.setProperties({offsetY:i},!1);break;case"LeftCenter":this.tooltipObj.setProperties({offsetX:-i},!1);break;case"RightCenter":this.tooltipObj.setProperties({offsetX:i},!1);break}}},t.prototype.materialTooltipEventCallBack=function(e){this.sliderBarClick(e),b.add(document,"mousemove touchmove",this.sliderBarMove,this),b.add(document,"mouseup touchend",this.sliderBarUp,this)},t.prototype.wireMaterialTooltipEvent=function(e){this.isMaterialTooltip&&(e?b.remove(this.tooltipElement,"mousedown touchstart",this.materialTooltipEventCallBack):b.add(this.tooltipElement,"mousedown touchstart",this.materialTooltipEventCallBack,this))},t.prototype.tooltipPositionCalculation=function(e){var i;switch(e){case"TopCenter":i=E.horizontalTooltipBefore;break;case"BottomCenter":i=E.horizontalTooltipAfter;break;case"LeftCenter":i=E.verticalTooltipBefore;break;case"RightCenter":i=E.verticalTooltipAfter;break}return i},t.prototype.getTooltipTransformProperties=function(e){var i;if(this.tooltipElement){var n=this.orientation==="Horizontal"?this.tooltipElement.clientHeight+14-this.tooltipElement.clientHeight/2:this.tooltipElement.clientWidth+14-this.tooltipElement.clientWidth/2;i=this.orientation==="Horizontal"?e===E.horizontalTooltipBefore?{rotate:"rotate(45deg)",translate:"translateY("+n+"px)"}:{rotate:"rotate(225deg)",translate:"translateY("+-n+"px)"}:e===E.verticalTooltipBefore?{rotate:"rotate(-45deg)",translate:"translateX("+n+"px)"}:{rotate:"rotate(-225deg)",translate:"translateX("+-n+"px)"}}return i},t.prototype.openMaterialTooltip=function(){var e=this;if(this.isMaterialTooltip){this.refreshTooltip(this.firstHandle);var i=this.tooltipElement.firstElementChild;i.classList.remove(E.materialTooltipHide),i.classList.add(E.materialTooltipShow),this.firstHandle.style.cursor="default",this.tooltipElement.style.transition=this.scaleTransform,this.tooltipElement.classList.add(E.materialTooltipOpen),this.materialHandle.style.transform="scale(0)",i.innerText.length>4?this.tooltipElement.style.transform="scale(1)":this.tooltipElement.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate,this.type==="Default"?setTimeout(function(){e.tooltipElement&&(e.tooltipElement.style.transition=e.transition.handle)},2500):setTimeout(function(){e.tooltipElement&&(e.tooltipElement.style.transition="none")},2500)}},t.prototype.closeMaterialTooltip=function(){var e=this;if(this.isMaterialTooltip){var i=this.tooltipElement.firstElementChild;this.tooltipElement.style.transition=this.scaleTransform,i.classList.remove(E.materialTooltipShow),i.classList.add(E.materialTooltipHide),this.firstHandle.style.cursor="-webkit-grab",this.firstHandle.style.cursor="grab",this.materialHandle&&(this.materialHandle.style.transform="scale(1)"),this.tooltipElement.classList.remove(E.materialTooltipOpen),this.setTooltipTransform(),this.tooltipTarget=void 0,setTimeout(function(){e.tooltipElement&&(e.tooltipElement.style.transition="none")},2500)}},t.prototype.checkTooltipPosition=function(e){var i=this.tooltipPositionCalculation(e.collidedPosition);(this.tooltipCollidedPosition===void 0||this.tooltipCollidedPosition!==e.collidedPosition||!e.element.classList.contains(i))&&(this.isMaterialTooltip&&(i!==void 0&&(e.element.classList.remove(this.previousTooltipClass),e.element.classList.add(i),this.previousTooltipClass=i),e.element.style.transform&&e.element.classList.contains(E.materialTooltipOpen)&&e.element.firstElementChild.innerText.length<=4&&(e.element.style.transform=this.getTooltipTransformProperties(this.previousTooltipClass).rotate)),this.tooltipCollidedPosition=e.collidedPosition),this.isMaterialTooltip&&this.tooltipElement&&this.tooltipElement.style.transform.indexOf("translate")!==-1&&this.setTooltipTransform()},t.prototype.setTooltipTransform=function(){var e=this.getTooltipTransformProperties(this.previousTooltipClass);h(this.tooltipElement)||(this.tooltipElement.firstElementChild.innerText.length>4?this.tooltipElement.style.transform=e.translate+" scale(0.01)":this.tooltipElement.style.transform=e.translate+" "+e.rotate+" scale(0.01)")},t.prototype.renderTooltip=function(){this.tooltipObj=new Qt({showTipPointer:this.isBootstrap||this.isMaterial||this.isMaterial3||this.isBootstrap4||this.isTailwind||this.isBootstrap5||this.isFluent,cssClass:E.sliderTooltip,height:this.isMaterial||this.isMaterial3?30:"auto",animation:{open:{effect:"None"},close:{effect:"FadeOut",duration:500}},opensOn:"Custom",beforeOpen:this.tooltipBeforeOpen.bind(this),beforeCollision:this.checkTooltipPosition.bind(this),beforeClose:this.tooltipBeforeClose.bind(this),enableHtmlSanitizer:this.enableHtmlSanitizer}),this.tooltipObj.appendTo(this.firstHandle),this.initializeTooltipProps()},t.prototype.initializeTooltipProps=function(){var e=this.tooltip.showOn==="Auto"?"Hover":this.tooltip.showOn;this.setProperties({tooltip:{showOn:e}},!0),this.tooltipObj.position=this.tooltipPlacement(),this.tooltipCollision(this.tooltipObj.position),[this.firstHandle,this.rangeBar,this.secondHandle].forEach(function(i){h(i)||(i.style.transition="none")}),this.isMaterialTooltip&&(this.sliderContainer.classList.add(E.materialSlider),this.tooltipValue(),this.tooltipObj.animation.close.effect="None",this.tooltipObj.open(this.firstHandle))},t.prototype.tooltipBeforeClose=function(){this.tooltipElement=void 0,this.tooltipCollidedPosition=void 0},t.prototype.setButtons=function(){this.firstBtn=this.createElement("div",{className:E.sliderButton+" "+E.firstButton}),this.firstBtn.appendChild(this.createElement("span",{className:E.sliderButtonIcon})),this.isTailwind&&this.firstBtn.querySelector("span").classList.add("e-icons"),this.firstBtn.tabIndex=-1,this.secondBtn=this.createElement("div",{className:E.sliderButton+" "+E.secondButton}),this.secondBtn.appendChild(this.createElement("span",{className:E.sliderButtonIcon})),this.isTailwind&&this.secondBtn.querySelector("span").classList.add("e-icons"),this.secondBtn.tabIndex=-1,this.sliderContainer.classList.add(E.sliderButtonClass),this.sliderContainer.appendChild(this.firstBtn),this.sliderContainer.appendChild(this.secondBtn),this.sliderContainer.appendChild(this.element),this.buttonTitle()},t.prototype.buttonTitle=function(){var e=this.enableRtl&&this.orientation!=="Vertical";this.l10n.setLocale(this.locale);var i=this.l10n.getConstant("decrementTitle"),n=this.l10n.getConstant("incrementTitle");ce(e?this.secondBtn:this.firstBtn,{"aria-label":i,title:i}),ce(e?this.firstBtn:this.secondBtn,{"aria-label":n,title:n})},t.prototype.buttonFocusOut=function(){(this.isMaterial||this.isMaterial3)&&this.getHandle().classList.remove("e-large-thumb-size")},t.prototype.repeatButton=function(e){var i=this.handleValueUpdate(),n=this.enableRtl&&this.orientation!=="Vertical",r;e.target.parentElement.classList.contains(E.firstButton)||e.target.classList.contains(E.firstButton)?n?r=this.add(i,parseFloat(this.step.toString()),!0):r=this.add(i,parseFloat(this.step.toString()),!1):(e.target.parentElement.classList.contains(E.secondButton)||e.target.classList.contains(E.secondButton))&&(n?r=this.add(i,parseFloat(this.step.toString()),!1):r=this.add(i,parseFloat(this.step.toString()),!0)),this.limits.enabled&&(r=this.getLimitCorrectedValues(r)),r>=this.min&&r<=this.max&&(this.changeHandleValue(r),this.tooltipToggle(this.getHandle()))},t.prototype.repeatHandlerMouse=function(e){e.preventDefault(),(e.type==="mousedown"||e.type==="touchstart")&&(this.buttonClick(e),this.repeatInterval=setInterval(this.repeatButton.bind(this),180,e))},t.prototype.materialChange=function(){this.getHandle().classList.contains("e-large-thumb-size")||this.getHandle().classList.add("e-large-thumb-size")},t.prototype.focusHandle=function(){this.getHandle().classList.contains(E.sliderTabHandle)||this.getHandle().classList.add(E.sliderTabHandle)},t.prototype.repeatHandlerUp=function(e){this.changeEvent("changed",e),this.closeTooltip(),clearInterval(this.repeatInterval),this.getHandle().focus()},t.prototype.customTickCounter=function(e){var i=4;return!h(this.customValues)&&this.customValues.length>0&&(e>4&&(i=3),e>7&&(i=2),e>14&&(i=1),e>28&&(i=0)),i},t.prototype.renderScale=function(){var e=this.orientation==="Vertical"?"v":"h";this.noOfDecimals=this.numberOfDecimals(this.step),this.ul=this.createElement("ul",{className:E.scale+" e-"+e+"-scale "+E.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation",tabIndex:"-1","aria-hidden":"true"}}),this.ul.style.zIndex="-1",D.isAndroid&&e==="h"&&this.ul.classList.add(E.sliderTickPosition);var i=this.ticks.smallStep;this.ticks.showSmallTicks?i<=0&&(i=parseFloat(H(this.step))):this.ticks.largeStep>0?i=this.ticks.largeStep:i=parseFloat(H(this.max))-parseFloat(H(this.min));var n=this.fractionalToInteger(this.min),r=this.fractionalToInteger(this.max),s=this.fractionalToInteger(i),a=!h(this.customValues)&&this.customValues.length>0&&this.customValues.length-1,l=this.customTickCounter(a),c=!h(this.customValues)&&this.customValues.length>0?a*l+a:Math.abs((r-n)/s);this.element.appendChild(this.ul);var p,d=parseFloat(this.min.toString());e==="v"&&(d=parseFloat(this.max.toString()));var u=0,f,m=100/c;m===1/0&&(m=5);for(var v=0,y=!h(this.customValues)&&this.customValues.length>0?this.customValues.length-1:0,L=0;v<=c;v++){if(p=this.createElement("li",{attrs:{class:E.tick,role:"presentation",tabIndex:"-1","aria-hidden":"true"}}),!h(this.customValues)&&this.customValues.length>0)f=v%(l+1)===0,f&&(e==="h"?(d=this.customValues[L],L++):(d=this.customValues[y],y--),p.setAttribute("title",d.toString()));else if(p.setAttribute("title",d.toString()),this.numberOfDecimals(this.max)===0&&this.numberOfDecimals(this.min)===0&&this.numberOfDecimals(this.step)===0)e==="h"?f=(d-parseFloat(this.min.toString()))%this.ticks.largeStep===0:f=Math.abs(d-parseFloat(this.max.toString()))%this.ticks.largeStep===0;else{var C=this.fractionalToInteger(this.ticks.largeStep),w=this.fractionalToInteger(d);e==="h"?f=(w-n)%C===0:f=Math.abs(w-parseFloat(r.toString()))%C===0}f&&p.classList.add(E.large),e==="h"?p.style.width=m+"%":p.style.height=m+"%";var k=f?this.ticks.placement==="Both"?2:1:0;if(f)for(var I=0;I<k;I++)this.createTick(p,d,m);else h(this.customValues)&&this.formatTicksValue(p,d);this.ul.appendChild(p),this.tickElementCollection.push(p);var P=void 0;h(this.customValues)&&(this.numberOfDecimals(i)>this.numberOfDecimals(d)?P=this.numberOfDecimals(i):P=this.numberOfDecimals(d),e==="h"?d=this.makeRoundNumber(d+i,P):this.min>this.max?d=this.makeRoundNumber(d+i,P):d=this.makeRoundNumber(d-i,P),u=this.makeRoundNumber(u+i,P))}this.ticksAlignment(e,m)},t.prototype.ticksAlignment=function(e,i,n){n===void 0&&(n=!0),this.firstChild=this.ul.firstElementChild,this.lastChild=this.ul.lastElementChild,this.firstChild.classList.add(E.sliderFirstTick),this.lastChild.classList.add(E.sliderLastTick),this.sliderContainer.classList.add(E.scale+"-"+this.ticks.placement.toLowerCase()),e==="h"?(this.firstChild.style.width=i/2+"%",this.lastChild.style.width=i/2+"%"):(this.firstChild.style.height=i/2+"%",this.lastChild.style.height=i/2+"%");var r={ticksWrapper:this.ul,tickElements:this.tickElementCollection};n&&this.trigger("renderedTicks",r),this.scaleAlignment()},t.prototype.createTick=function(e,i,n){var r=this.createElement("span",{className:E.tickValue+" "+E.tick+"-"+this.ticks.placement.toLowerCase(),attrs:{role:"presentation",tabIndex:"-1","aria-hidden":"true"}});e.appendChild(r),h(this.customValues)?this.formatTicksValue(e,i,r,n):this.enableHtmlSanitizer?r.innerHTML=vt.sanitize(i.toString()):r.innerHTML=i.toString()},t.prototype.formatTicksValue=function(e,i,n,r){var s=this,a=this.formatNumber(i),l=!h(this.ticks)&&!h(this.ticks.format)?this.formatString(i,this.ticksFormatInfo).formatString:a,c={value:i,text:l,tickElement:e};this.trigger("renderingTicks",c,function(p){e.setAttribute("title",p.text.toString()),n&&(s.enableHtmlSanitizer?n.innerHTML=vt.sanitize(p.text.toString()):n.innerHTML=p.text.toString())})},t.prototype.scaleAlignment=function(){this.tickValuePosition(),this.orientation,this.orientation==="Vertical"?this.element.getBoundingClientRect().width<=15?this.sliderContainer.classList.add(E.sliderSmallSize):this.sliderContainer.classList.remove(E.sliderSmallSize):this.element.getBoundingClientRect().height<=15?this.sliderContainer.classList.add(E.sliderSmallSize):this.sliderContainer.classList.remove(E.sliderSmallSize)},t.prototype.tickValuePosition=function(){this.firstChild=this.element.querySelector("ul").children[0];var e=this.firstChild.getBoundingClientRect(),i,n,r=this.ticks.smallStep,s=Math.abs(parseFloat(H(this.max))-parseFloat(H(this.min)))/r;this.firstChild.children.length>0&&(i=this.firstChild.children[0].getBoundingClientRect());var a=[this.sliderContainer.querySelectorAll("."+E.tick+"."+E.large+" ."+E.tickValue)],l;this.ticks.placement==="Both"?l=[].slice.call(a[0],2):l=[].slice.call(a[0],1);for(var c=this.orientation==="Vertical"?e.height*2:e.width*2,p=0;p<this.firstChild.children.length;p++)this.orientation==="Vertical"?this.firstChild.children[p].style.top=-(i.height/2)+"px":this.enableRtl?this.firstChild.children[p].style.left=(c-this.firstChild.children[p].getBoundingClientRect().width)/2+"px":this.firstChild.children[p].style.left=-(i.width/2)+"px";for(var p=0;p<l.length;p++)n=l[p].getBoundingClientRect(),this.orientation==="Vertical"?Q(l[p],{top:(c-n.height)/2+"px"}):Q(l[p],{left:(c-n.width)/2+"px"});this.enableRtl&&this.lastChild.children.length&&s!==0&&(this.lastChild.children[0].style.left=-(this.lastChild.getBoundingClientRect().width/2)+"px",this.ticks.placement==="Both"&&(this.lastChild.children[1].style.left=-(this.lastChild.getBoundingClientRect().width/2)+"px")),s===0&&(this.orientation==="Horizontal"&&(this.enableRtl?(this.firstChild.classList.remove(E.sliderLastTick),this.firstChild.style.right=this.firstHandle.style.right,this.firstChild.children[0].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px",this.ticks.placement==="Both"&&(this.firstChild.children[1].style.left=this.firstChild.getBoundingClientRect().width/2+2+"px")):(this.firstChild.classList.remove(E.sliderLastTick),this.firstChild.style.left=this.firstHandle.style.left)),this.orientation==="Vertical"&&this.firstChild.classList.remove(E.sliderLastTick))},t.prototype.setAriaAttrValue=function(e){var i,n=!h(this.ticks)&&!h(this.ticks.format),r=n?this.formatContent(this.tooltipFormatInfo,!1):this.formatContent(this.ticksFormatInfo,!1),s=n?this.formatContent(this.ticksFormatInfo,!0):this.formatContent(this.tooltipFormatInfo,!0);r=this.customAriaText?this.customAriaText:r,r.split(" - ").length===2?i=r.split(" - "):i=[r,r],this.setAriaAttributes(e),this.type!=="Range"?ce(e,{"aria-valuenow":s,"aria-valuetext":r}):this.enableRtl?e===this.firstHandle?ce(e,{"aria-valuenow":s.split(" - ")[1],"aria-valuetext":i[1]}):ce(e,{"aria-valuenow":s.split(" - ")[0],"aria-valuetext":i[0]}):e===this.firstHandle?ce(e,{"aria-valuenow":s.split(" - ")[0],"aria-valuetext":i[0]}):ce(e,{"aria-valuenow":s.split(" - ")[1],"aria-valuetext":i[1]})},t.prototype.handleValueUpdate=function(){var e;return this.type==="Range"?this.activeHandle===1?e=this.handleVal1:e=this.handleVal2:e=this.handleVal1,e},t.prototype.getLimitCorrectedValues=function(e){return this.type==="MinRange"||this.type==="Default"?e=this.getLimitValueAndPosition(e,this.limits.minStart,this.limits.minEnd)[0]:this.activeHandle===1?e=this.getLimitValueAndPosition(e,this.limits.minStart,this.limits.minEnd)[0]:e=this.getLimitValueAndPosition(e,this.limits.maxStart,this.limits.maxEnd)[0],e},t.prototype.focusSliderElement=function(){this.isElementFocused||(this.element.focus(),this.isElementFocused=!0)},t.prototype.buttonClick=function(e){this.focusSliderElement();var i,n=this.enableRtl&&this.orientation!=="Vertical",r=this.handleValueUpdate();e.keyCode===40||e.keyCode===37||e.currentTarget.classList.contains(E.firstButton)?n?i=this.add(r,parseFloat(this.step.toString()),!0):i=this.add(r,parseFloat(this.step.toString()),!1):e.keyCode===38||e.keyCode===39||e.currentTarget.classList.contains(E.secondButton)?n?i=this.add(r,parseFloat(this.step.toString()),!1):i=this.add(r,parseFloat(this.step.toString()),!0):e.keyCode===33||e.currentTarget.classList.contains(E.firstButton)?n?i=this.add(r,parseFloat(this.ticks.largeStep.toString()),!1):i=this.add(r,parseFloat(this.ticks.largeStep.toString()),!0):e.keyCode===34||e.currentTarget.classList.contains(E.secondButton)?n?i=this.add(r,parseFloat(this.ticks.largeStep.toString()),!0):i=this.add(r,parseFloat(this.ticks.largeStep.toString()),!1):e.keyCode===36?i=parseFloat(this.min<this.max?this.min.toString():this.max.toString()):e.keyCode===35&&(i=parseFloat(this.min<this.max?this.max.toString():this.min.toString())),this.limits.enabled&&(i=this.getLimitCorrectedValues(i)),this.changeHandleValue(i),(this.isMaterial||this.isMaterial3)&&!this.tooltip.isVisible&&!this.getHandle().classList.contains(E.sliderTabHandle)&&this.materialChange(),this.tooltipToggle(this.getHandle()),this.getHandle().focus(),this.focusHandle(),e.currentTarget.classList.contains(E.firstButton)&&b.add(this.firstBtn,"mouseup touchend",this.buttonUp,this),e.currentTarget.classList.contains(E.secondButton)&&b.add(this.secondBtn,"mouseup touchend",this.buttonUp,this)},t.prototype.tooltipToggle=function(e){this.isMaterialTooltip?this.tooltipElement.classList.contains(E.materialTooltipOpen)?this.refreshTooltip(this.firstHandle):this.openMaterialTooltip():this.tooltipElement?this.refreshTooltip(e):this.openTooltip(e)},t.prototype.buttonUp=function(e){e.currentTarget.classList.contains(E.firstButton)&&b.remove(this.firstBtn,"mouseup touchend",this.buttonUp),e.currentTarget.classList.contains(E.secondButton)&&b.remove(this.secondBtn,"mouseup touchend",this.buttonUp)},t.prototype.setRangeBar=function(){this.orientation==="Horizontal"&&!h(this.rangeBar)?this.type==="MinRange"?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",Q(this.rangeBar,{width:h(this.handlePos1)?0:this.handlePos1+"px"})):(this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",Q(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"})):h(this.rangeBar)||(this.type==="MinRange"?(this.rangeBar.style.bottom=this.min>this.max?this.handlePos1+"px":"0px",Q(this.rangeBar,{height:h(this.handlePos1)?0:this.min>this.max?this.element.clientHeight-this.handlePos1+"px":this.handlePos1+"px"})):(this.rangeBar.style.bottom=this.min>this.max?this.handlePos2+"px":this.handlePos1+"px",Q(this.rangeBar,{height:this.min>this.max?this.handlePos1-this.handlePos2+"px":this.handlePos2-this.handlePos1+"px"})))},t.prototype.checkValidValueAndPos=function(e){return e=this.checkHandleValue(e),e=this.checkHandlePosition(e),e},t.prototype.setLimitBarPositions=function(e,i,n,r){this.orientation==="Horizontal"?this.enableRtl?(this.limitBarFirst.style.right=e+"px",this.limitBarFirst.style.width=i-e+"px"):(this.limitBarFirst.style.left=e+"px",this.limitBarFirst.style.width=i-e+"px"):(this.limitBarFirst.style.bottom=(this.min<this.max?e:i)+"px",this.limitBarFirst.style.height=(this.min<this.max?i-e:e-i)+"px"),this.type==="Range"&&(this.orientation==="Horizontal"?this.enableRtl?(this.limitBarSecond.style.right=n+"px",this.limitBarSecond.style.width=r-n+"px"):(this.limitBarSecond.style.left=n+"px",this.limitBarSecond.style.width=r-n+"px"):(this.limitBarSecond.style.bottom=(this.min<this.max?n:r)+"px",this.limitBarSecond.style.height=(this.min<this.max?r-n:n-r)+"px"))},t.prototype.setLimitBar=function(){if(this.type==="Default"||this.type==="MinRange"){var e=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];e=this.checkValidValueAndPos(e);var i=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];i=this.checkValidValueAndPos(i),this.setLimitBarPositions(e,i)}else if(this.type==="Range"){var n=this.getLimitValueAndPosition(this.limits.minStart,this.limits.minStart,this.limits.minEnd,!0)[0];n=this.checkValidValueAndPos(n);var r=this.getLimitValueAndPosition(this.limits.minEnd,this.limits.minStart,this.limits.minEnd,!0)[0];r=this.checkValidValueAndPos(r);var s=this.getLimitValueAndPosition(this.limits.maxStart,this.limits.maxStart,this.limits.maxEnd,!0)[0];s=this.checkValidValueAndPos(s);var a=this.getLimitValueAndPosition(this.limits.maxEnd,this.limits.maxStart,this.limits.maxEnd,!0)[0];a=this.checkValidValueAndPos(a),this.setLimitBarPositions(n,r,s,a)}},t.prototype.getLimitValueAndPosition=function(e,i,n,r){return h(i)&&(i=this.min<this.max?this.min:this.max,h(e)&&r&&(e=i)),h(n)&&(n=this.min<this.max?this.max:this.min,h(e)&&r&&(e=n)),e<i&&(e=i),e>n&&(e=n),[e,this.checkHandlePosition(e)]},t.prototype.setValue=function(){if(!h(this.customValues)&&this.customValues.length>0&&(this.min=0,this.max=this.customValues.length-1,this.setBarColor()),this.setAriaAttributes(this.firstHandle),this.handleVal1=h(this.value)?this.checkHandleValue(parseFloat(this.min.toString())):this.checkHandleValue(parseFloat(this.value.toString())),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.preHandlePos1=this.handlePos1,h(this.activeHandle)?this.type==="Range"?this.activeHandle=2:this.activeHandle=1:this.activeHandle=this.activeHandle,this.type==="Default"||this.type==="MinRange"){if(this.limits.enabled){var e=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=e[0],this.handlePos1=e[1],this.preHandlePos1=this.handlePos1}this.setHandlePosition(null),this.handleStart(),this.value=this.handleVal1,this.setAriaAttrValue(this.firstHandle),this.changeEvent("changed",null)}else this.validateRangeValue();this.type!=="Default"&&this.setRangeBar(),this.limits.enabled&&this.setLimitBar()},t.prototype.rangeValueUpdate=function(){(this.value===null||typeof this.value!="object")&&(this.value=[parseFloat(H(this.min)),parseFloat(H(this.max))])},t.prototype.validateRangeValue=function(){this.rangeValueUpdate(),this.setRangeValue()},t.prototype.modifyZindex=function(){this.type==="Range"&&!h(this.firstHandle)&&!h(this.secondHandle)?this.activeHandle===1?(this.firstHandle.style.zIndex=this.zIndex+4+"",this.secondHandle.style.zIndex=this.zIndex+3+""):(this.firstHandle.style.zIndex=this.zIndex+3+"",this.secondHandle.style.zIndex=this.zIndex+4+""):this.isMaterialTooltip&&this.tooltipElement&&(this.tooltipElement.style.zIndex=cn(this.element)+"")},t.prototype.setHandlePosition=function(e){var i=this,n,r=this.activeHandle===1?this.handlePos1:this.handlePos2;this.isMaterialTooltip?n=[this.firstHandle,this.materialHandle]:n=[this.getHandle()],this.handleStart(),n.forEach(function(s){i.orientation==="Horizontal"?i.enableRtl?s.style.right=r+"px":s.style.left=r+"px":s.style.bottom=r+"px"}),this.changeEvent("change",e)},t.prototype.getHandle=function(){return this.activeHandle===1?this.firstHandle:this.secondHandle},t.prototype.setRangeValue=function(){this.updateRangeValue(),this.activeHandle=1,this.setHandlePosition(null),this.activeHandle=2,this.setHandlePosition(null),this.activeHandle=1},t.prototype.changeEvent=function(e,i){var n=e==="change"?this.previousVal:this.previousChanged;if(this.type!=="Range")this.setProperties({value:this.handleVal1},!0),n!==this.value&&(!this.isMaterialTooltip||!this.initialTooltip)&&(this.trigger(e,this.changeEventArgs(e,i)),this.initialTooltip=!0,this.setPreviousVal(e,this.value)),this.setAriaAttrValue(this.firstHandle);else{var r=this.value=[this.handleVal1,this.handleVal2];this.setProperties({value:r},!0),(n.length===this.value.length&&this.value[0]!==n[0]||this.value[1]!==n[1])&&(this.initialTooltip=!1,this.trigger(e,this.changeEventArgs(e,i)),this.initialTooltip=!0,this.setPreviousVal(e,this.value)),this.setAriaAttrValue(this.getHandle())}this.hiddenInput.value=this.value.toString()},t.prototype.changeEventArgs=function(e,i){var n;return this.tooltip.isVisible&&this.tooltipObj&&this.initialTooltip?(this.tooltipValue(),n={value:this.value,previousValue:e==="change"?this.previousVal:this.previousChanged,action:e,text:typeof this.tooltipObj.content=="function"?this.tooltipObj.content():this.tooltipObj.content,isInteracted:!h(i)}):n={value:this.value,previousValue:e==="change"?this.previousVal:this.previousChanged,action:e,text:h(this.ticksFormatInfo.format)?this.value.toString():this.type!=="Range"?this.formatString(this.value,this.ticksFormatInfo).formatString:this.formatString(this.value[0],this.ticksFormatInfo).formatString+" - "+this.formatString(this.value[1],this.ticksFormatInfo).formatString,isInteracted:!h(i)},n},t.prototype.setPreviousVal=function(e,i){e==="change"?this.previousVal=i:this.previousChanged=i},t.prototype.updateRangeValue=function(){var e=this.value.toString().split(",").map(Number);if(this.enableRtl&&this.orientation!=="Vertical"||this.rtl?this.value=[e[1],e[0]]:this.value=[e[0],e[1]],this.enableRtl&&this.orientation!=="Vertical"?(this.handleVal1=this.checkHandleValue(this.value[1]),this.handleVal2=this.checkHandleValue(this.value[0])):(this.handleVal1=this.checkHandleValue(this.value[0]),this.handleVal2=this.checkHandleValue(this.value[1])),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2),this.min<this.max&&this.handlePos1>this.handlePos2&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.min>this.max&&this.handlePos1<this.handlePos2&&(this.handlePos2=this.handlePos1,this.handleVal2=this.handleVal1),this.preHandlePos1=this.handlePos1,this.preHandlePos2=this.handlePos2,this.limits.enabled){this.activeHandle=1;var i=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=i[0],this.handlePos1=i[1],this.preHandlePos1=this.handlePos1,this.activeHandle=2,i=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=i[0],this.handlePos2=i[1],this.preHandlePos2=this.handlePos2}},t.prototype.checkHandlePosition=function(e){var i;return e=100*(e-parseFloat(H(this.min)))/(parseFloat(H(this.max))-parseFloat(H(this.min))),this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width*(e/100):i=this.element.getBoundingClientRect().height*(e/100),parseFloat(H(this.max))===parseFloat(H(this.min))&&(this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width:i=this.element.getBoundingClientRect().height),i},t.prototype.checkHandleValue=function(e){if(this.min===this.max)return parseFloat(H(this.max));var i=this.tempStartEnd();return e<i.start?e=i.start:e>i.end&&(e=i.end),e},t.prototype.reposition=function(){var e=this;h(this.firstHandle)||(this.firstHandle.style.transition="none"),this.type!=="Default"&&!h(this.rangeBar)&&(this.rangeBar.style.transition="none"),this.type==="Range"&&!h(this.secondHandle)&&(this.secondHandle.style.transition="none"),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handleVal2&&(this.handlePos2=this.checkHandlePosition(this.handleVal2)),this.orientation==="Horizontal"?(this.enableRtl?this.firstHandle.style.right=this.handlePos1+"px":this.firstHandle.style.left=this.handlePos1+"px",this.isMaterialTooltip&&!h(this.materialHandle)&&(this.enableRtl?this.materialHandle.style.right=this.handlePos1+"px":this.materialHandle.style.left=this.handlePos1+"px"),this.type==="MinRange"&&!h(this.rangeBar)?(this.enableRtl?this.rangeBar.style.right="0px":this.rangeBar.style.left="0px",Q(this.rangeBar,{width:h(this.handlePos1)?0:this.handlePos1+"px"})):this.type==="Range"&&!h(this.secondHandle)&&!h(this.rangeBar)&&(this.enableRtl?this.secondHandle.style.right=this.handlePos2+"px":this.secondHandle.style.left=this.handlePos2+"px",this.enableRtl?this.rangeBar.style.right=this.handlePos1+"px":this.rangeBar.style.left=this.handlePos1+"px",Q(this.rangeBar,{width:this.handlePos2-this.handlePos1+"px"}))):(this.firstHandle.style.bottom=this.handlePos1+"px",this.isMaterialTooltip&&(this.materialHandle.style.bottom=this.handlePos1+"px"),this.type==="MinRange"?(this.rangeBar.style.bottom=this.min>this.max?this.handlePos1+"px":"0px",Q(this.rangeBar,{height:h(this.handlePos1)?0:this.min>this.max?this.element.clientHeight-this.handlePos1+"px":this.handlePos1+"px"})):this.type==="Range"&&(this.secondHandle.style.bottom=this.handlePos2+"px",this.rangeBar.style.bottom=this.min>this.max?this.handlePos2+"px":this.handlePos1+"px",Q(this.rangeBar,{height:this.min>this.max?this.handlePos1-this.handlePos2+"px":this.handlePos2-this.handlePos1+"px"}))),this.limits.enabled&&this.setLimitBar(),this.ticks.placement!=="None"&&this.ul&&(this.removeElement(this.ul),this.ul=void 0,this.renderScale()),this.handleStart(),this.tooltip.isVisible||setTimeout(function(){h(e.firstHandle)||(e.firstHandle.style.transition=e.scaleTransform),e.type==="Range"&&!h(e.secondHandle)&&(e.secondHandle.style.transition=e.scaleTransform)}),this.refreshTooltip(this.tooltipTarget),this.setBarColor()},t.prototype.changeHandleValue=function(e){var i=null;this.activeHandle===1?(this.limits.enabled&&this.limits.startHandleFixed||(this.handleVal1=this.checkHandleValue(e),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.type==="Range"&&(this.handlePos1>this.handlePos2&&this.min<this.max||this.handlePos1<this.handlePos2&&this.min>this.max)&&(this.handlePos1=this.handlePos2,this.handleVal1=this.handleVal2),this.handlePos1!==this.preHandlePos1&&(i=this.preHandlePos1=this.handlePos1)),this.modifyZindex()):(this.limits.enabled&&this.limits.endHandleFixed||(this.handleVal2=this.checkHandleValue(e),this.handlePos2=this.checkHandlePosition(this.handleVal2),this.type==="Range"&&(this.handlePos2<this.handlePos1&&this.min<this.max||this.handlePos2>this.handlePos1&&this.min>this.max)&&(this.handlePos2=this.handlePos1,this.handleVal2=this.handleVal1),this.handlePos2!==this.preHandlePos2&&(i=this.preHandlePos2=this.handlePos2)),this.modifyZindex()),i!==null&&(this.type!=="Default"&&this.setRangeBar(),this.setHandlePosition(null))},t.prototype.tempStartEnd=function(){return this.min>this.max?{start:this.max,end:this.min}:{start:this.min,end:this.max}},t.prototype.xyToPosition=function(e){var i;if(this.min===this.max)return 100;if(this.orientation==="Horizontal"){var n=e.x-this.element.getBoundingClientRect().left,r=this.element.offsetWidth/100;this.val=n/r}else{var s=e.y-this.element.getBoundingClientRect().top,r=this.element.offsetHeight/100;this.val=100-s/r}var a=this.stepValueCalculation(this.val);return a<0?a=0:a>100&&(a=100),this.enableRtl&&this.orientation!=="Vertical"&&(a=100-a),this.orientation==="Horizontal"?i=this.element.getBoundingClientRect().width*(a/100):i=this.element.getBoundingClientRect().height*(a/100),i},t.prototype.stepValueCalculation=function(e){this.step===0&&(this.step=1);var i=parseFloat(H(this.step))/((parseFloat(H(this.max))-parseFloat(H(this.min)))/100),n=e%Math.abs(i);return n!==0&&(i/2>n?e-=n:e+=Math.abs(i)-n),e},t.prototype.add=function(e,i,n){var r=Math.pow(10,3),s;return n?s=(Math.round(e*r)+Math.round(i*r))/r:s=(Math.round(e*r)-Math.round(i*r))/r,s},t.prototype.positionToValue=function(e){var i,n=parseFloat(H(this.max))-parseFloat(H(this.min));this.orientation==="Horizontal"?i=e/this.element.getBoundingClientRect().width*n:i=e/this.element.getBoundingClientRect().height*n;var r=this.add(i,parseFloat(this.min.toString()),!0);return r},t.prototype.sliderBarClick=function(e){e.preventDefault();var i;e.type==="mousedown"||e.type==="mouseup"||e.type==="click"?i={x:e.clientX,y:e.clientY}:(e.type==="touchend"||e.type==="touchstart")&&(i={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY});var n=this.xyToPosition(i),r=this.positionToValue(n);if(this.type==="Range"&&(this.min<this.max&&this.handlePos2-n<n-this.handlePos1||this.min>this.max&&this.handlePos1-n>n-this.handlePos2)){if(this.activeHandle=2,!(this.limits.enabled&&this.limits.endHandleFixed)){if(this.limits.enabled){var s=this.getLimitValueAndPosition(r,this.limits.maxStart,this.limits.maxEnd);r=s[0],n=s[1]}this.secondHandle.classList.add(E.sliderActiveHandle),this.handlePos2=this.preHandlePos2=n,this.handleVal2=r}this.modifyZindex(),this.secondHandle.focus()}else{if(this.activeHandle=1,!(this.limits.enabled&&this.limits.startHandleFixed)){if(this.limits.enabled){var s=this.getLimitValueAndPosition(r,this.limits.minStart,this.limits.minEnd);r=s[0],n=s[1]}this.firstHandle.classList.add(E.sliderActiveHandle),this.handlePos1=this.preHandlePos1=n,this.handleVal1=r}this.modifyZindex(),this.firstHandle.focus()}this.isMaterialTooltip&&this.tooltipElement.classList.add(E.materialTooltipActive);var a=this.element.querySelector("."+E.sliderTabHandle);a&&this.getHandle()!==a&&a.classList.remove(E.sliderTabHandle);var l=this.activeHandle===1?this.firstHandle:this.secondHandle,c;if((e.type==="click"||e.type==="mousedown")&&e.target===l){var p=e.clientX,d=e.clientY;c=document.elementFromPoint(p,d)}if(e.target===l&&c!=l){(this.isMaterial||this.isMaterial3)&&!this.tooltip.isVisible&&!this.getHandle().classList.contains(E.sliderTabHandle)&&this.materialChange(),this.sliderBarUp(e),this.tooltipToggle(this.getHandle());return}if(this.checkRepeatedValue(r)){var u=(this.isMaterial||this.isMaterial3)&&this.tooltip.isVisible?this.transitionOnMaterialTooltip:this.transition;this.getHandle().style.transition=u.handle,this.type!=="Default"&&(this.rangeBar.style.transition=u.rangeBar),this.setHandlePosition(e),this.isMaterialTooltip&&(this.initialTooltip=!1),e.target!=l&&this.changeEvent("changed",e),this.type!=="Default"&&this.setRangeBar()}},t.prototype.handleValueAdjust=function(e,i,n){n===1?(this.handleVal1=i,this.handleVal2=this.handleVal1+this.minDiff):n===2&&(this.handleVal2=i,this.handleVal1=this.handleVal2-this.minDiff),this.handlePos1=this.checkHandlePosition(this.handleVal1),this.handlePos2=this.checkHandlePosition(this.handleVal2)},t.prototype.dragRangeBarMove=function(e){var i,n;e.type!=="touchmove"&&e.preventDefault(),this.rangeBarDragged=!0;var r;this.rangeBar.style.transition="none",this.firstHandle.style.transition="none",this.secondHandle.style.transition="none";var s,a;if(e.type==="mousemove"?(i=[e.clientX,e.clientY],s=i[0],a=i[1]):(n=[e.changedTouches[0].clientX,e.changedTouches[0].clientY],s=n[0],a=n[1]),!(this.limits.enabled&&this.limits.startHandleFixed)&&!(this.limits.enabled&&this.limits.endHandleFixed)){if(this.enableRtl?r={x:s+this.secondPartRemain,y:a+this.secondPartRemain}:r={x:s-this.firstPartRemain,y:a+this.secondPartRemain},this.min>this.max?(this.handlePos2=this.xyToPosition(r),this.handleVal2=this.positionToValue(this.handlePos2)):(this.handlePos1=this.xyToPosition(r),this.handleVal1=this.positionToValue(this.handlePos1)),this.enableRtl?r={x:s-this.firstPartRemain,y:a-this.firstPartRemain}:r={x:s+this.secondPartRemain,y:a-this.firstPartRemain},this.min>this.max?(this.handlePos1=this.xyToPosition(r),this.handleVal1=this.positionToValue(this.handlePos1)):(this.handlePos2=this.xyToPosition(r),this.handleVal2=this.positionToValue(this.handlePos2)),this.limits.enabled){var l=this.getLimitValueAndPosition(this.handleVal1,this.limits.minStart,this.limits.minEnd);this.handleVal1=l[0],this.handlePos1=l[1],this.handleVal1===this.limits.minEnd&&this.handleValueAdjust(this.handleVal1,this.limits.minEnd,1),this.handleVal1===this.limits.minStart&&this.handleValueAdjust(this.handleVal1,this.limits.minStart,1),l=this.getLimitValueAndPosition(this.handleVal2,this.limits.maxStart,this.limits.maxEnd),this.handleVal2=l[0],this.handlePos2=l[1],this.handleVal2===this.limits.maxStart&&this.handleValueAdjust(this.handleVal2,this.limits.maxStart,2),this.handleVal2===this.limits.maxEnd&&this.handleValueAdjust(this.handleVal2,this.limits.maxEnd,2)}this.handleVal2===(this.min>this.max?this.min:this.max)&&this.handleValueAdjust(this.handleVal2,this.min>this.max?this.min:this.max,2),this.handleVal1===(this.min>this.max?this.max:this.min)&&this.handleValueAdjust(this.handleVal1,this.min>this.max?this.max:this.min,1)}this.activeHandle=1,this.setHandlePosition(e),this.activeHandle=2,this.setHandlePosition(e),this.tooltipToggle(this.rangeBar),this.setRangeBar()},t.prototype.sliderBarUp=function(e){this.changeEvent("changed",e),this.handleFocusOut(),this.firstHandle.classList.remove(E.sliderActiveHandle),this.type==="Range"&&(this.initialTooltip=!1,this.secondHandle.classList.remove(E.sliderActiveHandle)),this.closeTooltip(),(this.isMaterial||this.isMaterial3)&&(this.getHandle().classList.remove("e-large-thumb-size"),this.isMaterialTooltip&&this.tooltipElement.classList.remove(E.materialTooltipActive)),b.remove(document,"mousemove touchmove",this.sliderBarMove),b.remove(document,"mouseup touchend",this.sliderBarUp)},t.prototype.sliderBarMove=function(e){e.type!=="touchmove"&&e.preventDefault();var i;e.type==="mousemove"?i={x:e.clientX,y:e.clientY}:i={x:e.changedTouches[0].clientX,y:e.changedTouches[0].clientY};var n=this.xyToPosition(i),r=this.positionToValue(n);if(n=Math.round(n),this.type!=="Range"&&this.activeHandle===1){if(!(this.limits.enabled&&this.limits.startHandleFixed)){if(this.limits.enabled){var s=this.getLimitValueAndPosition(r,this.limits.minStart,this.limits.minEnd);n=s[1],r=s[0]}this.handlePos1=n,this.handleVal1=r}this.firstHandle.classList.add(E.sliderActiveHandle)}if(this.type==="Range"){if(this.activeHandle===1){if(this.firstHandle.classList.add(E.sliderActiveHandle),!(this.limits.enabled&&this.limits.startHandleFixed)&&((this.min<this.max&&n>this.handlePos2||this.min>this.max&&n<this.handlePos2)&&(n=this.handlePos2,r=this.handleVal2),n!==this.preHandlePos1)){if(this.limits.enabled){var a=this.getLimitValueAndPosition(r,this.limits.minStart,this.limits.minEnd);r=a[0],n=a[1]}this.handlePos1=this.preHandlePos1=n,this.handleVal1=r,this.activeHandle=1}}else if(this.activeHandle===2&&(this.secondHandle.classList.add(E.sliderActiveHandle),!(this.limits.enabled&&this.limits.endHandleFixed)&&((this.min<this.max&&n<this.handlePos1||this.min>this.max&&n>this.handlePos1)&&(n=this.handlePos1,r=this.handleVal1),n!==this.preHandlePos2))){if(this.limits.enabled){var a=this.getLimitValueAndPosition(r,this.limits.maxStart,this.limits.maxEnd);r=a[0],n=a[1]}this.handlePos2=this.preHandlePos2=n,this.handleVal2=r,this.activeHandle=2}}this.checkRepeatedValue(r)&&(this.getHandle().style.transition=this.scaleTransform,this.type!=="Default"&&(this.rangeBar.style.transition="none"),this.setHandlePosition(e),(this.isMaterial||this.isMaterial3)&&!this.tooltip.isVisible&&!this.getHandle().classList.contains(E.sliderTabHandle)&&this.materialChange(),this.tooltipToggle(this.getHandle()),this.type!=="Default"&&this.setRangeBar())},t.prototype.dragRangeBarUp=function(e){this.rangeBarDragged?this.isDragComplete=!0:(this.focusSliderElement(),this.sliderBarClick(e)),this.changeEvent("changed",e),this.closeTooltip(),b.remove(document,"mousemove touchmove",this.dragRangeBarMove),b.remove(document,"mouseup touchend",this.dragRangeBarUp),this.rangeBarDragged=!1},t.prototype.checkRepeatedValue=function(e){if(this.type==="Range"){var i=this.enableRtl&&this.orientation!=="Vertical"?this.activeHandle===1?this.previousVal[1]:this.previousVal[0]:this.activeHandle===1?this.previousVal[0]:this.previousVal[1];if(e===i)return 0}else if(e===this.previousVal)return 0;return 1},t.prototype.refreshTooltip=function(e){this.tooltip.isVisible&&this.tooltipObj&&(this.tooltipValue(),e&&(this.tooltipObj.refresh(e),this.tooltipTarget=e))},t.prototype.openTooltip=function(e){this.tooltip.isVisible&&this.tooltipObj&&!this.isMaterialTooltip&&(this.tooltipValue(),this.tooltipObj.open(e),this.tooltipTarget=e)},t.prototype.closeTooltip=function(){this.tooltip.isVisible&&this.tooltipObj&&this.tooltip.showOn!=="Always"&&!this.isMaterialTooltip&&(this.tooltipValue(),this.tooltipObj.close(),this.tooltipTarget=void 0)},t.prototype.keyDown=function(e){switch(e.keyCode){case 37:case 38:case 39:case 40:case 33:case 34:case 36:case 35:e.preventDefault(),this.buttonClick(e);break}},t.prototype.wireButtonEvt=function(e){e?(b.remove(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut),b.remove(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut),b.remove(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse),b.remove(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),b.remove(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse),b.remove(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp),b.remove(this.firstBtn,"focusout",this.sliderFocusOut),b.remove(this.secondBtn,"focusout",this.sliderFocusOut)):(b.add(this.firstBtn,"mouseleave touchleave",this.buttonFocusOut,this),b.add(this.secondBtn,"mouseleave touchleave",this.buttonFocusOut,this),b.add(this.firstBtn,"mousedown touchstart",this.repeatHandlerMouse,this),b.add(this.firstBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),b.add(this.secondBtn,"mousedown touchstart",this.repeatHandlerMouse,this),b.add(this.secondBtn,"mouseup mouseleave touchup touchend",this.repeatHandlerUp,this),b.add(this.firstBtn,"focusout",this.sliderFocusOut,this),b.add(this.secondBtn,"focusout",this.sliderFocusOut,this))},t.prototype.rangeBarMousedown=function(e){var i,n;if(e.preventDefault(),this.focusSliderElement(),this.type==="Range"&&this.drag&&e.target===this.rangeBar){var r=void 0,s=void 0;e.type==="mousedown"?(i=[e.clientX,e.clientY],r=i[0],s=i[1]):e.type==="touchstart"&&(n=[e.changedTouches[0].clientX,e.changedTouches[0].clientY],r=n[0],s=n[1]),this.orientation==="Horizontal"?(this.firstPartRemain=r-this.rangeBar.getBoundingClientRect().left,this.secondPartRemain=this.rangeBar.getBoundingClientRect().right-r):(this.firstPartRemain=s-this.rangeBar.getBoundingClientRect().top,this.secondPartRemain=this.rangeBar.getBoundingClientRect().bottom-s),this.minDiff=this.handleVal2-this.handleVal1,this.tooltipToggle(this.rangeBar);var a=this.element.querySelector("."+E.sliderTabHandle);a&&a.classList.remove(E.sliderTabHandle),b.add(document,"mousemove touchmove",this.dragRangeBarMove,this),b.add(document,"mouseup touchend",this.dragRangeBarUp,this)}},t.prototype.elementClick=function(e){if(this.isDragComplete){this.isDragComplete=!1;return}e.preventDefault(),this.focusSliderElement(),this.sliderBarClick(e),this.focusHandle()},t.prototype.wireEvents=function(){this.onresize=this.reposition.bind(this),window.addEventListener("resize",this.onresize),this.enabled&&!this.readonly&&(b.add(this.element,"click",this.elementClick,this),this.type==="Range"&&this.drag&&b.add(this.rangeBar,"mousedown touchstart",this.rangeBarMousedown,this),b.add(this.sliderContainer,"keydown",this.keyDown,this),b.add(this.sliderContainer,"keyup",this.keyUp,this),b.add(this.element,"focusout",this.sliderFocusOut,this),b.add(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover,this),this.wireFirstHandleEvt(!1),this.type==="Range"&&this.wireSecondHandleEvt(!1),this.showButtons&&this.wireButtonEvt(!1),this.wireMaterialTooltipEvent(!1),this.isForm&&b.add(this.formElement,"reset",this.formResetHandler,this))},t.prototype.unwireEvents=function(){b.remove(this.element,"click",this.elementClick),this.type==="Range"&&this.drag&&b.remove(this.rangeBar,"mousedown touchstart",this.rangeBarMousedown),b.remove(this.sliderContainer,"keydown",this.keyDown),b.remove(this.sliderContainer,"keyup",this.keyUp),b.remove(this.element,"focusout",this.sliderFocusOut),b.remove(this.sliderContainer,"mouseover mouseout touchstart touchend",this.hover),this.wireFirstHandleEvt(!0),this.type==="Range"&&this.wireSecondHandleEvt(!0),this.showButtons&&this.wireButtonEvt(!0),this.wireMaterialTooltipEvent(!0),b.remove(this.element,"reset",this.formResetHandler)},t.prototype.formResetHandler=function(){this.setProperties({value:this.formResetValue},!0),this.setValue()},t.prototype.keyUp=function(e){if(e.keyCode===9&&e.target.classList.contains(E.sliderHandle)&&(this.focusSliderElement(),!e.target.classList.contains(E.sliderTabHandle))){this.element.querySelector("."+E.sliderTabHandle)&&this.element.querySelector("."+E.sliderTabHandle).classList.remove(E.sliderTabHandle),e.target.classList.add(E.sliderTabHandle);var i=e.target.parentElement;i===this.element&&(i.querySelector("."+E.sliderTrack).classList.add(E.sliderTabTrack),(this.type==="Range"||this.type==="MinRange")&&i.querySelector("."+E.rangeBar).classList.add(E.sliderTabRange)),this.type==="Range"&&(e.target.previousSibling.classList.contains(E.sliderHandle)?this.activeHandle=2:this.activeHandle=1),this.getHandle().focus(),this.tooltipToggle(this.getHandle())}this.closeTooltip(),this.changeEvent("changed",e)},t.prototype.hover=function(e){if(!h(e))if(e.type==="mouseover"||e.type==="touchmove"||e.type==="mousemove"||e.type==="pointermove"||e.type==="touchstart")this.sliderContainer.classList.add(E.sliderHover);else{this.sliderContainer.classList.remove(E.sliderHover);var i=e.currentTarget;this.tooltip.isVisible&&this.tooltip.showOn!=="Always"&&this.tooltipObj&&this.isMaterialTooltip&&!i.classList.contains(E.sliderHandleFocused)&&!i.classList.contains(E.sliderTabHandle)&&this.closeMaterialTooltip()}},t.prototype.sliderFocusOut=function(e){e.relatedTarget!==this.secondHandle&&e.relatedTarget!==this.firstHandle&&e.relatedTarget!==this.element&&e.relatedTarget!==this.firstBtn&&e.relatedTarget!==this.secondBtn&&(this.closeMaterialTooltip(),this.closeTooltip(),this.element.querySelector("."+E.sliderTabHandle)&&this.element.querySelector("."+E.sliderTabHandle).classList.remove(E.sliderTabHandle),this.element.querySelector("."+E.sliderTabTrack)&&(this.element.querySelector("."+E.sliderTabTrack).classList.remove(E.sliderTabTrack),(this.type==="Range"||this.type==="MinRange")&&this.element.querySelector("."+E.sliderTabRange)&&this.element.querySelector("."+E.sliderTabRange).classList.remove(E.sliderTabRange)),this.hiddenInput.focus(),this.hiddenInput.blur(),this.isElementFocused=!1)},t.prototype.removeElement=function(e){e.parentNode&&e.parentNode.removeChild(e)},t.prototype.changeSliderType=function(e,i){this.isMaterialTooltip&&this.materialHandle&&(this.sliderContainer.classList.remove(E.materialSlider),this.removeElement(this.materialHandle),this.materialHandle=void 0),this.removeElement(this.firstHandle),this.firstHandle=void 0,e!=="Default"&&(e==="Range"&&(this.removeElement(this.secondHandle),this.secondHandle=void 0),this.removeElement(this.rangeBar),this.rangeBar=void 0),this.tooltip.isVisible&&!h(this.tooltipObj)&&(this.tooltipObj.destroy(),this.tooltipElement=void 0,this.tooltipCollidedPosition=void 0),this.limits.enabled&&(e==="MinRange"||e==="Default"?h(this.limitBarFirst)||(this.removeElement(this.limitBarFirst),this.limitBarFirst=void 0):h(this.limitBarSecond)||(this.removeElement(this.limitBarSecond),this.limitBarSecond=void 0)),this.activeHandle=1,this.getThemeInitialization(),this.type==="Range"&&this.rangeValueUpdate(),this.createRangeBar(),this.limits.enabled&&this.createLimitBar(),this.setHandler(),this.setOrientClass(),this.wireFirstHandleEvt(!1),this.type==="Range"&&this.wireSecondHandleEvt(!1),this.setValue(),this.tooltip.isVisible&&(this.renderTooltip(),this.wireMaterialTooltipEvent(!1)),this.setBarColor(),i!=="tooltip"&&this.updateConfig()},t.prototype.changeRtl=function(){if(!this.enableRtl&&this.type==="Range"&&(this.value=[this.handleVal2,this.handleVal1]),this.updateConfig(),this.tooltip.isVisible&&this.tooltipObj.refresh(this.firstHandle),this.showButtons){var e=this.enableRtl&&this.orientation!=="Vertical";ce(e?this.secondBtn:this.firstBtn,{"aria-label":"Decrease",title:"Decrease"}),ce(e?this.firstBtn:this.secondBtn,{"aria-label":"Increase",title:"Increase"})}},t.prototype.changeOrientation=function(){this.changeSliderType(this.type,"null")},t.prototype.updateConfig=function(){this.setEnableRTL(),this.setValue(),this.tooltip.isVisible&&this.refreshTooltip(this.tooltipTarget),this.ticks.placement!=="None"&&this.ul&&(this.removeElement(this.ul),this.ul=void 0,this.renderScale()),this.limitsPropertyChange()},t.prototype.limitsPropertyChange=function(){this.limits.enabled?(h(this.limitBarFirst)&&this.type!=="Range"&&this.createLimitBar(),h(this.limitBarFirst)&&h(this.limitBarSecond)&&this.type==="Range"&&this.createLimitBar(),this.setLimitBar(),this.setValue()):(h(this.limitBarFirst)||S(this.limitBarFirst),h(this.limitBarSecond)||S(this.limitBarSecond))},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.destroy=function(){o.prototype.destroy.call(this),this.unwireEvents(),window.removeEventListener("resize",this.onresize),O([this.sliderContainer],[E.sliderDisabled]),this.firstHandle.removeAttribute("aria-orientation"),this.type==="Range"&&this.secondHandle.removeAttribute("aria-orientation"),this.sliderContainer.parentNode.insertBefore(this.element,this.sliderContainer),S(this.sliderContainer),this.tooltip.isVisible&&this.tooltipObj.destroy(),this.element.innerHTML="",this.hiddenInput=null,this.sliderContainer=null,this.sliderTrack=null,this.rangeBar=null,this.firstHandle=null,this.secondHandle=null,this.tickElementCollection=null,this.ul=null,this.firstBtn=null,this.secondBtn=null,this.materialHandle=null,this.tooltipObj=null,this.tooltipTarget=null,this.limitBarFirst=null,this.limitBarSecond=null,this.firstChild=null,this.lastChild=null,this.tooltipElement=null},t.prototype.onPropertyChanged=function(e,i){for(var n=this,r=0,s=Object.keys(e);r<s.length;r++){var a=s[r];switch(a){case"cssClass":this.setCSSClass(i.cssClass);break;case"value":if(e&&i){var l=h(e.value)?this.type==="Range"?[this.min,this.max]:this.min:e.value;this.setProperties({value:l},!0),!h(i.value)&&i.value.toString()!==l.toString()&&(this.setValue(),this.refreshTooltip(this.tooltipTarget),this.type==="Range"&&(h(e.value)||i.value[1]===l[1]?this.activeHandle=1:this.activeHandle=2))}break;case"min":case"step":case"max":this.setMinMaxValue();break;case"tooltip":!h(e.tooltip)&&!h(i.tooltip)&&(this.setTooltip(a),this.showButtons||this.wireEvents());break;case"type":!h(i)&&Object.keys(i).length&&!h(i.type)&&(this.changeSliderType(i.type,a),this.setZindex());break;case"enableRtl":i.enableRtl!==e.enableRtl&&this.orientation!=="Vertical"&&(this.rtl=i.enableRtl,this.changeRtl());break;case"limits":this.limitsPropertyChange();break;case"orientation":this.changeOrientation();break;case"ticks":h(this.sliderContainer.querySelector("."+E.scale))||(S(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(c){c.match(/e-scale-/)&&n.sliderContainer.classList.remove(c)})),this.ticks.placement!=="None"&&(this.renderScale(),this.setZindex());break;case"locale":this.showButtons&&this.buttonTitle();break;case"showButtons":e.showButtons?(this.setButtons(),this.reposition(),this.enabled&&!this.readonly&&this.wireButtonEvt(!1)):this.firstBtn&&this.secondBtn&&(this.sliderContainer.removeChild(this.firstBtn),this.sliderContainer.removeChild(this.secondBtn),this.sliderContainer.classList.remove(E.sliderButtonClass),this.firstBtn=void 0,this.secondBtn=void 0,this.reposition());break;case"enabled":this.setEnabled();break;case"readonly":this.setReadOnly();break;case"customValues":this.setValue(),this.reposition();break;case"colorRange":this.reposition();break;case"width":this.setElementWidth(e.width),this.setMinMaxValue(),this.limits&&this.limitsPropertyChange();break}}},t.prototype.setReadOnly=function(){this.readonly?(this.unwireEvents(),this.sliderContainer.classList.add(E.readonly)):(this.wireEvents(),this.sliderContainer.classList.remove(E.readonly))},t.prototype.setMinMaxValue=function(){var e=this;this.setValue(),this.refreshTooltip(this.tooltipTarget),h(this.sliderContainer.querySelector("."+E.scale))||this.ul&&(S(this.ul),Array.prototype.forEach.call(this.sliderContainer.classList,function(i){i.match(/e-scale-/)&&e.sliderContainer.classList.remove(i)})),this.ticks.placement!=="None"&&(this.renderScale(),this.setZindex())},t.prototype.setZindex=function(){this.zIndex=6,!h(this.ticks)&&this.ticks.placement!=="None"&&!h(this.ul)&&!h(this.element)&&(this.ul.style.zIndex=this.zIndex+-7+"",this.element.style.zIndex=this.zIndex+2+""),!this.isMaterial&&!this.isMaterial3&&!h(this.ticks)&&this.ticks.placement==="Both"&&(this.element.style.zIndex=this.zIndex+2+""),h(this.firstHandle)||(this.firstHandle.style.zIndex=this.zIndex+3+""),this.type==="Range"&&!h(this.secondHandle)&&(this.secondHandle.style.zIndex=this.zIndex+4+"")},t.prototype.setTooltip=function(e){this.changeSliderType(this.type,e)},t.prototype.setBarColor=function(){for(var e,i,n=this.sliderTrack.lastElementChild;n;)this.sliderTrack.removeChild(n),n=this.sliderTrack.lastElementChild;for(var r=0;r<this.colorRange.length;r++)if(!h(this.colorRange[r].start)&&!h(this.colorRange[r].end)&&this.colorRange[r].end>this.colorRange[r].start){this.colorRange[r].start<this.min&&(this.colorRange[r].start=this.min),this.colorRange[r].end>this.max&&(this.colorRange[r].end=this.max);var s=this.checkHandlePosition(this.colorRange[r].start),a=this.checkHandlePosition(this.colorRange[r].end),l=this.createElement("div");l.style.backgroundColor=this.colorRange[r].color,l.style.border="1px solid "+this.colorRange[r].color,this.orientation==="Horizontal"?(i=E.sliderHorizantalColor,this.enableRtl?h(this.customValues)?e=this.checkHandlePosition(this.max)-this.checkHandlePosition(this.colorRange[r].end):e=this.checkHandlePosition(this.customValues.length-this.colorRange[r].end-1):e=this.checkHandlePosition(this.colorRange[r].start),l.style.width=a-s+"px",l.style.left=e+"px"):(i=E.sliderVerticalColor,e=this.checkHandlePosition(this.colorRange[r].start),l.style.height=a-s+"px",l.style.bottom=e+"px"),l.classList.add(i),this.sliderTrack.appendChild(l)}},t.prototype.getModuleName=function(){return"slider"},q([g(null)],t.prototype,"value",void 0),q([g(null)],t.prototype,"customValues",void 0),q([g(1)],t.prototype,"step",void 0),q([g(null)],t.prototype,"width",void 0),q([g(0)],t.prototype,"min",void 0),q([g(100)],t.prototype,"max",void 0),q([g(!1)],t.prototype,"readonly",void 0),q([g("Default")],t.prototype,"type",void 0),q([$n([{}],vc)],t.prototype,"colorRange",void 0),q([X({},gc)],t.prototype,"ticks",void 0),q([X({},bc)],t.prototype,"limits",void 0),q([g(!0)],t.prototype,"enabled",void 0),q([X({},yc)],t.prototype,"tooltip",void 0),q([g(!1)],t.prototype,"showButtons",void 0),q([g(!0)],t.prototype,"enableAnimation",void 0),q([g("Horizontal")],t.prototype,"orientation",void 0),q([g("")],t.prototype,"cssClass",void 0),q([g(!1)],t.prototype,"enableHtmlSanitizer",void 0),q([N()],t.prototype,"created",void 0),q([N()],t.prototype,"change",void 0),q([N()],t.prototype,"changed",void 0),q([N()],t.prototype,"renderingTicks",void 0),q([N()],t.prototype,"renderedTicks",void 0),q([N()],t.prototype,"tooltipChange",void 0),t=q([Ct],t),t}($t),er=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),z=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},Sc="e-upload e-control-wrapper",wo="e-file-select",kr="e-file-drop",Ec="e-file-select-wrap",ko="e-upload-files",Wi="e-upload-file-list",le="e-file-status",Lc="e-upload-actions",wc="e-file-upload-btn e-css e-btn e-flat e-primary",kc="e-file-clear-btn e-css e-btn e-flat",xo="e-file-name",Do="e-file-type",Bo="e-file-size",me="e-file-remove-btn",Fe="e-file-delete-btn",Oo="e-spinner-pane",se="e-file-abort-btn",Ye="e-file-reload-btn",xr="e-upload-drag-hover",St="e-upload-progress-wrap",Qi="e-upload-progress-bar",Dr="e-progress-bar-text",ze="e-upload-progress",We="e-upload-success",qe="e-upload-fails",Br="e-file-container",No="e-validation-fails",Ro="e-rtl",Or="e-disabled",Mo="e-rtl-container",Nr="e-clear-icon-focus",xc="e-progress-inner-wrap",Ee="e-file-pause-btn",Et="e-file-play-btn",ri="e-restrict-retry",Ao=["title","style","class"],Po="e-form-upload",Dc="e-hidden-file-input",si="e-file-invalid",Bc="e-file-information",Oc=function(o){er(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return z([g("")],t.prototype,"name",void 0),z([g(null)],t.prototype,"size",void 0),z([g("")],t.prototype,"type",void 0),t}(W),Nc=function(o){er(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return z([g("Browse...")],t.prototype,"browse",void 0),z([g("Upload")],t.prototype,"upload",void 0),z([g("Clear")],t.prototype,"clear",void 0),t}(W),Rc=function(o){er(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return z([g("")],t.prototype,"saveUrl",void 0),z([g("")],t.prototype,"removeUrl",void 0),z([g(0)],t.prototype,"chunkSize",void 0),z([g(3)],t.prototype,"retryCount",void 0),z([g(500)],t.prototype,"retryAfterDelay",void 0),t}(W),Io=function(o){er(t,o);function t(e,i){var n=o.call(this,e,i)||this;return n.initialAttr={accept:null,multiple:!1,disabled:!1},n.uploadedFilesData=[],n.base64String=[],n.isForm=!1,n.allTypes=!1,n.pausedData=[],n.uploadMetaData=[],n.tabIndex="0",n.btnTabIndex="0",n.disableKeyboardNavigation=!1,n.count=-1,n.actionCompleteCount=0,n.flag=!0,n.selectedFiles=[],n.uploaderName="UploadFiles",n.fileStreams=[],n.newFileRef=0,n.isFirstFileOnSelection=!1,n.dragCounter=0,n.isAngular=!1,n.fileList=[],n.filesData=[],n.uploaderOptions=e,n}return t.prototype.onPropertyChanged=function(e,i){for(var n=0,r=Object.keys(e);n<r.length;n++){var s=r[n];switch(s){case"allowedExtensions":this.setExtensions(this.allowedExtensions),this.clearAll();break;case"enabled":this.setControlStatus();break;case"multiple":this.setMultipleSelection();break;case"enableRtl":this.setRTL(),this.reRenderFileList();break;case"buttons":this.buttons.browse=h(this.buttons.browse)?"":this.buttons.browse,this.buttons.clear=h(this.buttons.clear)?"":this.buttons.clear,this.buttons.upload=h(this.buttons.upload)?"":this.buttons.upload,this.renderButtonTemplates();break;case"dropArea":this.unBindDropEvents(),this.updateDropArea();break;case"htmlAttributes":this.updateHTMLAttrToElement(),this.updateHTMLAttrToWrapper(),this.checkHTMLAttributes(!0);break;case"files":this.renderPreLoadFiles();break;case"directoryUpload":this.updateDirectoryAttributes();break;case"template":var a=jt("ej2_instances",this.element);a[0].isReact?this.reRenderFileList():this.clearAll();break;case"minFileSize":case"maxFileSize":case"autoUpload":this.clearAll();break;case"sequentialUpload":this.clearAll();break;case"locale":this.l10n.setLocale(this.locale),this.setLocalizedTexts(),this.preLocaleObj=jt("currentLocale",this.l10n);break;case"cssClass":this.setCSSClass(i.cssClass);break}}},t.prototype.setLocalizedTexts=function(){h(this.template)&&(typeof this.buttons.browse=="string"&&(this.browseButton.innerText=this.buttons.browse==="Browse..."?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.innerText),this.uploadWrapper&&!h(this.uploadWrapper.querySelector("."+kr))&&(this.uploadWrapper.querySelector("."+kr).innerHTML=this.localizedTexts("dropFilesHint"))),this.updateFileList())},t.prototype.getKeyValue=function(e){for(var i,n=0,r=Object.keys(this.preLocaleObj);n<r.length;n++){var s=r[n];this.preLocaleObj[""+s]===e&&(i=s)}return i},t.prototype.updateFileList=function(){var e;if(this.fileList.length>0&&!h(this.uploadWrapper.querySelector("."+ko)))for(var i=0;i<this.fileList.length;i++)e=this.fileList[i].querySelector(".e-file-status"),e.innerHTML=this.localizedTexts(this.getKeyValue(this.filesData[i].status)),this.filesData[i].status=this.localizedTexts(this.getKeyValue(this.filesData[i].status)),this.fileList[i].classList.contains(We)&&this.fileList[i].querySelector(".e-icons").setAttribute("title",this.localizedTexts("delete")),this.fileList[i].querySelector(".e-file-play-btn")&&this.fileList[i].querySelector(".e-icons").setAttribute("title",this.localizedTexts("resume")),this.fileList[i].querySelector(".e-file-remove-btn")&&this.fileList[i].querySelector(".e-icons").setAttribute("title",this.localizedTexts("remove")),this.fileList[i].querySelector(".e-file-reload-btn")&&this.fileList[i].querySelector(".e-icons").setAttribute("title",this.localizedTexts("retry")),this.autoUpload||(this.uploadButton.innerText=this.buttons.upload==="Upload"?this.localizedTexts("Upload"):this.buttons.upload,this.uploadButton.setAttribute("title",this.localizedTexts("Upload")),this.clearButton.innerText=this.buttons.clear==="Clear"?this.localizedTexts("Clear"):this.buttons.clear,this.clearButton.setAttribute("title",this.localizedTexts("Clear")))},t.prototype.reRenderFileList=function(){this.listParent&&(S(this.listParent),this.listParent=null,this.fileList=[],this.internalCreateFileList(this.filesData),this.actionButtons&&(this.removeActionButtons(),this.renderActionButtons(),this.checkActionButtonStatus()))},t.prototype.preRender=function(){this.localeText={Browse:"Browse...",Clear:"Clear",Upload:"Upload",invalidFileName:"File Name is not allowed",dropFilesHint:"Or drop files here",invalidMaxFileSize:"File size is too large",invalidMinFileSize:"File size is too small",invalidFileType:"File type is not allowed",uploadFailedMessage:"File failed to upload",uploadSuccessMessage:"File uploaded successfully",removedSuccessMessage:"File removed successfully",removedFailedMessage:"Unable to remove file",inProgress:"Uploading",readyToUploadMessage:"Ready to upload",abort:"Abort",remove:"Remove",cancel:"Cancel",delete:"Delete file",pauseUpload:"File upload paused",pause:"Pause",resume:"Resume",retry:"Retry",fileUploadCancel:"File upload canceled",invalidFileSelection:"Invalid files selected",totalFiles:"Total files",size:"Size"},this.l10n=new Ii("uploader",this.localeText,this.locale),this.preLocaleObj=jt("currentLocale",this.l10n),this.formRendered(),this.updateHTMLAttrToElement(),this.checkHTMLAttributes(!1);var e=jt("ej2_instances",this.element);if(this.element.tagName==="EJS-UPLOADER"){var i=this.createElement("input",{attrs:{type:"file"}}),n=0;for(n;n<this.element.attributes.length;n++)this.element.attributes[n].nodeName!=="id"?i.setAttribute(this.element.attributes[n].nodeName,this.element.attributes[n].nodeValue):this.element.attributes[n].nodeName==="id"&&i.setAttribute(this.element.attributes[n].nodeName,st("uploader")),i.innerHTML=this.element.innerHTML;i.hasAttribute("name")||i.setAttribute("name","UploadFiles"),this.element.appendChild(i),this.element=i,Rn("ej2_instances",e,this.element)}e[0].isPureReactComponent&&(h(e[0].props.name)?!h(e[0].props.id)&&h(e[0].props.name)?this.element.setAttribute("name",e[0].props.id):this.element.setAttribute("name","UploadFiles"):this.element.setAttribute("name",e[0].props.name)),h(this.element.getAttribute("name"))&&this.element.setAttribute("name",this.element.getAttribute("id")),this.element.hasAttribute("type")||this.element.setAttribute("type","file"),this.updateDirectoryAttributes(),this.keyConfigs={enter:"enter"},this.element.hasAttribute("tabindex")&&(this.tabIndex=this.element.getAttribute("tabindex")),this.browserName=D.info.name,this.uploaderName=this.element.getAttribute("name")},t.prototype.formRendered=function(){var e=T(this.element,"form");if(!h(e))for(;e&&e!==document.documentElement;e=e.parentElement)e.tagName==="FORM"&&(this.isForm=!0,this.formElement=e,e.setAttribute("enctype","multipart/form-data"),e.setAttribute("encoding","multipart/form-data"))},t.prototype.getPersistData=function(){return this.addOnPersist(["filesData"])},t.prototype.getModuleName=function(){return"uploader"},t.prototype.updateDirectoryAttributes=function(){this.directoryUpload?(this.element.setAttribute("directory","true"),this.element.setAttribute("webkitdirectory","true")):(this.element.removeAttribute("directory"),this.element.removeAttribute("webkitdirectory"))},t.prototype.render=function(){this.renderBrowseButton(),this.initializeUpload(),this.updateHTMLAttrToWrapper(),this.wireEvents(),this.setMultipleSelection(),this.setExtensions(this.allowedExtensions),this.setRTL(),this.renderPreLoadFiles(),this.setControlStatus(),this.setCSSClass()},t.prototype.renderBrowseButton=function(){this.browseButton=this.createElement("button",{className:"e-css e-btn",attrs:{type:"button"}}),this.browseButton.setAttribute("tabindex",this.tabIndex),typeof this.buttons.browse=="string"?(this.browseButton.textContent=this.buttons.browse==="Browse..."?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.innerText)):this.browseButton.appendChild(this.buttons.browse),this.element.setAttribute("aria-label","Uploader")},t.prototype.renderActionButtons=function(){this.element.setAttribute("tabindex","-1"),this.actionButtons=this.createElement("div",{className:Lc}),this.uploadButton=this.createElement("button",{className:wc,attrs:{type:"button",tabindex:this.btnTabIndex}}),this.clearButton=this.createElement("button",{className:kc,attrs:{type:"button",tabindex:this.btnTabIndex}}),this.actionButtons.appendChild(this.clearButton),this.actionButtons.appendChild(this.uploadButton),this.renderButtonTemplates(),this.uploadWrapper.appendChild(this.actionButtons),this.browseButton.blur(),this.isPreloadFiles||this.uploadButton.focus(),this.wireActionButtonEvents()},t.prototype.serverActionButtonsEventBind=function(e){e&&!this.isForm&&(this.browseButton.blur(),this.actionButtons=e,this.uploadButton=this.actionButtons.querySelector(".e-file-upload-btn"),this.clearButton=this.actionButtons.querySelector(".e-file-clear-btn"),this.uploadButton.focus(),this.unwireActionButtonEvents(),this.wireActionButtonEvents(),this.checkActionButtonStatus())},t.prototype.wireActionButtonEvents=function(){b.add(this.uploadButton,"click",this.uploadButtonClick,this),b.add(this.clearButton,"click",this.clearButtonClick,this)},t.prototype.unwireActionButtonEvents=function(){b.remove(this.uploadButton,"click",this.uploadButtonClick),b.remove(this.clearButton,"click",this.clearButtonClick)},t.prototype.removeActionButtons=function(){this.actionButtons&&(this.unwireActionButtonEvents(),S(this.actionButtons),this.actionButtons=null)},t.prototype.renderButtonTemplates=function(){if(typeof this.buttons.browse=="string"?(this.browseButton.textContent=this.buttons.browse==="Browse..."?this.localizedTexts("Browse"):this.buttons.browse,this.browseButton.setAttribute("title",this.browseButton.textContent)):(this.browseButton.innerHTML="",this.browseButton.appendChild(this.buttons.browse)),this.uploadButton){var e=h(this.buttons.upload)?"Upload":this.buttons.upload;this.buttons.upload=e,typeof this.buttons.upload=="string"?(this.uploadButton.textContent=this.buttons.upload==="Upload"?this.localizedTexts("Upload"):this.buttons.upload,this.uploadButton.setAttribute("title",this.uploadButton.textContent)):(this.uploadButton.innerHTML="",this.uploadButton.appendChild(this.buttons.upload))}if(this.clearButton){var i=h(this.buttons.clear)?"Clear":this.buttons.clear;this.buttons.clear=i,typeof this.buttons.clear=="string"?(this.clearButton.textContent=this.buttons.clear==="Clear"?this.localizedTexts("Clear"):this.buttons.clear,this.clearButton.setAttribute("title",this.clearButton.textContent)):(this.clearButton.innerHTML="",this.clearButton.appendChild(this.buttons.clear))}},t.prototype.initializeUpload=function(){this.element.setAttribute("tabindex","-1");var e=this.createElement("span",{className:wo});this.element.parentElement.insertBefore(e,this.element),this.dropAreaWrapper=this.createElement("div",{className:Ec}),this.element.parentElement.insertBefore(this.dropAreaWrapper,this.element),e.appendChild(this.element),this.dropAreaWrapper.appendChild(this.browseButton),this.dropAreaWrapper.appendChild(e),this.uploadWrapper=this.createElement("div",{className:Sc}),this.dropAreaWrapper.parentElement.insertBefore(this.uploadWrapper,this.dropAreaWrapper),this.uploadWrapper.appendChild(this.dropAreaWrapper),this.setDropArea()},t.prototype.renderPreLoadFiles=function(){if(this.files.length){if(this.enablePersistence&&this.filesData.length){this.internalCreateFileList(this.filesData);return}if(h(this.files[0].size))return;this.isPreloadFiles=!0;var e=[].slice.call(this.files),i=[];this.multiple||(this.clearData(),e=[e[0]]);for(var n=0,r=e;n<r.length;n++){var s=r[n],a={name:s.name+"."+s.type.split(".")[s.type.split(".").length-1],rawFile:"",size:s.size,status:this.localizedTexts("uploadSuccessMessage"),type:s.type,validationMessages:{minSize:"",maxSize:""},statusCode:"2"};i.push(a),this.filesData.push(a)}this.internalCreateFileList(i),!this.autoUpload&&this.listParent&&!this.actionButtons&&(!this.isForm||this.allowUpload())&&this.showFileList&&this.renderActionButtons(),this.checkActionButtonStatus(),this.sequentialUpload&&(this.count=this.filesData.length-1),this.isPreloadFiles=!1}},t.prototype.checkActionButtonStatus=function(){if(this.actionButtons){var e=this.uploadWrapper.querySelectorAll("."+No).length+this.uploadWrapper.querySelectorAll(".e-upload-fails:not(.e-upload-progress)").length+this.uploadWrapper.querySelectorAll("span."+We).length+this.uploadWrapper.querySelectorAll("span."+ze).length;e>0&&e===this.uploadWrapper.querySelectorAll("li").length?this.uploadButton.setAttribute("disabled","disabled"):this.uploadButton.removeAttribute("disabled")}},t.prototype.setDropArea=function(){var e=this.dropAreaWrapper.querySelector(".e-file-drop");if(this.dropArea){this.dropZoneElement=typeof this.dropArea!="string"?this.dropArea:A(this.dropArea,document);for(var i=this.element,n=!1;i.parentNode;)i=i.parentNode,i===this.dropZoneElement&&(n=!0,e?e.innerHTML=this.localizedTexts("dropFilesHint"):this.createDropTextHint());!n&&e&&Ue(e)}else!h(this.uploaderOptions)&&this.uploaderOptions.dropArea===void 0&&(this.createDropTextHint(),this.dropZoneElement=this.uploadWrapper,this.setProperties({dropArea:this.uploadWrapper},!0));this.bindDropEvents()},t.prototype.updateDropArea=function(){if(this.dropArea)this.setDropArea();else{this.dropZoneElement=null;var e=this.dropAreaWrapper.querySelector(".e-file-drop");e&&Ue(e)}},t.prototype.createDropTextHint=function(){var e=this.createElement("span",{className:kr});e.innerHTML=this.localizedTexts("dropFilesHint"),this.dropAreaWrapper.appendChild(e)},t.prototype.updateHTMLAttrToElement=function(){if(!h(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var n=i[e];Ao.indexOf(n)<0&&this.element.setAttribute(n,this.htmlAttributes[""+n])}},t.prototype.updateHTMLAttrToWrapper=function(){if(!h(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var n=i[e];if(Ao.indexOf(n)>-1)if(n==="class"){var r=this.htmlAttributes[""+n].replace(/\s+/g," ").trim();r!==""&&x([this.uploadWrapper],r.split(" "))}else if(n==="style"){var s=this.uploadWrapper.getAttribute(n);s=h(s)?this.htmlAttributes[""+n]:s+this.htmlAttributes[""+n],this.uploadWrapper.setAttribute(n,s)}else this.uploadWrapper.setAttribute(n,this.htmlAttributes[""+n])}},t.prototype.setMultipleSelection=function(){if(this.multiple&&!this.element.hasAttribute("multiple")){var e=document.createAttribute("multiple");e.value="multiple",this.element.setAttributeNode(e)}else this.multiple||this.element.removeAttribute("multiple")},t.prototype.checkAutoUpload=function(e){this.autoUpload?(this.sequentialUpload?this.sequenceUpload(e):this.upload(e),this.removeActionButtons()):this.actionButtons||this.renderActionButtons(),this.checkActionButtonStatus()},t.prototype.sequenceUpload=function(e){if(this.filesData.length-e.length===0||this.filesData[this.filesData.length-e.length-1].statusCode!=="1"){(this.multiple||this.count<0)&&++this.count;var i=!this.showFileList;typeof this.filesData[this.count]=="object"?(this.isFirstFileOnSelection=!1,this.upload(this.filesData[this.count],i),this.filesData[this.count].statusCode==="0"&&this.sequenceUpload(e)):--this.count}},t.prototype.setCSSClass=function(e){var i=e;h(e)||(i=e.replace(/\s+/g," ").trim()),!h(e)&&i!==""&&O([this.uploadWrapper],i.split(" "));var n=this.cssClass;!h(this.cssClass)&&this.cssClass!==""&&(n=this.cssClass.replace(/\s+/g," ").trim()),!h(this.cssClass)&&n!==""&&x([this.uploadWrapper],n.split(n.indexOf(",")>-1?",":" "))},t.prototype.wireEvents=function(){b.add(this.browseButton,"click",this.browseButtonClick,this),b.add(this.element,"change",this.onSelectFiles,this),b.add(document,"click",this.removeFocus,this),this.keyboardModule=new Mn(this.uploadWrapper,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"}),this.isForm&&b.add(this.formElement,"reset",this.resetForm,this)},t.prototype.unWireEvents=function(){b.remove(this.browseButton,"click",this.browseButtonClick),b.remove(this.element,"change",this.onSelectFiles),b.remove(document,"click",this.removeFocus),this.isForm&&b.remove(this.formElement,"reset",this.resetForm),this.keyboardModule&&this.keyboardModule.destroy()},t.prototype.resetForm=function(){this.clearAll()},t.prototype.keyActionHandler=function(e){var i=e.target;switch(e.action){case"enter":if(e.target===this.clearButton)this.clearButtonClick();else if(e.target===this.uploadButton)this.uploadButtonClick();else if(e.target===this.browseButton)this.browseButtonClick();else if(i.classList.contains(Ee)){var n=this.getCurrentMetaData(null,e);n.file.statusCode="4",n.file.status=this.localizedTexts("pauseUpload"),this.abortUpload(n,!1)}else if(i.classList.contains(Et))this.resumeUpload(this.getCurrentMetaData(null,e),e);else if(i.classList.contains(Ye)){var n=this.getCurrentMetaData(null,e);if(!h(n))n.file.statusCode="1",n.file.status=this.localizedTexts("readyToUploadMessage"),this.chunkUpload(n.file);else{var r=e.target.parentElement,s=this.filesData[this.fileList.indexOf(r)];this.retry(s)}}else this.removeFiles(e),i.classList.contains(se)||this.browseButton.focus();e.preventDefault(),e.stopPropagation();break}},t.prototype.getCurrentMetaData=function(e,i){var n,r;if(h(e)){var s=i.target.parentElement;n=this.filesData[this.fileList.indexOf(s)]}else n=e;for(var a=0;a<this.uploadMetaData.length;a++)this.uploadMetaData[a].file.name===n.name&&(r=this.uploadMetaData[a]);return r},t.prototype.removeFocus=function(){this.uploadWrapper&&this.listParent&&this.listParent.querySelector("."+Nr)&&(document.activeElement.blur(),this.listParent.querySelector("."+Nr).classList.remove(Nr))},t.prototype.browseButtonClick=function(){this.element.click()},t.prototype.uploadButtonClick=function(){this.sequentialUpload?this.sequenceUpload(this.filesData):this.upload(this.filesData)},t.prototype.clearButtonClick=function(){this.clearAll(),this.sequentialUpload&&(this.count=-1),this.actionCompleteCount=0},t.prototype.bindDropEvents=function(){this.dropZoneElement&&(b.add(this.dropZoneElement,"drop",this.dropElement,this),b.add(this.dropZoneElement,"dragover",this.dragHover,this),b.add(this.dropZoneElement,"dragleave",this.onDragLeave,this),b.add(this.dropZoneElement,"paste",this.onPasteFile,this),b.add(this.dropZoneElement,"dragenter",this.onDragEnter,this))},t.prototype.unBindDropEvents=function(){this.dropZoneElement&&(b.remove(this.dropZoneElement,"drop",this.dropElement),b.remove(this.dropZoneElement,"dragover",this.dragHover),b.remove(this.dropZoneElement,"dragleave",this.onDragLeave),b.remove(this.dropZoneElement,"dragenter",this.onDragEnter))},t.prototype.onDragEnter=function(e){this.enabled&&(this.dropZoneElement.classList.add(xr),this.dragCounter=this.dragCounter+1,e.preventDefault(),e.stopPropagation())},t.prototype.onDragLeave=function(){this.enabled&&(this.dragCounter=this.dragCounter-1,this.dragCounter||this.dropZoneElement.classList.remove(xr))},t.prototype.dragHover=function(e){this.enabled&&(this.dropEffect!=="Default"&&(e.dataTransfer.dropEffect=this.dropEffect.toLowerCase()),e.preventDefault(),e.stopPropagation())},t.prototype.dropElement=function(e){this.dragCounter=0,this.dropZoneElement.classList.remove(xr),this.onSelectFiles(e),e.preventDefault(),e.stopPropagation()},t.prototype.onPasteFile=function(e){var i=e.clipboardData.items;if(e.type==="paste"&&this.browserName!=="msie"&&this.browserName!=="edge"&&this.browserName!=="safari"&&(this.element.files=e.clipboardData.files),!(i.length!==1&&!this.multiple))for(var n=0;n<i.length;n++){var r=[].slice.call(i)[n];(r.kind==="file"||r.type.match("^image/"))&&this.renderSelectedFiles(e,[r.getAsFile()],!1,!0)}},t.prototype.getSelectedFiles=function(e){for(var i=[],n=this.fileList[e],r=this.getFilesData(),s=+n.getAttribute("data-files-count"),a=0,l=0;l<e;l++)a+=+this.fileList[l].getAttribute("data-files-count");for(var c=a;c<a+s;c++)i.push(r[c]);return i},t.prototype.removeFiles=function(e){if(this.enabled){var i=e.target.parentElement,n=this.fileList.indexOf(i),r=this.fileList[n],s=this.isFormUpload(),a=s?this.getSelectedFiles(n):this.getFilesInArray(this.filesData[n]);if(!h(a)){if(e.target.classList.contains(se)&&!s){if(a[0].statusCode="5",!h(r)){var l=r.querySelector("."+se);rr({target:l,width:"20px"}),sr(l)}this.sequentialUpload&&this.uploadSequential(),r.classList.contains(ri)||this.checkActionComplete(!0)}else T(e.target,"."+Oo)||this.remove(a,!1,!1,!0,e);this.checkActionButtonStatus()}}},t.prototype.removeFilesData=function(e,i){var n;if(i){this.showFileList||(n=this.filesData.indexOf(e),this.filesData.splice(n,1));return}var r=this.getLiElement(e);h(r)||(this.element.value="",S(r),n=this.fileList.indexOf(r),this.fileList.splice(n,1),this.filesData.splice(n,1),this.fileList.length===0&&!h(this.listParent)&&(S(this.listParent),this.listParent=null,this.removeActionButtons()),this.sequentialUpload&&n<=this.count&&--this.count)},t.prototype.removeUploadedFile=function(e,i,n,r){var s=this,a=e,l=new Ut(this.asyncSettings.removeUrl,"POST",!0,null);l.emitError=!1;var c=new FormData;l.beforeSend=function(p){i.currentRequest=l.httpRequest,n?s.removingEventCallback(i,c,a,e):s.trigger("removing",i,function(d){d.cancel?p.cancel=!0:s.removingEventCallback(d,c,a,e)})},l.onLoad=function(p){return s.removeCompleted(p,a,r),{}},l.onError=function(p){return s.removeFailed(p,a,r),{}},l.send(c)},t.prototype.removingEventCallback=function(e,i,n,r){var s=this.element.getAttribute("name"),a=this.getLiElement(r);if(!h(a)&&(!h(a.querySelector("."+Fe))||!h(a.querySelector("."+me)))){var l=a.querySelector("."+Fe)?a.querySelector("."+Fe):a.querySelector("."+me);rr({target:l,width:"20px"}),sr(l)}e.postRawFile&&!h(n.rawFile)&&n.rawFile!==""?i.append(s,n.rawFile,n.name):i.append(s,n.name),this.updateFormData(i,e.customFormData)},t.prototype.updateFormData=function(e,i){if(i.length>0&&i[0])for(var n=function(s){var a=i[s],l=Object.keys(a).map(function(c){return a[""+c]});e.append(Object.keys(a)[0],l)},r=0;r<i.length;r++)n(r)},t.prototype.updateCustomheader=function(e,i){if(i.length>0&&i[0])for(var n=function(s){var a=i[s],l=Object.keys(a).map(function(c){return a[""+c]});e.setRequestHeader(Object.keys(a)[0],l)},r=0;r<i.length;r++)n(r)},t.prototype.removeCompleted=function(e,i,n){var r=e&&e.currentTarget?this.getResponse(e):null,s=e.target;if(s.readyState===4&&s.status>=200&&s.status<=299){var a={e,response:r,operation:"remove",file:this.updateStatus(i,this.localizedTexts("removedSuccessMessage"),"2")};this.trigger("success",a),this.removeFilesData(i,n);var l=this.uploadedFilesData.indexOf(i);this.uploadedFilesData.splice(l,1),this.trigger("change",{files:this.uploadedFilesData})}else this.removeFailed(e,i,n)},t.prototype.removeFailed=function(e,i,n){var r=e&&e.currentTarget?this.getResponse(e):null,s={e,response:r,operation:"remove",file:this.updateStatus(i,this.localizedTexts("removedFailedMessage"),"0")};if(!n){var a=this.filesData.indexOf(i),l=this.fileList[a];if(l){l.classList.remove(We),l.classList.add(qe);var c=l.querySelector("."+le);c&&(c.classList.remove(We),c.classList.add(qe))}this.checkActionButtonStatus()}this.trigger("failure",s);var p=this.getLiElement(i);if(!h(p)&&!h(p.querySelector("."+Fe))){var d=p.querySelector("."+Fe);Mt(d),S(p.querySelector(".e-spinner-pane"))}},t.prototype.getFilesFromFolder=function(e){this.filesEntries=[];var i=this.multiple?e.dataTransfer.items:[e.dataTransfer.items[0]],n=this.checkDirectoryUpload(i);if(n)for(var r=function(l){var c=i[l].webkitGetAsEntry();if(c.isFile){var p=[];c.file(function(d){var u=c.fullPath;p.push({path:u,file:d})}),s.renderSelectedFiles(e,p,!0)}else c.isDirectory&&s.traverseFileTree(c,e)},s=this,a=0;a<i.length;a++)r(a)},t.prototype.checkDirectoryUpload=function(e){for(var i=0;e&&i<e.length;i++){var n=e[i].webkitGetAsEntry();if(n.isDirectory)return!0}return!1},t.prototype.traverseFileTree=function(e,i){if(e.isFile)this.filesEntries.push(e);else if(e.isDirectory){var n=e.createReader();this.readFileFromDirectory(n,i)}},t.prototype.readFileFromDirectory=function(e,i){var n=this;e.readEntries(function(r){for(var s=0;s<r.length;s++)n.traverseFileTree(r[s],i);n.pushFilesEntries(i),r.length&&n.readFileFromDirectory(e)})},t.prototype.pushFilesEntries=function(e){for(var i=this,n=[],r=function(l){s.filesEntries[l].file(function(c){if(i.filesEntries.length){var p=i.filesEntries[l].fullPath;n.push({path:p,file:c}),l===i.filesEntries.length-1&&(i.filesEntries=[],i.renderSelectedFiles(e,n,!0))}})},s=this,a=0;a<this.filesEntries.length;a++)r(a)},t.prototype.onSelectFiles=function(e){if(this.enabled){var i;if(e.type==="drop")if(this.directoryUpload)this.getFilesFromFolder(e);else{var n=this.sortFilesList=e.dataTransfer.files;this.browserName!=="msie"&&this.browserName!=="edge"&&this.browserName!=="safari"&&(this.element.files=n),n.length>0&&(i=this.multiple?this.sortFileList(n):[n[0]],this.renderSelectedFiles(e,i))}else i=[].slice.call(e.target.files),this.renderSelectedFiles(e,i);(this.isAngular||this.isReact)&&e.stopPropagation()}},t.prototype.getBase64=function(e){return new Promise(function(i,n){var r=new FileReader;r.readAsDataURL(e),r.onload=function(){return i(r.result)},r.onerror=function(s){return n(s)}})},t.prototype.renderSelectedFiles=function(e,i,n,r){var s=this;this.base64String=[];var a={event:e,cancel:!1,filesData:[],isModified:!1,modifiedFilesData:[],progressInterval:"",isCanceled:!1,currentRequest:null,customFormData:null};if(i.length<1){a.isCanceled=!0,this.trigger("selected",a);return}this.flag=!0;var l=[];this.multiple||(this.clearData(!0),this.actionCompleteCount=0,i=[i[0]]);for(var c=0;c<i.length;c++){var p=n?i[c].file:i[c];this.updateInitialFileDetails(e,i,p,c,l,n,r)}if(a.filesData=l,this.allowedExtensions.indexOf("*")>-1&&(this.allTypes=!0),this.enableHtmlSanitizer)for(var c=0;c<l.length;c++){for(var d=vt.beforeSanitize(),u=vt.serializeValue(d,l[parseInt(c.toString())].name),f=l[parseInt(c.toString())].name,m=!1,v=0;v<f.length;v++)if(f.charCodeAt(v)>127){m=!0;break}var y=/<([a-z][a-z0-9]*)\b[^>]*>(.*?)<\/\1>/i,L=y.test(f);if(u!==l[parseInt(c.toString())].name&&!(m&&!L)){var C=i[parseInt(c.toString())].name.replace(/[\u00A0-\u9999<>\&]/g,function(k){return"&#"+k.charCodeAt(0)+";"});l[parseInt(c.toString())].name=C,l[parseInt(c.toString())].status=this.localizedTexts("invalidFileName"),l[parseInt(c.toString())].statusCode="0"}}this.allTypes||(l=this.checkExtension(l)),this.trigger("selected",a,function(w){s._internalRenderSelect(w,l)})},t.prototype.updateInitialFileDetails=function(e,i,n,r,s,a,l){var c=a?i[r].path.substring(1,i[r].path.length):l?st(n.name.substring(0,n.name.lastIndexOf(".")))+"."+this.getFileType(n.name):this.directoryUpload?i[r].webkitRelativePath:n.name,p={name:c,rawFile:n,size:n.size,status:this.localizedTexts("readyToUploadMessage"),type:this.getFileType(n.name),validationMessages:this.validatedFileSize(n.size),statusCode:"1",id:st(n.name.substring(0,n.name.lastIndexOf(".")))+"."+this.getFileType(n.name)};l&&(p.fileSource="paste"),p.status=p.validationMessages.minSize!==""?this.localizedTexts("invalidMinFileSize"):p.validationMessages.maxSize!==""?this.localizedTexts("invalidMaxFileSize"):p.status,(p.validationMessages.minSize!==""||p.validationMessages.maxSize!=="")&&(p.statusCode="0"),s.push(p)},t.prototype._internalRenderSelect=function(e,i){if(!e.cancel){if(this.selectedFiles=this.selectedFiles.concat(i),this.btnTabIndex=this.disableKeyboardNavigation?"-1":"0",this.showFileList){if(e.isModified&&e.modifiedFilesData.length>0){for(var n=0;n<e.modifiedFilesData.length;n++)for(var r=0;r<i.length;r++)e.modifiedFilesData[n].id===i[r].id&&(e.modifiedFilesData[n].rawFile=i[r].rawFile);var s=this.allTypes?e.modifiedFilesData:this.checkExtension(e.modifiedFilesData);this.updateSortedFileList(s),this.filesData=this.filesData.concat(s),(!this.isForm||this.allowUpload())&&this.checkAutoUpload(s)}else{if(this.internalCreateFileList(i),this.autoUpload&&this.sequenceUpload&&this.sequentialUpload&&this.filesData.length>0&&this.filesData[this.filesData.length-1].statusCode!=="2"&&this.filesData[this.filesData.length-1].statusCode!=="0"){this.filesData=this.filesData.concat(i);return}this.filesData=this.filesData.concat(i),(!this.isForm||this.allowUpload())&&this.checkAutoUpload(i)}!h(e.progressInterval)&&e.progressInterval!==""&&(this.progressInterval=e.progressInterval)}else this.filesData=this.filesData.concat(i),this.autoUpload&&this.upload(this.filesData,!0);for(var a=0;a<this.filesData.length;a++)this.filesData[a].statusCode==="0"&&this.checkActionComplete(!0);this.isFirstFileOnSelection=!0}},t.prototype.allowUpload=function(){var e=!1;return this.isForm&&!h(this.asyncSettings.saveUrl)&&this.asyncSettings.saveUrl!==""&&(e=!0),e},t.prototype.isFormUpload=function(){var e=!1;return this.isForm&&(h(this.asyncSettings.saveUrl)||this.asyncSettings.saveUrl==="")&&(h(this.asyncSettings.removeUrl)||this.asyncSettings.removeUrl==="")&&(e=!0),e},t.prototype.clearData=function(e){h(this.listParent)||(S(this.listParent),this.listParent=null),this.browserName!=="msie"&&!e&&(this.element.value=""),this.fileList=[],this.filesData=[],this.removeActionButtons()},t.prototype.updateSortedFileList=function(e){var i=this.createElement("div",{id:"clonewrapper"}),n=-1;if(this.listParent){for(var r=0;r<this.listParent.querySelectorAll("li").length;r++){var s=this.listParent.querySelectorAll("li")[r];i.appendChild(s.cloneNode(!0))}this.removeActionButtons();var a=[].slice.call(i.childNodes);this.createParentUL();for(var l=0;l<e.length;l++){for(var c=0;c<this.filesData.length;c++)this.filesData[c].name===e[l].name&&(this.listParent.appendChild(a[c]),b.add(a[c].querySelector(".e-icons"),"click",this.removeFiles,this),this.fileList.push(a[c]),n=l);n!==l&&this.internalCreateFileList([e[l]])}}else this.internalCreateFileList(e)},t.prototype.isBlank=function(e){return!e||/^\s*$/.test(e)},t.prototype.checkExtension=function(e){var i=e;if(!this.isBlank(this.allowedExtensions)){for(var n=[],r=this.allowedExtensions.split(","),s=0,a=r;s<a.length;s++){var l=a[s];n.push(l.trim().toLocaleLowerCase())}for(var c=0;c<e.length;c++)n.indexOf(("."+e[c].type).toLocaleLowerCase())===-1&&(e[c].status=this.localizedTexts("invalidFileType"),e[c].statusCode="0")}return i},t.prototype.validatedFileSize=function(e){var i="",n="";e<this.minFileSize?i=this.localizedTexts("invalidMinFileSize"):e>this.maxFileSize?n=this.localizedTexts("invalidMaxFileSize"):(i="",n="");var r={minSize:i,maxSize:n};return r},t.prototype.isPreLoadFile=function(e){for(var i=!1,n=0;n<this.files.length;n++)this.files[n].name===e.name.slice(0,e.name.lastIndexOf("."))&&this.files[n].type===e.type&&(i=!0);return i},t.prototype.createCustomfileList=function(e){this.createParentUL();for(var i=0,n=e;i<n.length;i++){var r=n[i],s=this.createElement("li",{className:Wi,attrs:{"data-file-name":r.name}});this.uploadTemplateFn=this.templateComplier(this.template);var a=this.uploadTemplateFn(r,this,"template",this.element.id+"Template",this.isStringTemplate,null,s);if(a){var l=[].slice.call(a);ve(l,s)}var c=e.indexOf(r),p={element:s,fileInfo:r,index:c,isPreload:this.isPreLoadFile(r)},d={element:s,fileInfo:r,index:c,isPreload:this.isPreLoadFile(r)};this.trigger("rendering",p),this.trigger("fileListRendering",d),this.listParent.appendChild(s),this.fileList.push(s)}this.renderReactTemplates()},t.prototype.createParentUL=function(){h(this.listParent)&&(this.listParent=this.createElement("ul",{className:ko}),this.uploadWrapper.appendChild(this.listParent))},t.prototype.formFileList=function(e,i){var n=this.createElement("li",{className:Wi});n.setAttribute("data-files-count",e.length+"");for(var r=this.createElement("span",{className:Br}),s,a=0,l=e;a<l.length;a++){var c=l[a],p=this.createElement("span",{className:xo});p.innerHTML=this.getFileNameOnly(c.name);var d=this.createElement("span",{className:Do}),u=this.getFileType(c.name);if(d.innerHTML="."+u,u||d.classList.add("e-hidden"),!this.enableRtl)r.appendChild(p),r.appendChild(d);else{var f=this.createElement("span",{className:Mo});f.appendChild(d),f.appendChild(p),r.appendChild(f)}this.truncateName(p),s=this.formValidateFileInfo(c,n)}n.appendChild(r),this.setListToFileInfo(e,n);var m=this.listParent.querySelectorAll("li").length,v=this.createElement("span");if(n.classList.contains(si)?(v.classList.add(le),v.classList.add(si),v.innerText=e.length>1?this.localizedTexts("invalidFileSelection"):s):(v.classList.add(e.length>1?Bc:Bo),v.innerText=e.length>1?this.localizedTexts("totalFiles")+": "+e.length+" , "+this.localizedTexts("size")+": "+this.bytesToSize(this.getFileSize(e)):this.bytesToSize(e[0].size),this.createFormInput(e)),r.appendChild(v),h(n.querySelector(".e-icons"))){var y=this.createElement("span",{className:"e-icons",attrs:{tabindex:this.btnTabIndex}});this.browserName==="msie"&&y.classList.add("e-msie"),y.setAttribute("title",this.localizedTexts("remove")),n.appendChild(r),n.appendChild(y),b.add(y,"click",this.removeFiles,this),y.classList.add(me)}var L={element:n,fileInfo:this.mergeFileInfo(e,n),index:m,isPreload:this.isPreLoadFile(this.mergeFileInfo(e,n))},C={element:n,fileInfo:this.mergeFileInfo(e,n),index:m,isPreload:this.isPreLoadFile(this.mergeFileInfo(e,n))};this.trigger("rendering",L),this.trigger("fileListRendering",C),this.listParent.appendChild(n),this.fileList.push(n)},t.prototype.formValidateFileInfo=function(e,i){var n=e.status,r=this.validatedFileSize(e.size);(r.minSize!==""||r.maxSize!=="")&&(this.addInvalidClass(i),n=r.minSize!==""?this.localizedTexts("invalidMinFileSize"):r.maxSize!==""?this.localizedTexts("invalidMaxFileSize"):n);var s=this.checkExtension(this.getFilesInArray(e))[0].status;return s===this.localizedTexts("invalidFileType")&&(this.addInvalidClass(i),n=s),n},t.prototype.addInvalidClass=function(e){e.classList.add(si)},t.prototype.createFormInput=function(e){if(this.browserName!=="safari"){var i=this.element.cloneNode(!0);i.classList.add(Dc);for(var n=0,r=e;n<r.length;n++){var s=r[n];s.input=i}i.setAttribute("id",st("hiddenUploader")),i.setAttribute("name",this.uploaderName),this.uploadWrapper.querySelector("."+wo).appendChild(i),this.browserName!=="msie"&&this.browserName!=="edge"&&(this.element.value="")}},t.prototype.getFileSize=function(e){for(var i=0,n=0,r=e;n<r.length;n++){var s=r[n];i+=s.size}return i},t.prototype.mergeFileInfo=function(e,i){for(var n={name:"",rawFile:"",size:0,status:"",type:"",validationMessages:{minSize:"",maxSize:""},statusCode:"1",list:i},r=[],s="",a=0,l=e;a<l.length;a++){var c=l[a];r.push(c.name),s=c.type}return n.name=r.join(", "),n.size=this.getFileSize(e),n.type=s,n.status=this.statusForFormUpload(e,i),n},t.prototype.statusForFormUpload=function(e,i){for(var n=!0,r,s=0,a=e;s<a.length;s++){var l=a[s];r=l.status;var c=this.validatedFileSize(l.size);(c.minSize!==""||c.maxSize!=="")&&(n=!1,r=c.minSize!==""?this.localizedTexts("invalidMinFileSize"):c.maxSize!==""?this.localizedTexts("invalidMaxFileSize"):r);var p=this.checkExtension(this.getFilesInArray(l))[0].status;p===this.localizedTexts("invalidFileType")&&(n=!1,r=p)}return n?r=this.localizedTexts("totalFiles")+": "+e.length+" , "+this.localizedTexts("size")+": "+this.bytesToSize(this.getFileSize(e)):(i.classList.add(si),r=e.length>1?this.localizedTexts("invalidFileSelection"):r),r},t.prototype.formCustomFileList=function(e,i){this.createParentUL();var n=this.createElement("li",{className:Wi});n.setAttribute("data-files-count",e.length+""),this.setListToFileInfo(e,n);var r=this.mergeFileInfo(e,n);n.setAttribute("data-file-name",r.name),this.uploadTemplateFn=this.templateComplier(this.template);var s=this.uploadTemplateFn(r,this,"template",this.element.id+"Template",this.isStringTemplate,null,n);if(s){var a=[].slice.call(s);ve(a,n)}var l=this.listParent.querySelectorAll("li").length;n.classList.contains(si)||this.createFormInput(e);var c={element:n,fileInfo:r,index:l,isPreload:this.isPreLoadFile(r)},p={element:n,fileInfo:r,index:l,isPreload:this.isPreLoadFile(r)};this.trigger("rendering",c),this.trigger("fileListRendering",p),this.listParent.appendChild(n),this.fileList.push(n),this.renderReactTemplates()},t.prototype.createFileList=function(e){this.filesData=this.filesData&&this.filesData.length>0?this.filesData.concat(e):e,this.internalCreateFileList(e)},t.prototype.internalCreateFileList=function(e){if(this.createParentUL(),this.template!==""&&!h(this.template))this.isFormUpload()?(this.uploadWrapper.classList.add(Po),this.formCustomFileList(e,this.element.files)):this.createCustomfileList(e);else if(this.isFormUpload())this.uploadWrapper.classList.add(Po),this.formFileList(e,this.element.files);else for(var i=0,n=e;i<n.length;i++){var r=n[i],s=this.createElement("li",{className:Wi,attrs:{"data-file-name":r.name,"data-files-count":"1"}}),a=this.createElement("span",{className:Br}),l=this.createElement("span",{className:xo,attrs:{title:r.name}});l.innerHTML=this.getFileNameOnly(r.name);var c=this.createElement("span",{className:Do}),p=this.getFileType(r.name);if(c.innerHTML="."+p,p||c.classList.add("e-hidden"),!this.enableRtl)a.appendChild(l),a.appendChild(c);else{var d=this.createElement("span",{className:Mo});d.appendChild(c),d.appendChild(l),a.appendChild(d)}var u=this.createElement("span",{className:Bo});u.innerHTML=this.bytesToSize(r.size),a.appendChild(u);var f=this.createElement("span",{className:le});a.appendChild(f),f.innerHTML=r.status,s.appendChild(a);var m=this.createElement("span",{className:" e-icons",attrs:{tabindex:this.btnTabIndex}});this.browserName==="msie"&&m.classList.add("e-msie"),m.setAttribute("title",this.localizedTexts("remove")),s.appendChild(m),b.add(m,"click",this.removeFiles,this),r.statusCode==="2"?(f.classList.add(We),m.classList.add(Fe),m.setAttribute("title",this.localizedTexts("delete"))):r.statusCode!=="1"&&(f.classList.remove(We),f.classList.add(No)),this.autoUpload&&r.statusCode==="1"&&this.asyncSettings.saveUrl!==""&&(f.innerHTML=""),m.classList.contains(Fe)||m.classList.add(me);var v=e.indexOf(r),y={element:s,fileInfo:r,index:v,isPreload:this.isPreLoadFile(r)},L={element:s,fileInfo:r,index:v,isPreload:this.isPreLoadFile(r)};this.trigger("rendering",y),this.trigger("fileListRendering",L),this.listParent.appendChild(s),this.fileList.push(s),this.truncateName(l);var C=this.flag;this.isPreLoadFile(r)&&(this.flag=!1,this.checkActionComplete(!0),this.flag=C)}},t.prototype.getSlicedName=function(e){var i=e.textContent;e.dataset.tail=i.slice(i.length-10)},t.prototype.setListToFileInfo=function(e,i){for(var n=0,r=e;n<r.length;n++){var s=r[n];s.list=i}},t.prototype.truncateName=function(e){var i=e;this.browserName!=="edge"&&i.offsetWidth<i.scrollWidth?this.getSlicedName(i):i.offsetWidth+1<i.scrollWidth&&this.getSlicedName(i)},t.prototype.getFileType=function(e){var i,n=e.lastIndexOf(".");return n>=0&&(i=e.substring(n+1)),i||""},t.prototype.getFileNameOnly=function(e){var i=this.getFileType(e),n=e.split("."+i);return i=n[0]},t.prototype.setInitialAttributes=function(){if(this.initialAttr.accept&&this.element.setAttribute("accept",this.initialAttr.accept),this.initialAttr.disabled&&this.element.setAttribute("disabled","disabled"),this.initialAttr.multiple){var e=document.createAttribute("multiple");this.element.setAttributeNode(e)}},t.prototype.filterfileList=function(e){for(var i=[],n,r=0;r<e.length;r++)n=this.getLiElement(e[r]),n.classList.contains(We)||i.push(e[r]);return i},t.prototype.updateStatus=function(e,i,n,r){if(r===void 0&&(r=!0),!(i===""||h(i))&&!(n===""||h(n))&&(e.status=i,e.statusCode=n),r){var s=this.getLiElement(e);h(s)||!h(s.querySelector("."+le))&&!(i===""||h(i))&&(s.querySelector("."+le).textContent=i)}return e},t.prototype.getLiElement=function(e){for(var i,n=0;n<this.filesData.length;n++)!h(e)&&(!h(this.filesData[n].id)&&!h(e.id)?this.filesData[n].name===e.name&&this.filesData[n].id===e.id:this.filesData[n].name===e.name)&&(i=n);return this.fileList[i]},t.prototype.createProgressBar=function(e){var i=this.createElement("span",{className:St}),n=this.createElement("progressbar",{className:Qi,attrs:{value:"0",max:"100"}}),r=this.createElement("span",{className:xc});n.setAttribute("style","width: 0%");var s=this.createElement("span",{className:Dr});s.textContent="0%",r.appendChild(n),i.appendChild(r),i.appendChild(s),e.querySelector("."+Br).appendChild(i)},t.prototype.updateProgressbar=function(e,i){if(!isNaN(Math.round(e.loaded/e.total*100))&&!h(i.querySelector("."+Qi)))if(!h(this.progressInterval)&&this.progressInterval!==""){var n=Math.round(e.loaded/e.total*100)%parseInt(this.progressInterval,10);(n===0||n===100)&&this.changeProgressValue(i,Math.round(e.loaded/e.total*100).toString()+"%")}else this.changeProgressValue(i,Math.round(e.loaded/e.total*100).toString()+"%")},t.prototype.changeProgressValue=function(e,i){e.querySelector("."+Qi).setAttribute("style","width:"+i),e.querySelector("."+Dr).textContent=i},t.prototype.uploadInProgress=function(e,i,n,r){var s=this.getLiElement(i);if(!(h(s)&&!n)){if(h(s))this.cancelUploadingFile(i,e,r);else{i.statusCode==="5"&&this.cancelUploadingFile(i,e,r,s),!(s.querySelectorAll("."+St).length>0)&&s.querySelector("."+le)&&(s.querySelector("."+le).classList.add(ze),this.createProgressBar(s),this.updateProgressBarClasses(s,ze),s.querySelector("."+le).classList.remove(qe)),this.updateProgressbar(e,s);var a=s.querySelector("."+me);h(a)||(a.classList.add(se,ze),a.setAttribute("title",this.localizedTexts("abort")),a.classList.remove(me))}var l={e,operation:"upload",file:this.updateStatus(i,this.localizedTexts("inProgress"),"3")};this.trigger("progress",l)}},t.prototype.cancelUploadingFile=function(e,i,n,r){var s=this;if(e.statusCode==="5"){var a={event:i,fileData:e,cancel:!1,customFormData:[],currentRequest:null};this.trigger("canceling",a,function(l){if(l.cancel){if(e.statusCode="3",!h(r)){var c=r.querySelector("."+se);h(c)||(Mt(c),S(r.querySelector(".e-spinner-pane")))}}else{n.emitError=!1,n.httpRequest.abort();var p=new FormData;if(e.statusCode==="5"){var d=s.element.getAttribute("name");p.append(d,e.name),p.append("cancel-uploading",e.name),s.updateFormData(p,l.customFormData);var u=new Ut(s.asyncSettings.removeUrl,"POST",!0,null);u.emitError=!1,u.beforeSend=function(f){l.currentRequest&&s.updateCustomheader(u.httpRequest,l.currentRequest)},u.onLoad=function(f){return s.removecanceledFile(f,e),{}},u.send(p)}}})}},t.prototype.removecanceledFile=function(e,i){var n=this.getLiElement(i);if(!(h(n)||n.querySelector("."+Ye)||h(n.querySelector("."+se)))){this.updateStatus(i,this.localizedTexts("fileUploadCancel"),"5"),this.renderFailureState(e,i,n);var r=n.querySelector("."+me);h(n)||(Mt(r),h(n.querySelector(".e-spinner-pane"))||S(n.querySelector(".e-spinner-pane")));var s=e&&e.currentTarget?this.getResponse(e):null,a={event:e,response:s,operation:"cancel",file:i};this.trigger("success",a)}},t.prototype.renderFailureState=function(e,i,n){var r=this;this.updateProgressBarClasses(n,qe),this.removeProgressbar(n,"failure"),h(n.querySelector(".e-file-status"))||n.querySelector(".e-file-status").classList.add(qe);var s=n.querySelector("."+se);if(!h(s)){s.classList.remove(se,ze),s.classList.add(me),s.setAttribute("title",this.localizedTexts("remove")),this.pauseButton=this.createElement("span",{className:"e-icons e-file-reload-btn",attrs:{tabindex:this.btnTabIndex}}),s.parentElement.insertBefore(this.pauseButton,s),this.pauseButton.setAttribute("title",this.localizedTexts("retry"));var a=n.querySelector("."+Ye);a.addEventListener("click",function(l){r.reloadcanceledFile(l,i,n,!1)},!1)}},t.prototype.reloadcanceledFile=function(e,i,n,r){i.statusCode="1",i.status=this.localizedTexts("readyToUploadMessage"),r||(h(n.querySelector("."+le))||n.querySelector("."+le).classList.remove(qe),h(n.querySelector("."+Ye))||S(n.querySelector("."+Ye)),this.pauseButton=null),h(n)||n.classList.add(ri),this.upload([i])},t.prototype.uploadComplete=function(e,i,n){var r=e.target;if(r.readyState===4&&r.status>=200&&r.status<=299){var s=this.getLiElement(i);if(h(s)&&(!n||h(n)))return;if(!h(s)){this.updateProgressBarClasses(s,We),this.removeProgressbar(s,"success");var a=s.querySelector("."+se);h(a)||(a.classList.add(Fe),a.setAttribute("title",this.localizedTexts("delete")),a.classList.remove(se),a.classList.remove(ze))}this.raiseSuccessEvent(e,i)}else this.uploadFailed(e,i)},t.prototype.getResponse=function(e){var i=e.currentTarget,n={readyState:i.readyState,statusCode:i.status,statusText:i.statusText,headers:i.getAllResponseHeaders(),withCredentials:i.withCredentials};return n},t.prototype.raiseSuccessEvent=function(e,i){var n=this,r=e&&e.currentTarget?this.getResponse(e):null,s=this.localizedTexts("uploadSuccessMessage"),a={e,response:r,operation:"upload",file:this.updateStatus(i,s,"2",!1),statusText:s},l=this.getLiElement(i);if(!h(l)){var c=l.querySelector("."+Oo);h(c)||(Mt(l),S(c))}this.trigger("success",a,function(p){n.updateStatus(i,p.statusText,"2"),n.uploadedFilesData.push(i),n.trigger("change",{file:n.uploadedFilesData}),n.checkActionButtonStatus(),n.fileList.length>0?n.getLiElement(i).classList.contains(ri)?n.getLiElement(i).classList.remove(ri):(n.uploadSequential(),n.checkActionComplete(!0)):n.showFileList||n.checkActionComplete(!0)})},t.prototype.uploadFailed=function(e,i){var n=this,r=this.getLiElement(i),s=e&&e.currentTarget?this.getResponse(e):null,a=this.localizedTexts("uploadFailedMessage"),l={e,response:s,operation:"upload",file:this.updateStatus(i,a,"0",!1),statusText:a};h(r)||this.renderFailureState(e,i,r),this.trigger("failure",l,function(c){n.updateStatus(i,c.statusText,"0"),n.checkActionButtonStatus(),n.uploadSequential(),n.checkActionComplete(!0)})},t.prototype.uploadSequential=function(){this.sequentialUpload&&(this.autoUpload?this.checkAutoUpload(this.filesData):this.uploadButtonClick())},t.prototype.checkActionComplete=function(e){e?++this.actionCompleteCount:--this.actionCompleteCount,this.raiseActionComplete()},t.prototype.raiseActionComplete=function(){if(this.filesData.length===this.actionCompleteCount&&this.flag){this.flag=!1;var e={fileData:[]};e.fileData=this.getSelectedFileStatus(this.selectedFiles),this.trigger("actionComplete",e)}},t.prototype.getSelectedFileStatus=function(e){for(var i=[],n=0,r=0;r<e.length;r++)for(var s=e[r],a=0;a<this.filesData.length;a++)this.filesData[a].name===s.name&&this.filesData[a].status===s.status&&(i[n]=this.filesData[a],++n);return i},t.prototype.updateProgressBarClasses=function(e,i){var n=e.querySelector("."+Qi);h(n)||n.classList.add(i)},t.prototype.removeProgressbar=function(e,i){var n=this;h(e.querySelector("."+St))||(this.progressAnimation=new rl({duration:1250}),this.progressAnimation.animate(e.querySelector("."+St),{name:"FadeOut"}),this.progressAnimation.animate(e.querySelector("."+Dr),{name:"FadeOut"}),setTimeout(function(){n.animateProgressBar(e,i)},750))},t.prototype.animateProgressBar=function(e,i){i==="success"?(e.classList.add(We),h(e.querySelector("."+le))||(e.querySelector("."+le).classList.remove(ze),this.progressAnimation.animate(e.querySelector("."+le),{name:"FadeIn"}),e.querySelector("."+le).classList.add(We))):h(e.querySelector("."+le))||(e.querySelector("."+le).classList.remove(ze),this.progressAnimation.animate(e.querySelector("."+le),{name:"FadeIn"}),e.querySelector("."+le).classList.add(qe)),e.querySelector("."+St)&&S(e.querySelector("."+St))},t.prototype.setExtensions=function(e){e!==""&&!h(e)?this.element.setAttribute("accept",e):this.element.removeAttribute("accept")},t.prototype.templateComplier=function(e){if(e)try{return typeof e!="function"&&Te(e,document).length?hn(A(e,document).innerHTML.trim()):hn(e)}catch{return hn(e)}},t.prototype.setRTL=function(){this.enableRtl?x([this.uploadWrapper],Ro):O([this.uploadWrapper],Ro)},t.prototype.localizedTexts=function(e){return this.l10n.setLocale(this.locale),this.l10n.getConstant(e)},t.prototype.setControlStatus=function(){this.enabled?(this.uploadWrapper.classList.contains(Or)&&this.uploadWrapper.classList.remove(Or),!h(this.browseButton)&&this.element.hasAttribute("disabled")&&(this.element.removeAttribute("disabled"),this.browseButton.removeAttribute("disabled")),!h(this.clearButton)&&this.clearButton.hasAttribute("disabled")&&this.clearButton.removeAttribute("disabled"),!h(this.uploadButton)&&this.uploadButton.hasAttribute("disabled")&&this.uploadButton.hasAttribute("disabled")):(this.uploadWrapper.classList.add(Or),this.element.setAttribute("disabled","disabled"),this.browseButton.setAttribute("disabled","disabled"),h(this.clearButton)||this.clearButton.setAttribute("disabled","disabled"),h(this.uploadButton)||this.uploadButton.setAttribute("disabled","disabled"))},t.prototype.checkHTMLAttributes=function(e){for(var i=e?h(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["accept","multiple","disabled"],n=0,r=i;n<r.length;n++){var s=r[n];if(!h(this.element.getAttribute(s)))switch(s){case"accept":(h(this.uploaderOptions)||this.uploaderOptions.allowedExtensions===void 0||e)&&(this.setProperties({allowedExtensions:this.element.getAttribute("accept")},!e),this.initialAttr.accept=this.allowedExtensions);break;case"multiple":if(h(this.uploaderOptions)||this.uploaderOptions.multiple===void 0||e){var a=this.element.getAttribute(s)==="multiple"||this.element.getAttribute(s)===""||this.element.getAttribute(s)==="true";this.setProperties({multiple:a},!e),this.initialAttr.multiple=!0}break;case"disabled":if(h(this.uploaderOptions)||this.uploaderOptions.enabled===void 0||e){var l=!(this.element.getAttribute(s)==="disabled"||this.element.getAttribute(s)===""||this.element.getAttribute(s)==="true");this.setProperties({enabled:l},!e),this.initialAttr.disabled=!0}}}},t.prototype.chunkUpload=function(e,i,n){var r=0,s=Math.min(this.asyncSettings.chunkSize,e.size),a=0,l=e.rawFile.slice(r,s),c={chunkIndex:a,blob:l,file:e,start:r,end:s,retryCount:0,request:null};this.sendRequest(e,c,i,n)},t.prototype.sendRequest=function(e,i,n,r){var s=this,a=new FormData,l=e.rawFile.slice(i.start,i.end);a.append(this.uploaderName,l,e.name),a.append("chunk-index",i.chunkIndex.toString()),a.append("chunkIndex",i.chunkIndex.toString());var c=Math.max(Math.ceil(e.size/this.asyncSettings.chunkSize),1);a.append("total-chunk",c.toString()),a.append("totalChunk",c.toString());var p=new Ut({url:this.asyncSettings.saveUrl,type:"POST",async:!0,contentType:null});p.emitError=!1,p.onLoad=function(u){return s.chunkUploadComplete(u,i,n),{}},p.onUploadProgress=function(u){return s.chunkUploadInProgress(u,i,n),{}};var d={fileData:e,customFormData:[],cancel:!1,chunkSize:this.asyncSettings.chunkSize===0?null:this.asyncSettings.chunkSize};p.beforeSend=function(u){d.currentRequest=p.httpRequest,d.currentChunkIndex=i.chunkIndex,d.currentChunkIndex===0?s.trigger("uploading",d,function(f){s.uploadingEventCallback(a,f,u,e)}):s.trigger("chunkUploading",d,function(f){s.uploadingEventCallback(a,f,u,e)})},p.onError=function(u){return s.chunkUploadFailed(u,i,n),{}},p.send(a),i.request=p},t.prototype.uploadingEventCallback=function(e,i,n,r){i.cancel?this.eventCancelByArgs(n,i,r):this.updateFormData(e,i.customFormData)},t.prototype.eventCancelByArgs=function(e,i,n){var r=this;if(e.cancel=!0,i.fileData.statusCode!=="5"){i.fileData.statusCode="5",i.fileData.status=this.localizedTexts("fileUploadCancel");var s=this.getLiElement(i.fileData);if(s){h(s.querySelector("."+le))||(s.querySelector("."+le).innerHTML=this.localizedTexts("fileUploadCancel"),s.querySelector("."+le).classList.add(qe)),this.pauseButton=this.createElement("span",{className:"e-icons e-file-reload-btn",attrs:{tabindex:this.btnTabIndex}});var a=s.querySelector("."+me);a&&a.parentElement.insertBefore(this.pauseButton,a),this.pauseButton.setAttribute("title",this.localizedTexts("retry")),this.pauseButton.addEventListener("click",function(l){r.reloadcanceledFile(l,n,s)},!1),this.checkActionButtonStatus()}}},t.prototype.checkChunkUpload=function(){return!(this.asyncSettings.chunkSize<=0||h(this.asyncSettings.chunkSize))},t.prototype.chunkUploadComplete=function(e,i,n){var r=this,s=e.target,a;if(s.readyState===4&&s.status>=200&&s.status<300){var l=e&&e.currentTarget?this.getResponse(e):null,c=Math.max(Math.ceil(i.file.size/this.asyncSettings.chunkSize),1),p={event:e,file:i.file,chunkIndex:i.chunkIndex,totalChunk:c,chunkSize:this.asyncSettings.chunkSize,response:l};if(this.trigger("chunkSuccess",p),(h(n)||!n)&&(a=this.getLiElement(i.file)),this.updateMetaData(i),i.end===i.file.size&&(i.file.statusCode="3"),i.file.statusCode==="5"){var d={event:e,fileData:i.file,cancel:!1,customFormData:[]};this.trigger("canceling",d,function(f){if(f.cancel){i.file.statusCode="3";var m=a.querySelector("."+se);!h(a)&&!h(m)&&(Mt(m),S(a.querySelector(".e-spinner-pane"))),r.sendNextRequest(i)}else{i.request.emitError=!1,s.abort();var v=new FormData,y=r.element.getAttribute("name");v.append(y,i.file.name),v.append("cancel-uploading",i.file.name),v.append("cancelUploading",i.file.name),r.updateFormData(v,f.customFormData);var L=new Ut(r.asyncSettings.removeUrl,"POST",!0,null);L.emitError=!1,L.onLoad=function(C){return r.removeChunkFile(C,i,n),{}},L.send(v)}})}else{if(c-1===i.chunkIndex&&c>i.chunkIndex){var u=this.pausedData.indexOf(i);u>=0&&this.pausedData.splice(u,1),h(this.template)&&(h(n)||!n)&&a&&(a&&!h(a.querySelector("."+Ee))&&S(a.querySelector("."+Ee)),this.removeChunkProgressBar(i)),this.raiseSuccessEvent(e,i.file);return}i.file.statusCode!=="4"&&this.sendNextRequest(i)}}else this.chunkUploadFailed(e,i)},t.prototype.sendNextRequest=function(e){e.start=e.end,e.end+=this.asyncSettings.chunkSize,e.end=Math.min(e.end,e.file.size),e.chunkIndex+=1,this.sendRequest(e.file,e)},t.prototype.removeChunkFile=function(e,i,n){if(h(this.template)&&h(n)&&!n){var r=this.getLiElement(i.file),s=r.querySelector("."+se),a=s;this.updateStatus(i.file,this.localizedTexts("fileUploadCancel"),"5"),this.updateProgressBarClasses(r,qe),this.removeProgressbar(r,"failure"),s&&s.classList.remove(se),s&&s.classList.add(me),s&&s.setAttribute("title",this.localizedTexts("remove"));var l=r.querySelector("."+Ee);l&&l.classList.add(Ye),l&&l.classList.remove(Ee),l&&l.setAttribute("title",this.localizedTexts("retry")),!h(r)&&!h(s)&&!h(r.querySelector(".e-spinner-pane"))&&(Mt(a),S(r.querySelector(".e-spinner-pane")))}},t.prototype.pauseUpload=function(e,i,n){e.file.statusCode="4",e.file.status=this.localizedTexts("pause"),this.updateMetaData(e);var r={event:i||null,file:e.file,chunkIndex:e.chunkIndex,chunkCount:Math.round(e.file.size/this.asyncSettings.chunkSize),chunkSize:this.asyncSettings.chunkSize};this.abortUpload(e,n,r)},t.prototype.abortUpload=function(e,i,n){e.file.statusCode!=="4"&&(e.request.emitError=!1,e.request.httpRequest.abort());var r=this.getLiElement(e.file);if(h(this.template)&&(h(i)||!i)){var s=r.querySelector("."+Ee);s.classList.remove(Ee),s.classList.add(Et),s.setAttribute("title",this.localizedTexts("resume")),s.nextElementSibling.classList.add(me),s.nextElementSibling.classList.remove(se),s.nextElementSibling.setAttribute("title",this.localizedTexts("remove"))}for(var a=0;a<this.pausedData.length;a++)this.pausedData[a].file.name===e.file.name&&this.pausedData.splice(a,1);this.pausedData.push(e),this.trigger("pausing",n)},t.prototype.resumeUpload=function(e,i,n){var r=this.getLiElement(e.file),s;h(r)||(s=r.querySelector("."+Et)),!h(s)&&(h(n)||!n)&&(s.classList.remove(Et),s.classList.add(Ee),s.setAttribute("title",this.localizedTexts("pause")),s.nextElementSibling.classList.remove(me),s.nextElementSibling.classList.add(se),s.nextElementSibling.setAttribute("title",this.localizedTexts("abort"))),e.file.status=this.localizedTexts("inProgress"),e.file.statusCode="3",this.updateMetaData(e);var a={event:i||null,file:e.file,chunkIndex:e.chunkIndex,chunkCount:Math.round(e.file.size/this.asyncSettings.chunkSize),chunkSize:this.asyncSettings.chunkSize};this.trigger("resuming",a);for(var l=0;l<this.pausedData.length;l++)this.pausedData[l].end===this.pausedData[l].file.size?this.chunkUploadComplete(i,e,n):this.pausedData[l].file.name===e.file.name&&(this.pausedData[l].start=this.pausedData[l].end,this.pausedData[l].end=this.pausedData[l].end+this.asyncSettings.chunkSize,this.pausedData[l].end=Math.min(this.pausedData[l].end,this.pausedData[l].file.size),this.pausedData[l].chunkIndex=this.pausedData[l].chunkIndex+1,this.sendRequest(this.pausedData[l].file,this.pausedData[l],n))},t.prototype.updateMetaData=function(e){this.uploadMetaData.indexOf(e)===-1?this.uploadMetaData.push(e):(this.uploadMetaData.splice(this.uploadMetaData.indexOf(e),1),this.uploadMetaData.push(e))},t.prototype.removeChunkProgressBar=function(e){var i=this.getLiElement(e.file);if(!h(i)){this.updateProgressBarClasses(i,We),this.removeProgressbar(i,"success");var n=i.querySelector("."+se);h(n)||(n.classList.add(Fe),n.setAttribute("title",this.localizedTexts("delete")),n.classList.remove(se,ze))}},t.prototype.chunkUploadFailed=function(e,i,n){var r=this,s=Math.max(Math.ceil(i.file.size/this.asyncSettings.chunkSize),1),a;h(this.template)&&(h(n)||!n)&&(a=this.getLiElement(i.file));var l=e&&e.currentTarget?this.getResponse(e):null,c={event:e,file:i.file,chunkIndex:i.chunkIndex,totalChunk:s,chunkSize:this.asyncSettings.chunkSize,cancel:!1,response:l};this.trigger("chunkFailure",c,function(p){if(!p.cancel)if(i.retryCount<r.asyncSettings.retryCount)setTimeout(function(){r.retryRequest(a,i,n)},r.asyncSettings.retryAfterDelay);else{if(!h(a)){var d=a.querySelector("."+Ee)?a.querySelector("."+Ee):a.querySelector("."+Et);h(d)||(d.classList.add(Ye),d.classList.remove(Ee,Et)),r.updateProgressBarClasses(a,qe),r.removeProgressbar(a,"failure"),a.querySelector(".e-icons").classList.remove(ze);var u=a.querySelector("."+se)?a.querySelector("."+se):a.querySelector("."+me);u.classList.remove(se),h(a.querySelector("."+Ee))||S(a.querySelector("."+Ee)),i.start>0?(u.classList.add(Fe),u.setAttribute("title",r.localizedTexts("delete"))):(u.classList.add(me),u.setAttribute("title",r.localizedTexts("remove")))}i.retryCount=0;var f=i.file,m=r.localizedTexts("uploadFailedMessage"),v={e,response:l,operation:"upload",file:r.updateStatus(f,m,"0",!1),statusText:m};r.trigger("failure",v,function(y){r.updateStatus(f,y.statusText,"0"),r.uploadSequential(),r.checkActionComplete(!0)})}})},t.prototype.retryRequest=function(e,i,n){h(this.template)&&(h(n)||!n)&&e&&this.updateProgressBarClasses(e,qe),i.retryCount+=1,this.sendRequest(i.file,i)},t.prototype.checkPausePlayAction=function(e){var i=e.target,n=e.target.parentElement,r=this.fileList.indexOf(n),s=this.filesData[r],a=this.getCurrentMetaData(s);i.classList.contains(Ee)?this.pauseUpload(a,e):i.classList.contains(Et)?this.resumeUpload(a,e):i.classList.contains(Ye)&&(a.file.status===this.localizedTexts("fileUploadCancel")?this.retryUpload(a,!1):this.retryUpload(a,!0))},t.prototype.retryUpload=function(e,i){i?(e.end=e.end+this.asyncSettings.chunkSize,e.start=e.start+this.asyncSettings.chunkSize,this.sendRequest(e.file,e)):(e.file.statusCode="1",e.file.status=this.localizedTexts("readyToUploadMessage"),this.chunkUpload(e.file)),this.getLiElement(e.file).classList.add(ri)},t.prototype.chunkUploadInProgress=function(e,i,n){var r=this;if(i.file.statusCode!=="4"){i.file.statusCode!=="4"&&i.file.statusCode!=="5"&&(i.file.statusCode="3",i.file.status=this.localizedTexts("inProgress")),this.updateMetaData(i);var s=this.getLiElement(i.file);if(!h(s)){var a=s.querySelector("."+Ye);if(h(a)||(a.classList.add(Ee),a.setAttribute("title",this.localizedTexts("pause")),a.classList.remove(Ye)),!h(s)){if(!(s.querySelectorAll("."+St).length>0)){var l=s.querySelector("."+le);h(this.template)&&(l.classList.add(ze),l.classList.remove(qe),this.createProgressBar(s),this.updateProgressBarClasses(s,ze));var c=s.querySelector("."+me)?s.querySelector("."+me):s.querySelector("."+Fe);h(c)||(c.classList.add(se),c.setAttribute("title",this.localizedTexts("abort")),c.classList.remove(me))}if(!isNaN(Math.round(e.loaded/e.total*100))&&h(this.template)&&i.file.statusCode!=="4"){var p=void 0,d=Math.ceil(i.file.size/this.asyncSettings.chunkSize)-1;this.asyncSettings.chunkSize&&d&&(p=Math.round(i.chunkIndex/d*100),this.changeProgressValue(s,p.toString()+"%"))}i.chunkIndex===0&&this.checkActionButtonStatus()}if(h(s.querySelector("."+Ee))&&h(this.template)&&h(s.querySelector("."+Fe))){this.pauseButton=this.createElement("span",{className:"e-icons e-file-pause-btn",attrs:{tabindex:this.btnTabIndex}}),this.browserName==="msie"&&this.pauseButton.classList.add("e-msie");var u=s.querySelector("."+se);u.parentElement.insertBefore(this.pauseButton,u),this.pauseButton.setAttribute("title",this.localizedTexts("pause")),this.pauseButton.addEventListener("click",function(f){r.checkPausePlayAction(f)},!1)}}}},t.prototype.bytesToSize=function(e){var i=-1;if(!e)return"0.0 KB";do e=e/1024,i++;while(e>99);return i>=2&&(e=e*1024,i=1),Math.max(e,0).toFixed(1)+" "+["KB","MB"][i]},t.prototype.sortFileList=function(e){e=e||this.sortFilesList;for(var i=e,n=[],r=0;r<i.length;r++)n.push(i[r].name);for(var s=n.sort(),a=[],l=0,c=s;l<c.length;l++)for(var p=c[l],r=0;r<i.length;r++)p===i[r].name&&a.push(i[r]);return a},t.prototype.destroy=function(){this.element.value=null,this.clearTemplate(),this.clearAll(),this.unWireEvents(),this.unBindDropEvents(),this.multiple&&this.element.removeAttribute("multiple"),this.enabled||this.element.removeAttribute("disabled"),this.element.removeAttribute("accept"),this.setInitialAttributes();for(var e=["aria-label","directory","webkitdirectory","tabindex"],i=0,n=e;i<n.length;i++){var r=n[i];this.element.removeAttribute(r)}h(this.uploadWrapper)||(this.uploadWrapper.parentElement.appendChild(this.element),S(this.uploadWrapper)),this.uploadWrapper=null,this.uploadWrapper=null,this.browseButton=null,this.dropAreaWrapper=null,this.dropZoneElement=null,this.dropArea=null,this.keyboardModule=null,this.clearButton=null,this.uploadButton=null,o.prototype.destroy.call(this)},t.prototype.upload=function(e,i){var n=this;if(e=e||this.filesData,this.sequentialUpload&&(this.isFirstFileOnSelection||i))this.sequenceUpload(e);else{var r=this.getFilesInArray(e),s={customFormData:[],currentRequest:null,cancel:!1};this.trigger("beforeUpload",s,function(a){a.cancel||n.uploadFiles(r,i)})}},t.prototype.getFilesInArray=function(e){var i=[];return e instanceof Array?i=e:i.push(e),i},t.prototype.serverReadFileBase64=function(e,i,n){var r=this;return new Promise(function(s,a){var l=r.fileStreams[e].rawFile;try{var c=new FileReader;c.onload=function(p){return function(){try{var d=p.result,u=d?d.split(";base64,")[1]:null;s(u)}catch(f){a(f)}}}(c),c.readAsDataURL(l.slice(i,i+n))}catch(p){a(p)}})},t.prototype.uploadFileCount=function(e){var i=this.filesData;if(!i||i.length===0)return-1;var n=i.length;return n},t.prototype.getFileRead=function(e,i){var n=this.filesData;if(!n||n.length===0)return-1;var r=n[e],s=this.newFileRef++;return this.fileStreams[s]=r,s},t.prototype.getFileInfo=function(e,i){var n=this.filesData;if(!n||n.length===0)return null;var r=n[e];return r?this.filesData[e]:null},t.prototype.uploadFiles=function(e,i){var n=[];if(!(this.asyncSettings.saveUrl===""||h(this.asyncSettings.saveUrl))){if(!i||h(i))if(this.multiple)n=this.filterfileList(e);else{var r=[];r.push(e[0]),n=this.filterfileList(r)}else n=e;for(var s=0;s<n.length;s++)this.uploadFilesRequest(n,s,i)}},t.prototype.uploadFilesRequest=function(e,i,n){var r=this,s=this.checkChunkUpload(),a=new Ut(this.asyncSettings.saveUrl,"POST",!0,null);a.emitError=!1;var l={fileData:e[i],customFormData:[],cancel:!1},c=new FormData;if(a.beforeSend=function(d){l.currentRequest=a.httpRequest,r.trigger("uploading",l,function(u){u.cancel&&r.eventCancelByArgs(d,u,e[i]),r.updateFormData(c,u.customFormData)})},e[i].statusCode==="1"){var p=this.element.getAttribute("name");c.append(p,e[i].rawFile,e[i].name),s&&e[i].size>this.asyncSettings.chunkSize?this.chunkUpload(e[i],n,i):(a.onLoad=function(d){return l.cancel?{}:(r.uploadComplete(d,e[i],n),{})},a.onUploadProgress=function(d){return l.cancel?{}:(r.uploadInProgress(d,e[i],n,a),{})},a.onError=function(d){return r.uploadFailed(d,e[i]),{}},a.send(c))}},t.prototype.spliceFiles=function(e){for(var i=this.fileList[e],n=this.getFilesData(),r=+i.getAttribute("data-files-count"),s=0,a=0;a<e;a++)s+=+this.fileList[a].getAttribute("data-files-count");for(var l=s+r-1,c=l;c>=s;c--)n.splice(c,1)},t.prototype.remove=function(e,i,n,r,s){var a=this;h(r)&&(r=!0);var l={event:s,cancel:!1,filesData:[],customFormData:[],postRawFile:r,currentRequest:null},c={cancel:!1,customFormData:[],currentRequest:null};this.trigger("beforeRemove",c,function(p){if(!p.cancel)if(a.isFormUpload())l.filesData=e,a.trigger("removing",l,function(C){if(!C.cancel)for(var w=a.getFilesInArray(e),k=!1,I=void 0,P=0,Z=w;P<Z.length;P++){var G=Z[P];if(k||(I=a.fileList.indexOf(G.list)),I>-1){var $=h(G.input)?null:G.input;$&&S($),a.spliceFiles(I),S(a.fileList[I]),a.fileList.splice(I,1),k=!0,I=-1}}});else if(a.isForm&&(h(a.asyncSettings.removeUrl)||a.asyncSettings.removeUrl===""))l.filesData=a.getFilesData(),a.trigger("removing",l,function(C){C.cancel||a.clearAll()});else{var d=[];e=h(e)?a.filesData:e,e instanceof Array?d=e:d.push(e),l.filesData=d;for(var u=a.asyncSettings.removeUrl,f=!(u===""||h(u)),m=function(C){var w=a.uploadedFilesData.indexOf(C);(C.statusCode==="2"||C.statusCode==="4"||C.statusCode==="0"&&w!==-1)&&f?a.removeUploadedFile(C,l,n,i):n?a.removeFilesData(C,i):a.trigger("removing",l,function(k){k.cancel||a.removeFilesData(C,i)}),s&&!s.target.classList.contains(me)&&a.checkActionComplete(!1)},v=0,y=d;v<y.length;v++){var L=y[v];m(L)}}})},t.prototype.clearAll=function(){var e=this;if(h(this.listParent)){this.browserName!=="msie"&&(this.element.value=""),this.filesData=[];return}var i={cancel:!1,filesData:this.filesData};this.trigger("clearing",i,function(n){n.cancel||(e.clearData(),e.actionCompleteCount=0,e.count=-1)})},t.prototype.getFilesData=function(e){return h(e)?this.filesData:this.getSelectedFiles(e)},t.prototype.pause=function(e,i){e=e||this.filesData;var n=this.getFilesInArray(e);this.pauseUploading(n,i)},t.prototype.pauseUploading=function(e,i){for(var n=this.getFiles(e),r=0;r<n.length;r++)n[r].statusCode==="3"&&this.pauseUpload(this.getCurrentMetaData(n[r],null),null,i)},t.prototype.getFiles=function(e){var i=[];return!h(e)&&!(e instanceof Array)?i.push(e):i=e,i},t.prototype.resume=function(e,i){e=e||this.filesData;var n=this.getFilesInArray(e);this.resumeFiles(n,i)},t.prototype.resumeFiles=function(e,i){for(var n=this.getFiles(e),r=0;r<n.length;r++)n[r].statusCode==="4"&&this.resumeUpload(this.getCurrentMetaData(n[r],null),null,i)},t.prototype.retry=function(e,i,n){e=e||this.filesData;var r=this.getFilesInArray(e);this.sequentialUpload&&this.isFirstFileOnSelection&&(this.isFirstFileOnSelection=!1),this.retryFailedFiles(r,i,n)},t.prototype.retryFailedFiles=function(e,i,n){for(var r=this.getFiles(e),s=0;s<r.length;s++)if(r[s].statusCode==="5"||r[s].statusCode==="0")if(this.asyncSettings.chunkSize>0&&this.getCurrentMetaData(r[s],null))this.retryUpload(this.getCurrentMetaData(r[s],null),i);else{var a=void 0;n||(a=this.fileList[this.filesData.indexOf(r[s])]),this.reloadcanceledFile(null,r[s],a,n)}},t.prototype.cancel=function(e){e=e||this.filesData;var i=this.getFilesInArray(e);this.cancelUpload(i)},t.prototype.cancelUpload=function(e){var i=this.getFiles(e);if(this.asyncSettings.chunkSize>0){for(var n=0;n<i.length;n++)if(i[n].statusCode==="3"){var r=this.getCurrentMetaData(i[n],null);r.file.statusCode="5",r.file.status=this.localizedTexts("fileUploadCancel"),this.updateMetaData(r),this.showHideUploadSpinner(i[n])}}else for(var n=0;n<i.length;n++)i[n].statusCode==="3"&&(i[n].statusCode="5",i[n].status=this.localizedTexts("fileUploadCancel"),this.showHideUploadSpinner(i[n]))},t.prototype.showHideUploadSpinner=function(e){var i=this.getLiElement(e);if(!h(i)&&h(this.template)){var n=i.querySelector("."+se);rr({target:n,width:"20px"}),sr(n)}},z([X({saveUrl:"",removeUrl:""},Rc)],t.prototype,"asyncSettings",void 0),z([g(!1)],t.prototype,"sequentialUpload",void 0),z([g({})],t.prototype,"htmlAttributes",void 0),z([g("")],t.prototype,"cssClass",void 0),z([g(!0)],t.prototype,"enabled",void 0),z([g(null)],t.prototype,"template",void 0),z([g(!0)],t.prototype,"multiple",void 0),z([g(!0)],t.prototype,"autoUpload",void 0),z([g(!0)],t.prototype,"enableHtmlSanitizer",void 0),z([X({},Nc)],t.prototype,"buttons",void 0),z([g("")],t.prototype,"allowedExtensions",void 0),z([g(0)],t.prototype,"minFileSize",void 0),z([g(3e7)],t.prototype,"maxFileSize",void 0),z([g(null)],t.prototype,"dropArea",void 0),z([$n([{}],Oc)],t.prototype,"files",void 0),z([g(!0)],t.prototype,"showFileList",void 0),z([g(!1)],t.prototype,"directoryUpload",void 0),z([g("Default")],t.prototype,"dropEffect",void 0),z([N()],t.prototype,"created",void 0),z([N()],t.prototype,"actionComplete",void 0),z([N()],t.prototype,"rendering",void 0),z([N()],t.prototype,"beforeUpload",void 0),z([N()],t.prototype,"fileListRendering",void 0),z([N()],t.prototype,"selected",void 0),z([N()],t.prototype,"uploading",void 0),z([N()],t.prototype,"success",void 0),z([N()],t.prototype,"failure",void 0),z([N()],t.prototype,"removing",void 0),z([N()],t.prototype,"beforeRemove",void 0),z([N()],t.prototype,"clearing",void 0),z([N()],t.prototype,"progress",void 0),z([N()],t.prototype,"change",void 0),z([N()],t.prototype,"chunkSuccess",void 0),z([N()],t.prototype,"chunkFailure",void 0),z([N()],t.prototype,"chunkUploading",void 0),z([N()],t.prototype,"canceling",void 0),z([N()],t.prototype,"pausing",void 0),z([N()],t.prototype,"resuming",void 0),t=z([Ct],t),t}($t),Mc=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),At=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r};function Ai(o,t){for(var e=ot({},o),i=0,n=Object.keys(e);i<n.length;i++){var r=n[i];t.indexOf(r)<0&&sl(e,r)}return e}function Ac(o,t){var e=t===40?0:o.childElementCount-1,i=e,n,r=o.querySelector(".e-selected");r&&r.classList.remove("e-selected");for(var s=0,a=o.children.length;s<a;s++)o.children[s].classList.contains("e-focused")&&(n=o.children[s],i=s,n.classList.remove("e-focused"),t===40?i++:i--,i===(t===40?o.childElementCount:-1)&&(i=e));n=o.children[i],i=Ca(o,n,i,t),i!==-1&&(x([o.children[i]],"e-focused"),o.children[i].focus())}function Ca(o,t,e,i,n){if(n===void 0&&(n=0),(t.classList.contains("e-separator")||t.classList.contains("e-disabled"))&&(e===(i===40?o.childElementCount-1:0)?e=i===40?0:o.childElementCount-1:i===40?e++:e--),t=o.children[e],t.classList.contains("e-separator")||t.classList.contains("e-disabled")){if(n++,n===o.childElementCount)return e=-1;e=Ca(o,t,e,i,n)}return e}function Pc(o,t){var e=[].slice.call(o.getElementsByClassName("e-blank-icon"));if(t){var i=[].slice.call(o.getElementsByClassName("e-item"));i.forEach(function(c){(c.style.paddingLeft||c.style.paddingRight)&&c.removeAttribute("style")})}if(e.length){var n=o.querySelector(".e-item:not(.e-blank-icon):not(.e-separator)");if(!h(n)){n.classList.contains("e-url")&&(n=n.querySelector(".e-menu-url"));var r=n.querySelector(".e-menu-icon"),s,a=o.classList.contains("e-rtl");a?s={padding:"paddingRight",margin:"marginLeft"}:s={padding:"paddingLeft",margin:"marginRight"};var l=parseInt(getComputedStyle(r).fontSize,10)+parseInt(getComputedStyle(r)[s.margin],10)+parseInt(getComputedStyle(n).paddingLeft,10)+"px";e.forEach(function(c){c.classList.contains("e-url")?c.querySelector(".e-menu-url").style[s.padding]=l:c.style[s.padding]=l})}}}var Ns=function(o){Mc(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return At([g("")],t.prototype,"iconCss",void 0),At([g("")],t.prototype,"id",void 0),At([g(!1)],t.prototype,"separator",void 0),At([g("")],t.prototype,"text",void 0),At([g("")],t.prototype,"url",void 0),At([g(!1)],t.prototype,"disabled",void 0),t}(W),Ic=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ge=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},$e={DISABLED:"e-disabled",FOCUS:"e-focused",ICON:"e-menu-icon",ITEM:"e-item",POPUP:"e-dropdown-popup",RTL:"e-rtl",SEPARATOR:"e-separator",VERTICAL:"e-vertical"},Ci=function(o){Ic(t,o);function t(e,i){var n=o.call(this,e,i)||this;return n.isPopupCreated=!0,n}return t.prototype.preRender=function(){},t.prototype.getPersistData=function(){return this.addOnPersist([])},t.prototype.toggle=function(){this.canOpen()?this.openPopUp():this.createPopupOnClick&&!this.isPopupCreated?(this.createPopup(),this.openPopUp()):this.closePopup()},t.prototype.render=function(){this.initialize(),this.disabled||this.wireEvents(),this.renderComplete()},t.prototype.addItems=function(e,i){for(var n,r=this.items.length,s=0,a=this.items.length;s<a;s++)if(i===this.items[s].text){r=s;break}for(var l=e.length-1;l>=0;l--)n=new Ns(this,"items",e[l],!0),this.items.splice(r,0,n);this.canOpen()||this.createItems()},t.prototype.removeItems=function(e,i){for(var n=!1,r=0,s=e.length;r<s;r++)for(var a=0,l=this.items.length;a<l;a++)if(e[r]===(i?this.items[a].id:this.items[a].text)){this.items.splice(a,1),n=!0;break}n&&this.getULElement()&&this.createItems()},t.prototype.createPopup=function(){var e,i=this.createElement("div",{className:$e.POPUP,id:this.element.id+"-popup"});document.body.appendChild(i),this.dropDown=new Hi(i,{relateTo:this.element,collision:{X:"fit",Y:"flip"},position:{X:"left",Y:"bottom"},targetType:"relative",content:this.target?this.getTargetElement():"",enableRtl:this.enableRtl}),this.dropDown.element.setAttribute("role","dialog"),this.dropDown.element.setAttribute("aria-label","dropdown menu"),h(this.popupContent)||(this.popupContent.style.display=""),this.dropDown.element.style.position==="fixed"&&this.dropDown.refreshPosition(this.element),this.dropDown.hide(),ce(this.element,(e={},e["aria-haspopup"]=this.items.length||this.target?"true":"false",e["aria-expanded"]="false",e.type="button",e)),this.cssClass&&x([i],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.isPopupCreated=!0},t.prototype.getTargetElement=function(){return this.createPopupOnClick&&!this.isColorPicker()&&!h(this.popupContent)?this.popupContent:typeof this.target=="string"?A(this.target):this.target},t.prototype.createItems=function(e){var i=this.items,n=this.hasIcon(this.items,"iconCss"),r,s,a,l,c=this.getULElement();c?c.innerHTML="":c=this.createElement("ul",{attrs:{role:"menu",tabindex:"0"}});for(var p=0;p<i.length;p++){s=i[p];var d=s.text;a=this.createElement("li",{innerHTML:s.url?"":d,className:s.separator?$e.ITEM+" "+$e.SEPARATOR:$e.ITEM,attrs:s.separator?{role:"separator",tabindex:"-1","aria-label":"separator","aria-hidden":"true"}:{role:"menuitem",tabindex:"-1","aria-label":d},id:s.id?s.id:st("e-"+this.getModuleName()+"-item")}),this.enableHtmlSanitizer?a.textContent=s.url?"":d:a.innerHTML=s.url?"":d,s.url&&(a.appendChild(this.createAnchor(s)),a.classList.add("e-url")),s.iconCss?(r=this.createElement("span",{className:$e.ICON+" "+s.iconCss}),s.url?a.childNodes[0].appendChild(r):a.insertBefore(r,a.childNodes[0])):n&&!s.separator&&a.classList.add("e-blank-icon");var u=s.disabled;s.disabled&&a.classList.add("e-disabled"),l={item:s,element:a},this.trigger("beforeItemRender",l);var f=l.item.disabled;u!==f&&(l.item.disabled?a.classList.add("e-disabled"):a.classList.remove("e-disabled")),c.appendChild(a)}e&&this.getPopUpElement().appendChild(c),n&&Pc(this.getPopUpElement())},t.prototype.hasIcon=function(e,i){for(var n=0,r=e.length;n<r;n++)if(e[n][""+i])return!0;return!1},t.prototype.createAnchor=function(e){var i=this.enableHtmlSanitizer?vt.sanitize(e.text):e.text;return this.createElement("a",{className:"e-menu-text e-menu-url",innerHTML:i,attrs:{href:e.url}})},t.prototype.initialize=function(){this.button=new zs({iconCss:this.iconCss,iconPosition:this.iconPosition,cssClass:this.cssClass,content:this.content,disabled:this.disabled,enableRtl:this.enableRtl,enablePersistence:this.enablePersistence}),this.button.createElement=this.createElement,this.button.appendTo(this.element),this.element.id||(this.element.id=st("e-"+this.getModuleName())),this.appendArrowSpan(),this.setActiveElem([this.element]),this.element.setAttribute("aria-label",this.element.textContent?this.element.textContent:"dropdownbutton"),this.target&&!this.isColorPicker()&&!this.createPopupOnClick||!this.createPopupOnClick?this.createPopup():(this.isPopupCreated=!1,this.target&&!this.isColorPicker()&&this.createPopupOnClick&&(this.popupContent=this.getTargetElement(),this.popupContent.style.display="none"))},t.prototype.isColorPicker=function(){if(!this.element)return!1;var e=this.element.previousSibling;return!!(e&&e.classList&&e.classList.contains("e-split-colorpicker"))},t.prototype.appendArrowSpan=function(){this.element.appendChild(this.createElement("span",{className:"e-btn-icon e-icons e-icon-"+(this.cssClass.indexOf($e.VERTICAL)>-1?"bottom":"right")+" e-caret"}))},t.prototype.setActiveElem=function(e){this.activeElem=e},t.prototype.getModuleName=function(){return"dropdown-btn"},t.prototype.canOpen=function(){var e=!1;return this.isPopupCreated&&(e=this.getPopUpElement().classList.contains("e-popup-close")),e},t.prototype.destroy=function(){var e=this;if(o.prototype.destroy.call(this),this.getModuleName()==="dropdown-btn"){var i;this.element.querySelector("span.e-caret")&&S(this.element.querySelector("span.e-caret")),this.cssClass&&(i=this.cssClass.split(" ")),this.button.destroy(),i&&O([this.element],i),O(this.activeElem,["e-active"]);var n=this.element.getAttribute("class")?["aria-haspopup","aria-expanded","aria-owns","type"]:["aria-haspopup","aria-expanded","aria-owns","type","class"];n.forEach(function(r){e.element.removeAttribute(r)}),this.popupUnWireEvents(),this.destroyPopup(),this.isPopupCreated=!1,this.disabled||this.unWireEvents()}},t.prototype.destroyPopup=function(){if(this.isPopupCreated){if(this.dropDown.destroy(),this.getPopUpElement()){var e=document.getElementById(this.getPopUpElement().id);e&&(O([e],["e-popup-open","e-popup-close"]),S(e))}b.remove(this.getPopUpElement(),"click",this.clickHandler),b.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler),this.isPopupCreated&&this.dropDown&&(this.dropDown.element=null,this.dropDown=void 0)}this.isPopupCreated=!1},t.prototype.getPopUpElement=function(){var e=null;if(!this.dropDown&&this.activeElem[0].classList.contains("e-split-btn")){var i=Ws(this.activeElem[1],"dropdown-btn");i&&(this.dropDown=i.dropDown)}return this.dropDown&&(e=this.dropDown.element),e},t.prototype.getULElement=function(){var e=null;return this.getPopUpElement()&&(e=this.getPopUpElement().children[0]),e},t.prototype.wireEvents=function(){this.delegateMousedownHandler=this.mousedownHandler.bind(this),this.createPopupOnClick||b.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),b.add(this.element,"click",this.clickHandler,this),b.add(this.element,"keydown",this.keyBoardHandler,this),b.add(window,"resize",this.windowResize,this)},t.prototype.windowResize=function(){!this.canOpen()&&this.dropDown&&this.dropDown.refreshPosition(this.element)},t.prototype.popupWireEvents=function(){this.delegateMousedownHandler||(this.delegateMousedownHandler=this.mousedownHandler.bind(this));var e=this.getPopUpElement();this.createPopupOnClick&&b.add(document,"mousedown touchstart",this.delegateMousedownHandler,this),e&&(b.add(e,"click",this.clickHandler,this),b.add(e,"keydown",this.keyBoardHandler,this),this.closeActionEvents&&b.add(e,this.closeActionEvents,this.focusoutHandler,this)),this.rippleFn=Qr(e,{selector:"."+$e.ITEM})},t.prototype.popupUnWireEvents=function(){var e=this.getPopUpElement();this.createPopupOnClick&&b.remove(document,"mousedown touchstart",this.delegateMousedownHandler),e&&e.parentElement&&(b.remove(e,"click",this.clickHandler),b.remove(e,"keydown",this.keyBoardHandler),this.closeActionEvents&&b.remove(e,this.closeActionEvents,this.focusoutHandler))},t.prototype.keyBoardHandler=function(e){if(!(e.target===this.element&&(e.keyCode===9||!e.altKey&&e.keyCode===40||e.keyCode===38)))switch(e.keyCode){case 38:case 40:e.altKey&&(e.keyCode===38||e.keyCode===40)?this.keyEventHandler(e):this.upDownKeyHandler(e);break;case 9:case 13:case 27:case 32:this.keyEventHandler(e);break}},t.prototype.upDownKeyHandler=function(e){this.target&&(e.keyCode===38||e.keyCode===40)||(e.preventDefault(),Ac(this.getULElement(),e.keyCode))},t.prototype.keyEventHandler=function(e){if(!(this.target&&(e.keyCode===13||e.keyCode===9))){if(e.keyCode===13&&this.activeElem[0].classList.contains("e-split-btn")){this.triggerSelect(e),this.activeElem[0].focus();return}e.target&&e.target.className.indexOf("e-edit-template")>-1&&e.keyCode===32||(e.keyCode!==9&&e.preventDefault(),e.keyCode===27||e.keyCode===38||e.keyCode===9?this.canOpen()||this.closePopup(e,this.element):this.clickHandler(e))}},t.prototype.getLI=function(e){return e.tagName==="LI"?e:T(e,"li")},t.prototype.mousedownHandler=function(e){var i=e.target;this.dropDown&&!this.canOpen()&&!(T(i,'[id="'+this.getPopUpElement().id+'"]')||T(i,'[id="'+this.element.id+'"]'))&&this.closePopup(e)},t.prototype.focusoutHandler=function(e){if(this.isPopupCreated&&!this.canOpen()){var i=e.relatedTarget;if(i&&i.className.indexOf("e-item")>-1){var n=this.getLI(i);if(n){var r=Array.prototype.indexOf.call(this.getULElement().children,n),s=this.items[r];if(s){var a={element:n,item:s,event:e};this.trigger("select",a)}}}this.closePopup(e)}},t.prototype.clickHandler=function(e){var i=e.target;if(T(i,'[id="'+this.element.id+'"]'))!this.createPopupOnClick||this.target&&this.target!==""&&!this.isColorPicker()&&!this.createPopupOnClick?this.getPopUpElement().classList.contains("e-popup-close")?this.openPopUp(e):this.closePopup(e):this.isPopupCreated?this.closePopup(e,this.activeElem[0]):(this.createPopup(),this.openPopUp(e));else if(T(i,'[id="'+this.getPopUpElement().id+'"]')){var n=this.getLI(e.target);n&&(this.triggerSelect(e),this.closePopup(e,this.activeElem[0]))}},t.prototype.triggerSelect=function(e){var i,n,r,s=this.getLI(e.target);s&&(n=Array.prototype.indexOf.call(this.getULElement().children,s),r=this.items[n],r&&(i={element:s,item:r,event:e},this.trigger("select",i)))},t.prototype.openPopUp=function(e){var i=this;e===void 0&&(e=null);var n=this.getPopUpElement();if(!this.target)this.createItems(!0);else if(this.activeElem.length>1){var r=Ws(this.activeElem[0],"split-btn");r.isReact&&n.childNodes.length<1&&(r.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates())}else this.isReact&&n.childNodes.length<1&&(this.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates());var s=this.getULElement();this.popupWireEvents();var a={element:s,items:this.items,event:e,cancel:!1};this.trigger("beforeOpen",a,function(l){if(!l.cancel){var c=i.getULElement();if(i.dropDown.show(null,i.element),x([i.element],"e-active"),i.element.setAttribute("aria-expanded","true"),i.element.setAttribute("aria-owns",i.getPopUpElement().id),c&&c.focus(),i.enableRtl&&c.parentElement.style.left!=="0px"){var p=void 0;i.element.parentElement&&i.element.parentElement.classList.contains("e-split-btn-wrapper")?p=i.element.parentElement.offsetWidth:p=i.element.offsetWidth;var d=c.parentElement.offsetWidth-p,u=parseFloat(c.parentElement.style.left)-d;u<0&&(u=0),c.parentElement.style.left=u+"px"}var f={element:c,items:i.items};i.trigger("open",f)}})},t.prototype.closePopup=function(e,i){var n=this;e===void 0&&(e=null);var r=this.getULElement(),s={element:r,items:this.items,event:e,cancel:!1};this.trigger("beforeClose",s,function(a){if(a.cancel)r&&r.focus();else{var l=n.getPopUpElement();l&&b.remove(l,"keydown",n.keyBoardHandler),n.popupUnWireEvents();var c=n.getULElement(),p=void 0;c&&(p=c.querySelector(".e-selected")),p&&p.classList.remove("e-selected"),n.dropDown.hide(),O(n.activeElem,"e-active"),n.element.setAttribute("aria-expanded","false"),n.element.removeAttribute("aria-owns"),i&&i.focus();var d={element:c,items:n.items};n.trigger("close",d),!n.target&&c&&S(c),(!n.target||n.isColorPicker()||n.target&&!n.isColorPicker())&&n.createPopupOnClick&&n.destroyPopup()}})},t.prototype.unWireEvents=function(){this.createPopupOnClick||b.remove(document,"mousedown touchstart",this.delegateMousedownHandler),b.remove(this.element,"click",this.clickHandler),b.remove(this.element,"keydown",this.keyBoardHandler),this.isPopupCreated&&(b.remove(this.getPopUpElement(),"click",this.clickHandler),b.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler)),b.remove(window,"resize",this.windowResize)},t.prototype.onPropertyChanged=function(e,i){var n=["content","cssClass","iconCss","iconPosition","disabled","enableRtl"];this.button.setProperties(Ai(e,n));var r;this.isPopupCreated&&(r=this.getPopUpElement(),this.dropDown.setProperties(Ai(e,["enableRtl"])));for(var s=0,a=Object.keys(e);s<a.length;s++){var l=a[s];switch(l){case"content":this.element.querySelector("span.e-caret")||this.appendArrowSpan();break;case"disabled":e.disabled?(this.unWireEvents(),this.isPopupCreated&&!this.canOpen()&&this.closePopup()):this.wireEvents();break;case"cssClass":if(e.cssClass.indexOf($e.VERTICAL)>-1||i.cssClass.indexOf($e.VERTICAL)>-1){this.element.querySelector("span.e-caret")||this.appendArrowSpan();var c=this.element.querySelector("span.e-caret");e.cssClass.indexOf($e.VERTICAL)>-1?An(c,["e-icon-bottom"],["e-icon-right"]):An(c,["e-icon-right"],["e-icon-bottom"])}this.isPopupCreated&&(i.cssClass&&O([r],i.cssClass.split(" ")),e.cssClass&&x([r],e.cssClass.replace(/\s+/g," ").trim().split(" ")));break;case"target":this.dropDown.content=this.getTargetElement(),this.dropDown.dataBind();break;case"items":this.isPopupCreated&&this.getULElement()&&this.createItems();break;case"createPopupOnClick":e.createPopupOnClick?this.destroyPopup():this.createPopup();break}}},t.prototype.focusIn=function(){this.element.focus()},ge([g("")],t.prototype,"content",void 0),ge([g("")],t.prototype,"cssClass",void 0),ge([g(!1)],t.prototype,"disabled",void 0),ge([g("")],t.prototype,"iconCss",void 0),ge([g("Left")],t.prototype,"iconPosition",void 0),ge([g(!1)],t.prototype,"enableHtmlSanitizer",void 0),ge([$n([],Ns)],t.prototype,"items",void 0),ge([g(!1)],t.prototype,"createPopupOnClick",void 0),ge([g("")],t.prototype,"target",void 0),ge([g("")],t.prototype,"closeActionEvents",void 0),ge([N()],t.prototype,"beforeItemRender",void 0),ge([N()],t.prototype,"beforeOpen",void 0),ge([N()],t.prototype,"beforeClose",void 0),ge([N()],t.prototype,"close",void 0),ge([N()],t.prototype,"open",void 0),ge([N()],t.prototype,"select",void 0),ge([N()],t.prototype,"created",void 0),t=ge([Ct],t),t}($t),Hc=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ye=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},Gi="e-rtl",Rr="EJS-SPLITBUTTON",Fc=function(o){Hc(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){var e=this.element;if(e.tagName===Rr){for(var i=jt("ej2_instances",e),n=this.createElement("button",{attrs:{type:"button"}}),r=this.createElement(Rr,{className:"e-"+this.getModuleName()+"-wrapper"}),s=0,a=e.attributes.length;s<a;s++)n.setAttribute(e.attributes[s].nodeName,e.attributes[s].nodeValue);e.parentNode.insertBefore(r,e),S(e),e=n,r.appendChild(e),Rn("ej2_instances",i,e),this.wrapper=r,this.element=e}this.element.id||(this.element.id=st("e-"+this.getModuleName()))},t.prototype.render=function(){this.initWrapper(),this.createPrimaryButton(),this.renderControl()},t.prototype.renderControl=function(){this.createSecondaryButton(),this.setActiveElem([this.element,this.secondaryBtnObj.element]),this.setAria(),this.wireEvents(),this.renderComplete()},t.prototype.addItems=function(e,i){o.prototype.addItems.call(this,e,i),this.secondaryBtnObj.items=this.items},t.prototype.removeItems=function(e,i){o.prototype.removeItems.call(this,e,i),this.secondaryBtnObj.items=this.items},t.prototype.initWrapper=function(){this.wrapper||(this.wrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.element.parentNode.insertBefore(this.wrapper,this.element)),this.element.classList.remove("e-"+this.getModuleName()),this.enableRtl&&this.wrapper.classList.add(Gi),this.cssClass&&x([this.wrapper],this.cssClass.replace(/\s+/g," ").trim().split(" "))},t.prototype.createPrimaryButton=function(){var e={cssClass:this.cssClass,enableRtl:this.enableRtl,iconCss:this.iconCss,iconPosition:this.iconPosition,content:this.content,disabled:this.disabled};this.primaryBtnObj=new zs(e),this.primaryBtnObj.createElement=this.createElement,this.primaryBtnObj.appendTo(this.element),this.element.classList.add("e-"+this.getModuleName()),this.element.type="button",this.wrapper.appendChild(this.element)},t.prototype.createSecondaryButton=function(){var e=this,i=this.createElement("button",{className:"e-icon-btn",attrs:{tabindex:"-1"},id:this.element.id+"_dropdownbtn"});this.wrapper.appendChild(i);var n={cssClass:this.cssClass,disabled:this.disabled,enableRtl:this.enableRtl,items:this.items,target:this.target,createPopupOnClick:this.createPopupOnClick};n.beforeItemRender=function(r){e.createPopupOnClick&&(e.secondaryBtnObj.dropDown.relateTo=e.wrapper,e.dropDown=e.secondaryBtnObj.dropDown),e.trigger("beforeItemRender",r)},n.open=function(r){e.trigger("open",r)},n.close=function(r){e.trigger("close",r)},n.select=function(r){e.trigger("select",r)},n.beforeOpen=function(r){e.createPopupOnClick&&e.items.length==0&&(e.secondaryBtnObj.dropDown.relateTo=e.wrapper,e.dropDown=e.secondaryBtnObj.dropDown);var s=new Qn;return e.trigger("beforeOpen",r,function(a){s.resolve(a)}),s},n.beforeClose=function(r){var s=new Qn;return e.trigger("beforeClose",r,function(a){s.resolve(a)}),s},this.secondaryBtnObj=new Ci(n),this.secondaryBtnObj.createElement=this.createElement,this.secondaryBtnObj.appendTo(i),this.createPopupOnClick||(this.secondaryBtnObj.dropDown.relateTo=this.wrapper,this.dropDown=this.secondaryBtnObj.dropDown),this.isPopupCreated=this.secondaryBtnObj.isPopupCreated,this.secondaryBtnObj.activeElem=[this.element,this.secondaryBtnObj.element],this.secondaryBtnObj.element.querySelector(".e-btn-icon").classList.remove("e-icon-right"),this.disabled&&this.wrapper.classList.add("e-splitbtn-disabled")},t.prototype.setAria=function(){ce(this.element,{"aria-expanded":"false","aria-haspopup":"true","aria-label":this.element.textContent?this.element.textContent+" splitbutton":"splitbutton","aria-owns":this.element.id+"_dropdownbtn-popup"})},t.prototype.getModuleName=function(){return"split-btn"},t.prototype.toggle=function(){this.secondaryBtnObj.toggle()},t.prototype.destroy=function(){var e=this,i=[Gi];if(this.cssClass&&(i=i.concat(this.cssClass.split(" "))),this.element){var n=document.getElementById(this.element.id);n&&n.parentElement===this.wrapper&&(this.wrapper.tagName===Rr?(this.wrapper.innerHTML="",O([this.wrapper],["e-rtl","e-"+this.getModuleName()+"-wrapper"]),O([this.wrapper],this.cssClass.split(" "))):(O([this.element],i),["aria-label","aria-haspopup","aria-expanded","aria-owns","type"].forEach(function(r){e.element.removeAttribute(r)}),this.wrapper.parentNode.insertBefore(this.element,this.wrapper),Ue(this.wrapper)),this.unWireEvents())}this.primaryBtnObj.destroy(),this.secondaryBtnObj.destroy(),o.prototype.destroy.call(this),this.element&&!this.element.getAttribute("class")&&this.element.removeAttribute("class"),this.refreshing&&this.isAngular&&(this.element=this.wrapper,["e-control","e-split-btn","e-lib"].forEach(function(r){e.element.classList.add(r)}),Rn("ej2_instances",[this],this.element)),this.wrapper=null},t.prototype.wireEvents=function(){b.add(this.element,"click",this.primaryBtnClickHandler,this),new Mn(this.element,{keyAction:this.btnKeyBoardHandler.bind(this),keyConfigs:{altdownarrow:"alt+downarrow",enter:"enter"}})},t.prototype.unWireEvents=function(){b.remove(this.element,"click",this.primaryBtnClickHandler),mt(this.element,Mn).destroy()},t.prototype.primaryBtnClickHandler=function(){this.trigger("click",{element:this.element})},t.prototype.btnKeyBoardHandler=function(e){switch(e.action){case"altdownarrow":this.clickHandler(e);break;case"enter":this.clickHandler(e),this.getPopUpElement()&&!this.getPopUpElement().classList.contains("e-popup-close")?(this.element.classList.remove("e-active"),this.secondaryBtnObj.element.classList.add("e-active")):this.secondaryBtnObj.element.classList.remove("e-active");break}},t.prototype.onPropertyChanged=function(e,i){var n=["content","iconCss","iconPosition","cssClass","disabled","enableRtl"];this.primaryBtnObj.setProperties(Ai(e,n)),n=["beforeOpen","beforeItemRender","select","open","close","cssClass","disabled","enableRtl","createPopupOnClick"],Object.keys(e).indexOf("items")>-1&&(this.secondaryBtnObj.items=e.items,this.secondaryBtnObj.dataBind()),this.secondaryBtnObj.setProperties(Ai(e,n));for(var r=0,s=Object.keys(e);r<s.length;r++){var a=s[r];switch(a){case"cssClass":i.cssClass&&O([this.wrapper],i.cssClass.split(" ")),x([this.wrapper],e.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":e.enableRtl?x([this.wrapper],Gi):O([this.wrapper],Gi);break;case"disabled":e.disabled?x([this.wrapper],"e-splitbtn-disabled"):O([this.wrapper],"e-splitbtn-disabled")}}},t.prototype.focusIn=function(){this.element.focus()},ye([g("")],t.prototype,"content",void 0),ye([g("")],t.prototype,"cssClass",void 0),ye([g(!1)],t.prototype,"disabled",void 0),ye([g("")],t.prototype,"iconCss",void 0),ye([g("Left")],t.prototype,"iconPosition",void 0),ye([g(!1)],t.prototype,"createPopupOnClick",void 0),ye([$n([],Ns)],t.prototype,"items",void 0),ye([g("")],t.prototype,"target",void 0),ye([N()],t.prototype,"beforeItemRender",void 0),ye([N()],t.prototype,"beforeOpen",void 0),ye([N()],t.prototype,"beforeClose",void 0),ye([N()],t.prototype,"click",void 0),ye([N()],t.prototype,"close",void 0),ye([N()],t.prototype,"open",void 0),ye([N()],t.prototype,"select",void 0),ye([N()],t.prototype,"created",void 0),t=ye([Ct],t),t}(Ci),Qn=function(){function o(){var t=this;this.promise=new Promise(function(e,i){t.resolve=e,t.reject=i}),this.catch=this.promise.catch.bind(this.promise),this.then=this.promise.then.bind(this.promise)}return o}(),zc=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),oe=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},oi="e-apply",Ki="e-cancel",Mr="e-current",qc="e-container",ai="e-ctrl-btn",Pt="e-switch-ctrl-btn",Ho="e-disabled",Fo="e-value-switch-btn",zo="e-handler",qo="e-hex",Ar="e-hide-hex-value",Pr="e-hide-opacity",It="e-hide-switchable-value",Lt="e-hide-value",Vo="e-hide-valueswitcher",li="e-hsv-color",Uo="e-hsv-container",Ht="e-selected-value",Xi="e-mode-switch-btn",Ir="e-nocolor-item",Hr="e-opacity-value",hi="e-palette",Yi="e-color-palette",Fr="e-color-picker",$i="e-preview-container",Ji="e-previous",Vc="e-rtl",Ft="e-show-value",ci="e-selected",Zi="e-split-preview",en="e-tile",Uc={default:["#000000","#f44336","#e91e63","#9c27b0","#673ab7","#2196f3","#03a9f4","#00bcd4","#009688","#ffeb3b","#ffffff","#ffebee","#fce4ec","#f3e5f5","#ede7f6","#e3f2fd","#e1f5fe","#e0f7fa","#e0f2f1","#fffde7","#f2f2f2","#ffcdd2","#f8bbd0","#e1bee7","#d1c4e9","#bbdefb","#b3e5fc","#b2ebf2","#b2dfdb","#fff9c4","#e6e6e6","#ef9a9a","#f48fb1","#ce93d8","#b39ddb","#90caf9","#81d4fa","#80deea","#80cbc4","#fff59d","#cccccc","#e57373","#f06292","#ba68c8","#9575cd","#64b5f6","#4fc3f7","#4dd0e1","#4db6ac","#fff176","#b3b3b3","#ef5350","#ec407a","#ab47bc","#7e57c2","#42a5f5","#29b6f6","#26c6da","#26a69a","#ffee58","#999999","#e53935","#d81b60","#8e24aa","#5e35b1","#1e88e5","#039be5","#00acc1","#00897b","#fdd835","#808080","#d32f2f","#c2185b","#7b1fa2","#512da8","#1976d2","#0288d1","#0097a7","#00796b","#fbc02d","#666666","#c62828","#ad1457","#6a1b9a","#4527a0","#1565c0","#0277bd","#00838f","#00695c","#f9a825","#4d4d4d","#b71c1c","#880e4f","#4a148c","#311b92","#0d47a1","#01579b","#006064","#004d40","#f57f17"]},jo=function(o){zc(t,o);function t(e,i){return o.call(this,e,i)||this}return t.prototype.preRender=function(){var e=this.element;this.formElement=T(this.element,"form"),this.formElement&&b.add(this.formElement,"reset",this.formResetHandler,this);var i={Apply:"Apply",Cancel:"Cancel",ModeSwitcher:"Switch Mode"};this.l10n=new Ii("colorpicker",i,this.locale),e.getAttribute("ejs-for")&&!e.getAttribute("name")&&e.setAttribute("name",e.id)},t.prototype.render=function(){this.initWrapper(),this.inline?this.createWidget():this.createSplitBtn(),this.enableOpacity||x([this.container.parentElement],Pr),this.renderComplete()},t.prototype.initWrapper=function(){var e=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"});this.element.parentNode.insertBefore(e,this.element),e.appendChild(this.element),ce(this.element,{tabindex:"-1",spellcheck:"false","aria-label":"colorpicker"}),this.container=this.createElement("div",{className:qc}),this.getWrapper().appendChild(this.container);var i=this.value?this.roundValue(this.value).toLowerCase():"#008000ff";this.noColor&&this.mode==="Palette"&&this.value===""&&(i="");var n=i.slice(0,7);h(this.initialInputValue)&&(this.initialInputValue=n),this.element.value=n,this.enableOpacity?this.setProperties({value:i},!0):this.setProperties({value:n},!0),this.enableRtl&&e.classList.add(Vc),this.cssClass&&x([e],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.tileRipple=Qr(this.container,{selector:"."+en}),this.ctrlBtnRipple=Qr(this.container,{selector:".e-btn"})},t.prototype.getWrapper=function(){return this.element.parentElement},t.prototype.createWidget=function(){this.mode==="Palette"?(this.createPalette(),this.inline||this.firstPaletteFocus()):(this.createPicker(),this.inline||this.getDragHandler().focus()),this.isRgb=!0,this.createInput(),this.createCtrlBtn(),this.disabled||this.wireEvents(),this.inline&&this.disabled&&this.toggleDisabled(!0),D.isDevice&&this.refreshPopupPos()},t.prototype.createSplitBtn=function(){var e=this,i=this.createElement("button",{className:"e-split-colorpicker"});this.getWrapper().appendChild(i),this.splitBtn=new Fc({iconCss:"e-selected-color",target:this.container,disabled:this.disabled,enableRtl:this.enableRtl,createPopupOnClick:this.createPopupOnClick,open:this.onOpen.bind(this),click:function(){e.trigger("change",{currentValue:{hex:e.value.slice(0,7),rgba:e.convertToRgbString(e.hexToRgb(e.value))},previousValue:{hex:null,rgba:null},value:e.value})}}),this.splitBtn.createElement=this.createElement,this.splitBtn.appendTo(i);var n=this.createElement("span",{className:Zi});A(".e-selected-color",i).appendChild(n),n.style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value));var r=this.getPopupEle();if(x([r],"e-colorpicker-popup"),this.cssClass&&x([r],this.cssClass.replace(/\s+/g," ").trim().split(" ")),D.isDevice&&!this.createPopupOnClick){var s=this.getPopupInst();s.relateTo=document.body,s.position={X:"center",Y:"center"},s.targetType="container",s.collision={X:"fit",Y:"fit"},s.offsetY=4,r.style.zIndex=cn(this.splitBtn.element).toString()}this.bindCallBackEvent()},t.prototype.onOpen=function(){if(this.trigger("open",{element:this.container}),!D.isDevice){var e=this.getPopupInst(),i=Kr(e.element);i.length>0&&(e.collision={X:"flip",Y:"fit"},e.position={X:"right",Y:"bottom"},e.targetType="container")}},t.prototype.getPopupInst=function(){return mt(this.getPopupEle(),Hi)},t.prototype.bindCallBackEvent=function(){var e=this;this.splitBtn.beforeOpen=function(i){var n=new Qn;return e.trigger("beforeOpen",i,function(r){if(!r.cancel){var s=e.getPopupEle();if(s.style.top=H(0+pageYOffset),s.style.left=H(0+pageXOffset),s.style.display="block",e.createWidget(),s.style.display="",D.isDevice){if(e.createPopupOnClick){var a=e.getPopupInst();a.relateTo=document.body,a.position={X:"center",Y:"center"},a.targetType="container",a.collision={X:"fit",Y:"fit"},a.offsetY=4,s.style.zIndex=cn(e.splitBtn.element).toString()}e.modal=e.createElement("div"),e.modal.className="e-"+e.getModuleName()+" e-modal",e.modal.style.display="none",document.body.insertBefore(e.modal,s),document.body.className+=" e-colorpicker-overflow",e.modal.style.display="block",e.modal.style.zIndex=(Number(s.style.zIndex)-1).toString()}}i.cancel=r.cancel,n.resolve(r)}),n},this.splitBtn.beforeClose=function(i){var n=new Qn;if(h(i.event))n.resolve(i);else{var r={element:e.container,event:i.event,cancel:!1};e.trigger("beforeClose",r,function(s){D.isDevice&&i.event.target===e.modal&&(s.cancel=!0),s.cancel||e.onPopupClose(),i.cancel=s.cancel,n.resolve(s)})}return n}},t.prototype.onPopupClose=function(){this.unWireEvents(),this.destroyOtherComp(),this.container.style.width="",A("."+Zi,this.splitBtn.element).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value)),this.container.innerHTML="",O([this.container],[Fr,Yi]),D.isDevice&&this.modal&&(O([document.body],"e-colorpicker-overflow"),this.modal.style.display="none",this.modal.outerHTML="",this.modal=null)},t.prototype.createPalette=function(){if(An(this.container,[Yi],[Fr]),this.presetColors){var e=this.createElement("div",{className:"e-custom-palette"});this.appendElement(e);var i=Object.keys(this.presetColors);if(i.length===1)this.appendPalette(this.presetColors[i[0]],i[0],e);else for(var n=0,r=i.length;n<r;n++)this.appendPalette(this.presetColors[i[n]],i[n],e);Te(".e-row",e).length>10&&x([e],"e-palette-group")}else this.appendPalette(Uc.default,"default");this.mode==="Palette"&&!this.modeSwitcher&&this.noColor&&this.setNoColor();var s=parseInt(getComputedStyle(this.container).borderBottomWidth,10);this.container.style.width=H(this.container.children[0].offsetWidth+s+s),this.rgb=this.hexToRgb(this.roundValue(this.value)),this.hsv=this.rgbToHsv.apply(this,this.rgb)},t.prototype.firstPaletteFocus=function(){A("."+ci,this.container.children[0])||Te("."+hi,this.container)[0].focus()},t.prototype.appendPalette=function(e,i,n){var r=this.createElement("div",{className:hi,attrs:{tabindex:"0",role:"grid"}});n?n.appendChild(r):this.appendElement(r);for(var s,a,l,c=0,p=e.length;c<p;c++)(c===0||c%this.columns===0)&&(s=this.createElement("div",{className:"e-row",attrs:{role:"row"}}),r.appendChild(s)),l=this.roundValue(e[c]).toLowerCase(),a=this.createElement("span",{className:en,attrs:{role:"gridcell","aria-label":l,"aria-selected":"false",tabindex:"0"}}),this.trigger("beforeTileRender",{element:a,presetName:i,value:e[c]}),s.appendChild(a),this.value===l&&(this.addTileSelection(a),r.focus()),a.style.backgroundColor=this.convertToRgbString(this.hexToRgb(l))},t.prototype.setNoColor=function(){var e=this.container.querySelector(".e-row").children[0];e.classList.add(Ir),this.value||(e.classList.add(ci),T(e,"."+hi).focus()),["aria-selected","aria-label"].forEach(function(i){e.removeAttribute(i)}),e.style.backgroundColor=""},t.prototype.appendElement=function(e,i){i===void 0&&(i=0);var n=this.container.children[i];n?this.container.insertBefore(e,n):this.container.appendChild(e)},t.prototype.addTileSelection=function(e){e.classList.add(ci),e.setAttribute("aria-selected","true")},t.prototype.createPicker=function(){An(this.container,[Fr],[Yi]);var e=this.createElement("div",{className:Uo});this.appendElement(e),e.appendChild(this.createElement("div",{className:li}));var i=this.createElement("span",{className:zo,attrs:{tabindex:"0"}});e.appendChild(i),(this.value===null||this.value==="")&&(this.value="#008000ff"),this.rgb=this.hexToRgb(this.value),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHsvContainerBg(),this.setHandlerPosition(),this.createSlider(),this.createDragTooltip()},t.prototype.setHsvContainerBg=function(e){e===void 0&&(e=this.hsv[0]),this.getHsvContainer().style.backgroundColor=this.convertToRgbString(this.hsvToRgb(e,100,100,1))},t.prototype.getHsvContainer=function(){return A("."+Uo,this.container)},t.prototype.setHandlerPosition=function(){var e=this.getDragHandler(),i=A("."+li,this.container);this.enableRtl?e.style.left=H(i.offsetWidth*Math.abs(100-this.hsv[1])/100):e.style.left=H(i.offsetWidth*this.hsv[1]/100),e.style.top=H(i.offsetHeight*(100-this.hsv[2])/100)},t.prototype.createSlider=function(){var e=this.createElement("div",{className:"e-slider-preview"});this.appendElement(e,1),this.createPreview(e);var i=this.createElement("div",{className:"e-colorpicker-slider"});e.insertBefore(i,e.children[0]);var n=this.createElement("div",{className:"e-hue-slider"});i.appendChild(n),this.hueSlider=new Lo({value:this.hsv[0],min:0,max:359,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.hueChange.bind(this)}),this.hueSlider.createElement=this.createElement,this.hueSlider.appendTo(n),this.enableOpacity&&(n=this.createElement("div",{className:"e-opacity-slider"}),i.appendChild(n),this.createOpacitySlider(n))},t.prototype.createOpacitySlider=function(e){this.opacitySlider=new Lo({value:this.rgb[3]*100,min:0,max:100,enableRtl:this.enableRtl,enabled:!this.disabled,change:this.opacityChange.bind(this)}),this.opacitySlider.createElement=this.createElement,this.opacitySlider.appendTo(e);var i=this.createElement("div",{className:"e-opacity-empty-track"});e.appendChild(i),this.updateOpacitySliderBg()},t.prototype.updateOpacitySliderBg=function(){var e=this.enableRtl?"to left":"to right",i=A(".e-opacity-empty-track",this.opacitySlider.element);i&&(i.style.background="linear-gradient("+e+", rgba("+this.rgb.slice(0,3)+", 0) 0%, "+this.convertToRgbString(this.rgb.slice(0,3))+" 100%)")},t.prototype.hueChange=function(e){this.hsv[0]=e.value,this.setHsvContainerBg(),this.convertToOtherFormat()},t.prototype.opacityChange=function(e){var i=e.value,n=this.rgbToHex(this.rgb);this.hsv[3]=i/100,this.rgb[3]=i/100;var r=this.rgbToHex(this.rgb);this.updateOpacityInput(i);var s=this.convertToRgbString(this.rgb);this.updatePreview(s),this.triggerEvent(r,n,s)},t.prototype.updateOpacityInput=function(e){if(this.enableOpacity&&!this.getWrapper().classList.contains(Lt)){var i=mt(A("."+Hr,this.container),Vi);i.value=e,i.dataBind()}},t.prototype.createPreview=function(e){var i=this.createElement("div",{className:$i});e.appendChild(i);var n=this.createElement("span",{className:"e-preview "+Mr});i.appendChild(n);var r=this.convertToRgbString(this.rgb);n.style.backgroundColor=r,n=this.createElement("span",{className:"e-preview "+Ji}),i.appendChild(n),n.style.backgroundColor=r},t.prototype.isPicker=function(){return!this.container.classList.contains(Yi)},t.prototype.getPopupEle=function(){return this.container.parentElement},t.prototype.createNumericInput=function(e,i,n,r){var s=this,a=new Vi({value:i,placeholder:n,min:0,max:r,format:"###.##",showSpinButton:!1,floatLabelType:"Always",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker(),change:function(l){l.event&&s.inputHandler(l.event)}});a.createElement=this.createElement,a.appendTo(e)},t.prototype.createInput=function(){var e=this.isPicker(),i=this.getWrapper();if(e&&!i.classList.contains(Lt)||!e&&i.classList.contains(Ft)){var n=this.createElement("div",{className:Ht});e?this.appendElement(n,2):this.appendElement(n,1);var r=this.createElement("div",{className:"e-input-container"});if(n.appendChild(r),i.classList.contains(Vo)||this.appendValueSwitchBtn(n),!i.classList.contains(Ar)){var s=this.createElement("input",{className:qo,attrs:{maxlength:"7",spellcheck:"false","aria-label":"HEX"}});r.appendChild(s),J.createInput({element:s,floatLabelType:"Always",properties:{placeholder:"HEX",enableRtl:this.enableRtl,enabled:!this.disabled,readonly:!this.isPicker()}},this.createElement),J.setValue(this.value.slice(0,7),s),s.addEventListener("input",this.inputHandler.bind(this))}if(!i.classList.contains(It)){var a=void 0,l=void 0;this.isRgb?(a="RGB",l=this.rgb):(a="HSV",l=this.hsv);for(var c=["rh","gs","bv"],p=0;p<3;p++)this.createNumericInput(r.appendChild(this.createElement("input",{className:"e-"+c[p]+"-value"})),l[p],a[p],255);this.enableOpacity&&this.appendOpacityValue(r)}}},t.prototype.appendOpacityValue=function(e){this.createNumericInput(e.appendChild(this.createElement("input",{className:Hr})),this.rgb[3]*100,"A",100)},t.prototype.appendValueSwitchBtn=function(e){var i=this.createElement("button",{className:"e-icons e-css e-btn e-flat e-icon-btn "+Fo,attrs:{title:"Toggle format"}});e.appendChild(i),this.isPicker()&&!this.getWrapper().classList.contains(It)&&i.addEventListener("click",this.formatSwitchHandler.bind(this))},t.prototype.createCtrlBtn=function(){if(this.modeSwitcher||this.showButtons){this.l10n.setLocale(this.locale);var e=this.createElement("div",{className:Pt});if(this.container.appendChild(e),this.showButtons){var i=this.createElement("div",{className:ai});e.appendChild(i);var n=this.l10n.getConstant("Apply");i.appendChild(this.createElement("button",{innerHTML:n,className:"e-btn e-css e-flat e-primary e-small "+oi,attrs:{title:n}}));var r=this.l10n.getConstant("Cancel");i.appendChild(this.createElement("button",{innerHTML:r,className:"e-btn e-css e-flat e-small "+Ki,attrs:{title:r}}))}this.modeSwitcher&&this.appendModeSwitchBtn()}},t.prototype.appendModeSwitchBtn=function(){var e=this.createElement("button",{className:"e-icons e-btn e-flat e-icon-btn "+Xi,attrs:{title:this.l10n.getConstant("ModeSwitcher")}});A("."+Pt,this.container).insertBefore(e,A("."+ai,this.container))},t.prototype.createDragTooltip=function(){var e=this,i=new Qt({opensOn:"Custom",showTipPointer:!1,cssClass:"e-color-picker-tooltip",htmlAttributes:{title:"tooltip"},beforeOpen:function(n){e.tooltipEle=n.element},animation:{open:{effect:"None"},close:{effect:"None"}}});i.createElement=this.createElement,i.appendTo(this.container),i.open(this.container),this.tooltipEle.style.zIndex=cn(this.tooltipEle).toString(),this.tooltipEle.setAttribute("aria-label","colorpicker-tooltip"),A(".e-tip-content",this.tooltipEle).appendChild(this.createElement("div",{className:"e-tip-transparent"}))},t.prototype.getTooltipInst=function(){return mt(this.container,Qt)},t.prototype.setTooltipOffset=function(e){this.getTooltipInst().offsetY=e},t.prototype.toggleDisabled=function(e){e?this.getWrapper().classList.add(Ho):this.getWrapper().classList.remove(Ho),this.showButtons&&[].slice.call(Te(".e-btn",this.container)).forEach(function(i){e?ce(i,{disabled:""}):i.removeAttribute("disabled")})},t.prototype.convertToRgbString=function(e){return e.length?e.length===4?"rgba("+e.join()+")":"rgb("+e.join()+")":""},t.prototype.convertToHsvString=function(e){return e.length===4?"hsva("+e.join()+")":"hsv("+e.join()+")"},t.prototype.updateHsv=function(){this.hsv[1]=this.hsv[1]>100?100:this.hsv[1],this.hsv[2]=this.hsv[2]>100?100:this.hsv[2],this.setHandlerPosition()},t.prototype.convertToOtherFormat=function(e){e===void 0&&(e=!1);var i=this.rgbToHex(this.rgb);this.rgb=this.hsvToRgb.apply(this,this.hsv);var n=this.rgbToHex(this.rgb),r=this.convertToRgbString(this.rgb);this.updatePreview(r),this.updateInput(n),this.triggerEvent(n,i,r,e)},t.prototype.updateInput=function(e){var i=this.getWrapper();i.classList.contains(Lt)||(i.classList.contains(Ar)||J.setValue(e.substr(0,7),A("."+qo,this.container)),i.classList.contains(It)||(this.isRgb?this.updateValue(this.rgb,!1):this.updateValue(this.hsv,!1)))},t.prototype.updatePreview=function(e){this.enableOpacity&&this.updateOpacitySliderBg(),A(".e-tip-transparent",this.tooltipEle).style.backgroundColor=e,A("."+$i+" ."+Mr,this.container).style.backgroundColor=e,A("."+$i+" ."+Ji,this.container).style.backgroundColor=this.convertToRgbString(this.hexToRgb(this.value))},t.prototype.getDragHandler=function(){return A("."+zo,this.container)},t.prototype.removeTileSelection=function(){var e=[].slice.call(Te("."+ci,this.container.children[0]));e.forEach(function(i){i.classList.remove(ci),i.setAttribute("aria-selected","false")})},t.prototype.convertRgbToNumberArray=function(e){return e.slice(e.indexOf("(")+1,e.indexOf(")")).split(",").map(function(i,n){return n!==3?parseInt(i,10):parseFloat(i)})},t.prototype.getValue=function(e,i){if(e||(e=this.value),i=i?i.toLowerCase():"hex",e[0]==="r"){var n=this.convertRgbToNumberArray(e);if(i==="hex"||i==="hexa"){var r=this.rgbToHex(n);return i==="hex"?r.slice(0,7):r}else return i==="hsv"?this.convertToHsvString(this.rgbToHsv.apply(this,n.slice(0,3))):i==="hsva"?this.convertToHsvString(this.rgbToHsv.apply(this,n)):"null"}else if(e[0]==="h"){var n=this.hsvToRgb.apply(this,this.convertRgbToNumberArray(e));if(i==="rgba")return this.convertToRgbString(n);if(i==="hex"||i==="hexa"){var r=this.rgbToHex(n);return i==="hex"?r.slice(0,7):r}else return i==="rgb"?this.convertToRgbString(n.slice(0,3)):"null"}else{e=this.roundValue(e);var s=this.hexToRgb(e);return(i==="rgb"||i==="hsv")&&(s=s.slice(0,3)),i==="rgba"||i==="rgb"?this.convertToRgbString(s):i==="hsva"||i==="hsv"?this.convertToHsvString(this.rgbToHsv.apply(this,s)):i==="hex"?e.slice(0,7):i==="a"?s[3].toString():"null"}},t.prototype.toggle=function(){this.container.parentElement.classList.contains("e-popup-close")?this.splitBtn.toggle():this.closePopup(null)},t.prototype.getModuleName=function(){return"colorpicker"},t.prototype.getPersistData=function(){return this.addOnPersist(["value"])},t.prototype.wireEvents=function(){if(this.isPicker()){var e=this.getDragHandler();b.add(e,"keydown",this.pickerKeyDown,this);var i=A("."+ai,this.container);i&&b.add(i,"keydown",this.ctrlBtnKeyDown,this),b.add(this.getHsvContainer(),"mousedown touchstart",this.handlerDown,this),(this.modeSwitcher||this.showButtons)&&this.addCtrlSwitchEvent(),b.add(A("."+Ji,this.container),"click",this.previewHandler,this)}else b.add(this.container,"click",this.paletteClickHandler,this),b.add(this.container,"keydown",this.paletteKeyDown,this)},t.prototype.formResetHandler=function(){this.value=this.initialInputValue,ce(this.element,{value:this.initialInputValue})},t.prototype.addCtrlSwitchEvent=function(){var e=A("."+Pt,this.container);e&&b.add(e,"click",this.btnClickHandler,this)},t.prototype.ctrlBtnKeyDown=function(e){if(e.keyCode===13){var i=A("."+oi,this.container);if(i){var n=this.rgbToHex(this.rgb);this.triggerChangeEvent(n)}this.splitBtn.element.focus()}},t.prototype.pickerKeyDown=function(e){switch(e.keyCode){case 39:this.handlerDragPosition(1,this.enableRtl?-1:1,e);break;case 37:this.handlerDragPosition(1,this.enableRtl?1:-1,e);break;case 38:this.handlerDragPosition(2,1,e);break;case 40:this.handlerDragPosition(2,-1,e);break;case 13:{e.preventDefault();var i=this.rgbToHex(this.rgb);this.enterKeyHandler(i,e)}}},t.prototype.enterKeyHandler=function(e,i){this.triggerChangeEvent(e),this.inline||this.splitBtn.element.focus()},t.prototype.closePopup=function(e){var i=this,n={element:this.container,event:e,cancel:!1};this.trigger("beforeClose",n,function(r){r.cancel||(i.splitBtn.toggle(),i.onPopupClose())})},t.prototype.triggerChangeEvent=function(e){var i=e.slice(0,7);this.trigger("change",{currentValue:{hex:i,rgba:this.convertToRgbString(this.rgb)},previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},value:this.enableOpacity?e:i}),this.enableOpacity?this.setProperties({value:e},!0):this.setProperties({value:i},!0),this.element.value=i||"#000000"},t.prototype.handlerDragPosition=function(e,i,n){n.preventDefault(),this.hsv[e]+=i*(n.ctrlKey?1:3),this.hsv[e]<0&&(this.hsv[e]=0),this.updateHsv(),this.convertToOtherFormat(!0)},t.prototype.handlerDown=function(e){e.preventDefault(),e.type==="mousedown"?(this.clientX=Math.abs(e.pageX-pageXOffset),this.clientY=Math.abs(e.pageY-pageYOffset),this.setTooltipOffset(8)):(this.clientX=Math.abs(e.changedTouches[0].pageX-pageXOffset),this.clientY=Math.abs(e.changedTouches[0].pageY-pageYOffset),this.setTooltipOffset(-8)),this.setHsv(this.clientX,this.clientY),this.getDragHandler().style.transition="left .4s cubic-bezier(.25, .8, .25, 1), top .4s cubic-bezier(.25, .8, .25, 1)",this.updateHsv(),this.convertToOtherFormat(),this.getDragHandler().focus(),b.add(document,"mousemove touchmove",this.handlerMove,this),b.add(document,"mouseup touchend",this.handlerEnd,this)},t.prototype.handlerMove=function(e){e.type!=="touchmove"&&e.preventDefault();var i,n;e.type==="mousemove"?(i=Math.abs(e.pageX-pageXOffset),n=Math.abs(e.pageY-pageYOffset)):(i=Math.abs(e.changedTouches[0].pageX-pageXOffset),n=Math.abs(e.changedTouches[0].pageY-pageYOffset)),this.setHsv(i,n);var r=this.getDragHandler();this.updateHsv(),this.convertToOtherFormat(),this.getTooltipInst().refresh(r),this.tooltipEle.style.transform||(Math.abs(this.clientX-i)>8||Math.abs(this.clientY-n)>8)&&(A("."+li,this.container).style.cursor="pointer",r.style.transition="none",this.inline||(this.tooltipEle.style.zIndex=(parseInt(this.getPopupEle().style.zIndex,10)+1).toString()),this.tooltipEle.style.transform="rotate(45deg)",r.classList.add("e-hide-handler"))},t.prototype.setHsv=function(e,i){var n=A("."+li,this.container),r=n.getBoundingClientRect();this.enableRtl?e=e>r.right?0:Math.abs(e-r.right):e=e>r.left?Math.abs(e-r.left):0,i=i>r.top?Math.abs(i-r.top):0,this.hsv[2]=Math.round(Number(100*(n.offsetHeight-Math.max(0,Math.min(n.offsetHeight,i-n.offsetTop)))/n.offsetHeight)*10)/10,this.hsv[1]=Math.round(Number(100*Math.max(0,Math.min(n.offsetWidth,e-n.offsetLeft))/n.offsetWidth)*10)/10},t.prototype.handlerEnd=function(e){e.type!=="touchend"&&e.preventDefault(),b.remove(document,"mousemove touchmove",this.handlerMove),b.remove(document,"mouseup touchend",this.handlerEnd);var i=this.getDragHandler();A("."+li,this.container).style.cursor="",this.tooltipEle.style.transform&&(this.tooltipEle.style.transform="",i.classList.remove("e-hide-handler")),!this.inline&&!this.showButtons&&this.closePopup(e)},t.prototype.btnClickHandler=function(e){var i=e.target;T(i,"."+Xi)?(e.stopPropagation(),this.switchToPalette()):(i.classList.contains(oi)||i.classList.contains(Ki))&&this.ctrlBtnClick(i,e)},t.prototype.switchToPalette=function(){this.trigger("beforeModeSwitch",{element:this.container,mode:"Palette"}),this.unWireEvents(),this.destroyOtherComp(),S(A(".e-slider-preview",this.container)),this.getWrapper().classList.contains(Lt)||Ue(A("."+Ht,this.container)),S(this.getHsvContainer()),this.createPalette(),this.firstPaletteFocus(),this.createInput(),this.refreshPopupPos(),this.element.parentElement&&this.element.parentElement.parentElement&&this.element.parentElement.parentElement.classList.contains("e-ie-ddb-popup")&&this.refreshImageEditorPopupPos(),this.wireEvents(),this.trigger("onModeSwitch",{element:this.container,mode:"Palette"})},t.prototype.refreshImageEditorPopupPos=function(){if(D.isDevice){var e=this.getPopupEle();e.style.left=H(0+pageXOffset),e.style.top=H(0+pageYOffset);var i=document.querySelector("#"+this.element.parentElement.parentElement.id.split("-popup")[0]);i&&e.parentElement.ej2_instances[0].refreshPosition(i)}},t.prototype.refreshPopupPos=function(){if(!this.inline){var e=this.getPopupEle();e.style.left=H(0+pageXOffset),e.style.top=H(0+pageYOffset),this.getPopupInst().refreshPosition(this.splitBtn.element.parentElement)}},t.prototype.formatSwitchHandler=function(){this.isRgb?(this.updateValue(this.hsv,!0,3,[360,100,100]),this.isRgb=!1):(this.updateValue(this.rgb,!0,2),this.isRgb=!0)},t.prototype.updateValue=function(e,i,n,r){for(var s=["e-rh-value","e-gs-value","e-bv-value"],a,l=0,c=s.length;l<c;l++)a=mt(A("."+s[l],this.container),Vi),a.value=Math.round(e[l]),i&&(a.placeholder=s[l].substr(n,1).toUpperCase(),a.max=r?r[l]:255),a.dataBind()},t.prototype.previewHandler=function(e){var i=e.target,n=this.rgbToHex(this.rgb);this.rgb=this.convertRgbToNumberArray(i.style.backgroundColor),this.rgb[3]||(this.rgb[3]=1);var r=this.rgbToHex(this.rgb),s=this.rgbToHsv.apply(this,this.rgb);s[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:s[0]},!0),this.hueSlider.refresh()),this.setHsvContainerBg(s[0]),this.enableOpacity&&s[3]!==this.hsv[3]&&(this.opacitySlider.setProperties({value:s[3]*100},!0),this.opacitySlider.refresh(),this.updateOpacitySliderBg()),this.hsv=s,this.setHandlerPosition(),this.updateInput(r),A("."+$i+" ."+Mr,this.container).style.backgroundColor=this.convertToRgbString(this.rgb),this.triggerEvent(r,n,this.convertToRgbString(this.rgb))},t.prototype.paletteClickHandler=function(e){e.preventDefault();var i=e.target;if(i.classList.contains(en)){if(this.removeTileSelection(),this.addTileSelection(i),i.classList.contains(Ir))this.noColorTile();else{var n=i.getAttribute("aria-label"),r=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(this.roundValue(n)),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains(Ft)&&this.updateInput(n),this.triggerEvent(n,r,this.convertToRgbString(this.rgb))}!this.inline&&!this.showButtons&&this.closePopup(e)}else T(i,"."+Xi)?this.switchToPicker():i.classList.contains(oi)||i.classList.contains(Ki)?this.ctrlBtnClick(i,e):this.getWrapper().classList.contains(Ft)&&T(i,"."+Fo)&&this.formatSwitchHandler()},t.prototype.noColorTile=function(e){e===void 0&&(e=!1);var i=this.rgbToHex(this.rgb);this.rgb=[],this.hsv=[],this.triggerEvent("",i,"",e)},t.prototype.switchToPicker=function(){var e=this.getWrapper();this.trigger("beforeModeSwitch",{element:this.container,mode:"Picker"}),this.unWireEvents(),[].slice.call(Te("."+hi,this.container)).forEach(function(n){S(n)}),e.classList.contains(Ft)&&S(A("."+Ht,this.container)),this.container.style.width="";var i=A(".e-custom-palette",this.container);this.presetColors&&Ue(i),this.createPicker(),this.getDragHandler().focus(),this.createInput(),this.refreshPopupPos(),this.element.parentElement&&this.element.parentElement.parentElement&&this.element.parentElement.parentElement.classList.contains("e-ie-ddb-popup")&&this.refreshImageEditorPopupPos(),this.wireEvents(),this.trigger("onModeSwitch",{element:this.container,mode:"Picker"})},t.prototype.ctrlBtnClick=function(e,i){if(e.classList.contains(oi)){var n=this.rgbToHex(this.rgb);this.triggerChangeEvent(n)}if(!this.inline)this.closePopup(i),this.splitBtn.element.focus();else if(e.classList.contains(Ki)){var r={element:this.container,event:i,cancel:!1};this.trigger("beforeClose",r)}},t.prototype.paletteKeyDown=function(e){var i=e.target;if(i.classList.contains(hi)){var n,r,s=[].slice.call(Te("."+en,i)),a=s.filter(function(c){return c.classList.contains("e-selected")}).pop();switch(!e.altKey&&e.keyCode){case 39:e.preventDefault(),n=a?s[this.tilePosition(s,a,this.enableRtl?-1:1)]:s[this.enableRtl?s.length-1:0],this.keySelectionChanges(n);break;case 37:e.preventDefault(),n=a?s[this.tilePosition(s,a,this.enableRtl?1:-1)]:s[this.enableRtl?0:s.length-1],this.keySelectionChanges(n);break;case 38:e.preventDefault(),r=a?this.tilePosition(s,a,-this.columns):0,n=s[r]?s[r]:s[r-this.columns],this.keySelectionChanges(n);break;case 40:e.preventDefault(),r=a?this.tilePosition(s,a,this.columns):s.length-1,s[r]||(r%=s.length,r+=s[s.length-1].parentElement.childElementCount),n=s[r],this.keySelectionChanges(n);break;case 13:if(e.preventDefault(),a){var l=a.getAttribute("aria-label");this.enterKeyHandler(l||"",e)}}}},t.prototype.keySelectionChanges=function(e){if(this.removeTileSelection(),this.addTileSelection(e),e.classList.contains(Ir))this.noColorTile(!0);else{var i=e.getAttribute("aria-label"),n=this.rgbToHex(this.rgb);this.rgb=this.hexToRgb(i),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.getWrapper().classList.contains(Ft)&&this.updateInput(i),this.triggerEvent(i,n,this.convertToRgbString(this.rgb),!0)}},t.prototype.tilePosition=function(e,i,n){e=Array.prototype.slice.call(e);var r=e.length,s=this.columns-e[r-1].parentElement.childElementCount,a=e.indexOf(i);return a+=n,a<0?a+=r+s:a%=r+s,a},t.prototype.inputHandler=function(e){var i=e.target;if(i.value.length){var n,r,s=A(".e-float-text",i.parentElement).textContent;switch(s){case"HEX":{var a="";if((i.value[0]==="#"&&i.value.length!==5||i.value[0]!=="#"&&i.value.length!==4)&&(a=this.roundValue(i.value)),a.length===9)r=this.rgbToHex(this.rgb),this.rgb=this.hexToRgb(a+a.substr(-2)),this.inputValueChange(this.rgbToHsv.apply(this,this.rgb),r,i.value);else return;break}case"R":this.rgb[0]!==Number(i.value)&&(r=this.rgbToHex(this.rgb),this.rgb[0]=Number(i.value),n=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(n,r));break;case"G":this.rgb[1]!==Number(i.value)&&(r=this.rgbToHex(this.rgb),this.rgb[1]=Number(i.value),n=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(n,r));break;case"B":this.rgb[2]!==Number(i.value)&&(r=this.rgbToHex(this.rgb),this.rgb[2]=Number(i.value),n=this.rgbToHsv.apply(this,this.rgb),this.inputValueChange(n,r));break;case"H":this.hueSlider.value=Number(i.value);break;case"S":this.hsv[1]!==Number(i.value)&&(this.hsv[1]=Number(i.value),this.updateHsv(),this.convertToOtherFormat());break;case"V":this.hsv[2]!==Number(i.value)&&(this.hsv[2]=Number(i.value),this.updateHsv(),this.convertToOtherFormat());break;case"A":this.opacitySlider.value=Number(i.value);break}}},t.prototype.inputValueChange=function(e,i,n){e[0]!==this.hsv[0]&&(this.hueSlider.setProperties({value:e[0]},!0),this.hueSlider.refresh(),this.setHsvContainerBg(e[0])),this.hsv=e;var r=this.rgbToHex(this.rgb);this.setHandlerPosition(),this.updateInput(n||r);var s=this.convertToRgbString(this.rgb);this.updatePreview(s),this.triggerEvent(r,i,s)},t.prototype.triggerEvent=function(e,i,n,r){r===void 0&&(r=!1);var s=e.slice(0,7);!this.showButtons&&!r?(this.trigger("change",{currentValue:{hex:s,rgba:n},previousValue:{hex:this.value.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(this.value))},value:e}),this.enableOpacity?this.setProperties({value:e},!0):this.setProperties({value:s},!0),this.element.value=s||"#000000"):this.trigger("select",{currentValue:{hex:s,rgba:n},previousValue:{hex:i.slice(0,7),rgba:this.convertToRgbString(this.hexToRgb(i))}})},t.prototype.destroy=function(){var e=this,i=this.getWrapper();o.prototype.destroy.call(this),["tabindex","spellcheck"].forEach(function(n){e.element.removeAttribute(n)}),this.inline?(this.unWireEvents(),this.destroyOtherComp()):(this.isPopupOpen()&&(this.unWireEvents(),this.destroyOtherComp()),this.splitBtn.destroy(),this.splitBtn=null),this.tileRipple(),this.tileRipple=null,this.ctrlBtnRipple(),this.ctrlBtnRipple=null,this.element.nextElementSibling&&S(this.element.nextElementSibling),i&&(i.parentElement.insertBefore(this.element,i),S(i)),this.container=null,this.formElement&&b.remove(this.formElement,"reset",this.formResetHandler)},t.prototype.destroyOtherComp=function(){if(this.isPicker()){for(var e=T(this.hueSlider.element,".e-color-picker"),i=e.querySelectorAll(".e-numerictextbox"),n=0;n<i.length;n++)mt(i[n],Vi).destroy();this.hueSlider.destroy(),this.enableOpacity&&(this.opacitySlider.destroy(),this.opacitySlider=null),this.hueSlider=null;var r=this.getTooltipInst();r.close(),r.destroy(),this.tooltipEle=null}},t.prototype.isPopupOpen=function(){return this.getPopupEle().classList.contains("e-popup-open")},t.prototype.unWireEvents=function(){if(this.isPicker()){var e=this.getDragHandler();b.remove(e,"keydown",this.pickerKeyDown);var i=A("."+ai,this.container);i&&b.remove(i,"keydown",this.ctrlBtnKeyDown),b.remove(this.getHsvContainer(),"mousedown touchstart",this.handlerDown),(this.modeSwitcher||this.showButtons)&&b.remove(A("."+Pt,this.container),"click",this.btnClickHandler),b.remove(A("."+Ji,this.container),"click",this.previewHandler)}else b.remove(this.container,"click",this.paletteClickHandler),b.remove(this.container,"keydown",this.paletteKeyDown)},t.prototype.roundValue=function(e){if(!e)return"";e[0]!=="#"&&(e="#"+e);var i=e.length;if(i===4&&(e+="f",i=5),i===5){for(var n="",r=1,s=e.length;r<s;r++)n+=e.charAt(r)+e.charAt(r);e="#"+n,i=9}return i===7&&(e+="ff"),e},t.prototype.hexToRgb=function(e){if(!e)return[];e=e.trim(),e.length!==9&&(e=this.roundValue(e));var i=Number((parseInt(e.slice(-2),16)/255).toFixed(2));e=e.slice(1,7);var n=parseInt(e,16),r=[];return r.push(n>>16&255),r.push(n>>8&255),r.push(n&255),r.push(i),r},t.prototype.rgbToHsv=function(e,i,n,r){if(this.rgb&&!this.rgb.length)return[];e/=255,i/=255,n/=255;var s=Math.max(e,i,n),a=Math.min(e,i,n),l,c=s,p=s-a,d=s===0?0:p/s;if(s===a)l=0;else{switch(s){case e:l=(i-n)/p+(i<n?6:0);break;case i:l=(n-e)/p+2;break;case n:l=(e-i)/p+4;break}l/=6}var u=[Math.round(l*360),Math.round(d*1e3)/10,Math.round(c*1e3)/10];return h(r)||u.push(r),u},t.prototype.hsvToRgb=function(e,i,n,r){var s,a,l;if(i/=100,n/=100,i===0)return s=a=l=n,[Math.round(s*255),Math.round(a*255),Math.round(l*255),r];e/=60;var c=Math.floor(e),p=e-c,d=n*(1-i),u=n*(1-i*p),f=n*(1-i*(1-p));switch(c){case 0:s=n,a=f,l=d;break;case 1:s=u,a=n,l=d;break;case 2:s=d,a=n,l=f;break;case 3:s=d,a=u,l=n;break;case 4:s=f,a=d,l=n;break;default:s=n,a=d,l=u}var m=[Math.round(s*255),Math.round(a*255),Math.round(l*255)];return h(r)||m.push(r),m},t.prototype.rgbToHex=function(e){return e.length?"#"+this.hex(e[0])+this.hex(e[1])+this.hex(e[2])+(h(e[3])?"":e[3]!==0?(Math.round(e[3]*255)+65536).toString(16).substr(-2):"00"):""},t.prototype.hex=function(e){return("0"+e.toString(16)).slice(-2)},t.prototype.changeModeSwitcherProp=function(e){var i=A("."+Pt,this.container);e?i?this.appendModeSwitchBtn():(this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):i&&(this.showButtons?S(A("."+Xi,i)):Ue(i))},t.prototype.changeShowBtnProps=function(e){var i=A("."+Pt,this.container);e?(i&&Ue(i),this.createCtrlBtn(),this.isPicker()&&!this.disabled&&this.addCtrlSwitchEvent()):this.modeSwitcher?S(A("."+ai,i)):Ue(i)},t.prototype.changeValueProp=function(e){if(this.isPicker())this.rgb=this.hexToRgb(e),this.hsv=this.rgbToHsv.apply(this,this.rgb),this.setHandlerPosition(),S(T(this.hueSlider.element,".e-slider-preview")),this.createSlider(),this.setHsvContainerBg(),this.updateInput(e),this.rgb.length===4&&this.updateOpacityInput(this.rgb[3]*100);else{this.removeTileSelection();var i=this.container.querySelector('span[aria-label="'+this.roundValue(e)+'"]');i&&this.addTileSelection(i)}},t.prototype.setInputEleProps=function(){Ue(A("."+Ht,this.container)),this.createInput()},t.prototype.changeDisabledProp=function(e){this.isPicker()&&(this.hueSlider.enabled=!e,this.opacitySlider.enabled=!e,this.setInputEleProps()),e?(this.toggleDisabled(!0),this.unWireEvents()):(this.toggleDisabled(!1),this.wireEvents())},t.prototype.changeCssClassProps=function(e,i){var n=this.getWrapper(),r=this.getPopupEle();i&&O([n,r],i.split(" ")),e&&x([n,r],e.replace(/\s+/g," ").trim().split(" "))},t.prototype.changeRtlProps=function(e){e?x([this.getWrapper()],"e-rtl"):O([this.getWrapper()],"e-rtl")},t.prototype.changePaletteProps=function(){S(this.container.children[0]),this.container.style.width="",this.createPalette()},t.prototype.changeOpacityProps=function(e){var i=this.getWrapper();e?(O([this.container.parentElement],Pr),this.createOpacitySlider(A(".e-colorpicker-slider",this.container).appendChild(this.createElement("div",{className:"e-opacity-slider"}))),!i.classList.contains(Lt)&&!i.classList.contains(It)&&this.appendOpacityValue(A(".e-input-container",this.container))):(x([this.container.parentElement],Pr),this.opacitySlider.destroy(),Ue(this.opacitySlider.element),this.opacitySlider=null,!i.classList.contains(Lt)&&!i.classList.contains(It)&&Ue(A("."+Hr,this.container).parentElement))},t.prototype.onPropertyChanged=function(e,i){var n=this;if(!h(e.value)){var r=this.roundValue(e.value);if(r.length===9){this.element.value=this.roundValue(r).slice(0,7);var s=this.splitBtn&&A("."+Zi,this.splitBtn.element);s&&(s.style.backgroundColor=this.convertToRgbString(this.hexToRgb(e.value)))}else if(this.noColor&&this.mode==="Palette"&&this.value===""){var s=this.splitBtn&&A("."+Zi,this.splitBtn.element);s.style.backgroundColor=""}else this.value=i.value}if(!this.inline&&h(e.inline)){var a=["disabled","enableRtl"];if(this.splitBtn.setProperties(Ai(e,a)),!this.isPopupOpen()){this.changeCssClassProps(e.cssClass,i.cssClass),this.changeRtlProps(e.enableRtl);return}}for(var l=function(f){switch(f){case"inline":e.inline?(c.getWrapper().appendChild(c.container),c.splitBtn.destroy(),S(c.element.nextElementSibling),c.container.children.length||c.createWidget()):(c.destroyOtherComp(),c.unWireEvents(),c.container.innerHTML="",c.createSplitBtn());break;case"cssClass":{c.changeCssClassProps(e.cssClass,i.cssClass);var m=e.cssClass.split(" ").concat(i.cssClass.split(" "));m=m.reduce(function(y,L){return y.indexOf(L)<0&&y.push(L),y},[]);var v=0;m.forEach(function(y){if(v===0&&(y===Lt||y===Vo||y===Ft||y===Ar||y===It)){var L=A("."+Ht,n.container);L&&Ue(A("."+Ht,n.container)),n.createInput(),v++}});break}case"enableRtl":c.isPicker()&&(c.hueSlider.enableRtl=e.enableRtl,c.enableOpacity&&(c.opacitySlider.enableRtl=e.enableRtl),c.setInputEleProps()),c.changeRtlProps(e.enableRtl);break;case"disabled":c.changeDisabledProp(e.disabled);break;case"value":c.value!==i.value&&c.changeValueProp(e.value);break;case"showButtons":c.changeShowBtnProps(e.showButtons);break;case"mode":e.mode==="Picker"?c.switchToPicker():c.switchToPalette();break;case"modeSwitcher":c.changeModeSwitcherProp(e.modeSwitcher);break;case"columns":case"presetColors":c.isPicker()||c.changePaletteProps();break;case"noColor":e.noColor?c.mode==="Palette"&&!c.modeSwitcher&&c.setNoColor():c.changePaletteProps();break;case"enableOpacity":c.changeOpacityProps(e.enableOpacity);break}},c=this,p=0,d=Object.keys(e);p<d.length;p++){var u=d[p];l(u)}},t.prototype.focusIn=function(){this.element.parentElement.focus()},oe([g("#008000ff")],t.prototype,"value",void 0),oe([g("")],t.prototype,"cssClass",void 0),oe([g(!1)],t.prototype,"disabled",void 0),oe([g("Picker")],t.prototype,"mode",void 0),oe([g(!0)],t.prototype,"modeSwitcher",void 0),oe([g(null)],t.prototype,"presetColors",void 0),oe([g(!0)],t.prototype,"showButtons",void 0),oe([g(10)],t.prototype,"columns",void 0),oe([g(!1)],t.prototype,"inline",void 0),oe([g(!1)],t.prototype,"noColor",void 0),oe([g(!1)],t.prototype,"enablePersistence",void 0),oe([g(!0)],t.prototype,"enableOpacity",void 0),oe([g(!1)],t.prototype,"createPopupOnClick",void 0),oe([N()],t.prototype,"select",void 0),oe([N()],t.prototype,"change",void 0),oe([N()],t.prototype,"beforeTileRender",void 0),oe([N()],t.prototype,"beforeOpen",void 0),oe([N()],t.prototype,"open",void 0),oe([N()],t.prototype,"beforeClose",void 0),oe([N()],t.prototype,"beforeModeSwitch",void 0),oe([N()],t.prototype,"onModeSwitch",void 0),oe([N()],t.prototype,"created",void 0),t=oe([Ct],t),t}($t),jc=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),pe=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},_c="e-clear-icon-hide",_o="e-input-focus",zr=["title","style","class"],Wo=function(o){jc(t,o);function t(e,i){var n=o.call(this,e,i)||this;return n.previousValue=null,n.isAngular=!1,n.isHiddenInput=!1,n.isForm=!1,n.inputPreviousValue=null,n.isVue=!1,n.textboxOptions=e,n}return t.prototype.onPropertyChanged=function(e,i){for(var n=0,r=Object.keys(e);n<r.length;n++){var s=r[n];switch(s){case"floatLabelType":J.removeFloating(this.textboxWrapper),J.addFloating(this.respectiveElement,this.floatLabelType,this.placeholder);break;case"enabled":J.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container),this.bindClearEvent();break;case"width":J.setWidth(e.width,this.textboxWrapper.container);break;case"value":{var a=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.isBlank(this.value)||(this.value=this.value.toString()),this.isProtectedOnChange=a,J.setValue(this.value,this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value),this.inputPreviousValue=this.respectiveElement.value,(this.isAngular||this.isVue)&&this.preventChange===!0?(this.previousValue=this.isAngular?this.value:this.previousValue,this.preventChange=!1):(h(this.isAngular)||!this.isAngular||this.isAngular&&!this.preventChange||this.isAngular&&h(this.preventChange))&&this.raiseChangeEvent()}break;case"htmlAttributes":this.updateHTMLAttrToElement(),this.updateHTMLAttrToWrapper(),this.checkAttributes(!0),this.multiline&&!h(this.textarea)?J.validateInputType(this.textboxWrapper.container,this.textarea):J.validateInputType(this.textboxWrapper.container,this.element);break;case"readonly":J.setReadonly(this.readonly,this.respectiveElement);break;case"type":this.respectiveElement.tagName!=="TEXTAREA"&&(this.respectiveElement.setAttribute("type",this.type),J.validateInputType(this.textboxWrapper.container,this.element),this.raiseChangeEvent());break;case"showClearButton":J.setClearButton(this.showClearButton,this.respectiveElement,this.textboxWrapper),this.bindClearEvent();break;case"enableRtl":J.setEnableRtl(this.enableRtl,[this.textboxWrapper.container]);break;case"placeholder":J.setPlaceholder(this.placeholder,this.respectiveElement),J.calculateWidth(this.respectiveElement,this.textboxWrapper.container);break;case"autocomplete":this.autocomplete!=="on"&&this.autocomplete!==""?this.respectiveElement.autocomplete=this.autocomplete:this.removeAttributes(["autocomplete"]);break;case"cssClass":this.updateCssClass(e.cssClass,i.cssClass);break;case"locale":this.globalize=new Wr(this.locale),this.l10n.setLocale(this.locale),this.setProperties({placeholder:this.l10n.getConstant("placeholder")},!0),J.setPlaceholder(this.placeholder,this.respectiveElement);break}}},t.prototype.getModuleName=function(){return"textbox"},t.prototype.isBlank=function(e){return!e||/^\s*$/.test(e)},t.prototype.preRender=function(){if(this.cloneElement=this.element.cloneNode(!0),this.formElement=T(this.element,"form"),h(this.formElement)||(this.isForm=!0),this.element.tagName==="EJS-TEXTBOX"){var e=jt("ej2_instances",this.element),i=this.multiline?this.createElement("textarea"):this.createElement("input"),n=0;for(n;n<this.element.attributes.length;n++){var r=this.element.attributes[n].nodeName;r!=="id"&&r!=="class"?(i.setAttribute(r,this.element.attributes[n].nodeValue),i.innerHTML=this.element.innerHTML,r==="name"&&this.element.removeAttribute("name")):r==="class"&&i.setAttribute(r,this.element.className.split(" ").filter(function(l){return l.indexOf("ng-")!==0}).join(" "))}this.element.appendChild(i),this.element=i,Rn("ej2_instances",e,this.element)}this.updateHTMLAttrToElement(),this.checkAttributes(!1),(h(this.textboxOptions)||this.textboxOptions.value===void 0)&&this.element.value!==""&&this.setProperties({value:this.element.value},!0),this.element.tagName!=="TEXTAREA"&&this.element.setAttribute("type",this.type),this.type==="text"&&this.element.setAttribute("role","textbox"),this.globalize=new Wr(this.locale);var s={placeholder:this.placeholder};if(this.l10n=new Ii("textbox",s,this.locale),this.l10n.getConstant("placeholder")!==""&&this.setProperties({placeholder:this.placeholder||this.l10n.getConstant("placeholder")},!0),this.element.hasAttribute("id")||this.element.setAttribute("id",st("textbox")),this.element.hasAttribute("name")||this.element.setAttribute("name",this.element.getAttribute("id")),this.element.tagName==="INPUT"&&this.multiline){this.isHiddenInput=!0,this.textarea=this.createElement("textarea"),this.element.parentNode.insertBefore(this.textarea,this.element),this.element.setAttribute("type","hidden"),this.textarea.setAttribute("name",this.element.getAttribute("name")),this.element.removeAttribute("name"),this.textarea.setAttribute("role",this.element.getAttribute("role")),this.element.removeAttribute("role"),this.textarea.setAttribute("id",st("textarea"));for(var a=["placeholder","disabled","value","readonly","type","autocomplete"],n=0;n<this.element.attributes.length;n++){var r=this.element.attributes[n].nodeName;this.element.hasAttribute(r)&&zr.indexOf(r)<0&&!(r==="id"||r==="type"||r==="e-mappinguid")&&(this.textarea.setAttribute(r,this.element.attributes[n].nodeValue),a.indexOf(r)<0&&(this.element.removeAttribute(r),n--))}}},t.prototype.checkAttributes=function(e){for(var i=e?h(this.htmlAttributes)?[]:Object.keys(this.htmlAttributes):["placeholder","disabled","value","readonly","type","autocomplete"],n=0,r=i;n<r.length;n++){var s=r[n];if(!h(this.element.getAttribute(s)))switch(s){case"disabled":if(h(this.textboxOptions)||this.textboxOptions.enabled===void 0||e){var a=!(this.element.getAttribute(s)==="disabled"||this.element.getAttribute(s)===""||this.element.getAttribute(s)==="true");this.setProperties({enabled:a},!e)}break;case"readonly":if(h(this.textboxOptions)||this.textboxOptions.readonly===void 0||e){var l=this.element.getAttribute(s)==="readonly"||this.element.getAttribute(s)===""||this.element.getAttribute(s)==="true";this.setProperties({readonly:l},!e)}break;case"placeholder":(h(this.textboxOptions)||this.textboxOptions.placeholder===void 0||e)&&this.setProperties({placeholder:this.element.placeholder},!e);break;case"autocomplete":if(h(this.textboxOptions)||this.textboxOptions.autocomplete===void 0||e){var c=this.element.autocomplete==="off"?"off":"on";this.setProperties({autocomplete:c},!e)}break;case"value":(h(this.textboxOptions)||this.textboxOptions.value===void 0||e)&&this.element.value!==""&&this.setProperties({value:this.element.value},!e);break;case"type":(h(this.textboxOptions)||this.textboxOptions.type===void 0||e)&&this.setProperties({type:this.element.type},!e);break}}},t.prototype.render=function(){var e=this.cssClass;!h(this.cssClass)&&this.cssClass!==""&&(e=this.getInputValidClassList(this.cssClass)),this.respectiveElement=this.isHiddenInput?this.textarea:this.element,this.textboxWrapper=J.createInput({element:this.respectiveElement,floatLabelType:this.floatLabelType,properties:{enabled:this.enabled,enableRtl:this.enableRtl,cssClass:e,readonly:this.readonly,placeholder:this.placeholder,showClearButton:this.showClearButton}}),this.updateHTMLAttrToWrapper(),this.isHiddenInput&&this.respectiveElement.parentNode.insertBefore(this.element,this.respectiveElement),this.wireEvents(),h(this.value)||(J.setValue(this.value,this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value)),h(this.value)||(this.initialValue=this.value,this.setInitialValue()),this.autocomplete!=="on"&&this.autocomplete!==""?this.respectiveElement.autocomplete=this.autocomplete:!h(this.textboxOptions)&&this.textboxOptions.autocomplete!==void 0&&this.removeAttributes(["autocomplete"]),this.previousValue=this.value,this.inputPreviousValue=this.value,this.respectiveElement.defaultValue=this.respectiveElement.value,J.setWidth(this.width,this.textboxWrapper.container),!h(T(this.element,"fieldset"))&&T(this.element,"fieldset").disabled&&(this.enabled=!1),this.renderComplete()},t.prototype.updateHTMLAttrToWrapper=function(){if(!h(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var n=i[e];if(zr.indexOf(n)>-1)if(n==="class"){var r=this.getInputValidClassList(this.htmlAttributes[""+n]);r!==""&&x([this.textboxWrapper.container],r.split(" "))}else if(n==="style"){var s=this.textboxWrapper.container.getAttribute(n);s=h(s)?this.htmlAttributes[""+n]:s+this.htmlAttributes[""+n],this.textboxWrapper.container.setAttribute(n,s)}else this.textboxWrapper.container.setAttribute(n,this.htmlAttributes[""+n])}},t.prototype.updateHTMLAttrToElement=function(){if(!h(this.htmlAttributes))for(var e=0,i=Object.keys(this.htmlAttributes);e<i.length;e++){var n=i[e];zr.indexOf(n)<0&&(this.multiline&&!h(this.textarea)?this.textarea.setAttribute(n,this.htmlAttributes[""+n]):this.element.setAttribute(n,this.htmlAttributes[""+n]))}},t.prototype.updateCssClass=function(e,i){J.setCssClass(this.getInputValidClassList(e),[this.textboxWrapper.container],this.getInputValidClassList(i))},t.prototype.getInputValidClassList=function(e){var i=e;return!h(e)&&e!==""&&(i=e.replace(/\s+/g," ").trim()),i},t.prototype.setInitialValue=function(){this.isAngular||this.respectiveElement.setAttribute("value",this.initialValue)},t.prototype.wireEvents=function(){b.add(this.respectiveElement,"focus",this.focusHandler,this),b.add(this.respectiveElement,"blur",this.focusOutHandler,this),b.add(this.respectiveElement,"keydown",this.keydownHandler,this),b.add(this.respectiveElement,"input",this.inputHandler,this),b.add(this.respectiveElement,"change",this.changeHandler,this),this.isForm&&b.add(this.formElement,"reset",this.resetForm,this),this.bindClearEvent(),!h(this.textboxWrapper.container.querySelector(".e-float-text"))&&this.floatLabelType==="Auto"&&this.textboxWrapper.container.classList.contains("e-autofill")&&this.textboxWrapper.container.classList.contains("e-outline")&&b.add(this.textboxWrapper.container.querySelector(".e-float-text"),"animationstart",this.animationHandler,this)},t.prototype.animationHandler=function(){this.textboxWrapper.container.classList.add("e-valid-input");var e=this.textboxWrapper.container.querySelector(".e-float-text");h(e)||(e.classList.add("e-label-top"),e.classList.contains("e-label-bottom")&&e.classList.remove("e-label-bottom"))},t.prototype.resetValue=function(e){var i=this.isProtectedOnChange;this.isProtectedOnChange=!0,this.value=e,e==null&&this.textboxWrapper.container.classList.contains("e-valid-input")&&this.textboxWrapper.container.classList.remove("e-valid-input"),this.isProtectedOnChange=i},t.prototype.resetForm=function(){if(this.isAngular?this.resetValue(""):this.resetValue(this.initialValue),!h(this.textboxWrapper)){var e=this.textboxWrapper.container.querySelector(".e-float-text");!h(e)&&this.floatLabelType!=="Always"&&(h(this.initialValue)||this.initialValue===""?(e.classList.add("e-label-bottom"),e.classList.remove("e-label-top")):this.initialValue!==""&&(e.classList.add("e-label-top"),e.classList.remove("e-label-bottom")))}},t.prototype.focusHandler=function(e){var i={container:this.textboxWrapper.container,event:e,value:this.value};this.trigger("focus",i)},t.prototype.focusOutHandler=function(e){!(this.previousValue===null&&this.value===null&&this.respectiveElement.value==="")&&this.previousValue!==this.value&&this.raiseChangeEvent(e,!0);var i={container:this.textboxWrapper.container,event:e,value:this.value};this.trigger("blur",i)},t.prototype.keydownHandler=function(e){(e.keyCode===13||e.keyCode===9)&&!((this.previousValue===null||this.previousValue==="")&&(this.value===null||this.value==="")&&this.respectiveElement.value==="")&&this.setProperties({value:this.respectiveElement.value},!0)},t.prototype.inputHandler=function(e){var i=this,n={event:e,value:this.respectiveElement.value,previousValue:this.inputPreviousValue,container:this.textboxWrapper.container};this.inputPreviousValue=this.respectiveElement.value,this.isAngular&&(i.localChange({value:this.respectiveElement.value}),this.preventChange=!0),this.isVue&&(this.preventChange=!0),this.trigger("input",n),e.stopPropagation()},t.prototype.changeHandler=function(e){this.setProperties({value:this.respectiveElement.value},!0),this.previousValue!=this.value&&this.raiseChangeEvent(e,!0),e.stopPropagation()},t.prototype.raiseChangeEvent=function(e,i){var n={event:e,value:this.value,previousValue:this.previousValue,container:this.textboxWrapper.container,isInteraction:i||!1,isInteracted:i||!1};this.preventChange=!1,this.trigger("change",n),this.previousValue=this.value,this.element.tagName==="INPUT"&&this.multiline&&D.info.name==="mozilla"&&(this.element.value=this.respectiveElement.value)},t.prototype.bindClearEvent=function(){this.showClearButton&&(this.enabled?b.add(this.textboxWrapper.clearButton,"mousedown touchstart",this.resetInputHandler,this):b.remove(this.textboxWrapper.clearButton,"mousedown touchstart",this.resetInputHandler))},t.prototype.resetInputHandler=function(e){if(e.preventDefault(),!this.textboxWrapper.clearButton.classList.contains(_c)||this.textboxWrapper.container.classList.contains("e-static-clear")){J.setValue("",this.respectiveElement,this.floatLabelType,this.showClearButton),this.isHiddenInput&&(this.element.value=this.respectiveElement.value),this.setProperties({value:this.respectiveElement.value},!0);var i={event:e,value:this.respectiveElement.value,previousValue:this.inputPreviousValue,container:this.textboxWrapper.container};if(this.trigger("input",i),this.inputPreviousValue=this.respectiveElement.value,this.raiseChangeEvent(e,!0),T(this.element,"form")){var n=this.element,r=document.createEvent("KeyboardEvent");r.initEvent("keyup",!1,!0),n.dispatchEvent(r)}}},t.prototype.unWireEvents=function(){b.remove(this.respectiveElement,"focus",this.focusHandler),b.remove(this.respectiveElement,"blur",this.focusOutHandler),b.remove(this.respectiveElement,"keydown",this.keydownHandler),b.remove(this.respectiveElement,"input",this.inputHandler),b.remove(this.respectiveElement,"change",this.changeHandler),this.isForm&&b.remove(this.formElement,"reset",this.resetForm),!h(this.textboxWrapper.container.querySelector(".e-float-text"))&&this.floatLabelType==="Auto"&&this.textboxWrapper.container.classList.contains("e-outline")&&this.textboxWrapper.container.classList.contains("e-autofill")&&b.remove(this.textboxWrapper.container.querySelector(".e-float-text"),"animationstart",this.animationHandler)},t.prototype.destroy=function(){this.unWireEvents(),this.element.tagName==="INPUT"&&this.multiline&&(S(this.textboxWrapper.container.getElementsByTagName("textarea")[0]),this.respectiveElement=this.element,this.element.removeAttribute("type")),this.respectiveElement.value=this.respectiveElement.defaultValue,this.respectiveElement.classList.remove("e-input"),this.removeAttributes(["aria-disabled","aria-readonly","aria-labelledby"]),h(this.textboxWrapper)||(this.textboxWrapper.container.insertAdjacentElement("afterend",this.respectiveElement),S(this.textboxWrapper.container)),this.textboxWrapper=null,J.destroy(),o.prototype.destroy.call(this)},t.prototype.addIcon=function(e,i){J.addIcon(e,i,this.textboxWrapper.container,this.respectiveElement,this.createElement)},t.prototype.getPersistData=function(){var e=["value"];return this.addOnPersist(e)},t.prototype.addAttributes=function(e){for(var i=0,n=Object.keys(e);i<n.length;i++){var r=n[i];r==="disabled"?(this.setProperties({enabled:!1},!0),J.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container)):r==="readonly"?(this.setProperties({readonly:!0},!0),J.setReadonly(this.readonly,this.respectiveElement)):r==="class"?this.respectiveElement.classList.add(e[""+r]):r==="placeholder"?(this.setProperties({placeholder:e[""+r]},!0),J.setPlaceholder(this.placeholder,this.respectiveElement)):r==="rows"&&this.respectiveElement.tagName==="TEXTAREA"?this.respectiveElement.setAttribute(r,e[""+r]):this.respectiveElement.setAttribute(r,e[""+r])}},t.prototype.removeAttributes=function(e){for(var i=0,n=e;i<n.length;i++){var r=n[i];r==="disabled"?(this.setProperties({enabled:!0},!0),J.setEnabled(this.enabled,this.respectiveElement,this.floatLabelType,this.textboxWrapper.container)):r==="readonly"?(this.setProperties({readonly:!1},!0),J.setReadonly(this.readonly,this.respectiveElement)):r==="placeholder"?(this.setProperties({placeholder:null},!0),J.setPlaceholder(this.placeholder,this.respectiveElement)):this.respectiveElement.removeAttribute(r)}},t.prototype.focusIn=function(){document.activeElement!==this.respectiveElement&&this.enabled&&(this.respectiveElement.focus(),(this.textboxWrapper.container.classList.contains("e-input-group")||this.textboxWrapper.container.classList.contains("e-outline")||this.textboxWrapper.container.classList.contains("e-filled"))&&x([this.textboxWrapper.container],[_o]))},t.prototype.focusOut=function(){document.activeElement===this.respectiveElement&&this.enabled&&(this.respectiveElement.blur(),(this.textboxWrapper.container.classList.contains("e-input-group")||this.textboxWrapper.container.classList.contains("e-outline")||this.textboxWrapper.container.classList.contains("e-filled"))&&O([this.textboxWrapper.container],[_o]))},pe([g("text")],t.prototype,"type",void 0),pe([g(!1)],t.prototype,"readonly",void 0),pe([g(null)],t.prototype,"value",void 0),pe([g("Never")],t.prototype,"floatLabelType",void 0),pe([g("")],t.prototype,"cssClass",void 0),pe([g(null)],t.prototype,"placeholder",void 0),pe([g("on")],t.prototype,"autocomplete",void 0),pe([g({})],t.prototype,"htmlAttributes",void 0),pe([g(!1)],t.prototype,"multiline",void 0),pe([g(!0)],t.prototype,"enabled",void 0),pe([g(!1)],t.prototype,"showClearButton",void 0),pe([g(!1)],t.prototype,"enablePersistence",void 0),pe([g(null)],t.prototype,"width",void 0),pe([N()],t.prototype,"created",void 0),pe([N()],t.prototype,"destroyed",void 0),pe([N()],t.prototype,"change",void 0),pe([N()],t.prototype,"blur",void 0),pe([N()],t.prototype,"focus",void 0),pe([N()],t.prototype,"input",void 0),t=pe([Ct],t),t}($t),Wc=function(){function o(t,e){this.parent=t,e&&(this.l10n=e.getService("rteLocale")),this.wireEvent()}return o.prototype.wireEvent=function(){this.parent.on(j,this.unWireEvent,this),this.parent.on(Mi,this.destroyTooltip,this)},o.prototype.destroyTooltip=function(){var t=this.parent.iframeSettings.enable?this.parent.contentModule.getPanel().ownerDocument:this.parent.contentModule.getDocument();if(!h(t.querySelector(".e-tooltip-wrap"))&&!h(t.querySelector("[data-tooltip-id]"))){var e=t.querySelector("[data-tooltip-id]"),i=new MouseEvent("mouseleave",{bubbles:!0,cancelable:!0});e.dispatchEvent(i)}},o.prototype.unWireEvent=function(){this.parent.off(j,this.unWireEvent)},o.prototype.toolbarBeforeCreate=function(t){this.mode==="Extended"&&(t.enableCollision=!1)},o.prototype.toolbarCreated=function(){this.parent.notify(Rl,this)},o.prototype.toolbarClicked=function(t){this.parent.enabled&&(this.parent.trigger("toolbarClick",t),(!this.parent.readonly||h(t.item))&&this.parent.notify(Li,t))},o.prototype.dropDownSelected=function(t){this.parent.notify(wi,t),this.destroyTooltip()},o.prototype.beforeDropDownItemRender=function(t){this.parent.readonly||!this.parent.enabled||this.parent.notify(ns,t)},o.prototype.tooltipBeforeRender=function(t){if(!h(t.target.getAttribute("title"))){var e=t.target.getAttribute("title"),i=void 0;switch(e){case"Minimize":i=this.l10n.getConstant("minimize"),t.target.setAttribute("title",i+" (Esc)");break;case"Maximize":i=this.l10n.getConstant("maximize"),t.target.setAttribute("title",i+" (Ctrl+Shift+F)");break}}},o.prototype.dropDownOpen=function(t){if(t.element.parentElement.getAttribute("id").indexOf("TableCell")>-1&&!h(t.element.parentElement.querySelector(".e-cell-merge"))&&(!h(t.element.parentElement.querySelector(".e-cell-horizontal-split"))||!h(t.element.parentElement.querySelector(".e-cell-vertical-split")))){var e=t.element.querySelectorAll("li"),i=this.parent.inputElement.querySelectorAll(".e-cell-select");i.length===1?(x([e[0]],"e-disabled"),O([e[1],e[2]],"e-disabled")):i.length>1&&(Array.from(i).every(function(n){return n.tagName.toLowerCase()===i[0].tagName.toLowerCase()})?O([e[0]],"e-disabled"):x([e[0]],"e-disabled"),x([e[1],e[2]],"e-disabled"))}this.parent.notify(nt,t)},o.prototype.dropDownClose=function(t){this.parent.notify(rt,t)},o.prototype.renderToolbar=function(t){this.setPanel(t.target),this.renderPanel(),this.mode=t.overflowMode,t.rteToolbarObj.toolbarObj=new vl({items:t.items,width:"100%",overflowMode:t.overflowMode,beforeCreate:this.toolbarBeforeCreate.bind(this),created:this.toolbarCreated.bind(this),clicked:this.toolbarClicked.bind(this),enablePersistence:t.enablePersistence,enableRtl:t.enableRtl,cssClass:t.cssClass}),t.rteToolbarObj.toolbarObj.isStringTemplate=!0,t.rteToolbarObj.toolbarObj.createElement=this.parent.createElement,t.rteToolbarObj.toolbarObj.appendTo(t.target),this.parent.showTooltip&&(this.tooltip=new Qt({target:"#"+this.parent.getID()+"_toolbar_wrapper [title]",showTipPointer:!0,openDelay:400,opensOn:"Hover",beforeRender:this.tooltipBeforeRender.bind(this),cssClass:this.parent.getCssClass(),windowCollision:!0,position:"BottomCenter"}),this.tooltip.appendTo(t.target)),this.parent.showTooltip&&(this.dropdownTooltip=new Qt({target:'[aria-owns="'+this.parent.getID()+'"].e-rte-elements [title]',showTipPointer:!0,openDelay:400,opensOn:"Hover",beforeRender:this.tooltipBeforeRender.bind(this),cssClass:this.parent.getCssClass(),windowCollision:!0,position:"BottomCenter"}),this.dropdownTooltip.appendTo(document.body))},o.prototype.renderDropDownButton=function(t){var e=this,i;t.element.classList.add(ke),i=t.cssClass+" "+Ce+" "+Sr,this.parent.inlineMode.enable&&D.isDevice&&(i=i+" "+mr);var n=this,r=new Ci({items:t.items,iconCss:t.iconCss,cssClass:i,content:t.content,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,select:this.dropDownSelected.bind(this),beforeOpen:function(a){if(n.parent.readonly||!n.parent.enabled){a.cancel=!0;return}if(n.parent.editorMode!=="Markdown"){var l=n.parent.getRange().startContainer.parentElement,c=l.closest("table"),p=l.closest("tr");if(!h(c)&&c.classList.contains("e-dashed-border"))for(var d=0;d<a.element.childNodes.length;d++)a.element.childNodes[d].classList.contains("e-dashed-borders")&&x([a.element.childNodes[d]],"e-active");else if(!h(c)&&!c.classList.contains("e-dashed-border")&&c.classList.contains("e-alternate-rows")&&window.getComputedStyle(p).backgroundColor!=="")for(var d=0;d<a.element.childNodes.length;d++)a.element.childNodes[d].classList.contains("e-alternate-rows")&&x([a.element.childNodes[d]],"e-active");for(var u=n.parent.getRange().startContainer;u!==n.parent.inputElement&&!h(u.parentElement);){u.nodeName==="#text"&&(u=u.parentElement);var f=window.getComputedStyle(u).textAlign;if(a.items[0].command==="Alignments"){if(a.items[0].text==="Align Left"&&f==="left"||f==="start"){x([a.element.childNodes[0]],"e-active");break}else if(a.items[1].text==="Align Center"&&f==="center"){x([a.element.childNodes[1]],"e-active");break}else if(a.items[2].text==="Align Right"&&f==="right"){x([a.element.childNodes[2]],"e-active");break}else if(a.items[3].text==="Align Justify"&&f==="justify"){x([a.element.childNodes[3]],"e-active");break}}u=u.parentElement}var m=l.closest("img"),v=m||l.querySelector("img");if(a.items[0].command==="Images"&&!h(v)){var d=void 0;v.classList.contains("e-imgleft")||v.classList.contains("e-imginline")?d=0:v.classList.contains("e-imgcenter")||v.classList.contains("e-imgbreak")?d=1:v.classList.contains("e-imgright")&&(d=2),h(a.element.childNodes[d])||x([a.element.childNodes[d]],"e-active")}if(a.items[0].command==="Formats"||a.items[0].command==="Font")for(var d=0;d<a.element.childNodes.length;d++){var y=e.parent.createElement("div");y.innerHTML=r.content.trim(),y.textContent.trim()!==""&&a.element.childNodes[d].textContent.trim()===y.textContent.trim()?a.element.childNodes[d].classList.contains("e-active")||x([a.element.childNodes[d]],"e-active"):O([a.element.childNodes[d]],"e-active")}}n.parent.notify(Fn,a)},close:this.dropDownClose.bind(this),open:this.dropDownOpen.bind(this),beforeItemRender:this.beforeDropDownItemRender.bind(this)});r.isStringTemplate=!0,r.createElement=n.parent.createElement,r.appendTo(t.element),t.element.tabIndex=-1;var s=document.getElementById(r.element.id+"-popup");return s.setAttribute("aria-owns",this.parent.getID()),r},o.prototype.renderListDropDown=function(t){var e=this,i=Ce+" "+Sr+(this.parent.inlineMode?" "+mr:"");i+=" "+(t.itemName==="NumberFormatList"?Th:Sh);var n=e.parent.createElement("span",{className:Er}),r=e.parent.createElement("span",{className:t.cssClass});n.appendChild(r);var s=new Ci({items:t.items,cssClass:i,content:t.content,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,select:this.dropDownSelected.bind(this),beforeOpen:function(l){if(e.parent.readonly||!e.parent.enabled){l.cancel=!0;return}e.parent.notify(rt,{});var c=l.event?l.event.target:null;if(e.currentElement=s.element,e.currentDropdown=s,l.event&&l.event.type==="click"&&(c.classList.contains(Er)||c.parentElement.classList.contains(Er))){l.cancel=!0;return}e.parent.notify(Fn,l)},close:this.dropDownClose.bind(this),open:this.dropDownOpen.bind(this),beforeItemRender:this.beforeDropDownItemRender.bind(this)});s.isStringTemplate=!0,s.createElement=e.parent.createElement,s.appendTo(t.element),t.element.tabIndex=-1,t.element.setAttribute("role","button");var a=document.getElementById(s.element.id+"-popup");return a.setAttribute("aria-owns",this.parent.getID()),t.element.childElementCount===1&&s.element.insertBefore(n,s.element.querySelector(".e-caret")),t.element.tabIndex=-1,s.element.removeAttribute("type"),s.element.onmousedown=function(){e.parent.notify(nt,{})},s.element.onkeydown=function(){e.parent.notify(nt,{})},s},o.prototype.paletteSelection=function(t,e){var i=t.element.querySelector(".e-control.e-colorpicker"),n=[].slice.call(Te(".e-tile",i.parentElement));O(n,"e-selected");var r=e.querySelector("."+Ce).style.borderBottomColor;n.filter(function(s){s.style.backgroundColor===r&&x([s],"e-selected")})},o.prototype.renderColorPickerDropDown=function(t,e,i,n){var r=this,s=this,a=Ce+" "+Sr+(this.parent.inlineMode?" "+mr:"");a+=" "+(e==="backgroundcolor"?Oh:Bh),a+=this.parent.getCssClass(!0);var l=s.parent.createElement("span",{className:ii}),c=s.parent.createElement("span",{className:t.cssClass}),p,d=h(n)?s.parent.backgroundColor.default:n;c.style.borderBottomColor=e==="backgroundcolor"?d:s.parent.fontColor.default,l.appendChild(c);var u=new Ci({target:i.element.parentElement,cssClass:a,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,beforeOpen:function(m){if(i.inline=!0,i.dataBind(),s.parent.readonly||!s.parent.enabled){m.cancel=!0;return}var v=m.event?m.event.target:null;if(s.currentElement=u.element,s.currentDropdown=u,s.paletteSelection(m,s.currentElement),m.event&&m.event.type==="click"&&(v.classList.contains(ii)||v.parentElement.classList.contains(ii))){m.cancel=!0;var y=v.classList.contains(Ce)?v.style.borderBottomColor:v.querySelector("."+Ce).style.borderBottomColor;s.parent.notify(rt,{}),p=s.parent.formatter.editorManager.nodeSelection.getRange(s.parent.contentModule.getDocument());var L=p.startContainer.parentNode,C=T(p.startContainer.parentNode,"table");(p.startContainer.nodeName==="TD"||p.startContainer.nodeName==="TH"||T(p.startContainer.parentNode,"td,th")||s.parent.iframeSettings.enable&&!he(L.ownerDocument.querySelector("body"),"e-lib"))&&p.collapsed&&t.subCommand==="BackgroundColor"&&T(C,"."+Vn)?s.parent.notify(dr,{item:{command:t.command,subCommand:t.subCommand,value:y}}):s.parent.notify(bi,{item:{command:t.command,subCommand:t.subCommand,value:y}});return}else{var w=m.element.querySelector(".e-control.e-colorpicker"),k=mt(w,jo);k.showButtons=!m.element.querySelector(".e-color-palette"),k.dataBind()}m.element.onclick=function(I){I.target.classList.contains("e-cancel")&&u.toggle()}},open:function(m){r.setColorPickerContentWidth(i);var v,y=m.element.querySelector(".e-control.e-colorpicker");m.element.querySelector(".e-color-palette")?v=y.parentElement.querySelector(".e-palette"):v=y.parentElement.querySelector("e-handler"),v&&v.focus(),r.pickerRefresh(m)},beforeClose:function(m){var v=m.event?m.event.target:null;if(m.event&&m.event.type==="click"&&(v.classList.contains(ii)||v.parentElement.classList.contains(ii))){var y=v.classList.contains(Ce)?v.style.borderBottomColor:v.querySelector("."+Ce).style.borderBottomColor;p=s.parent.formatter.editorManager.nodeSelection.getRange(s.parent.contentModule.getDocument()),(p.startContainer.nodeName==="TD"||p.startContainer.nodeName==="TH"||T(p.startContainer.parentNode,"td,th"))&&p.collapsed?s.parent.notify(dr,{item:{command:t.command,subCommand:t.subCommand,value:y}}):s.parent.notify(bi,{item:{command:t.command,subCommand:t.subCommand,value:y}});return}},close:function(m){s.parent.notify(rt,{})}});u.isStringTemplate=!0,u.createElement=s.parent.createElement,t.element.setAttribute("role","button"),u.appendTo(t.element);var f=document.getElementById(u.element.id+"-popup");return f.setAttribute("aria-owns",this.parent.getID()),u.element.insertBefore(l,u.element.querySelector(".e-caret")),t.element.tabIndex=-1,u.element.removeAttribute("type"),u.element.onmousedown=function(){s.parent.notify(nt,{})},u.element.onkeydown=function(){s.parent.notify(nt,{})},u},o.prototype.pickerRefresh=function(t){if(this.parent.backgroundColor.mode==="Picker"){var e=t.element.parentElement;e.style.width=(e.offsetWidth+5).toString()+"px",mt(e,Hi).refreshPosition(e),e.style.width=(e.offsetWidth-5).toString()+"px"}},o.prototype.setColorPickerContentWidth=function(t){var e=t.element.nextSibling;if(e.style.width==="0px"){e.style.width="";var i=parseInt(getComputedStyle(e).borderBottomWidth,10);e.style.width=H(e.children[0].offsetWidth+i+i)}},o.prototype.renderColorPicker=function(t,e){var i=this,n=this,r,s=new jo({enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,inline:!1,value:"#fff",created:function(){var a=e==="backgroundcolor"?n.parent.backgroundColor.default:n.parent.fontColor.default;s.setProperties({value:a})},mode:e==="backgroundcolor"?n.parent.backgroundColor.mode:n.parent.fontColor.mode,modeSwitcher:e==="backgroundcolor"?n.parent.backgroundColor.modeSwitcher:n.parent.fontColor.modeSwitcher,beforeTileRender:function(a){if(a.element.classList.add(Nh),a.element.classList.add(Wh),!h(i.parent.cssClass))for(var l=i.parent.getCssClass().split(" "),c=0;c<l.length;c++)l[c].trim()!==""&&a.element.classList.add(l[c]);a.value===""&&a.element.classList.add(Qh)},change:function(a){var l=a.currentValue.rgba;a.item={command:t.command,subCommand:t.subCommand,value:l},n.parent.notify(rt,{}),n.currentElement.querySelector("."+Ce).style.borderBottomColor=l;var c=n.parent.formatter.editorManager.nodeSelection.getRange(n.parent.contentModule.getDocument()),p=T(c.startContainer.parentNode,"table");(c.startContainer.nodeName==="TD"||c.startContainer.nodeName==="TH"||c.startContainer.nodeName==="BODY"||T(c.startContainer.parentNode,"td,th"))&&c.collapsed&&t.subCommand==="BackgroundColor"&&T(p,"."+Vn)?n.parent.notify(dr,a):n.parent.notify(bi,a),n.currentDropdown.toggle()},beforeModeSwitch:function(a){r=s.value,r===""&&s.setProperties({value:a.mode==="Picker"?"#008000ff":""},!0),s.showButtons=a.mode!=="Palette"}});return s.isStringTemplate=!0,s.columns=e==="backgroundcolor"?this.parent.backgroundColor.columns:this.parent.fontColor.columns,s.presetColors=e==="backgroundcolor"?this.parent.backgroundColor.colorCode:this.parent.fontColor.colorCode,s.cssClass=(e==="backgroundcolor"?Mh:Rh)+" "+t.cssClass,s.createElement=this.parent.createElement,s.appendTo(document.getElementById(t.target)),s},o.prototype.renderPanel=function(){this.getPanel().classList.add(un)},o.prototype.getPanel=function(){return this.toolbarPanel},o.prototype.setPanel=function(t){this.toolbarPanel=t},o}(),Ta=function(){function o(t,e){this.tools={},this.parent=t,this.locator=e,this.renderFactory=this.locator.getService("rendererFactory"),this.addEventListener(),this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?ot(this.tools,Xt,Us(this.parent.toolbarSettings.itemConfigs),!0):this.tools=Xt}return o.prototype.addEventListener=function(){this.parent.on(dt,this.setRtl,this),this.parent.on(we,this.setCssClass,this),this.parent.on(j,this.removeEventListener,this)},o.prototype.removeEventListener=function(){this.parent.off(dt,this.setRtl),this.parent.off(we,this.setCssClass),this.parent.off(j,this.removeEventListener)},o.prototype.setCssClass=function(t){h(this.toolbarObj)||(h(t.oldCssClass)?this.toolbarObj.setProperties({cssClass:(this.toolbarObj.cssClass+" "+t.cssClass).trim()}):this.toolbarObj.setProperties({cssClass:(this.toolbarObj.cssClass.replace(t.oldCssClass,"").trim()+" "+t.cssClass).trim()}))},o.prototype.setRtl=function(t){h(this.toolbarObj)||this.toolbarObj.setProperties({enableRtl:t.enableRtl})},o.prototype.getClass=function(t){var e;switch(t){case"fontsize":e="e-rte-inline-size-template";break;case"fontcolor":case"backgroundcolor":e="e-rte-inline-color-template";break;default:e="e-rte-inline-template";break}return e},o.prototype.getTemplateObject=function(t,e){var i;switch(t){case"fontcolor":case"backgroundcolor":case"numberformatlist":case"bulletformatlist":i="span";break;default:i="button";break}return{command:this.tools[t.toLocaleLowerCase()].command,subCommand:this.tools[t.toLocaleLowerCase()].subCommand,template:this.parent.createElement(i,{id:this.parent.getID()+"_"+e+"_"+this.tools[t.toLocaleLowerCase()].id}).outerHTML,cssClass:this.parent.inlineMode.enable?this.getClass(t):"",tooltipText:_n(t,this.locator)}},o.prototype.getObject=function(t,e){var i=t.toLowerCase();if(qs.indexOf(i)!==-1)return this.getTemplateObject(i,e);switch(i){case"|":return{type:"Separator"};case"-":return{type:"Separator",cssClass:Ch};default:return this.parent.showTooltip?{id:this.parent.getID()+"_"+e+"_"+this.tools[i.toLocaleLowerCase()].id,prefixIcon:this.tools[i.toLocaleLowerCase()].icon,tooltipText:_n(i,this.locator),command:this.tools[i.toLocaleLowerCase()].command,subCommand:this.tools[i.toLocaleLowerCase()].subCommand}:{id:this.parent.getID()+"_"+e+"_"+this.tools[i.toLocaleLowerCase()].id,prefixIcon:this.tools[i.toLocaleLowerCase()].icon,command:this.tools[i.toLocaleLowerCase()].command,subCommand:this.tools[i.toLocaleLowerCase()].subCommand}}},o.prototype.getItems=function(t,e){var i=this;if(this.parent.toolbarSettings.items.length<1)return[];for(var n=[],r=function(f){switch(typeof f){case"string":n.push(s.getObject(f,e));break;default:if(!h(f.click)){var m=f,v=m.click;m.click=function(){if(m.undo&&i.parent.formatter.getUndoRedoStack().length===0&&i.parent.formatter.saveData(),v.call(i),i.parent.formatter.getUndoRedoStack().length>0){var y=i.parent.createElement("div"),L=i.parent.formatter.getUndoRedoStack()[i.parent.formatter.getUndoRedoStack().length-1],C=L.text.cloneNode(!0);if(y.appendChild(C),y.innerHTML.trim()===i.parent.inputElement.innerHTML.trim())return}m.undo&&i.parent.formatter.saveData()}}n.push(f)}},s=this,a=0,l=t;a<l.length;a++){var c=l[a];r(c)}for(var p=0;p<n.length;p++){var d=n[p].tooltipText,u=void 0;Lr[""+d]?u=D.isDevice&&ie()?Lr[""+d].replace("Ctrl","Cmd"):Lr[""+d]:u=d,u&&(n[p].tooltipText=d!==u?d+" ("+u+")":d)}return n},o.prototype.getToolbarOptions=function(t){return{target:t.target,rteToolbarObj:this,items:this.getItems(t.items,t.container),overflowMode:t.mode,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,cssClass:t.cssClass}},o.prototype.render=function(t){this.toolbarRenderer=this.renderFactory.getRenderer(U.Toolbar),this.toolbarRenderer.renderToolbar(this.getToolbarOptions(t))},o}(),Sa=function(){function o(t,e){this.parent=t,this.locator=e,this.renderFactory=this.locator.getService("rendererFactory"),this.addEventListener()}return o.prototype.initializeInstance=function(){this.toolbarRenderer=this.renderFactory.getRenderer(U.Toolbar)},o.prototype.beforeRender=function(t){var e=t.item;e.cssClass&&x([t.element],e.cssClass),(e.command==="Images"||e.command==="Videos"||e.command==="Audios"||e.command==="Table")&&t.element.setAttribute("title",uc(e.text)),(e.command==="Alignments"||e.subCommand==="JustifyLeft"||e.subCommand==="JustifyRight"||e.subCommand==="JustifyCenter")&&t.element.setAttribute("title",_n(e.subCommand.toLocaleLowerCase(),this.locator)),e.command==="Formats"&&t.element.setAttribute("title",ni(e.subCommand.toLocaleLowerCase(),this.locator,fa)),e.command==="Font"&&t.element.setAttribute("title",ni(e.value.toLocaleLowerCase(),this.locator,ua)),e.subCommand==="BulletFormatList"&&t.element.setAttribute("title",ni(e.value.toLocaleLowerCase(),this.locator,ga)),e.subCommand==="NumberFormatList"&&t.element.setAttribute("title",ni(e.text.replace(/\s/g,"").toLocaleLowerCase(),this.locator,ma)),e.subCommand==="FontSize"&&t.element.setAttribute("title",ni(e.value.toLocaleLowerCase(),null,null,this.parent))},o.prototype.dropdownContent=function(t,e,i){return'<span style="display: inline-flex;width:'+(e==="quick"?"auto":t)+'" ><span class="e-rte-dropdown-btn-text">'+i+"</span></span>"},o.prototype.renderDropDowns=function(t){var e=this;this.initializeInstance();var i=t.containerType,n=t.container;qs.forEach(function(r){var s=void 0;if(Vs(r,t.items)!==-1)switch(r){case"numberformatlist":{if(s=A("#"+e.parent.getID()+"_"+i+"_NumberFormatList",n),h(s)||s.classList.contains(ke))return;var a=e.parent.numberFormatList.types.slice();a.forEach(function(v){Object.defineProperties(v,{command:{value:"Lists",enumerable:!0},subCommand:{value:"NumberFormatList",enumerable:!0}})}),e.numberFormatListDropDown=e.toolbarRenderer.renderListDropDown({cssClass:"e-order-list "+Ce+" "+Un,itemName:"NumberFormatList",items:a,element:s});break}case"bulletformatlist":{if(s=A("#"+e.parent.getID()+"_"+i+"_BulletFormatList",n),h(s)||s.classList.contains(ke))return;var l=e.parent.bulletFormatList.types.slice();l.forEach(function(v){Object.defineProperties(v,{command:{value:"Lists",enumerable:!0},subCommand:{value:"BulletFormatList",enumerable:!0}})}),e.bulletFormatListDropDown=e.toolbarRenderer.renderListDropDown({cssClass:"e-unorder-list "+Ce+" "+Un,itemName:"BulletFormatList",items:l,element:s});break}case"formats":{if(s=A("#"+e.parent.getID()+"_"+i+"_Formats",n),h(s)||s.classList.contains(ke))return;var c=e.parent.format.types.slice();c.forEach(function(v){Object.defineProperties(v,{command:{value:"Formats",enumerable:!0},subCommand:{value:v.value,enumerable:!0}})});var p=h(e.parent.format.default)?c[0].text:e.parent.format.default;e.formatDropDown=e.toolbarRenderer.renderDropDownButton({iconCss:i==="quick"?"e-formats e-icons":"",content:e.dropdownContent(e.parent.format.width,i,i==="quick"?"":it(c,p,"text","text")),cssClass:Ie+" "+Xe+" "+Eh,itemName:"Formats",items:c,element:s});break}case"fontname":{if(s=A("#"+e.parent.getID()+"_"+i+"_FontName",n),h(s)||s.classList.contains(ke))return;var d=e.parent.fontFamily.items.slice();d.forEach(function(v){Object.defineProperties(v,{command:{value:"Font",enumerable:!0},subCommand:{value:"FontName",enumerable:!0}})});var u=h(e.parent.fontFamily.default)?d[0].text:e.parent.fontFamily.default;e.fontNameDropDown=e.toolbarRenderer.renderDropDownButton({iconCss:i==="quick"?"e-font-name e-icons":"",content:e.dropdownContent(e.parent.fontFamily.width,i,i==="quick"?"":it(d,u,"text","text")),cssClass:Ie+" "+Xe+" "+Lh,itemName:"FontName",items:d,element:s}),h(e.parent.fontFamily.default)||(e.getEditNode().style.fontFamily=e.parent.fontFamily.default);break}case"fontsize":{if(s=A("#"+e.parent.getID()+"_"+i+"_FontSize",n),h(s)||s.classList.contains(ke))return;var f=!h(e.fontSizeDropDown)&&!h(e.fontSizeDropDown.items)&&e.fontSizeDropDown.items.length>0?e.fontSizeDropDown.items:JSON.parse(JSON.stringify(e.parent.fontSize.items.slice()));f.forEach(function(v){Object.defineProperties(v,{command:{value:"Font",enumerable:!0},subCommand:{value:"FontSize",enumerable:!0}})});var m=h(e.parent.fontSize.default)?f[1].text:e.parent.fontSize.default;e.fontSizeDropDown=e.toolbarRenderer.renderDropDownButton({content:e.dropdownContent(e.parent.fontSize.width,i,Bs(it(f,m.replace(/\s/g,""),"value","text"))),cssClass:Ie+" "+Xe+" "+wh,itemName:"FontSize",items:f,element:s}),h(e.parent.fontSize.default)||(e.getEditNode().style.fontSize=e.parent.fontSize.default);break}case"alignments":if(s=A("#"+e.parent.getID()+"_"+i+"_Alignments",n),h(s)||s.classList.contains(ke))return;e.alignDropDown=e.toolbarRenderer.renderDropDownButton({iconCss:"e-justify-left e-icons",cssClass:Ie+" "+Xe+" "+kh,itemName:"Alignments",items:yi,element:s});break;case"align":case"videoalign":e.renderAlignmentDropDown(i,n,s,r);break;case"display":case"audiolayoutoption":case"videolayoutoption":e.renderDisplayDropDown(i,n,s,r);break;case"tablerows":e.rowDropDown(i,n,s);break;case"tablecolumns":e.columnDropDown(i,n,s);break;case"tablecell":e.cellDropDown(i,n,s);break;case"tablecellverticalalign":e.verticalAlignDropDown(i,n,s);break;case"styles":e.tableStylesDropDown(i,n,s);break}}),this.parent.inlineMode.enable&&this.setCssClass({cssClass:this.parent.getCssClass()})},o.prototype.getUpdateItems=function(t,e){var i=t.slice();return i.forEach(function(n){Object.defineProperties(n,{command:{value:e==="Format"?"Formats":"Font",enumerable:!0},subCommand:{value:e==="Format"?n.value:e,enumerable:!0}})}),i},o.prototype.onPropertyChanged=function(t){for(var e=t.newProp,i,n,r=0,s=Object.keys(e);r<s.length;r++){var a=s[r];switch(a){case"fontFamily":if(this.fontNameDropDown)for(var l=0,c=Object.keys(e.fontFamily);l<c.length;l++){var p=c[l];switch(p){case"default":case"width":{var d=this.fontNameDropDown.items;i=h(T(this.fontNameDropDown.element,"."+fn))?"toolbar":"quick";var u=h(this.parent.fontFamily.default)?d[0].text:this.parent.fontFamily.default;n=this.dropdownContent(this.parent.fontFamily.width,i,i==="quick"?"":it(d,u,"text","text")),this.fontNameDropDown.setProperties({content:n}),h(this.parent.fontFamily.default)?this.getEditNode().style.removeProperty("font-family"):this.getEditNode().style.fontFamily=this.parent.fontFamily.default;break}case"items":this.fontNameDropDown.setProperties({items:this.getUpdateItems(e.fontFamily.items,"FontName")});break}}break;case"fontSize":if(this.fontSizeDropDown)for(var f=0,m=Object.keys(e.fontSize);f<m.length;f++){var v=m[f];switch(v){case"default":case"width":{var y=this.fontSizeDropDown.items;i=h(T(this.fontSizeDropDown.element,"."+fn))?"toolbar":"quick";var L=h(this.parent.fontSize.default)?y[1].text:this.parent.fontSize.default;n=this.dropdownContent(this.parent.fontSize.width,i,Bs(it(y,L.replace(/\s/g,""),"value","text"))),this.fontSizeDropDown.setProperties({content:n}),h(this.parent.fontSize.default)?this.getEditNode().style.removeProperty("font-size"):this.getEditNode().style.fontSize=this.parent.fontSize.default;break}case"items":this.fontSizeDropDown.setProperties({items:this.getUpdateItems(e.fontSize.items,"FontSize")});break}}break;case"format":if(this.formatDropDown)for(var C=0,w=Object.keys(e.format);C<w.length;C++){var k=w[C];switch(k){case"default":case"width":{var I=this.formatDropDown.items;i=h(T(this.formatDropDown.element,"."+fn))?"toolbar":"quick";var P=h(this.parent.format.default)?I[0].text:this.parent.format.default;n=this.dropdownContent(this.parent.format.width,i,i==="quick"?"":it(I,P,"text","text")),this.formatDropDown.setProperties({content:n});break}case"types":this.formatDropDown.setProperties({items:this.getUpdateItems(e.format.types,"Format")});break}}break}}},o.prototype.getEditNode=function(){return this.parent.contentModule.getEditPanel()},o.prototype.rowDropDown=function(t,e,i){i=A("#"+this.parent.getID()+"_"+t+"_TableRows",e),!i.classList.contains(ke)&&(this.tableRowsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-rows e-icons",cssClass:Ie+" "+Xe+" "+Tt,itemName:"TableRows",items:Cn,element:i}))},o.prototype.columnDropDown=function(t,e,i){i=A("#"+this.parent.getID()+"_"+t+"_TableColumns",e),!i.classList.contains(ke)&&(this.tableColumnsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-columns e-icons",cssClass:Ie+" "+Xe+" "+Tt,itemName:"TableColumns",items:Tn,element:i}))},o.prototype.cellDropDown=function(t,e,i){i=A("#"+this.parent.getID()+"_"+t+"_TableCell",e),!i.classList.contains(ke)&&(this.tableRowsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-cell e-icons",cssClass:Ie+" "+Xe+" "+Tt,itemName:"TableCell",items:Zh,element:i}))},o.prototype.verticalAlignDropDown=function(t,e,i){i=A("#"+this.parent.getID()+"_"+t+"_TableCellVerticalAlign",e),!i.classList.contains(ke)&&(this.tableCellVerticalAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-cell-ver-align e-icons",cssClass:Ie+" "+Xe+" "+Tt,itemName:"TableCellVerticalAlign",items:Sn,element:i}))},o.prototype.renderDisplayDropDown=function(t,e,i,n){i=A("#"+this.parent.getID()+"_"+t+(n==="display"?"_Display":n==="videolayoutoption"?"_VideoLayoutOption":"_AudioLayoutOption"),e),!i.classList.contains(ke)&&(this.displayDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:n==="display"?"e-display e-icons":n==="videolayoutoption"?"e-video-display e-icons":"e-audio-display e-icons",cssClass:Ie+" "+Xe+" "+Tt,itemName:n==="display"?"Display":n==="videolayoutoption"?"VideoLayoutOption":"AudioLayoutOption",items:n==="display"?vn:n==="videolayoutoption"?yn:bn,element:i}))},o.prototype.renderAlignmentDropDown=function(t,e,i,n){i=A("#"+this.parent.getID()+"_"+t+(n==="align"?"_Align":"_VideoAlign"),e),!i.classList.contains(ke)&&(this.imageAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-justify-left e-icons",cssClass:Ie+" "+gr+" "+Tt,itemName:n==="align"?"Align":"VideoAlign",items:n==="align"?Kh:Xh,element:i}))},o.prototype.tableStylesDropDown=function(t,e,i){i=A("#"+this.parent.getID()+"_"+t+"_Styles",e),!i.classList.contains(ke)&&(this.imageAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-style e-icons",cssClass:Ie+" "+gr+" "+Tt,itemName:"Styles",items:this.parent.tableSettings.styles,element:i}))},o.prototype.removeDropDownClasses=function(t){O([t],[ke,Ie,gr,Xe])},o.prototype.destroyDropDowns=function(){this.formatDropDown&&(this.removeDropDownClasses(this.formatDropDown.element),this.formatDropDown.destroy()),this.fontNameDropDown&&(this.removeDropDownClasses(this.fontNameDropDown.element),this.fontNameDropDown.destroy()),this.fontSizeDropDown&&(this.removeDropDownClasses(this.fontSizeDropDown.element),this.fontSizeDropDown.destroy()),this.alignDropDown&&(this.removeDropDownClasses(this.alignDropDown.element),this.alignDropDown.destroy()),this.imageAlignDropDown&&(this.removeDropDownClasses(this.imageAlignDropDown.element),this.imageAlignDropDown.destroy()),this.displayDropDown&&(this.removeDropDownClasses(this.displayDropDown.element),this.displayDropDown.destroy()),this.tableRowsDropDown&&(this.removeDropDownClasses(this.tableRowsDropDown.element),this.tableRowsDropDown.destroy()),this.tableColumnsDropDown&&(this.removeDropDownClasses(this.tableColumnsDropDown.element),this.tableColumnsDropDown.destroy()),this.tableCellVerticalAlignDropDown&&(this.removeDropDownClasses(this.tableCellVerticalAlignDropDown.element),this.tableCellVerticalAlignDropDown.destroy()),this.numberFormatListDropDown&&(this.removeDropDownClasses(this.numberFormatListDropDown.element),this.numberFormatListDropDown.destroy()),this.bulletFormatListDropDown&&(this.removeDropDownClasses(this.bulletFormatListDropDown.element),this.bulletFormatListDropDown.destroy())},o.prototype.setRtl=function(t){this.formatDropDown&&this.formatDropDown.setProperties({enableRtl:t.enableRtl}),this.fontNameDropDown&&this.fontNameDropDown.setProperties({enableRtl:t.enableRtl}),this.fontSizeDropDown&&this.fontSizeDropDown.setProperties({enableRtl:t.enableRtl}),this.alignDropDown&&this.alignDropDown.setProperties({enableRtl:t.enableRtl}),this.imageAlignDropDown&&this.imageAlignDropDown.setProperties({enableRtl:t.enableRtl}),this.displayDropDown&&this.displayDropDown.setProperties({enableRtl:t.enableRtl}),this.numberFormatListDropDown&&this.numberFormatListDropDown.setProperties({enableRtl:t.enableRtl}),this.bulletFormatListDropDown&&this.bulletFormatListDropDown.setProperties({enableRtl:t.enableRtl})},o.prototype.updateCss=function(t,e){t&&e.cssClass&&(h(e.oldCssClass)?t.setProperties({cssClass:(t.cssClass+" "+e.cssClass).trim()}):t.setProperties({cssClass:(t.cssClass.replace(e.oldCssClass,"").trim()+" "+e.cssClass).trim()}))},o.prototype.setCssClass=function(t){for(var e=[this.formatDropDown,this.fontNameDropDown,this.fontSizeDropDown,this.alignDropDown,this.imageAlignDropDown,this.displayDropDown,this.numberFormatListDropDown,this.bulletFormatListDropDown,this.tableRowsDropDown,this.tableColumnsDropDown,this.tableCellVerticalAlignDropDown],i=0;i<e.length;i++)this.updateCss(e[i],t)},o.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(ns,this.beforeRender,this),this.parent.on(pt,this.onIframeMouseDown,this),this.parent.on(dt,this.setRtl,this),this.parent.on(j,this.removeEventListener,this),this.parent.on(be,this.onPropertyChanged,this),this.parent.on(we,this.setCssClass,this))},o.prototype.onIframeMouseDown=function(){this.parent.getToolbarElement().querySelectorAll('.e-rte-dropdown-btn[aria-expanded="true"]').length>0&&Zn(document,"mousedown")},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(pt,this.onIframeMouseDown),this.parent.off(dt,this.setRtl),this.parent.off(ns,this.beforeRender),this.parent.off(j,this.removeEventListener),this.parent.off(be,this.onPropertyChanged),this.parent.off(we,this.setCssClass))},o}(),Ea=function(){function o(){this.services={}}return o.prototype.register=function(t,e){h(this.services[""+t])&&(this.services[""+t]=e)},o.prototype.getService=function(t){if(h(this.services[""+t]))throw"The service "+t+" is not registered";return this.services[""+t]},o}(),La=function(){function o(){this.rendererMap={}}return o.prototype.addRenderer=function(t,e){var i=Qs(U,t);h(this.rendererMap[""+i])&&(this.rendererMap[""+i]=e)},o.prototype.getRenderer=function(t){var e=Qs(U,t);if(h(this.rendererMap[""+e]))throw"The renderer "+e+" is not found";return this.rendererMap[""+e]},o}(),Qc=function(){function o(t){this.parent=t,this.addEventListener(),this.serviceLocator=new Ea,this.serviceLocator.register("rendererFactory",new La)}return o.prototype.addEventListener=function(){this.parent.on(Li,this.toolbarClick,this),this.parent.on(wi,this.dropDownSelect,this),this.parent.on(bi,this.renderSelection,this),this.parent.on(j,this.removeEventListener,this)},o.prototype.toolbarClick=function(t){if(!h(t.item)){if(!h(t.item.controlParent)){var e=t.item.controlParent.activeEle;e&&(e.tabIndex=-1)}(t.item.command==="NumberFormatList"||t.item.command==="BulletFormatList")&&(t.originalEvent.target.classList.contains("e-order-list")||t.originalEvent.target.classList.contains("e-unorder-list"))&&(t.item.command="Lists",t.item.subCommand=t.item.subCommand==="NumberFormatList"?"OL":"UL"),t.item.command==="Lists"&&t.originalEvent.target.classList.contains("e-caret")&&(t.originalEvent.target.parentElement.classList.contains("e-rte-bulletformatlist-dropdown")||t.originalEvent.target.parentElement.classList.contains("e-rte-numberformatlist-dropdown"))&&(t.item.command=t.item.subCommand=null),this.parent.notify(Jr,t),this.parent.notify(Ol,t)}},o.prototype.dropDownSelect=function(t){if(this.parent.notify(rt,{}),!(document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))&&t.item&&(t.item.command==="Images"||t.item.command==="Audios"||t.item.command==="Videos"||t.item.command==="VideoLayoutOption"||t.item.command==="Display"||t.item.command==="Table"))){var e=t.item.controlParent&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.tableQTBar&&this.parent.quickToolbarModule.tableQTBar.element.contains(t.item.controlParent.element)?"Table":null;if(t.item.command==="Lists"){var i={listStyle:t.item.value,listImage:t.item.listImage,type:t.item.subCommand};this.parent.formatter.process(this.parent,t,t.originalEvent,i)}else this.parent.formatter.process(this.parent,t,t.originalEvent,e)}this.parent.notify(nt,{})},o.prototype.renderSelection=function(t){this.parent.notify(rt,{}),this.parent.formatter.process(this.parent,t,t.originalEvent,null),this.parent.notify(nt,{})},o.prototype.removeEventListener=function(){this.parent.off(Li,this.toolbarClick),this.parent.off(wi,this.dropDownSelect),this.parent.off(bi,this.renderSelection),this.parent.off(j,this.removeEventListener)},o}(),Gc=function(){function o(t,e){this.tools={},this.parent=t,this.isToolbar=!1,this.locator=e,this.isTransformChild=!1,this.renderFactory=this.locator.getService("rendererFactory"),lc(this.parent),ya(this.parent),this.renderFactory.addRenderer(U.Toolbar,new Wc(this.parent,this.locator)),this.toolbarRenderer=this.renderFactory.getRenderer(U.Toolbar),this.baseToolbar=new Ta(this.parent,this.locator),this.addEventListener(),this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?ot(this.tools,Xt,Us(this.parent.toolbarSettings.itemConfigs),!0):this.tools=Xt}return o.prototype.initializeInstance=function(){this.contentRenderer=this.renderFactory.getRenderer(U.Content),this.editableElement=this.contentRenderer.getEditPanel(),this.editPanel=this.contentRenderer.getPanel()},o.prototype.toolbarBindEvent=function(){this.parent.inlineMode.enable||(this.keyBoardModule=new Mn(this.getToolbarElement(),{keyAction:this.toolBarKeyDown.bind(this),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"}))},o.prototype.toolBarKeyDown=function(t){switch(t.action){case"escape":this.parent.contentModule.getEditPanel().focus();break;case"enter":t.target.classList.contains("e-hor-nav")&&this.adjustContentHeight(t.target,!0)}},o.prototype.createToolbarElement=function(){this.tbElement=this.parent.createElement("div",{id:this.parent.getID()+"_toolbar"}),!(!D.isDevice&&this.parent.inlineMode.enable&&ie())&&(this.parent.inlineMode.enable?this.parent.element.insertBefore(this.tbElement,this.editPanel):(this.tbWrapper=this.parent.createElement("div",{id:this.parent.getID()+"_toolbar_wrapper",innerHTML:this.tbElement.outerHTML,className:vr}),this.tbElement=this.tbWrapper.firstElementChild,this.parent.element.insertBefore(this.tbWrapper,this.editPanel)))},o.prototype.getToolbarMode=function(){var t;switch(this.parent.toolbarSettings.type){case Le.Expand:t="Extended";break;case Le.Scrollable:t="Scrollable";break;default:t="MultiRow"}return ie()&&this.parent.toolbarSettings.type===Le.Expand&&(t=Le.Scrollable),t},o.prototype.checkToolbarResponsive=function(t){if(!D.isDevice||ie())return!1;var e;return this.parent.toolbarSettings.type===Le.Expand?e=Le.MultiRow:e=this.parent.toolbarSettings.type,this.baseToolbar.render({container:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items,mode:e,target:t,cssClass:this.parent.getCssClass()}),this.parent.toolbarSettings.type===Le.Expand&&(x([t],["e-rte-tb-mobile"]),this.parent.inlineMode.enable?this.addFixedTBarClass():x([t],[fh])),this.wireEvents(),this.dropDownModule.renderDropDowns({container:t,containerType:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items}),this.parent.notify(Hn,{container:this.tbElement,containerType:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items}),!0},o.prototype.checkIsTransformChild=function(){this.isTransformChild=!1;for(var t=Te('[style*="transform"]',document),e=0;e<t.length;e++)if(!h(t[e].contains)&&t[e].contains(this.parent.element)){this.isTransformChild=!0;break}},o.prototype.toggleFloatClass=function(t){var e,i=!1,n=!1,r,s=this.parent.floatingToolbarOffset;t&&this.parent.iframeSettings.enable&&this.parent.inputElement.ownerDocument===t.target?r=t.target.body:t&&t.target!==document?r=t.target:(i=!0,r=document.body);var a=this.getToolbarHeight()+this.getExpandTBarPopHeight();if(this.isTransformChild){e=0;var l=0,c=this.parent.element.offsetHeight;if(i){var p=window.getComputedStyle(r);l=parseFloat(p.marginTop.split("px")[0])+parseFloat(p.paddingTop.split("px")[0])}var d=this.parent.element.getBoundingClientRect().top,u=D.isMSPointer&&i?window.pageYOffset:r.parentElement.scrollTop,f=r.getBoundingClientRect(),m=i?f.top+u:f.top,v=!(d-(i?0:m)+c>a+s);d>m+s||d<-c||d<0&&v?(n=!1,O([this.tbElement],[ks])):d<m+s&&(d<0?e=-d+m:e=m-d,e=i?e-l:e,x([this.tbElement],[ks]),n=!0)}else{var y=this.parent.element.getBoundingClientRect();if(window.innerHeight<y.top)return;e=t&&t.target!==document?r.getBoundingClientRect().top:0,y.bottom<s+a+e||y.bottom<0||y.top>s+e?n=!1:(y.top<s||y.top<s+e)&&(n=!0)}n?(x([this.tbElement],[ws]),Q(this.tbElement,{width:this.parent.element.offsetWidth+"px",top:s+e+"px"})):(O([this.tbElement],[ws]),Q(this.tbElement,{top:"0px",width:"100%"}))},o.prototype.renderToolbar=function(){if(this.initializeInstance(),this.createToolbarElement(),!this.checkToolbarResponsive(this.tbElement)){this.parent.inlineMode.enable?this.parent.notify(ds,{}):(this.baseToolbar.render({container:"toolbar",items:this.parent.toolbarSettings.items,mode:this.getToolbarMode(),target:this.tbElement,cssClass:this.parent.getCssClass()}),this.parent.inlineMode.enable||(this.parent.toolbarSettings.enableFloating&&(this.checkIsTransformChild(),this.toggleFloatClass()),x([this.parent.element],[To]),this.parent.toolbarSettings.type===Le.Expand&&x([this.parent.element],[oo]))),this.wireEvents(),this.parent.inlineMode.enable&&!ie()&&this.addFixedTBarClass(),this.parent.inlineMode.enable||(this.dropDownModule.renderDropDowns({container:this.tbElement,containerType:"toolbar",items:this.parent.toolbarSettings.items}),this.parent.notify(Hn,{container:this.tbElement,containerType:"toolbar",items:this.parent.toolbarSettings.items}),this.refreshToolbarOverflow());var t=this.parent.element.querySelector("."+bt),e=this.parent.element.querySelector(".e-source-content");(!this.parent.iframeSettings.enable&&!h(t)&&t.style.display==="block"||this.parent.iframeSettings.enable&&!h(e)&&e.style.display==="block")&&(this.parent.notify(vi,{targetItem:"SourceCode",updateItem:"Preview",baseToolbar:this.parent.getBaseToolbarObject()}),this.parent.disableToolbarItem(this.parent.toolbarSettings.items))}},o.prototype.addFixedTBarClass=function(){x([this.tbElement],[so])},o.prototype.removeFixedTBarClass=function(){O([this.tbElement],[so])},o.prototype.showFixedTBar=function(){x([this.tbElement],[ho]),D.isIos&&x([this.tbElement],[vo])},o.prototype.hideFixedTBar=function(){this.isToolbar?this.isToolbar=!1:O([this.tbElement],[ho,vo])},o.prototype.updateItem=function(t){var e=this.tools[t.updateItem.toLocaleLowerCase()];this.parent.locale!=="en-US"&&(e.tooltip=_n(t.updateItem.toLocaleLowerCase(),this.locator));var i=this.tools[t.targetItem.toLocaleLowerCase()],n=Bn(Dn(i.subCommand),t.baseToolbar.toolbarObj.items)[0];if(h(n))this.addTBarItem(t,0);else{var r=this.parent.inlineMode.enable?"_quick_":"_toolbar_";t.baseToolbar.toolbarObj.items[n].id=this.parent.getID()+r+e.id,t.baseToolbar.toolbarObj.items[n].prefixIcon=e.icon,t.baseToolbar.toolbarObj.items[n].tooltipText=e.tooltip,t.baseToolbar.toolbarObj.items[n].subCommand=e.subCommand,t.baseToolbar.toolbarObj.dataBind(),t.baseToolbar.toolbarObj.refreshOverflow()}},o.prototype.updateToolbarStatus=function(t){if(!(!this.tbElement||this.parent.inlineMode.enable&&(ie()||!D.isDevice))){var e={args:t,dropDownModule:this.dropDownModule,parent:this.parent,tbElements:Te("."+gt,this.tbElement),tbItems:this.baseToolbar.toolbarObj.items};Os(e,!!this.parent.inlineMode.enable,this.parent)}},o.prototype.fullScreen=function(t){this.parent.fullScreenModule.showFullScreen(t)},o.prototype.hideScreen=function(t){this.parent.fullScreenModule.hideFullScreen(t)},o.prototype.getBaseToolbar=function(){return this.baseToolbar},o.prototype.addTBarItem=function(t,e){t.baseToolbar.toolbarObj.addItems([t.baseToolbar.getObject(t.updateItem,"toolbar")],e)},o.prototype.enableTBarItems=function(t,e,i,n){var r=Bn(Dn(e),t.toolbarObj.items);this.tbItems=Te("."+gt,t.toolbarObj.element);for(var s=0;s<r.length;s++){var a=this.tbItems[r[s]];a&&t.toolbarObj.enableItems(a,i)}!A("."+bt,this.parent.element)&&!n&&Yt(t,this.parent.formatter.editorManager.undoRedoManager.getUndoStatus())},o.prototype.removeTBarItems=function(t){h(this.baseToolbar.toolbarObj)&&(this.baseToolbar=this.parent.getBaseToolbarObject());var e=Bn(Dn(t),this.baseToolbar.toolbarObj.items);this.tbItems=this.parent.inlineMode.enable?Te("."+gt,this.baseToolbar.toolbarObj.element):Te("."+gt,this.parent.element);for(var i=0;i<e.length;i++)this.baseToolbar.toolbarObj.removeItems(this.tbItems[e[i]])},o.prototype.getExpandTBarPopHeight=function(){var t=0;if(this.parent.toolbarSettings.type===Le.Expand&&this.tbElement.classList.contains("e-extended-toolbar")){var e=A(".e-toolbar-extended",this.tbElement);e&&this.tbElement.classList.contains("e-expand-open")||e&&e.classList.contains("e-popup-open")?(x([e],[co]),t=t+e.offsetHeight,O([e],[co])):O([this.tbElement],[Dt])}return t},o.prototype.getToolbarHeight=function(){return this.tbElement.offsetHeight},o.prototype.getToolbarElement=function(){return A("."+un,this.parent.element)},o.prototype.refreshToolbarOverflow=function(){this.parent.element.classList.remove(wt),this.baseToolbar.toolbarObj.refreshOverflow(),this.parent.enableRtl&&this.parent.element.classList.add(wt)},o.prototype.isToolbarDestroyed=function(){return this.baseToolbar.toolbarObj&&!this.baseToolbar.toolbarObj.isDestroyed},o.prototype.destroyToolbar=function(){if(this.isToolbarDestroyed()){this.parent.unWireScrollElementsEvents(),this.unWireEvents(),this.parent.notify(Zr,{}),this.dropDownModule.destroyDropDowns(),this.baseToolbar.toolbarObj.destroy(),this.removeEventListener(),O([this.parent.element],[To]),O([this.parent.element],[oo]);var t=A("."+vr,this.parent.element),e=A("."+un,this.parent.element);h(t)?h(e)||S(e):S(t)}},o.prototype.destroy=function(){h(this.parent)||this.isToolbarDestroyed()&&(this.destroyToolbar(),this.keyBoardModule&&this.keyBoardModule.destroy())},o.prototype.moduleDestroy=function(){this.parent=null,this.baseToolbar.parent=null,this.toolbarActionModule.parent=null,this.dropDownModule.parent=null},o.prototype.scrollHandler=function(t){this.parent.inlineMode.enable||this.parent.toolbarSettings.enableFloating&&this.getDOMVisibility(this.tbElement)&&this.toggleFloatClass(t.args)},o.prototype.getDOMVisibility=function(t){return!(!t.offsetParent&&t.offsetWidth===0&&t.offsetHeight===0)},o.prototype.mouseDownHandler=function(){D.isDevice&&this.parent.inlineMode.enable&&!ie()&&this.showFixedTBar()},o.prototype.focusChangeHandler=function(){D.isDevice&&this.parent.inlineMode.enable&&!ie()&&(this.isToolbar=!1,this.hideFixedTBar())},o.prototype.dropDownBeforeOpenHandler=function(){this.isToolbar=!0},o.prototype.tbFocusHandler=function(t){var e=document.activeElement,i=T(e,".e-rte-toolbar");if(e===this.parent.getToolbarElement()||i===this.parent.getToolbarElement())for(var n=this.parent.getToolbarElement().querySelectorAll(".e-expended-nav"),r=0;r<n.length;r++)h(this.parent.getToolbarElement().querySelector(".e-insert-table-btn"))?n[r].setAttribute("tabindex","0"):n[r].setAttribute("tabindex","1")},o.prototype.toolbarClickHandler=function(t){var e=T(t.originalEvent.target,".e-hor-nav");this.adjustContentHeight(e,!1)},o.prototype.adjustContentHeight=function(t,e){if(t&&this.parent.toolbarSettings.type===Le.Expand&&!h(t)){var i=this.tbElement.querySelector(".e-toolbar-extended");h(i)||(Q(i,{maxHeight:"",display:"block"}),Q(i,{maxHeight:i.offsetHeight+"px",display:""}));var n=t.classList.contains("e-nav-active"),r=e?!n:!!n;r?x([this.tbElement],[Dt]):O([this.tbElement],[Dt]),this.parent.setContentHeight("toolbar",r)}else(D.isDevice||this.parent.inlineMode.enable)&&(this.isToolbar=!0);h(t)&&this.parent.toolbarSettings.type===Le.Expand&&O([this.tbElement],[Dt])},o.prototype.wireEvents=function(){this.parent.inlineMode.enable&&ie()||b.add(this.tbElement,"focusin",this.tbFocusHandler,this)},o.prototype.unWireEvents=function(){b.remove(this.tbElement,"focusin",this.tbFocusHandler)},o.prototype.addEventListener=function(){this.parent.isDestroyed||(this.dropDownModule=new Sa(this.parent,this.locator),this.toolbarActionModule=new Qc(this.parent),this.parent.on(Me,this.renderToolbar,this),this.parent.on(xt,this.scrollHandler,this),this.parent.on($r,this.toolbarBindEvent,this),this.parent.on(ct,this.updateToolbarStatus,this),this.parent.on(be,this.onPropertyChanged,this),this.parent.on(In,this.onRefresh,this),this.parent.on(j,this.destroy,this),this.parent.on(ts,this.fullScreen,this),this.parent.on(is,this.hideScreen,this),this.parent.on(vi,this.updateItem,this),this.parent.on(Fn,this.dropDownBeforeOpenHandler,this),this.parent.on(Ks,this.parent.setContentHeight,this.parent),this.parent.on(Bi,this.focusChangeHandler,this),this.parent.on(_e,this.mouseDownHandler,this),this.parent.on(Di,this.mouseDownHandler,this),this.parent.on(we,this.setCssClass,this),this.parent.on(fe,this.moduleDestroy,this),!this.parent.inlineMode.enable&&!ie()&&this.parent.on(Li,this.toolbarClickHandler,this))},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Me,this.renderToolbar),this.parent.off(xt,this.scrollHandler),this.parent.off($r,this.toolbarBindEvent),this.parent.off(ct,this.updateToolbarStatus),this.parent.off(be,this.onPropertyChanged),this.parent.off(In,this.onRefresh),this.parent.off(j,this.destroy),this.parent.off(ts,this.parent.fullScreenModule.showFullScreen),this.parent.off(is,this.parent.fullScreenModule.hideFullScreen),this.parent.off(vi,this.updateItem),this.parent.off(Fn,this.dropDownBeforeOpenHandler),this.parent.off(Ks,this.parent.setContentHeight),this.parent.off(Bi,this.focusChangeHandler),this.parent.off(_e,this.mouseDownHandler),this.parent.off(Di,this.mouseDownHandler),this.parent.off(we,this.setCssClass),this.parent.off(fe,this.moduleDestroy),!this.parent.inlineMode.enable&&!ie()&&this.parent.off(Li,this.toolbarClickHandler))},o.prototype.setCssClass=function(t){this.toolbarObj&&t.cssClass&&(h(t.oldCssClass)?this.toolbarObj.setProperties({cssClass:(this.toolbarObj.cssClass+" "+t.cssClass).trim()}):this.toolbarObj.setProperties({cssClass:(this.toolbarObj.cssClass.replace(t.oldCssClass,"").trim()+" "+t.cssClass).trim()}))},o.prototype.onRefresh=function(){this.parent.inlineMode.enable||this.refreshToolbarOverflow(),this.parent.setContentHeight("",!0)},o.prototype.onPropertyChanged=function(t){if(!h(t.newProp.inlineMode))for(var e=0,i=Object.keys(t.newProp.inlineMode);e<i.length;e++){var n=i[e];switch(n){case"enable":this.refreshToolbar();break}}t.module===this.getModuleName()&&this.refreshToolbar()},o.prototype.refreshToolbar=function(){h(this.baseToolbar.toolbarObj)&&(this.baseToolbar=this.parent.getBaseToolbarObject());var t=A("."+vr,this.parent.element),e=A("."+un,this.parent.element);(e||t)&&this.destroyToolbar(),this.parent.toolbarSettings.enable&&(this.addEventListener(),this.renderToolbar(),this.parent.wireScrollElementsEvents(),A("."+bt,this.parent.element)||Yt(this.baseToolbar,this.parent.formatter.editorManager.undoRedoManager.getUndoStatus()),this.parent.notify(vs,{}))},o.prototype.getModuleName=function(){return"toolbar"},o}(),Kc=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),tn=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},Xc={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,space:32,escape:27,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,delete:46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,plus:187,comma:188,minus:189,dot:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222,"]":221,"[":219,"=":187,"<":188,">":190},Rs=function(o){Kc(t,o);function t(i,n){var r=o.call(this,n,i)||this;return r.keyPressHandler=function(s){for(var a=s.altKey,l=s.ctrlKey,c=s.shiftKey,p=s.metaKey,d=s.which,u=Object.keys(r.keyConfigs),f=0,m=u;f<m.length;f++)for(var v=m[f],y=r.keyConfigs[""+v].split(","),L=0,C=y;L<C.length;L++){var w=C[L],k=e.getKeyConfigData(w.trim());a===k.altKey&&(l===k.ctrlKey||p)&&c===k.shiftKey&&d===k.keyCode&&(s.action=v)}r.keyAction&&r.keyAction(s)},r.bind(),r}e=t,t.prototype.destroy=function(){this.unwireEvents(),o.prototype.destroy.call(this)},t.prototype.onPropertyChanged=function(i,n){},t.prototype.bind=function(){this.wireEvents()},t.prototype.getModuleName=function(){return"keyboard"},t.prototype.wireEvents=function(){this.element.addEventListener(this.eventName,this.keyPressHandler)},t.prototype.unwireEvents=function(){this.element.removeEventListener(this.eventName,this.keyPressHandler)},t.getKeyConfigData=function(i){if(i in this.configCache)return this.configCache[""+i];var n=i.toLowerCase().split("+"),r={altKey:n.indexOf("alt")!==-1,ctrlKey:n.indexOf("ctrl")!==-1,shiftKey:n.indexOf("shift")!==-1,keyCode:null};return n[n.length-1].length>1&&Number(n[n.length-1])?r.keyCode=Number(n[n.length-1]):r.keyCode=e.getKeyCode(n[n.length-1]),e.configCache[""+i]=r,r},t.getKeyCode=function(i){return Xc[""+i]||i.toUpperCase().charCodeAt(0)};var e;return t.configCache={},tn([g({})],t.prototype,"keyConfigs",void 0),tn([g("keyup")],t.prototype,"eventName",void 0),tn([N()],t.prototype,"keyAction",void 0),t=e=tn([Ct],t),t}(ol),wa=function(){function o(t,e){this.tools={},this.parent=t,this.locator=e,this.renderFactory=this.locator.getService("rendererFactory"),this.addEventListener(),this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?ot(this.tools,Xt,Us(this.parent.toolbarSettings.itemConfigs),!0):this.tools=Xt}return o.prototype.initializeInstance=function(){this.toolbarRenderer=this.renderFactory.getRenderer(U.Toolbar)},o.prototype.renderColorPickerInput=function(t){var e=this;this.initializeInstance();var i=t.containerType,n=t.container,r,s;qs.forEach(function(a){if(Vs(a,t.items)!==-1)switch(a){case"fontcolor":{r=e.parent.getID()+"_"+i+"_FontColor_Target";var l=e.parent.createElement("input");if(l.id=r,l.classList.add(xh),!h(e.parent.cssClass))for(var c=e.parent.cssClass.split(" "),p=0;p<c.length;p++)c[p].trim()!==""&&l.classList.add(c[p]);document.body.appendChild(l),s={cssClass:e.tools[a.toLocaleLowerCase()].icon+" "+Ce+" "+Un+e.parent.getCssClass(!0),value:e.tools[a.toLocaleLowerCase()].value,command:e.tools[a.toLocaleLowerCase()].command,subCommand:e.tools[a.toLocaleLowerCase()].subCommand,element:A("#"+e.parent.getID()+"_"+i+"_FontColor",n),target:r},e.fontColorPicker=e.toolbarRenderer.renderColorPicker(s,"fontcolor"),e.fontColorDropDown=e.toolbarRenderer.renderColorPickerDropDown(s,"fontcolor",e.fontColorPicker);break}case"backgroundcolor":{r=e.parent.getID()+"_"+i+"_BackgroundColor_Target";var d=e.parent.createElement("input");if(d.id=r,d.classList.add(Dh),!h(e.parent.cssClass))for(var c=e.parent.cssClass.split(" "),p=0;p<c.length;p++)c[p].trim()!==""&&d.classList.add(c[p]);document.body.appendChild(d),s={cssClass:e.tools[a.toLocaleLowerCase()].icon+" "+Ce+" "+Un+e.parent.getCssClass(!0),value:e.tools[a.toLocaleLowerCase()].value,command:e.tools[a.toLocaleLowerCase()].command,subCommand:e.tools[a.toLocaleLowerCase()].subCommand,element:A("#"+e.parent.getID()+"_"+i+"_BackgroundColor",n),target:r},e.backgroundColorPicker=e.toolbarRenderer.renderColorPicker(s,"backgroundcolor"),e.backgroundColorDropDown=e.toolbarRenderer.renderColorPickerDropDown(s,"backgroundcolor",e.backgroundColorPicker,e.defaultColorPicker);break}}}),this.parent.inlineMode.enable&&this.setCssClass({cssClass:this.parent.getCssClass()})},o.prototype.destroy=function(){this.removeEventListener(),this.destroyColorPicker()},o.prototype.destroyColorPicker=function(){if(this.fontColorPicker&&!this.fontColorPicker.isDestroyed&&this.fontColorPicker.destroy(),this.backgroundColorPicker&&!this.backgroundColorPicker.isDestroyed&&this.backgroundColorPicker.destroy(),this.fontColorDropDown&&!this.fontColorDropDown.isDestroyed){var t=this.fontColorDropDown.element.querySelector(".e-rte-color-content");t&&S(t),this.fontColorDropDown.destroy()}if(this.backgroundColorDropDown&&!this.backgroundColorDropDown.isDestroyed){var t=this.backgroundColorDropDown.element.querySelector(".e-rte-color-content");t&&(this.defaultColorPicker=t.children[0].style.borderBottomColor,S(t)),this.backgroundColorDropDown.destroy()}},o.prototype.setRtl=function(t){this.fontColorPicker&&(this.fontColorPicker.setProperties({enableRtl:t.enableRtl}),this.fontColorDropDown.setProperties({enableRtl:t.enableRtl})),this.backgroundColorPicker&&(this.backgroundColorPicker.setProperties({enableRtl:t.enableRtl}),this.backgroundColorDropDown.setProperties({enableRtl:t.enableRtl}))},o.prototype.setCssClass=function(t){this.updateCss(this.fontColorPicker,this.fontColorDropDown,t),this.updateCss(this.backgroundColorPicker,this.backgroundColorDropDown,t)},o.prototype.updateCss=function(t,e,i){t&&i.cssClass&&(h(i.oldCssClass)?(t.setProperties({cssClass:(t.cssClass+" "+i.cssClass).trim()}),e.setProperties({cssClass:(e.cssClass+" "+i.cssClass).trim()})):(t.setProperties({cssClass:(t.cssClass.replace(i.oldCssClass,"").replace("  "," ").trim()+" "+i.cssClass).trim()}),e.setProperties({cssClass:(e.cssClass.replace(i.oldCssClass,"").replace("  "," ").trim()+" "+i.cssClass).trim()})))},o.prototype.addEventListener=function(){this.parent.on(Gs,this.renderColorPickerInput,this),this.parent.on(dt,this.setRtl,this),this.parent.on(j,this.destroy,this),this.parent.on(Zr,this.destroyColorPicker,this),this.parent.on(be,this.onPropertyChanged,this),this.parent.on(we,this.setCssClass,this)},o.prototype.onPropertyChanged=function(t){for(var e=t.newProp,i,n=0,r=Object.keys(e);n<r.length;n++){var s=r[n];switch(s){case"fontColor":if(this.fontColorPicker)for(var a=0,l=Object.keys(e.fontColor);a<l.length;a++){var c=l[a];switch(c){case"default":{this.fontColorPicker.setProperties({value:e.fontColor.default}),i=this.fontColorDropDown.element;var p=i.querySelector("."+this.tools.fontcolor.icon);p.style.borderBottomColor=e.fontColor.default;break}case"mode":this.fontColorPicker.setProperties({mode:e.fontColor.mode});break;case"columns":this.fontColorPicker.setProperties({columns:e.fontColor.columns});break;case"colorCode":this.fontColorPicker.setProperties({presetColors:e.fontColor.colorCode});break;case"modeSwitcher":this.fontColorPicker.setProperties({modeSwitcher:e.fontColor.modeSwitcher});break}}break;case"backgroundColor":if(this.backgroundColorPicker)for(var d=0,u=Object.keys(e.backgroundColor);d<u.length;d++){var f=u[d];switch(f){case"default":{this.backgroundColorPicker.setProperties({value:e.backgroundColor.default}),i=this.backgroundColorDropDown.element;var m=i.querySelector("."+this.tools.backgroundcolor.icon);m.style.borderBottomColor=e.backgroundColor.default;break}case"mode":this.backgroundColorPicker.setProperties({mode:e.backgroundColor.mode});break;case"columns":this.backgroundColorPicker.setProperties({columns:e.backgroundColor.columns});break;case"colorCode":this.backgroundColorPicker.setProperties({presetColors:e.backgroundColor.colorCode});break;case"modeSwitcher":this.backgroundColorPicker.setProperties({modeSwitcher:e.backgroundColor.modeSwitcher});break}}break}}},o.prototype.removeEventListener=function(){this.parent.off(Gs,this.renderColorPickerInput),this.parent.off(j,this.destroy),this.parent.off(dt,this.setRtl),this.parent.off(Zr,this.destroyColorPicker),this.parent.off(be,this.onPropertyChanged),this.parent.off(we,this.setCssClass)},o}(),Yc=function(){function o(t,e){this.parent=t,this.locator=e,this.isDOMElement=!1,this.renderFactory=this.locator.getService("rendererFactory"),this.contentRenderer=this.renderFactory.getRenderer(U.Content),this.popupRenderer=this.renderFactory.getRenderer(U.Popup),this.dropDownButtons=new Sa(this.parent,this.locator),this.colorPickerObj=new wa(this.parent,this.locator)}return o.prototype.appendPopupContent=function(){this.toolbarElement=this.parent.createElement("div",{className:fn}),this.element.classList.contains(lo)&&this.toolbarElement.classList.add(uh),this.element.appendChild(this.toolbarElement)},o.prototype.render=function(t){var e;t.popupType==="Image"?e=gh:t.popupType==="Inline"?e=di:t.popupType==="Text"?e=lo:e="";var i=st(t.popupType+"_Quick_Popup");this.stringItems=t.toolbarItems,this.element=this.parent.createElement("div",{id:i,className:e+" "+Ce}),this.element.setAttribute("aria-owns",this.parent.getID()),this.appendPopupContent(),this.createToolbar(t.toolbarItems,t.mode,t.cssClass),this.popupRenderer.renderPopup(this),this.addEventListener()},o.prototype.createToolbar=function(t,e,i){this.quickTBarObj=new Ta(this.parent,this.locator),this.quickTBarObj.render({container:"quick",target:this.toolbarElement,items:t,mode:e,cssClass:i}),this.quickTBarObj.toolbarObj.refresh()},o.prototype.setPosition=function(t){var e,i,n=T(t.target,".e-img-caption"),r=!(t.target.classList.contains("e-imginline")||t.target.classList.contains("e-imgbreak")),s=h(n)?t.target:n;x([this.toolbarElement],[po]);var a=s.offsetTop,l=window.pageYOffset+t.parentData.top;a-t.editTop>t.popHeight?i=l+t.tBarElementHeight+(a-t.editTop)-t.popHeight-5:t.editTop+t.editHeight-(a+s.offsetHeight)>t.popHeight?i=l+t.tBarElementHeight+(a-t.editTop)+s.offsetHeight+5:i=t.y,s=r?t.target:s,s.offsetWidth>t.popWidth?e=s.offsetWidth/2-t.popWidth/2+t.parentData.left+s.offsetLeft:e=t.parentData.left+s.offsetLeft,this.popupObj.position.X=e+t.popWidth>t.parentData.right?t.parentData.right-t.popWidth:e,this.popupObj.position.Y=i>=0?i:t.y+5,this.popupObj.dataBind(),O([this.toolbarElement],[po])},o.prototype.checkCollision=function(t,e,i){var n,r,s=t.parentData.top,a=t.windowY+s+t.tBarElementHeight,l=[];e==="document"?l=Kr(t.popup):l=Kr(t.popup,t.parentElement);for(var c=0;c<l.length;c++)switch(l[c]){case"top":e==="document"?r=t.windowY:r=window.pageYOffset+s+t.tBarElementHeight;break;case"bottom":{var p=void 0;e==="document"?i==="inline"||i==="text"?p=t.y-t.popHeight-10:t.windowHeight-(s+t.tBarElementHeight)>t.popHeight?a-t.windowHeight>t.popHeight?p=a+(t.windowHeight-s)-t.popHeight:p=a:p=t.windowY+(s+t.tBarElementHeight):t.target.tagName!=="IMG"?p=t.parentData.bottom+window.pageYOffset-t.popHeight-10:p=t.parentData.bottom+window.pageYOffset-t.popHeight-5,r=p;break}case"right":i==="inline"||i==="text"?n=window.pageXOffset+(t.windowWidth-(t.popWidth+t.bodyRightSpace+10)):n=t.x-t.popWidth;break;case"left":i==="inline"||i==="text"?n=0:n=t.parentData.left;break}this.popupObj.position.X=n||this.popupObj.position.X,this.popupObj.position.Y=r||this.popupObj.position.Y,this.popupObj.dataBind()},o.prototype.showPopup=function(t,e,i,n){var r=this,s={popup:this.popupObj,cancel:!1,targetElement:i,positionX:t,positionY:e};this.parent.trigger(Xl,s,function(a){if(!a.cancel){var l=void 0,c=void 0,p=window.getComputedStyle(document.body),d=parseFloat(p.marginRight.split("px")[0])+parseFloat(p.paddingRight.split("px")[0]),u=window.innerHeight,f=window.innerWidth,m=r.parent.element,v=!h(r.parent.getToolbar()),y=v&&r.parent.toolbarModule.getToolbarHeight(),L=v&&r.parent.toolbarModule.getExpandTBarPopHeight(),C=v?y+L:0;if(x([r.element],[ui]),D.isDevice&&!ie()&&x([r.parent.getToolbar()],[ui]),r.parent.iframeSettings.enable){var w=r.contentRenderer.getPanel().contentWindow;l=w.pageYOffset,c=w.innerHeight}else{var w=T(i,"."+pa);l=w?w.scrollTop:0,c=w?w.offsetHeight:0}(!r.parent.inlineMode.enable&&!T(i,"table")&&n!=="text"&&n!=="link"||i.tagName==="IMG")&&(r.parent.disableToolbarItem(r.parent.toolbarSettings.items),r.parent.enableToolbarItem(["Undo","Redo"])),ve([r.element],document.body),r.parent.showTooltip&&(r.tooltip=new Qt({target:"#"+r.element.id+" [title]",openDelay:400,showTipPointer:!0,windowCollision:!0,position:"BottomCenter"}),r.tooltip.appendTo(r.element)),r.popupObj.position.X=a.positionX+20,r.popupObj.position.Y=a.positionY+20,r.popupObj.dataBind(),r.popupObj.element.classList.add("e-popup-open"),r.dropDownButtons.renderDropDowns({container:r.toolbarElement,containerType:"quick",items:r.stringItems}),r.colorPickerObj.renderColorPickerInput({container:r.toolbarElement,containerType:"quick",items:r.stringItems});var k={x:t,y:e,target:i,editTop:l,editHeight:c,popup:r.popupObj.element,popHeight:r.popupObj.element.offsetHeight,popWidth:r.popupObj.element.offsetWidth,parentElement:m,bodyRightSpace:d,windowY:window.pageYOffset,windowHeight:u,windowWidth:f,parentData:m.getBoundingClientRect(),tBarElementHeight:C};(i.tagName==="IMG"||i.tagName==="AUDIO"||i.tagName==="VIDEO"||i.tagName==="IFRAME"||i.classList&&(i.classList.contains(mn)||i.classList.contains(fi)||i.classList.contains(da)))&&r.setPosition(k),r.parent.inlineMode.enable||r.checkCollision(k,"parent",""),r.checkCollision(k,"document",r.parent.inlineMode.enable?"inline":n==="text"?"text":""),r.popupObj.element.classList.remove("e-popup-open"),O([r.element],[ui]),r.popupObj.show({name:"ZoomIn",duration:D.isIE?250:400}),r.popupObj&&r.parent.cssClass&&(O([r.popupObj.element],r.parent.cssClass),x([r.popupObj.element],r.parent.cssClass)),Q(r.element,{maxWidth:window.outerWidth+"px"}),x([r.element],[ao]),r.isDOMElement=!0}})},o.prototype.hidePopup=function(){var t=this.parent.sourceCodeModule.getViewPanel();if(D.isDevice&&!ie()&&O([this.parent.getToolbar()],[ui]),h(document.querySelector(".e-tooltip-wrap")))h(this.tooltip)||this.tooltip.destroy();else{if(!h(document.querySelector("#"+this.element.id+" [data-tooltip-id]"))){var e=document.querySelector("#"+this.element.id+" [data-tooltip-id]"),i=e.getAttribute("data-content");e.removeAttribute("data-content"),e.setAttribute("title",i),e.removeAttribute("data-tooltip-id")}this.tooltip.destroy()}!h(this.parent.getToolbar())&&!this.parent.inlineMode.enable&&(h(t)||t.style.display==="none")&&this.parent.enableToolbarItem(this.parent.toolbarSettings.items),this.parent.showTooltip&&!h(document.querySelector(".e-tooltip-wrap"))&&this.parent.notify(Mi,{args:event}),this.removeEleFromDOM(),this.isDOMElement=!1},o.prototype.addQTBarItem=function(t,e){this.quickTBarObj.toolbarObj.addItems(this.quickTBarObj.getItems(t,"toolbar"),e)},o.prototype.removeQTBarItem=function(t){this.quickTBarObj.toolbarObj.removeItems(t)},o.prototype.removeEleFromDOM=function(){var t=this.popupObj.element;if(this.isDOMElement){this.dropDownButtons.destroyDropDowns(),this.colorPickerObj.destroyColorPicker(),O([this.element],[ao]),S(t);var e=this.popupObj;this.parent.trigger($l,e)}},o.prototype.updateStatus=function(t){var e={args:t,dropDownModule:this.dropDownButtons,parent:this.parent,tbElements:Te("."+gt,this.element),tbItems:this.quickTBarObj.toolbarObj.items};if(Os(e,!0,this.parent),this.parent.quickToolbarSettings.text&&this.parent.quickToolbarModule.textQTBar){var i={args:t,dropDownModule:this.parent.quickToolbarModule.textQTBar.dropDownButtons,parent:this.parent,tbElements:Te("."+gt,this.parent.quickToolbarModule.textQTBar.element),tbItems:this.parent.quickToolbarModule.textQTBar.quickTBarObj.toolbarObj.items};Os(i,!0,this.parent),Yt(this.parent.quickToolbarModule.textQTBar.quickTBarObj,this.parent.formatter.editorManager.undoRedoManager.getUndoStatus())}A("."+bt,this.parent.element)||Yt(this.parent.getBaseToolbarObject(),this.parent.formatter.editorManager.undoRedoManager.getUndoStatus())},o.prototype.destroy=function(){this.popupObj&&!this.popupObj.isDestroyed&&(this.popupObj.destroy(),this.removeEleFromDOM()),this.removeEventListener()},o.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(j,this.destroy,this),this.parent.on(be,this.onPropertyChanged,this),(this.parent.inlineMode.enable||this.parent.quickToolbarSettings.text)&&this.parent.on(ct,this.updateStatus,this))},o.prototype.onPropertyChanged=function(t){if(!h(t.newProp.inlineMode))for(var e=0,i=Object.keys(t.newProp.inlineMode);e<i.length;e++){var n=i[e];switch(n){case"enable":t.newProp.inlineMode.enable?this.parent.on(ct,this.updateStatus,this):this.parent.off(ct,this.updateStatus);break}}},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(j,this.destroy),this.parent.off(be,this.onPropertyChanged),(this.parent.inlineMode.enable||this.parent.quickToolbarSettings.text)&&this.parent.off(ct,this.updateStatus))},o}(),$c=function(){function o(t){this.parent=t}return o.prototype.quickToolbarOpen=function(){var t=this.popupObj;this.parent.trigger(Yl,t)},o.prototype.renderPopup=function(t){this.setPanel(t.element),this.renderPanel(),t.popupObj=new Hi(t.element,{targetType:"relative",relateTo:this.parent.element,open:this.quickToolbarOpen.bind(this)}),this.popupObj=t.popupObj,t.popupObj.hide()},o.prototype.renderPanel=function(){this.getPanel().classList.add(mh)},o.prototype.getPanel=function(){return this.popupPanel},o.prototype.setPanel=function(t){this.popupPanel=t},o}(),Jc=function(){function o(t,e){this.parent=t,this.locator=e,this.renderFactory=this.locator.getService("rendererFactory"),this.renderFactory.addRenderer(U.Popup,new $c(this.parent)),this.addEventListener()}return o.prototype.formatItems=function(t){var e=[];return t.forEach(function(i){if(typeof i=="string")switch(i.toLocaleLowerCase()){case"open":e.push("openLink");break;case"edit":e.push("editLink");break;case"unlink":e.push("removeLink");break;default:e.push(i);break}else e.push(i)}),e},o.prototype.getQTBarOptions=function(t,e,i,n){return{popupType:t,toolbarItems:i,mode:e,renderType:n,cssClass:this.parent.getCssClass()}},o.prototype.createQTBar=function(t,e,i,n){if(i.length<1)return null;var r=new Yc(this.parent,this.locator);return r.render(this.getQTBarOptions(t,e,this.formatItems(i),n)),r},o.prototype.initializeQuickToolbars=function(){this.parent.quickToolbarModule=this,this.contentRenderer=this.renderFactory.getRenderer(U.Content),this.parent.inlineMode.enable&&this.parent.inlineMode.onSelection&&ie()&&b.add(this.contentRenderer.getDocument(),"selectionchange",this.selectionChangeHandler,this)},o.prototype.onMouseDown=function(t){this.parent.isBlur=!1,this.parent.isRTE=!0},o.prototype.keyUpQT=function(t){t.which===27&&this.hideQuickToolbars()},o.prototype.renderQuickToolbars=function(){this.linkQTBar||this.imageQTBar||this.audioQTBar||this.videoQTBar||this.textQTBar||this.tableQTBar||(this.linkQTBar=this.createQTBar("Link","Scrollable",this.parent.quickToolbarSettings.link,U.LinkToolbar),this.renderFactory.addRenderer(U.LinkToolbar,this.linkQTBar),!h(this.parent.quickToolbarSettings.text)&&!this.parent.inlineMode.enable&&(this.textQTBar=this.createQTBar("Text","MultiRow",this.parent.quickToolbarSettings.text,U.TextToolbar),this.renderFactory.addRenderer(U.TextToolbar,this.textQTBar)),this.imageQTBar=this.createQTBar("Image","MultiRow",this.parent.quickToolbarSettings.image,U.ImageToolbar),this.renderFactory.addRenderer(U.ImageToolbar,this.imageQTBar),this.audioQTBar=this.createQTBar("Audio","MultiRow",this.parent.quickToolbarSettings.audio,U.AudioToolbar),this.renderFactory.addRenderer(U.AudioToolbar,this.audioQTBar),this.videoQTBar=this.createQTBar("Video","MultiRow",this.parent.quickToolbarSettings.video,U.VideoToolbar),this.renderFactory.addRenderer(U.VideoToolbar,this.videoQTBar),this.tableQTBar=this.createQTBar("Table","MultiRow",this.parent.quickToolbarSettings.table,U.TableToolbar),this.renderFactory.addRenderer(U.TableToolbar,this.tableQTBar),this.linkQTBar&&(b.add(this.linkQTBar.element,"mousedown",this.onMouseDown,this),b.add(this.linkQTBar.element,"keyup",this.keyUpQT,this)),this.imageQTBar&&(b.add(this.imageQTBar.element,"mousedown",this.onMouseDown,this),b.add(this.imageQTBar.element,"keyup",this.keyUpQT,this)),this.audioQTBar&&(b.add(this.audioQTBar.element,"mousedown",this.onMouseDown,this),b.add(this.audioQTBar.element,"keyup",this.keyUpQT,this)),this.videoQTBar&&(b.add(this.videoQTBar.element,"mousedown",this.onMouseDown,this),b.add(this.videoQTBar.element,"keyup",this.keyUpQT,this)),this.textQTBar&&(b.add(this.textQTBar.element,"mousedown",this.onMouseDown,this),b.add(this.textQTBar.element,"keyup",this.keyUpQT,this)),this.tableQTBar&&(b.add(this.tableQTBar.element,"mousedown",this.onMouseDown,this),b.add(this.tableQTBar.element,"keyup",this.keyUpQT,this)))},o.prototype.renderInlineQuickToolbar=function(){this.parent.inlineMode.enable&&(!D.isDevice||ie())&&(x([this.parent.element],[fr]),this.inlineQTBar=this.createQTBar("Inline","MultiRow",this.parent.toolbarSettings.items,U.InlineToolbar),this.renderFactory.addRenderer(U.InlineToolbar,this.inlineQTBar),b.add(this.inlineQTBar.element,"mousedown",this.onMouseDown,this),b.add(this.inlineQTBar.element,"keyup",this.keyUpQT,this))},o.prototype.showInlineQTBar=function(t,e,i){h(this.parent)||this.parent.readonly||i.tagName.toLowerCase()==="img"||this.inlineQTBar.showPopup(t,e,i)},o.prototype.hideInlineQTBar=function(){this.inlineQTBar&&!he(this.inlineQTBar.element,"e-popup-close")&&this.inlineQTBar.hidePopup()},o.prototype.hideQuickToolbars=function(){this.linkQTBar&&!he(this.linkQTBar.element,"e-popup-close")&&document.body.contains(this.linkQTBar.element)&&this.linkQTBar.hidePopup(),this.textQTBar&&!he(this.textQTBar.element,"e-popup-close")&&document.body.contains(this.textQTBar.element)&&this.textQTBar.hidePopup(),this.imageQTBar&&!he(this.imageQTBar.element,"e-popup-close")&&document.body.contains(this.imageQTBar.element)&&this.imageQTBar.hidePopup(),this.audioQTBar&&!he(this.audioQTBar.element,"e-popup-close")&&document.body.contains(this.audioQTBar.element)&&this.audioQTBar.hidePopup(),this.videoQTBar&&!he(this.videoQTBar.element,"e-popup-close")&&document.body.contains(this.videoQTBar.element)&&this.videoQTBar.hidePopup(),this.tableQTBar&&!he(this.tableQTBar.element,"e-popup-close")&&document.body.contains(this.tableQTBar.element)&&this.tableQTBar.hidePopup(),!h(this.parent)&&this.parent.inlineMode.enable&&(!D.isDevice||ie())&&this.hideInlineQTBar()},o.prototype.deBounce=function(t,e,i){var n=this;clearTimeout(this.deBouncer),this.deBouncer=window.setTimeout(function(){n.showInlineQTBar(t,e,i)},1e3)},o.prototype.mouseUpHandler=function(t){if(this.parent.inlineMode.enable&&(!D.isDevice||ie())){var e=t.args.touches?t.args.changedTouches[0]:t.args,i=this.parent.getRange(),n=t.args.target;if(h(A("."+di,document.body))){if(ie()&&t.touchData&&t.touchData.prevClientX!==t.touchData.clientX&&t.touchData.prevClientY!==t.touchData.clientY)return;this.hideInlineQTBar();var r=this.parent.element.getBoundingClientRect().left;if(this.offsetX=this.parent.iframeSettings.enable?window.pageXOffset+r+e.clientX:e.pageX,this.offsetY=So(e,this.parent.element,this.parent.iframeSettings.enable),n.nodeName==="TEXTAREA")this.showInlineQTBar(this.offsetX,this.offsetY,n);else{var s=T(n,"a");n=s||n;var a=this.parent.getRange().startContainer.parentElement,l=this.parent.getRange().endContainer.parentElement;if((h(T(a,"A"))||h(T(l,"A")))&&(!T(n,"td,th")||!i.collapsed)&&(n.tagName!=="IMG"||this.parent.getRange().startOffset!==this.parent.getRange().endOffset)){if(this.parent.inlineMode.onSelection&&i.collapsed)return;this.target=n,this.showInlineQTBar(this.offsetX,this.offsetY,n)}}}}if(!h(this.textQTBar)&&!h(this.parent.quickToolbarSettings.text)&&!this.parent.inlineMode.enable){var e=t.args.touches?t.args.changedTouches[0]:t.args,n=t.args.target;this.hideQuickToolbars();var r=this.parent.element.getBoundingClientRect().left;this.offsetX=this.parent.iframeSettings.enable?this.parent.element.ownerDocument.documentElement.scrollLeft+r+e.clientX:e.pageX,this.offsetY=So(e,this.parent.element,this.parent.iframeSettings.enable);var i=this.parent.getRange();if(i.endContainer.parentElement.tagName===i.startContainer.parentElement.tagName&&i.startContainer.parentElement.tagName==="A"&&i.endContainer.parentElement.tagName==="A"||n.tagName==="IMG"||n.tagName==="VIDEO"||n.tagName==="AUDIO"||n.childNodes[0].nodeType===1&&n.childNodes[0].classList.contains("e-rte-audio")||this.parent.getRange().startOffset===this.parent.getRange().endOffset)return;this.target=n,this.textQTBar.showPopup(this.offsetX,this.offsetY,n,"text")}},o.prototype.keyDownHandler=function(){this.parent.inlineMode.enable&&(!D.isDevice||ie())&&!h(A("."+di,document))&&this.hideInlineQTBar(),this.textQTBar&&!he(this.textQTBar.element,"e-popup-close")&&this.textQTBar.hidePopup()},o.prototype.inlineQTBarMouseDownHandler=function(){this.parent.inlineMode.enable&&(!D.isDevice||ie())&&!h(A("."+di,document))&&this.hideInlineQTBar(),h(this.parent.quickToolbarSettings.text)||this.textQTBar&&!he(this.textQTBar.element,"e-popup-close")&&document.body.contains(this.textQTBar.element)&&this.textQTBar.hidePopup()},o.prototype.keyUpHandler=function(t){var e=t.args;if(this.parent.inlineMode.enable&&!D.isDevice){if(this.parent.inlineMode.onSelection){this.parent.getSelection().length>0&&(e.ctrlKey&&e.keyCode===65||e.shiftKey&&(e.keyCode===33||e.keyCode===34||e.keyCode===35||e.keyCode===36||e.keyCode===37||e.keyCode===38||e.keyCode===39||e.keyCode===40))&&this.showInlineQTBar(this.offsetX,this.offsetY,e.target);return}this.deBounce(this.offsetX,this.offsetY,e.target)}this.parent.quickToolbarSettings.text&&!D.isDevice&&(e.ctrlKey&&e.keyCode===65||e.shiftKey&&(e.keyCode===33||e.keyCode===34||e.keyCode===35||e.keyCode===36||e.keyCode===37||e.keyCode===38||e.keyCode===39||e.keyCode===40))&&this.textQTBar.showPopup(this.offsetX,this.offsetY,e.target,"text")},o.prototype.selectionChangeHandler=function(t){var e=this;clearTimeout(this.deBouncer),this.deBouncer=window.setTimeout(function(){e.onSelectionChange(t)},1e3)},o.prototype.onSelectionChange=function(t){if(h(A("."+di,document.body))){var e=this.contentRenderer.getDocument().getSelection();e.isCollapsed||this.mouseUpHandler({args:t})}},o.prototype.getInlineBaseToolbar=function(){return this.inlineQTBar&&this.inlineQTBar.quickTBarObj},o.prototype.destroy=function(){h(this.parent)||(this.linkQTBar&&(b.remove(this.linkQTBar.element,"mousedown",this.onMouseDown),b.remove(this.linkQTBar.element,"keyup",this.keyUpQT),this.linkQTBar.destroy()),this.textQTBar&&(b.remove(this.textQTBar.element,"mousedown",this.onMouseDown),b.remove(this.textQTBar.element,"keyup",this.keyUpQT),this.textQTBar.destroy()),this.imageQTBar&&(b.remove(this.imageQTBar.element,"mousedown",this.onMouseDown),b.remove(this.imageQTBar.element,"keyup",this.keyUpQT),this.imageQTBar.destroy()),this.audioQTBar&&(b.remove(this.audioQTBar.element,"mousedown",this.onMouseDown),b.remove(this.audioQTBar.element,"keyup",this.keyUpQT),this.audioQTBar.destroy()),this.videoQTBar&&(b.remove(this.videoQTBar.element,"mousedown",this.onMouseDown),b.remove(this.videoQTBar.element,"keyup",this.keyUpQT),this.videoQTBar.destroy()),this.tableQTBar&&(b.remove(this.tableQTBar.element,"mousedown",this.onMouseDown),b.remove(this.tableQTBar.element,"keyup",this.keyUpQT),this.tableQTBar.destroy()),this.inlineQTBar&&(b.remove(this.inlineQTBar.element,"mousedown",this.onMouseDown),b.remove(this.inlineQTBar.element,"keyup",this.keyUpQT),ie()&&b.remove(document,"selectionchange",this.selectionChangeHandler),this.inlineQTBar.destroy()),this.removeEventListener())},o.prototype.moduleDestroy=function(){this.parent=null},o.prototype.wireInlineQTBarEvents=function(){this.parent.on(es,this.mouseUpHandler,this),this.parent.on(_e,this.inlineQTBarMouseDownHandler,this),this.parent.on(Ne,this.keyDownHandler,this),this.parent.on(at,this.keyUpHandler,this),this.parent.on(Di,this.mouseUpHandler,this),this.parent.on(ds,this.renderInlineQuickToolbar,this),this.parent.on(fe,this.moduleDestroy,this)},o.prototype.unWireInlineQTBarEvents=function(){this.parent.off(es,this.mouseUpHandler),this.parent.off(_e,this.inlineQTBarMouseDownHandler),this.parent.off(Ne,this.keyDownHandler),this.parent.off(at,this.keyUpHandler),this.parent.off(Di,this.mouseUpHandler),this.parent.off(ds,this.renderInlineQuickToolbar),this.parent.off(fe,this.moduleDestroy)},o.prototype.toolbarUpdated=function(t){this.linkQTBar&&!he(this.linkQTBar.element,"e-popup-close")&&this.linkQTBar.hidePopup(),this.imageQTBar&&!he(this.imageQTBar.element,"e-popup-close")&&this.imageQTBar.hidePopup(),this.audioQTBar&&!he(this.audioQTBar.element,"e-popup-close")&&this.audioQTBar.hidePopup(),this.videoQTBar&&!he(this.videoQTBar.element,"e-popup-close")&&this.videoQTBar.hidePopup(),this.tableQTBar&&!he(this.tableQTBar.element,"e-popup-close")&&this.tableQTBar.hidePopup()},o.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(Me,this.initializeQuickToolbars,this),this.parent.on(_e,this.renderQuickToolbars,this),this.parent.on(ct,this.toolbarUpdated,this),this.parent.on(gs,this.renderQuickToolbars,this),this.wireInlineQTBarEvents(),this.parent.on(be,this.onPropertyChanged,this),this.parent.quickToolbarSettings.actionOnScroll==="hide"&&(this.parent.on(xt,this.hideQuickToolbars,this),this.parent.on(pi,this.hideQuickToolbars,this)),this.parent.on(Bi,this.hideQuickToolbars,this),this.parent.on(pt,this.onIframeMouseDown,this),this.parent.on(j,this.destroy,this),this.parent.on(Ne,this.onKeyDown,this),this.parent.on(dt,this.setRtl,this),this.parent.on(we,this.setCssClass,this),this.parent.on(Es,this.hideQuickToolbars,this))},o.prototype.onKeyDown=function(t){var e=t.args;(e.which===8||e.which===46)&&(this.imageQTBar&&!he(this.imageQTBar.element,"e-popup-close")&&this.imageQTBar.hidePopup(),this.audioQTBar&&!he(this.audioQTBar.element,"e-popup-close")&&this.audioQTBar.hidePopup(),this.videoQTBar&&!he(this.videoQTBar.element,"e-popup-close")&&this.videoQTBar.hidePopup(),this.tableQTBar&&!he(this.tableQTBar.element,"e-popup-close")&&this.tableQTBar.hidePopup(),this.linkQTBar&&!he(this.linkQTBar.element,"e-popup-close")&&this.linkQTBar.hidePopup(),this.textQTBar&&!he(this.textQTBar.element,"e-popup-close")&&this.textQTBar.hidePopup())},o.prototype.onIframeMouseDown=function(){this.hideQuickToolbars(),this.hideInlineQTBar()},o.prototype.updateCss=function(t,e){t&&e.cssClass&&(h(e.oldCssClass&&t.quickTBarObj.toolbarObj.cssClass!==e.cssClass)?t.quickTBarObj.toolbarObj.setProperties({cssClass:(t.quickTBarObj.toolbarObj.cssClass+" "+e.cssClass).trim()}):t.quickTBarObj.toolbarObj.setProperties({cssClass:(t.quickTBarObj.toolbarObj.cssClass.replace(e.oldCssClass,"").trim()+" "+e.cssClass).trim()}))},o.prototype.setCssClass=function(t){for(var e=[this.inlineQTBar,this.imageQTBar,this.linkQTBar,this.textQTBar,this.tableQTBar],i=0;i<e.length;i++)this.updateCss(e[i],t)},o.prototype.setRtl=function(t){this.inlineQTBar&&this.inlineQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:t.enableRtl}),this.imageQTBar&&this.imageQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:t.enableRtl}),this.audioQTBar&&this.audioQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:t.enableRtl}),this.videoQTBar&&this.videoQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:t.enableRtl}),this.linkQTBar&&this.linkQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:t.enableRtl}),this.textQTBar&&this.textQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:t.enableRtl})},o.prototype.removeEventListener=function(){this.deBouncer&&clearTimeout(this.deBouncer),!this.parent.isDestroyed&&(this.parent.off(Me,this.initializeQuickToolbars),this.parent.off(_e,this.renderQuickToolbars),this.parent.off(ct,this.toolbarUpdated),this.parent.off(gs,this.renderQuickToolbars),this.unWireInlineQTBarEvents(),this.parent.off(be,this.onPropertyChanged),this.parent.quickToolbarSettings.actionOnScroll==="hide"&&(this.parent.off(xt,this.hideQuickToolbars),this.parent.off(pi,this.hideQuickToolbars)),this.parent.off(Bi,this.hideQuickToolbars),this.parent.off(j,this.destroy),this.parent.off(pt,this.onIframeMouseDown),this.parent.off(Ne,this.onKeyDown),this.parent.off(dt,this.setRtl),this.parent.off(we,this.setCssClass),this.parent.off(Es,this.hideQuickToolbars))},o.prototype.onPropertyChanged=function(t){if(!h(t.newProp.quickToolbarSettings))for(var e=0,i=Object.keys(t.newProp.quickToolbarSettings);e<i.length;e++){var n=i[e];switch(n){case"actionOnScroll":t.newProp.quickToolbarSettings.actionOnScroll==="none"?(this.parent.off(xt,this.hideQuickToolbars),this.parent.off(pi,this.hideQuickToolbars)):(this.parent.on(xt,this.hideQuickToolbars,this),this.parent.on(pi,this.hideQuickToolbars,this));break}}t.module===this.getModuleName()&&(this.inlineQTBar&&(O([this.parent.element],[fr]),this.unWireInlineQTBarEvents(),this.hideInlineQTBar()),this.parent.inlineMode.enable&&(!D.isDevice||ie())&&(x([this.parent.element],[fr]),this.wireInlineQTBarEvents()))},o.prototype.getModuleName=function(){return"quickToolbar"},o}(),Zc=function(){function o(t,e){this.parent=t,this.locator=e,this.renderFactory=this.locator.getService("rendererFactory"),this.addEventListener()}return o.prototype.initializeInstance=function(){this.contentRenderer=this.renderFactory.getRenderer(U.Content),this.editPanel=this.contentRenderer.getEditPanel(),this.addEventListener()},o.prototype.renderCount=function(){this.initializeInstance(),this.element=this.parent.createElement("span",{className:go}),this.contentRenderer.getPanel().parentElement.appendChild(this.element),this.appendCount(),this.parent.maxLength!==-1&&this.charCountBackground(this.htmlLength)},o.prototype.appendCount=function(){var t=this.parent.editorMode==="Markdown"?this.editPanel.value:this.parent.getText().replace(/(\r\n|\n|\r|\t)/gm,"");this.parent.editorMode!=="Markdown"&&t.indexOf("")!==-1?this.htmlLength=t.replace(/\u200B/g,"").length:this.htmlLength=t.length;var e=this.parent.maxLength===-1?this.htmlLength:this.htmlLength+" / "+this.parent.maxLength;this.element.innerHTML=e},o.prototype.charCountBackground=function(t){var e=t/this.parent.maxLength*100;e<85?(this.element.classList.remove(Cr),this.element.classList.remove(Tr)):e>85&&e<=90?(this.element.classList.remove(Tr),this.element.classList.add(Cr)):e>90&&(this.element.classList.remove(Cr),this.element.classList.add(Tr))},o.prototype.refresh=function(){h(this.editPanel)||(this.appendCount(),this.parent.maxLength!==-1&&this.charCountBackground(this.htmlLength))},o.prototype.destroy=function(){this.element&&!h(this.parent.element.querySelector("."+go))&&S(this.element),this.removeEventListener()},o.prototype.toggle=function(t){this.element.style.display=t.member==="viewSource"?"none":"block"},o.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(Me,this.renderCount,this),this.parent.on(at,this.refresh,this),this.parent.on(hs,this.refresh,this),this.parent.on(In,this.refresh,this),this.parent.on(_e,this.refresh,this),this.parent.on(j,this.destroy,this),this.parent.on(Gt,this.toggle,this),this.parent.on(xi,this.toggle,this))},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Me,this.renderCount),this.parent.off(at,this.refresh),this.parent.off(In,this.refresh),this.parent.off(hs,this.refresh),this.parent.off(_e,this.refresh),this.parent.off(j,this.destroy),this.parent.off(Gt,this.toggle),this.parent.off(xi,this.toggle))},o.prototype.getModuleName=function(){return"count"},o}(),ep=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","strike","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"];function De(){var o=!1;return D.isDevice&&D.isIos&&(o=!0),o}function yt(o,t){if(o.nodeName==="BODY"&&!h(t)){var e=top.window.document.querySelector(t);h(e)||e.contentWindow.focus()}}function tp(o,t){var e=document.createElement("div");e.innerHTML=o,e.setAttribute("class","tempDiv");var i=document.createElement("div"),n=e.childNodes;if(n.length>0){for(var r=void 0,s=void 0,a=void 0;e.firstChild;)e.firstChild.nodeName==="#text"&&(e.firstChild.textContent.indexOf(`
`)<0||e.firstChild.textContent.trim()!=="")||ep.indexOf(e.firstChild.nodeName.toLocaleLowerCase())>=0?r?(s.appendChild(e.firstChild),s=a,r=!0):t==="BR"?(i.appendChild(e.firstChild),s=i):(a=R("p"),i.appendChild(a),a.appendChild(e.firstChild),s=a,r=!0):e.firstChild.nodeName==="#text"&&(e.firstChild.textContent===`
`||e.firstChild.textContent.indexOf(`
`)>=0&&e.firstChild.textContent.trim()==="")?S(e.firstChild):(i.appendChild(e.firstChild),r=!1);for(var l=i.querySelectorAll("table"),c=0;c<l.length;c++)if(l[c].classList.length>0&&!l[c].classList.contains("e-rte-table")){if(l[c].classList.add("e-rte-paste-table"),l[c].classList.contains("e-rte-paste-word-table")){l[c].classList.remove("e-rte-paste-word-table");continue}else if(l[c].classList.contains("e-rte-paste-excel-table")){l[c].classList.remove("e-rte-paste-excel-table"),l[c].getAttribute("border")==="0"&&l[c].removeAttribute("border");for(var p=l[c].querySelectorAll("td"),d=0;d<p.length;d++)p[d].style.borderLeft==="none"&&p[d].style.removeProperty("border-left"),p[d].style.borderRight==="none"&&p[d].style.removeProperty("border-right"),p[d].style.borderBottom==="none"&&p[d].style.removeProperty("border-bottom"),p[d].style.borderTop==="none"&&p[d].style.removeProperty("border-top"),p[d].style.border==="none"&&p[d].style.removeProperty("border")}else if(l[c].classList.contains("e-rte-paste-onenote-table")){l[c].classList.remove("e-rte-paste-onenote-table");continue}}for(var u=i.querySelectorAll("img"),c=0;c<u.length;c++)u[c].classList.contains("e-rte-image")||u[c].classList.add("e-rte-image"),u[c].classList.contains("e-imginline")||u[c].classList.contains("e-imgbreak")||u[c].classList.add("e-imginline")}return i.innerHTML}function ip(o){var t=o;do t.childNodes.length>0&&(t=t.childNodes[0]);while(t.childNodes.length>0);return t}function ka(){return{bold:!1,italic:!1,subscript:!1,superscript:!1,strikethrough:!1,orderedlist:!1,unorderedlist:!1,numberFormatList:!1,bulletFormatList:!1,underline:!1,alignments:null,backgroundcolor:null,fontcolor:null,fontname:null,fontsize:null,formats:null,createlink:!1,insertcode:!1}}var np=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(rs,this.commandCallBack,this),this.parent.on(j,this.removeEventListener,this)},o.prototype.commandCallBack=function(t){var e=!h(t.requestType)&&t.requestType==="FormatPainter"&&t.action==="format-copy";!h(t)&&!h(t.requestType)&&t.requestType!=="Undo"&&t.requestType!=="Redo"&&!e&&this.parent.formatter.saveData(),this.parent.notify(_t,{args:t}),this.parent.notify(hs,{})},o.prototype.removeEventListener=function(){this.parent.off(rs,this.commandCallBack),this.parent.off(j,this.removeEventListener)},o}(),xa="keydown",Ms="action",Da="format-type",Oe="keydown-handler",Ba="list-type",Pi="keyup-handler",Gn="keyup",Kn="model_changed_plugin",As="model_changed",Oa="ms_word_cleanup_plugin",rp="ms_word_cleanup",Na="onBegin",Ra="actionBegin",Ps="format_painter_actions",Ma="emoji_picker_actions",sp="mouseDown",op=function(){function o(){}return o.prototype.process=function(t,e,i,n){var r=this,s=t.contentModule.getDocument().getSelection(),a=s.rangeCount>0?s.getRangeAt(s.rangeCount-1):null,l,c;!h(n)&&!h(n.selection)&&(c=n.selection.range);var p=!h(n)&&!h(n.cssClass)&&n.cssClass!=="e-video-inline";if(t.editorMode==="HTML"&&!h(e)&&!p&&(h(e.name)||!h(e.name)&&e.name!=="showDialog")&&(c?l=this.editorManager.nodeSelection.save(c,t.contentModule.getDocument()):l=this.editorManager.nodeSelection.save(a,t.contentModule.getDocument())),!(!h(e)&&e.item.command&&e.item.command!=="Table"&&e.item.command!=="Actions"&&e.item.command!=="Links"&&e.item.command!=="Images"&&e.item.command!=="Files"&&e.item.command!=="Audios"&&e.item.command!=="Videos"&&e.item.command!=="EmojiPicker"&&a&&!(t.contentModule.getEditPanel().contains(this.getAncestorNode(a.commonAncestorContainer))||t.contentModule.getEditPanel()===a.commonAncestorContainer||t.contentModule.getPanel()===a.commonAncestorContainer))){if(!h(e)&&t.maxLength!==-1&&!h(e.item.command)){var d=0;e.item.command==="Links"&&(d=n.text.length===0?n.url.length:n.text.length),(e.item.command==="Images"||e.item.command==="Videos"||e.item.command==="Table"||e.item.command==="Files")&&(d=1);var u=t.getText().trim().replace(/(\r\n|\n|\r|\t)/gm,"").replace(/\u200B/g,"").length,f=t.getSelection().length,m=u-f+d;if(!(t.maxLength===-1||m<=t.maxLength))return}if(h(e)){var v=i.action;e={};var y={originalEvent:i,cancel:!1,requestType:v||i.key+"Key",itemCollection:n};if(ot(e,e,y,!0),v!=="tab"&&v!=="enter"&&v!=="space"&&v!=="escape"&&(t.editorMode==="Markdown"&&v==="insert-table"&&(n={headingText:t.localeObj.getConstant("TableHeadingText"),colText:t.localeObj.getConstant("TableColText")}),t.trigger(Ae,e,function(C){C.cancel&&(v==="paste"||v==="cut"||v==="copy")&&i.preventDefault()})),!e.cancel){var L=h(t.tableModule)?!0:t.tableModule?t.tableModule.ensureInsideTableList:!1;(i.which===9&&L||i.which!==9)&&(i.which===13&&t.editorMode==="HTML"&&(n={enterAction:t.enterKey}),this.editorManager.observer.notify(i.type==="keydown"?xa:Gn,{event:i,callBack:this.onSuccess.bind(this,t),value:n,enterAction:t.enterKey}))}}else!h(e)&&e.item.command&&e.item.subCommand&&(e.item.command!==e.item.subCommand&&e.item.command!=="Font"||(e.item.subCommand==="FontName"||e.item.subCommand==="FontSize")&&e.name==="dropDownSelect"||(e.item.subCommand==="BackgroundColor"||e.item.subCommand==="FontColor")&&e.name==="colorPickerChanged"||e.item.subCommand==="FormatPainter"||e.item.subCommand==="EmojiPicker")&&(ot(e,e,{requestType:e.item.subCommand,cancel:!1,itemCollection:n,selectType:e.name},!0),t.trigger(Ae,e,function(C){if(!C.cancel){var w=!h(C.requestType)&&C.requestType==="FormatPainter"&&C.name==="format-copy",k=!h(C.requestType)&&C.requestType==="FormatPainter"&&C.name==="format-paste";(r.getUndoRedoStack().length===0&&C.item.command!=="Links"&&C.item.command!=="Images"&&!w||k)&&r.saveData(),t.isBlur=!1,(h(l)||h(T(l.range.startContainer.parentElement,".e-img-caption"))||T(l.range.startContainer.parentElement,".e-img-caption").getAttribute("contenteditable")!="false")&&t.contentModule.getEditPanel().focus(),t.editorMode==="HTML"&&!p&&(h(e.selectType)||!h(e.selectType)&&e.selectType!=="showDialog")&&l.restore();var I=C.item.subCommand.toLocaleLowerCase();I==="paste"||I==="cut"||I==="copy"?t.clipboardAction(I,i):(r.editorManager.observer.notify(us,{subCommand:C.item.subCommand}),r.editorManager.execCommand(C.item.command,C.item.subCommand,i,r.onSuccess.bind(r,t),C.item.value,C.item.subCommand==="Pre"&&C.selectType==="dropDownSelect"?{name:C.selectType}:n,"#"+t.getID()+" iframe",t.enterKey))}}));(h(i)||i&&i.action!=="copy")&&this.enableUndo(t)}},o.prototype.getAncestorNode=function(t){return t=t.nodeType===3?t.parentNode:t,t},o.prototype.onKeyHandler=function(t,e){var i=this;this.editorManager.observer.notify(Gn,{event:e,callBack:function(){t.notify(gi,{}),i.enableUndo(t)}})},o.prototype.onSuccess=function(t,e){t.notify(gi,{}),e&&(h(e.event)||e.event.action!=="copy")&&(this.enableUndo(t),t.notify(rs,e)),t.trigger(Ge,e,function(i){if(t.setPlaceHolder(),(i.requestType==="Images"||i.requestType==="Links"||i.requestType==="Audios"||i.requestType==="Videos")&&t.editorMode==="HTML"){var n=i;if(i.requestType==="Links"&&i.event&&i.event.type==="keydown"&&i.event.keyCode===32)return;t.notify(ki,{args:n.event,type:i.requestType,isNotify:!0,elements:n.elements})}i.requestType==="VideosPlayPause"&&t.notify("editAreaClick",{args:event}),t.autoResize()})},o.prototype.saveData=function(t){this.editorManager.undoRedoManager.saveData(t)},o.prototype.getUndoStatus=function(){return this.editorManager.undoRedoManager.getUndoStatus()},o.prototype.getUndoRedoStack=function(){return this.editorManager.undoRedoManager.undoRedoStack},o.prototype.enableUndo=function(t){var e=this.getUndoStatus();t.inlineMode.enable&&(!D.isDevice||ie())?Yt(t.quickToolbarModule.inlineQTBar.quickTBarObj,e):t.toolbarModule&&Yt(t.toolbarModule.baseToolbar,e)},o}(),ap={"toolbar-focus":"alt+f10",escape:"27","insert-link":"ctrl+k","insert-image":"ctrl+shift+i","insert-audio":"ctrl+shift+a","insert-video":"ctrl+alt+v","insert-table":"ctrl+shift+e",undo:"ctrl+z",redo:"ctrl+y",copy:"ctrl+c",cut:"ctrl+x",paste:"ctrl+v",bold:"ctrl+b",italic:"ctrl+i",underline:"ctrl+u",strikethrough:"ctrl+shift+s",uppercase:"ctrl+shift+u",lowercase:"ctrl+shift+l",superscript:"ctrl+shift+=",subscript:"ctrl+=",indents:"ctrl+]",outdents:"ctrl+[","html-source":"ctrl+shift+h","full-screen":"ctrl+shift+f","decrease-fontsize":"ctrl+shift+<","increase-fontsize":"ctrl+shift+>","justify-center":"ctrl+e","justify-full":"ctrl+j","justify-left":"ctrl+l","justify-right":"ctrl+r","clear-format":"ctrl+shift+r","ordered-list":"ctrl+shift+o","unordered-list":"ctrl+alt+o",space:"32",enter:"13",tab:"tab",delete:"46","format-copy":"alt+shift+c","format-paste":"alt+shift+v"},Qo=["BR","IMG"],Is="INSERT-IMAGE",Aa="INSERT-AUDIO",Pa="INSERT-VIDEO",Ia="INSERT-TABLE",Ha="INSERT-LINK",Fa="INSERT-ROW",za="INSERT-COLUMN",qa="DELETE-ROW",Va="DELETE-COLUMN",Ua="REMOVE-TABLE",ja="TABLE-HEADER",_a="TABLE_VERTICAL_ALIGN",Wa="TABLE_MERGE",Qa="TABLE_VERTICAL_SPLIT",Ga="TABLE_HORIZONTAL_SPLIT",lp="TABLE_MOVE",Ka="alignment-type",Xa="indent-type",je="p",Nt=["address","article","aside","audio","blockquote","canvas","details","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul","video","body"],tt=["td","th"],mi=["table","tbody","td","tfoot","th","thead","tr"],Ya="selection-type",$a="inserthtml-type",Ja="insert-text-type",Za="clear-type",hp=["area","base","br","embed","hr","img","input","param","source","track","wbr","iframe","td","table"],qr=["word","excel","onenote"],Be=function(){function o(){this.startNodeName=[],this.endNodeName=[]}return o.prototype.saveInstance=function(t,e){return this.range=t.cloneRange(),this.rootNode=this.documentFromRange(t),this.body=e,this.startContainer=this.getNodeArray(t.startContainer,!0),this.endContainer=this.getNodeArray(t.endContainer,!1),this.startOffset=t.startOffset,this.endOffset=t.endOffset,this.html=this.body.innerHTML,this},o.prototype.documentFromRange=function(t){return t.startContainer.nodeType===9?t.startContainer:t.startContainer.ownerDocument},o.prototype.getRange=function(t){var e=this.get(t),i=e&&e.rangeCount>0?e.getRangeAt(e.rangeCount-1):t.createRange();return i.startContainer!==t||i.endContainer!==t||i.startOffset||i.endOffset||(i.setStart(t.body,0),i.collapse(!0)),i},o.prototype.get=function(t){return t.defaultView.getSelection()},o.prototype.save=function(t,e){return t=t?t.cloneRange():this.getRange(e),this.saveInstance(t,e.body)},o.prototype.getIndex=function(t){var e,i=0;if(t=!t.previousSibling&&t.tagName==="BR"?t:t.previousSibling,t)for(var n=t.nodeType;t;null)e=t.nodeType,i++,n=e,t=t.previousSibling;return i},o.prototype.isChildNode=function(t,e){for(var i=0;i<e.childNodes.length;i++)if(t.indexOf(e.childNodes[i])>-1)return!0;return!1},o.prototype.getNode=function(t,e,i){return e===t&&(t.nodeType===3||!t.firstChild||i.indexOf(t.firstChild)!==-1||this.isChildNode(i,t))?null:i.indexOf(t.firstChild)===-1&&t.firstChild&&!this.isChildNode(i,t)?t.firstChild:t.nextSibling?t.nextSibling:t.parentNode?t.parentNode:null},o.prototype.getNodeCollection=function(t){var e=t.startContainer.childNodes[t.startOffset]||t.startContainer,i=t.endContainer.childNodes[t.endOffset>0?t.endOffset-1:t.endOffset]||t.endContainer;if((e===i||e.nodeName==="BR"&&e===t.endContainer.childNodes[t.endOffset])&&e.childNodes.length===0)return[e];if(t.startOffset===t.endOffset&&t.startOffset!==0&&t.startContainer.nodeName==="PRE")return[e.nodeName==="BR"||e.nodeName==="#text"?e:e.childNodes[0]];var n=[];do n.indexOf(e)===-1&&n.push(e),e=this.getNode(e,i,n);while(e);return n},o.prototype.getParentNodeCollection=function(t){return this.getParentNodes(this.getNodeCollection(t),t)},o.prototype.getParentNodes=function(t,e){t=t.reverse();for(var i=0;i<t.length;i++)t.indexOf(t[i].parentNode)!==-1||t[i].nodeType===3&&e.startContainer!==e.endContainer&&e.startContainer.parentNode!==e.endContainer.parentNode?(t.splice(i,1),i--):t[i].nodeType===3&&(t[i]=t[i].parentNode);return t},o.prototype.getSelectionNodeCollection=function(t){return this.getSelectionNodes(this.getNodeCollection(t))},o.prototype.getSelectionNodeCollectionBr=function(t){return this.getSelectionNodesBr(this.getNodeCollection(t))},o.prototype.getSelectionNodes=function(t){t=t.reverse();for(var e=new RegExp(String.fromCharCode(8203),"g"),i=0;i<t.length;i++)(t[i].nodeType!==3||t[i].textContent.trim()===""||t[i].textContent.length===1&&t[i].textContent.match(e))&&(t.splice(i,1),i--);return t.reverse()},o.prototype.getSelectionNodesBr=function(t){t=t.reverse();for(var e=new RegExp(String.fromCharCode(8203),"g"),i=0;i<t.length;i++)t[i].nodeName!=="BR"&&(t[i].nodeType!==3||t[i].textContent.trim()===""||t[i].textContent.length===1&&t[i].textContent.match(e))&&(t.splice(i,1),i--);return t.reverse()},o.prototype.getInsertNodeCollection=function(t){return this.getInsertNodes(this.getNodeCollection(t))},o.prototype.getInsertNodes=function(t){t=t.reverse();for(var e=0;e<t.length;e++)(t[e].childNodes.length!==0&&t[e].nodeType!==3||t[e].nodeType===3&&t[e].textContent==="")&&(t.splice(e,1),e--);return t.reverse()},o.prototype.getNodeArray=function(t,e,i){var n=[];for(e?this.startNodeName=[]:this.endNodeName=[];t!==(i||this.rootNode)&&!h(t);null)e?this.startNodeName.push(t.nodeName.toLowerCase()):this.endNodeName.push(t.nodeName.toLowerCase()),n.push(this.getIndex(t)),t=t.parentNode;return n},o.prototype.setRangePoint=function(t,e,i,n){for(var r=this.rootNode,s=i.length,a=n;s--;null)r=r&&r.childNodes[i[s]];return r&&a>=0&&r.nodeName!=="html"&&(r.nodeType===3&&r.nodeValue.replace(/\u00a0/g,"&nbsp;")==="&nbsp;"&&(a=r.textContent.length),t[e?"setStart":"setEnd"](r,a)),t},o.prototype.restore=function(){var t=this.range.cloneRange();return t=this.setRangePoint(t,!0,this.startContainer,this.startOffset),t=this.setRangePoint(t,!1,this.endContainer,this.endOffset),this.selectRange(this.rootNode,t),t},o.prototype.selectRange=function(t,e){this.setRange(t,e),this.save(e,t)},o.prototype.setRange=function(t,e){var i=this.get(t);i.removeAllRanges(),i.addRange(e)},o.prototype.setSelectionText=function(t,e,i,n,r){var s=t.createRange();s.setStart(e,n),s.setEnd(i,r),this.setRange(t,s)},o.prototype.setSelectionContents=function(t,e){var i=t.createRange();i.selectNode(e),this.setRange(t,i)},o.prototype.setSelectionNode=function(t,e){var i=t.createRange();i.selectNodeContents(e),this.setRange(t,i)},o.prototype.getSelectedNodes=function(t){return this.getNodeCollection(this.getRange(t))},o.prototype.Clear=function(t){this.get(t).removeAllRanges()},o.prototype.insertParentNode=function(t,e,i){i.surroundContents(e),this.selectRange(t,i)},o.prototype.setCursorPoint=function(t,e,i){var n=t.createRange(),r=t.defaultView.getSelection();n.setStart(e,i),n.collapse(!0),r.removeAllRanges(),r.addRange(n)},o}(),V={startSelection:"e-editor-select-start",endSelection:"e-editor-select-end"},Xn=function(){function o(t,e){this.parent=t,this.nodeSelection=new Be,this.currentDocument=e}return o.prototype.contents=function(t){return t&&t.tagName!=="IFRAME"?Array.prototype.slice.call(t.childNodes||[]):[]},o.prototype.isBlockNode=function(t){return!!t&&t.nodeType===Node.ELEMENT_NODE&&Nt.indexOf(t.tagName.toLowerCase())>=0},o.prototype.isLink=function(t){return!!t&&t.nodeType===Node.ELEMENT_NODE&&t.tagName.toLowerCase()==="a"},o.prototype.blockParentNode=function(t){for(;t&&t.parentNode!==this.parent&&(!t.parentNode||!this.hasClass(t.parentNode,"e-node-inner"));null)if(t=t.parentNode,this.isBlockNode(t))return t;return t},o.prototype.rawAttributes=function(t){var e={},i=t.attributes;if(i.length>0)for(var n=0;n<i.length;n++){var r=i[n];e[r.nodeName]=r.value}return e},o.prototype.attributes=function(t){if(!t)return"";for(var e="",i=this.rawAttributes(t),n=Object.keys(i).sort(),r=0;r<n.length;r++){var s=n[r],a=i[""+s];a.indexOf("'")<0&&a.indexOf('"')>=0?e+=" "+s+"='"+a+"'":(a.indexOf('"')>=0&&a.indexOf("'")>=0&&(a=a.replace(/"/g,"&quot;")),e+=" "+s+'="'+a+'"')}return e},o.prototype.clearAttributes=function(t){for(var e=t.attributes,i=e.length-1;i>=0;i--){var n=e[i];t.removeAttribute(n.nodeName)}},o.prototype.openTagString=function(t){return"<"+t.tagName.toLowerCase()+this.attributes(t)+">"},o.prototype.closeTagString=function(t){return"</"+t.tagName.toLowerCase()+">"},o.prototype.createTagString=function(t,e,i){return"<"+t.toLowerCase()+this.attributes(e)+">"+i+"</"+t.toLowerCase()+">"},o.prototype.isList=function(t){return!!t&&["UL","OL"].indexOf(t.tagName)>=0},o.prototype.isElement=function(t){return t===this.parent},o.prototype.isEditable=function(t){return(!t.getAttribute||t.getAttribute("contenteditable")==="true")&&["STYLE","SCRIPT"].indexOf(t.tagName)<0},o.prototype.hasClass=function(t,e){return t&&t.classList&&t.classList.contains(e)},o.prototype.replaceWith=function(t,e){var i=t.parentNode;i.insertBefore(this.parseHTMLFragment(e),t),S(t)},o.prototype.parseHTMLFragment=function(t){var e=R("template");return e.innerHTML=t,e.content instanceof DocumentFragment?e.content:document.createRange().createContextualFragment(t)},o.prototype.wrap=function(t,e){return t.parentNode.insertBefore(e,t),e=t.previousSibling,e.appendChild(t),e},o.prototype.insertAfter=function(t,e){e.parentNode.insertBefore(t,e.nextSibling)},o.prototype.wrapInner=function(t,e){for(t.appendChild(e),e=t.querySelector(".e-rte-wrap-inner"),e.classList.remove("e-rte-wrap-inner"),e.classList.length===0&&e.removeAttribute("class");t.firstChild!==e;)e.appendChild(t.firstChild);return e},o.prototype.unWrap=function(t){for(var e=t.parentNode,i=[];t.firstChild;)i.push(t.firstChild),e.insertBefore(t.firstChild,t);return i=i.length>0?i:[t.parentNode],e.removeChild(t),i},o.prototype.getSelectedNode=function(t,e){return t.nodeType===Node.ELEMENT_NODE&&t.childNodes.length>0&&t.childNodes[e-1]&&t.childNodes[e-1].nodeType===Node.ELEMENT_NODE&&(t.childNodes[e-1].classList.contains(V.startSelection)||t.childNodes[e-1].classList.contains(V.endSelection))?t=t.childNodes[e-1]:t.nodeType===Node.ELEMENT_NODE&&t.childNodes.length>0&&t.childNodes[e]&&(t=t.childNodes[e]),t.nodeType===Node.TEXT_NODE&&(t=t.parentNode),t},o.prototype.nodeFinds=function(t,e){for(var i=[],n=0;n<e.length;n++)t.contains(e[n])&&t!==e[n]&&i.push(e[n]);return i},o.prototype.isEditorArea=function(){var t=this.getRangePoint(0),e;for(e=t.commonAncestorContainer;e&&!this.isElement(e);null)e=e.parentNode;return!!this.isElement(e)},o.prototype.getRangePoint=function(t){var e=this.getSelection(),i=[];if(e&&e.getRangeAt&&e.rangeCount){i=[];for(var n=0;n<e.rangeCount;n++)i.push(e.getRangeAt(n))}else i=[this.currentDocument.createRange()];return typeof t<"u"?i[t]:i},o.prototype.getSelection=function(){return this.nodeSelection.get(this.currentDocument)},o.prototype.getPreviousNode=function(t){for(t=t.previousElementSibling;t&&t.textContent===`
`;null)t=t.previousElementSibling;return t},o.prototype.encode=function(t){var e=document.createElement("div");return e.innerText=t,e.innerHTML.replace(/<br\s*[\/]?>/gi,`
`)},o.prototype.saveMarker=function(t,e){var i=this.parent.querySelector("."+V.startSelection),n=this.parent.querySelector("."+V.endSelection),r,s;if(this.hasClass(i,V.startSelection)&&i.classList.length>1){var a=this.createTagString(je,i,this.encode(i.textContent));this.replaceWith(i,a),i=this.parent.querySelector("."+V.startSelection),i.classList.remove(V.startSelection),r=i.childNodes[0]}else r=this.unWrap(i)[0];if(this.hasClass(n,V.endSelection)&&n.classList.length>1){var a=this.createTagString(je,n,this.encode(n.textContent));this.replaceWith(n,a),n=this.parent.querySelector("."+V.endSelection),n.classList.remove(V.endSelection),s=n.childNodes[0]}else s=n?this.unWrap(n)[0]:r;return t.startContainer=t.getNodeArray(r,!0),t.endContainer=t.getNodeArray(s,!1),t},o.prototype.marker=function(t,e){return'<span class="'+t+'">'+e+"</span>"},o.prototype.setMarker=function(t){var e=t.range,i=e.startContainer.childNodes,n=i.length>1&&i[0].nodeName==="TABLE",r=(n?ip(i[e.startOffset+1]):i[e.startOffset>0?e.startOffset-1:e.startOffset])||e.startContainer,s=e.endContainer.childNodes[e.endOffset>0?e.endOffset-1:e.endOffset]||e.endContainer;if(r.nodeType===Node.ELEMENT_NODE&&s.nodeType===Node.ELEMENT_NODE&&(r.contains(s)||s.contains(r))){var a=r.contains(s)?r:s,l=a.nodeType!==Node.TEXT_NODE;if(l){for(var c=[],p=[],d=a;a.contains(d);null)c.indexOf(d)<0&&d.childNodes&&d.childNodes.length?(c.push(d),d=d.childNodes[0]):d.nextSibling?d=d.nextSibling:d.parentNode&&(d=d.parentNode,c.push(d)),p.indexOf(d)<0&&(d.nodeType===Node.TEXT_NODE||tt.indexOf(d.parentNode.tagName.toLocaleLowerCase())>=0&&(d.tagName==="BR"||d.tagName==="IMG"))&&p.push(d);p.length&&(r=r.contains(s)?p[0]:r,s=p[p.length-1])}}if(r!==s){if(r.nodeType!==Node.TEXT_NODE&&(r.tagName==="BR"&&tt.indexOf(r.parentNode.tagName.toLocaleLowerCase())>=0||r.tagName==="IMG")){this.replaceWith(r,this.marker(V.startSelection,this.encode(r.textContent)));var u=e.startContainer.querySelector("."+V.startSelection);u.appendChild(r)}else if(r.nodeType!==3&&r.nodeName!=="#text"&&r.nodeName!=="BR"){var f=this.marker(V.startSelection,"");ve([this.parseHTMLFragment(f)],r)}else this.replaceWith(r,this.marker(V.startSelection,this.encode(r.textContent)));if(s.nodeType!==Node.TEXT_NODE&&s.tagName==="BR"&&tt.indexOf(s.parentNode.tagName.toLocaleLowerCase())>=0){this.replaceWith(s,this.marker(V.endSelection,this.encode(s.textContent)));var m=e.endContainer.querySelector("."+V.endSelection);m.appendChild(s)}else this.ensureSelfClosingTag(s,V.endSelection,e)}else this.ensureSelfClosingTag(r,V.startSelection,e)},o.prototype.ensureSelfClosingTag=function(t,e,i){var n=!1;if(t.nodeType===3)this.replaceWith(t,this.marker(e,this.encode(t.textContent)));else if(t.tagName==="BR"){this.replaceWith(t,this.marker(e,this.encode(t.textContent)));var r=i.startContainer.querySelector("."+e);r&&r.parentElement.appendChild(t)}else{if(t.tagName==="IMG"){var s=document.createElement("p");t.parentElement.insertBefore(s,t),s.appendChild(t),t=s.children[0]}if(t.tagName==="TABLE")if(n=!0,t.textContent===""){var a=t.querySelectorAll("td");t=a[a.length-1],t=h(t.childNodes[0])?t:t.childNodes[0]}else{for(var l=t.lastChild;l.nodeType!==3&&l.nodeName!=="#text"&&l.nodeName!=="BR";)l=l.lastChild;t=l}for(var c=0;c<Qo.length;c++)t=t.tagName===Qo[c]&&!n?t.parentNode:t;if(t.nodeType===3&&t.nodeName==="#text")this.replaceWith(t,this.marker(e,this.encode(t.textContent)));else if(t.nodeName==="BR"){this.replaceWith(t,this.marker(V.endSelection,this.encode(t.textContent)));var p=i.endContainer.querySelector("."+V.endSelection);p.appendChild(t)}else{var d=this.marker(e,"");ve([this.parseHTMLFragment(d)],t)}}},o.prototype.createTempNode=function(t){var e=t.textContent;if(t.tagName==="BR"){var i="<"+je+"></"+je+">",n=t.parentNode;tt.indexOf(n.tagName.toLocaleLowerCase())>=0&&(t=this.wrap(t,this.parseHTMLFragment(i)))}else if(t.nodeType!==Node.TEXT_NODE&&(t.classList.contains(V.startSelection)||t.classList.contains(V.endSelection))||e.replace(/\n/g,"").replace(/(^ *)|( *$)/g,"").length>0||e.length&&e.indexOf(`
`)<0){var i="<"+je+"></"+je+">",r=t;t=this.wrap(t,this.parseHTMLFragment(i));var s=r.nodeType===Node.ELEMENT_NODE&&r.firstChild&&r.firstChild.nodeName==="BR"&&(r.classList.contains(V.startSelection)||r.classList.contains(V.endSelection));!s&&t.nextElementSibling&&t.nextElementSibling.tagName==="BR"&&t.appendChild(t.nextElementSibling)}return t},o.prototype.getImageTagInSelection=function(){var t=this.getSelection();return this.isEditorArea()&&t.rangeCount?t.focusNode.querySelectorAll("img"):null},o.prototype.blockNodes=function(){var t=[],e=this.getSelection();if(this.isEditorArea()&&e.rangeCount)for(var i=this.getRangePoint(),n=0;n<i.length;n++){var r=void 0,s=i[n],a=this.getSelectedNode(s.startContainer,s.startOffset),l=this.getSelectedNode(s.endContainer,s.endOffset);if(this.isBlockNode(a)&&t.indexOf(a)<0&&t.push(a),r=this.blockParentNode(a),r&&t.indexOf(r)<0)if(tt.indexOf(r.tagName.toLocaleLowerCase())>=0&&(a.tagName==="BR"||a.nodeType===Node.TEXT_NODE||a.classList.contains(V.startSelection)||a.classList.contains(V.endSelection))){var c=a.previousSibling&&a.previousSibling.nodeType===Node.TEXT_NODE?a.previousSibling:a;!a.nextSibling&&!a.previousSibling&&a.tagName==="BR"?t.push(c):t.push(this.createTempNode(c))}else t.push(r);for(var p=[],d=a;d!==l&&d!==this.parent;null)p.indexOf(d)<0&&d.childNodes&&d.childNodes.length?(p.push(d),d=d.childNodes[0]):d&&d.nodeType!==8&&(d.tagName==="BR"||d.nodeType===Node.TEXT_NODE&&d.textContent.trim()!==""||d.nodeType!==Node.TEXT_NODE&&(d.classList.contains(V.startSelection)||d.classList.contains(V.endSelection)))&&tt.indexOf(d.parentNode.tagName.toLocaleLowerCase())>=0?d=this.createTempNode(d):d.nextSibling&&d.nextSibling.nodeType!==8&&(d.nextSibling.tagName==="BR"||d.nextSibling.nodeType===Node.TEXT_NODE||d.nextSibling.classList.contains(V.startSelection)||d.nextSibling.classList.contains(V.endSelection))&&tt.indexOf(d.nextSibling.parentNode.tagName.toLocaleLowerCase())>=0?d=this.createTempNode(d.nextSibling):d.nextSibling?d=d.nextSibling:d.parentNode&&(d=d.parentNode,p.push(d)),t.indexOf(d)<0&&d.nodeType===Node.ELEMENT_NODE&&tt.indexOf(d.parentNode.tagName.toLocaleLowerCase())>=0&&(d.classList.contains(V.startSelection)||d.classList.contains(V.endSelection))&&t.push(this.createTempNode(d)),this.isBlockNode(d)&&this.ignoreTableTag(d)&&p.indexOf(d)<0&&t.indexOf(d)<0&&(d!==l||s.endOffset>0)&&t.push(d),d.nodeName==="IMG"&&d.parentElement.contentEditable==="true"&&t.push(d);r=this.blockParentNode(l),r&&this.ignoreTableTag(r)&&t.indexOf(r)<0&&!h(r.previousElementSibling)&&r.previousElementSibling.tagName!=="IMG"&&t.push(r)}for(var u=t.length-1;u>0;u--){var p=this.nodeFinds(t[u],t);if(p.length){var f=t[u].querySelectorAll("ul, ol");if(t[u].tagName==="LI"&&f.length>0)continue;t.splice(u,1)}}return t},o.prototype.ignoreTableTag=function(t){return!(mi.indexOf(t.tagName.toLocaleLowerCase())>=0)},o}(),cp=function(){function o(t){this.parent=t,this.domNode=this.parent.domNode,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.observer.on(Ba,this.applyListsHandler,this),this.parent.observer.on(Pi,this.onKeyUp,this),this.parent.observer.on(Oe,this.keyDownHandler,this),this.parent.observer.on(Ra,this.spaceKeyAction,this)},o.prototype.testList=function(t){var e=[/^[\d]+[.]+$/,/^(?=[MDCLXVI])M*(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})[.]$/gi,/^[a-zA-Z][.]+$/],i=h(t)?null:t.innerText.trim().split(".")[0]+".";if(!h(i)){for(var n=0;n<e.length;n++)if(e[n].test(i))return!0}return!1},o.prototype.testCurrentList=function(t){var e=[/^[1]+[.]+$/,/^[i]+[.]+$/,/^[a]+[.]+$/];if(!h(t.startContainer.textContent.slice(0,t.startOffset))){for(var i=t.startContainer.textContent.replace(/\u200B/g,"").slice(0,t.startOffset).trim(),n=0;n<e.length;n++)if(e[n].test(i)&&i.length===2)return!0}return!1},o.prototype.spaceList=function(t){var e=this.parent.nodeSelection.getRange(this.parent.currentDocument);this.saveSelection=this.parent.nodeSelection.save(e,this.parent.currentDocument);var i=this.parent.domNode.getSelectedNode(e.startContainer,e.startOffset);this.parent.domNode.getSelectedNode(e.endContainer,e.endOffset);var n=i.previousElementSibling,r=i.nextElementSibling,s=h(n)?null:n.innerText.trim().substring(0,1),a=h(r)?null:r.innerText.trim().substring(0,1),l=this.testCurrentList(e),c=this.testList(n),p=this.testList(r);!c&&!p&&s!=="*"&&a!=="*"&&(l?(e.startContainer.textContent=e.startContainer.textContent.slice(e.startOffset,e.startContainer.textContent.length),this.applyListsHandler({subCommand:"OL",callBack:t.callBack}),t.event.preventDefault()):(e.startContainer.textContent.replace(/\u200B/g,"").slice(0,e.startOffset).trim()==="*"||e.startContainer.textContent.replace(/\u200B/g,"").slice(0,e.startOffset).trim()==="-")&&(e.startContainer.textContent=e.startContainer.textContent.slice(e.startOffset,e.startContainer.textContent.length),this.applyListsHandler({subCommand:"UL",callBack:t.callBack}),t.event.preventDefault()))},o.prototype.enterList=function(t){var e=this.parent.nodeSelection.getRange(this.parent.currentDocument),i=e.startContainer.nodeName==="LI"?e.startContainer:e.startContainer.parentElement.closest("LI"),n=e.endContainer.nodeName==="LI"?e.endContainer:e.endContainer.parentElement.closest("LI"),r=!1;if(!h(i)){var s=i.querySelectorAll(".e-video-clickelem"),a=s.length>0&&s[0].childNodes[0].nodeName==="IFRAME";r=i.querySelectorAll("IMG").length>0||i.querySelectorAll("AUDIO").length>0||i.querySelectorAll("VIDEO").length>0||a}if(!h(i)&&!h(n)&&i===n&&i.tagName==="LI"&&i.textContent.trim()===""&&!r){if(i.innerHTML.indexOf("&nbsp;")>=0)return;i.textContent.charCodeAt(0)===65279&&(i.textContent="");var l=i.parentElement;if(h(l.parentElement.closest("UL"))&&h(l.parentElement.closest("OL"))){if(!h(i.nextElementSibling)){var c=this.parent.domNode.blockParentNode(i);this.parent.nodeCutter.GetSpliceNode(e,c)}var p=void 0;t.enterAction==="DIV"?(p=R("div"),p.innerHTML="<br>"):t.enterAction==="P"?(p=R("p"),p.innerHTML="<br>"):p=R("br"),this.parent.domNode.insertAfter(p,l),t.event.preventDefault(),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,p,0),l.textContent===""&&l.querySelectorAll("audio,video").length===0?S(l):S(i)}}},o.prototype.backspaceList=function(t){var e=this.parent.nodeSelection.getRange(this.parent.currentDocument),i=this.parent.domNode.getSelectedNode(e.startContainer,e.startOffset),n=this.parent.domNode.getSelectedNode(e.endContainer,e.endOffset);if(i=i.nodeName==="BR"?i.parentElement:i,n=n.nodeName==="BR"?n.parentElement:n,i===n&&!h(T(i,"li"))&&(i.textContent.trim()===""&&i.textContent.charCodeAt(0)===65279||i.textContent.length===1&&i.textContent.charCodeAt(0)===8203)&&(i.textContent=""),i===n&&i.tagName==="LI"&&i.textContent.length===0&&h(i.previousElementSibling)&&i.removeAttribute("style"),i===n&&i.textContent===""){if(i.parentElement.tagName==="LI"&&n.parentElement.tagName==="LI")S(i);else if(i.closest("ul")||i.closest("ol")){var r=h(i.closest("ul"))?i.closest("ol"):i.closest("ul");if(r.firstElementChild===i&&!h(r.children[1])&&(r.children[1].tagName==="OL"||r.children[1].tagName==="UL"))if(r.tagName===r.children[1].tagName){for(;r.children[1].lastChild;)this.parent.domNode.insertAfter(r.children[1].lastChild,r.children[1]);S(r.children[1])}else r.parentElement.insertBefore(r.children[1],r)}}else if(!h(i.firstChild)&&i.firstChild.nodeName==="BR"&&!h(i.childNodes[1])&&(i.childNodes[1].nodeName==="UL"||i.childNodes[1].nodeName==="OL")){var r=h(i.closest("ul"))?i.closest("ol"):i.closest("ul");if(r.tagName===i.childNodes[1].nodeName){for(;i.childNodes[1].lastChild;)this.parent.domNode.insertAfter(i.children[1].lastChild,i);S(i.childNodes[1])}else r.parentElement.insertBefore(i.children[1],r)}this.removeList(e,t),this.firstListBackSpace(e,t)},o.prototype.removeList=function(t,e){var i=this.parent.domNode.getSelectedNode(t.startContainer,t.startOffset),n=this.parent.domNode.getSelectedNode(t.endContainer,t.endOffset);i=i.nodeName==="BR"?i.parentElement:i,n=n.nodeName==="BR"?n.parentElement:n,i=i.nodeName!=="LI"&&!h(i.closest("LI"))?i.closest("LI"):i,n=n.nodeName!=="LI"&&!h(n.closest("LI"))?n.closest("LI"):n,((t.commonAncestorContainer.nodeName==="OL"||t.commonAncestorContainer.nodeName==="UL"||t.commonAncestorContainer.nodeName==="LI")&&h(n.nextElementSibling)&&n.textContent.length===t.endOffset&&h(i.previousElementSibling)&&t.startOffset===0||D.userAgent.indexOf("Firefox")!==-1&&t.startContainer===t.endContainer&&t.startContainer===this.parent.editableElement&&t.startOffset===0&&t.endOffset===1)&&(D.userAgent.indexOf("Firefox")!==-1?S(t.commonAncestorContainer.childNodes[0]):t.commonAncestorContainer.nodeName==="LI"?S(t.commonAncestorContainer.parentElement):S(t.commonAncestorContainer),e.event.preventDefault())},o.prototype.onKeyUp=function(){if(!h(this.commonLIParent)&&!h(this.commonLIParent.querySelector(".removeList"))){for(var t=this.commonLIParent.querySelector(".removeList");!h(t.firstChild);)this.parent.domNode.insertAfter(t.firstChild,t);S(t)}},o.prototype.firstListBackSpace=function(t,e){var i=this.parent.domNode.getSelectedNode(t.startContainer,t.startOffset);if(h(i.closest("OL"))?h(i.closest("UL"))||(this.commonLIParent=i.closest("UL")):this.commonLIParent=i.closest("OL"),i.nodeName==="LI"&&t.startOffset===0&&t.endOffset===0&&h(i.previousSibling)&&!h(this.commonLIParent)&&h(this.commonLIParent.previousSibling)&&h(this.commonLIParent.parentElement.closest("OL"))&&h(this.commonLIParent.parentElement.closest("UL"))&&h(this.commonLIParent.parentElement.closest("LI"))){var n=R("P");n.innerHTML="&#8203;",i.classList.add("removeList"),this.commonLIParent.parentElement.insertBefore(n,this.commonLIParent)}},o.prototype.keyDownHandler=function(t){if(t.event.which===13&&this.enterList(t),t.event.which===32&&this.spaceList(t),t.event.which===8&&this.backspaceList(t),t.event.which===46&&t.event.action==="delete"){var e=this.parent.nodeSelection.getRange(this.parent.currentDocument),i=e.commonAncestorContainer,n=e.startContainer,r=e.endContainer,s=n.nodeType===3?n.parentElement:n,a=r.nodeType===3?r.parentElement:r;(i.nodeName==="UL"||i.nodeName==="OL")&&s!==a&&(!h(T(s,"ul"))||!h(T(s,"ol")))&&(!h(T(a,"ul"))||!h(T(a,"ol")))&&i.lastElementChild===T(a,"li")&&!e.collapsed&&S(i),this.removeList(e,t)}if(t.event.which===9){var e=this.parent.nodeSelection.getRange(this.parent.currentDocument);t.event.action&&t.event.action==="indent"||(this.saveSelection=this.parent.nodeSelection.save(e,this.parent.currentDocument));var l=void 0,c=e.startOffset,p=e.endOffset,s=this.parent.domNode.getSelectedNode(e.startContainer,e.startOffset),a=this.parent.domNode.getSelectedNode(e.endContainer,e.endOffset);if(s===a&&(s.nodeName==="BR"||s.nodeName==="#text")&&tt.indexOf(s.parentNode.tagName.toLocaleLowerCase())>=0)return;t.event.action&&t.event.action==="indent"||this.domNode.setMarker(this.saveSelection),l=this.domNode.blockNodes();for(var d=[],u=!0,f=0;f<l.length;f++)l[f].parentNode.tagName==="LI"?d.push(l[f].parentNode):l[f].tagName==="LI"&&l[f].childNodes[0].tagName!=="P"&&l[f].childNodes[0].tagName!=="OL"&&l[f].childNodes[0].tagName!=="UL"&&d.push(l[f]);d.length>1||d.length&&(c===0&&p===0||t.ignoreDefault)?(t.event.preventDefault(),t.event.stopPropagation(),this.currentAction=this.getAction(d[0]),t.event.shiftKey?(this.revertList(d,t),this.revertClean()):u=this.nestedList(d),u&&(this.cleanNode(),this.parent.editableElement.focus()),t.event.action&&t.event.action==="indent"||(this.saveSelection=this.domNode.saveMarker(this.saveSelection),this.saveSelection.restore(),t.callBack&&t.callBack({requestType:this.currentAction,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes(),event:t.event}))):t.event.action&&t.event.action==="indent"||(t.event&&t.event.shiftKey&&t.event.key==="Tab"&&(t.event.action="tab"),this.saveSelection=this.domNode.saveMarker(this.saveSelection,t.event.action),this.saveSelection.restore())}else switch(t.event.action){case"ordered-list":this.applyListsHandler({subCommand:"OL",callBack:t.callBack}),t.event.preventDefault();break;case"unordered-list":this.applyListsHandler({subCommand:"UL",callBack:t.callBack}),t.event.preventDefault();break}},o.prototype.spaceKeyAction=function(t){t.event.which===32&&this.spaceList(t)},o.prototype.getAction=function(t){var e=t.parentNode;return e.nodeName==="OL"?"OL":"UL"},o.prototype.revertClean=function(){for(var t=this.parent.editableElement.querySelectorAll("ul, ol"),e=0;e<t.length;e++){var i=t[e].querySelectorAll("ul, ol");if(i.length>0)for(var n=0;n<i.length;n++){var r=i[n].previousSibling;r&&r.tagName==="LI"&&r.appendChild(i[n])}}},o.prototype.noPreviousElement=function(t){var e,i,n=t.querySelectorAll("ol, ul"),r=t.querySelectorAll("li"),s=this.domNode.contents(r[0])[0];if(r.length>0&&(s.nodeName==="OL"||s.nodeName==="UL")?e=r[0]:i=n[0],e)for(var a=this.domNode.contents(t)[0];a&&!this.domNode.isList(a);null){var l=a.nextSibling;ht([a],e),Q(t,{"list-style-type":"none"}),Q(e,{"list-style-type":""}),a=l}else if(i){var c=R("li");ht([c],i);for(var a=this.domNode.contents(t)[0];a&&!this.domNode.isList(a);null){var l=a.nextSibling;c.appendChild(a),a=l}ht([i],t.parentNode),S(t);var p=R("li",{styles:"list-style-type: none;"});ht([p],i.parentNode),ve([i],p)}else{var p=R("li",{styles:"list-style-type: none;"});ht([p],t.parentNode);var c=R(t.parentNode.tagName);ht([c],p),ve([t],c)}},o.prototype.nestedList=function(t){for(var e=!1,i=0;i<t.length;i++){var n=this.domNode.getPreviousNode(t[i]);if(n){e=!0;var r=void 0,s=void 0,a=t[i].querySelectorAll("ol, ul"),l=t[i].querySelectorAll("li"),c=this.domNode.contents(l[0])[0];if(l.length>0&&(c.nodeName==="OL"||c.nodeName==="UL")?s=l[0]:r=a[0],r){var p=R("li");ht([p],r);for(var d=this.domNode.contents(t[i])[0];d&&!this.domNode.isList(d);null){var u=d.nextSibling;p.appendChild(d),d=u}ve([r],n),S(t[i])}else if(s){if(n.tagName==="LI"){for(var d=this.domNode.contents(t[i])[0];d&&!this.domNode.isList(d);null){var u=d.nextSibling;ht([d],s),Q(t[i],{"list-style-type":"none"}),Q(s,{"list-style-type":""}),d=u}ve([s.parentNode],n),S(t[i])}}else if(n.tagName==="LI"){var p=R(t[i].parentNode.tagName);ve([p],n),ve([t[i]],p)}else(n.tagName==="OL"||n.tagName==="UL")&&ve([t[i]],n)}else{var f=t[i];e=!0,this.noPreviousElement(f)}}return e},o.prototype.applyListsHandler=function(t){var e=this.parent.nodeSelection.getRange(this.parent.currentDocument);if(D.userAgent.indexOf("Firefox")!==-1&&e.startContainer===e.endContainer&&e.startContainer===this.parent.editableElement){for(var i=e.startContainer.childNodes,n=i[e.startOffset>0?e.startOffset-1:e.startOffset]||e.startContainer,r=e.endContainer.childNodes[e.endOffset>0?e.endOffset-1:e.endOffset]||e.endContainer,s=r.lastChild.nodeName==="BR"?h(r.lastChild.previousSibling)?r:r.lastChild.previousSibling:r.lastChild;!h(s)&&s.nodeName!=="#text"&&s.nodeName!=="IMG"&&s.nodeName!=="BR"&&s.nodeName!=="HR";)s=s.lastChild;this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,n,s,0,s.textContent.length),e=this.parent.nodeSelection.getRange(this.parent.currentDocument)}if(e.startContainer===e.endContainer&&e.startContainer===this.parent.editableElement&&e.startOffset===e.endOffset&&e.startOffset===0&&this.parent.editableElement.textContent.length===0&&this.parent.editableElement.childNodes[0].nodeName!=="TABLE"&&this.parent.editableElement.childNodes[0].nodeName!=="IMG"){var a=e.startContainer.childNodes[0];this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,a,a,0,0),e=this.parent.nodeSelection.getRange(this.parent.currentDocument)}this.saveSelection=this.parent.nodeSelection.save(e,this.parent.currentDocument),this.currentAction=t.subCommand,this.currentAction=t.subCommand=this.currentAction==="NumberFormatList"?"OL":this.currentAction==="BulletFormatList"?"UL":this.currentAction,this.domNode.setMarker(this.saveSelection);var l=this.domNode.blockNodes();if(t.enterAction==="BR"){this.setSelectionBRConfig();var c=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),p=this.parent.nodeSelection.getSelectionNodes(c),d=[];p.length===0&&p.push(l[0]);for(var u=0;u<p.length;u++){for(var f=p[u],m=void 0;!this.parent.domNode.isBlockNode(f)&&f!==this.parent.editableElement;)m=f,f=f.parentElement;this.parent.domNode.isBlockNode(f)&&f===this.parent.editableElement&&d.push(m)}for(var u=0;u<d.length;u++)if(!this.parent.domNode.isBlockNode(d[u])){for(var f=d[u],v=f;f===this.parent.editableElement;)v=f,f=f.parentElement;var y=void 0;this.parent.domNode.isBlockNode(v.parentElement)&&v.parentElement===this.parent.editableElement?(y=R("p"),v.parentElement.insertBefore(y,v),y.appendChild(v)):y=v;for(var L=y.previousSibling;!h(L)&&L.nodeName!=="BR"&&!this.parent.domNode.isBlockNode(L);)y.firstChild.parentElement.insertBefore(L,y.firstChild),L=y.previousSibling;!h(L)&&L.nodeName==="BR"&&S(L);for(var C=y.nextSibling;!h(C)&&C.nodeName!=="BR"&&!this.parent.domNode.isBlockNode(C);)y.appendChild(C),C=y.nextSibling;!h(C)&&C.nodeName==="BR"&&S(C)}this.setSelectionBRConfig(),l=this.parent.domNode.blockNodes()}for(var u=0;u<l.length;u++)l[u].tagName==="TABLE"&&!e.collapsed&&l.splice(u,1),l.length>0&&l[u].tagName!=="LI"&&l[u].parentNode.tagName==="LI"&&(l[u]=l[u].parentNode);this.applyLists(l,this.currentAction,t.selector,t.item,t),t.callBack&&t.callBack({requestType:this.currentAction,event:t.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},o.prototype.setSelectionBRConfig=function(){var t=this.parent.editableElement.querySelector("."+V.startSelection),e=this.parent.editableElement.querySelector("."+V.endSelection);h(e)?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,t,0):this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,t,e,0,0)},o.prototype.applyLists=function(t,e,i,n,r){if(this.isRevert(t,e,n)&&h(n))this.revertList(t,r),this.removeEmptyListElements();else{this.checkLists(t,e,n);for(var s=0;s<t.length;s++)if(!h(n)&&!h(n.listStyle)&&(n.listStyle==="listImage"?Q(t[s],{"list-style-image":n.listImage}):(Q(t[s],{"list-style-image":"none"}),Q(t[s],{"list-style-type":n.listStyle.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}))),t[s].getAttribute("contenteditable")==="true"&&t[s].childNodes.length===1&&t[s].childNodes[0].nodeName==="TABLE"){var a=document.createElement(e);a.innerHTML="<li><br/></li>",t[s].appendChild(a)}else if(t[s].tagName!=="LI"&&h(n)){var l=t[s].tagName==="IMG"?"":this.domNode.attributes(t[s]),c="<"+e+">",p="</"+e+">",d="li"+l,u=t[s].tagName.toLowerCase()===je?t[s].innerHTML:t[s].outerHTML,f=this.domNode.createTagString(d,null,u),m=c+f+p;this.domNode.replaceWith(t[s],m)}else if(!h(n)&&t[s].tagName!=="LI"){var l=t[s].tagName==="IMG"?"":this.domNode.attributes(t[s]),c="<"+e+l+">",p="</"+e+">",d="li",u=t[s].tagName.toLowerCase()===je?t[s].innerHTML:t[s].outerHTML,f=this.domNode.createTagString(d,null,u),m=c+f+p;this.domNode.replaceWith(t[s],m)}}this.cleanNode(),this.parent.editableElement.focus(),De()&&yt(this.parent.editableElement,i),this.saveSelection=this.domNode.saveMarker(this.saveSelection),this.saveSelection.restore()},o.prototype.removeEmptyListElements=function(){for(var t=this.parent.editableElement.querySelectorAll("ol, ul"),e=0;e<t.length;e++)t[e].textContent.trim()===""&&S(t[e])},o.prototype.isRevert=function(t,e,i){for(var n=!0,r=0;r<t.length;r++){if(t[r].tagName!=="LI")return!1;(t[r].parentNode.tagName!==e||h(i)&&t[r].parentNode.style.listStyleType!=="")&&(n=!1)}return n},o.prototype.checkLists=function(t,e,i){for(var n=[],r=0;r<t.length;r++){var s=t[r].parentNode;!h(i)&&t[r].tagName==="LI"&&!h(i.listStyle)&&(i.listStyle==="listImage"?Q(s,{"list-style-image":i.listImage}):(Q(s,{"list-style-image":"none"}),Q(s,{"list-style-type":i.listStyle.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}))),(t[r].tagName==="LI"&&s.tagName!==e&&n.indexOf(s)<0||t[r].tagName==="LI"&&s.tagName===e&&n.indexOf(s)<0&&i!==null)&&n.push(s),h(i)&&(s.tagName===e||(s.tagName==="UL"||s.tagName==="OL")&&s.hasAttribute("style"))&&s.hasAttribute("style")&&s.removeAttribute("style")}for(var a=n.length-1;a>=0;a--){var l=n[a],c="<"+e.toLowerCase()+" "+this.domNode.attributes(l)+">"+l.innerHTML+"</"+e.toLowerCase()+">";this.domNode.replaceWith(n[a],c)}},o.prototype.cleanNode=function(){for(var t=this.parent.editableElement.querySelectorAll("ol + ol, ul + ul"),e=0;e<t.length;e++){var i=t[e];if(this.domNode.isList(i.previousElementSibling)&&this.domNode.openTagString(i)===this.domNode.openTagString(i.previousElementSibling)){for(var n=this.domNode.contents(i),r=0;r<n.length;r++)i.previousElementSibling.appendChild(n[r]);i.parentNode.removeChild(i)}else h(i.getAttribute("level"))||i.tagName===i.previousElementSibling.tagName&&i.previousElementSibling.lastChild.append(i)}},o.prototype.findUnSelected=function(t,e){if(t=t.slice().reverse(),t.length>0){var i=[],n=[],r=e[e.length-1],s=[],a=[];s=r.childNodes;for(var l=0;l<s.length;l++)if(s[l].tagName==="OL"||s[l].tagName==="UL"){var c=s[l].querySelectorAll("li");if(c.length>0)for(var p=0;p<c.length;p++)a.push(c[p])}for(var d=0;d<a.length;d++){for(var u=0,f=0;f<t.length;f++)a[d].contains(t[f])||(u=u+1);u===t.length&&n.push(a[d])}if(n.length>0)for(var m=0;m<n.length;m++)this.domNode.contents(n[m])[0].nodeName!=="OL"&&this.domNode.contents(n[m])[0].nodeName!=="UL"&&i.push(n[m]);i.length>0&&this.nestedList(i)}},o.prototype.revertList=function(t,e){for(var i=[],n=t.length-1;n>=0;n--)for(var r=n-1;r>=0;r--)if(t[r].contains(t[n])||t[r]===t[n]){i.push(t[n]),t.splice(n,1);break}this.findUnSelected(i,t);for(var s=[],n=0;n<t.length;n++){var a=t[n];this.domNode.contents(a)[0].nodeType===3&&this.domNode.contents(a)[0].textContent.trim().length===0&&S(this.domNode.contents(a)[0]);var l=t[n].parentNode,c=a.getAttribute("class");if(i.length===0){var p=t[n].querySelectorAll("ul, ol"),d=p[0];if(d){var u=d.querySelectorAll("li");if(u){var f=R(d.tagName);ve([f],d.parentNode);var m=R("li",{styles:"list-style-type: none;"});ve([m],f),ve([d],m)}}}if(a.parentNode.insertBefore(this.closeTag(l.tagName),a),l.parentNode.tagName==="LI"||l.parentNode.tagName==="OL"||l.parentNode.tagName==="UL")a.parentNode.insertBefore(this.closeTag("LI"),a);else{if(a.querySelectorAll(Nt.join(", ")).length===0){var v=h(c)?' class="e-rte-wrap-inner"':' class="'+c+' e-rte-wrap-inner"',y="<"+je+v+this.domNode.attributes(l)+"></"+je+">";e.enterAction!=="BR"&&this.domNode.wrapInner(a,this.domNode.parseHTMLFragment(y))}else if(this.domNode.contents(a)[0].nodeType===3){var L=this.domNode.createTagString(je,l,this.parent.domNode.encode(this.domNode.contents(a)[0].textContent));this.domNode.replaceWith(this.domNode.contents(a)[0],L)}else if(this.domNode.contents(a)[0].classList.contains(V.startSelection)||this.domNode.contents(a)[0].classList.contains(V.endSelection)){var L=this.domNode.createTagString(je,l,this.domNode.contents(a)[0].outerHTML);this.domNode.replaceWith(this.domNode.contents(a)[0],L)}else{var C=a.firstChild;c=C.getAttribute("class"),ce(C,this.domNode.rawAttributes(l)),c&&C.getAttribute("class")&&ce(C,{class:c+" "+C.getAttribute("class")})}ve([this.openTag("LI")],a),ht([this.closeTag("LI")],a)}this.domNode.insertAfter(this.openTag(l.tagName),a),l.parentNode.tagName==="LI"&&(l=l.parentNode.parentNode),s.indexOf(l)<0&&s.push(l)}for(var n=0;n<s.length;n++){var w=s[n],k=w.innerHTML,I=/<span class="e-rte-list-close-([a-z]*)"><\/span>/g,P=/<span class="e-rte-list-open-([a-z]*)"><\/span>/g;k=k.replace(I,"</$1>"),k=k.replace(P,"<$1 "+this.domNode.attributes(w)+">"),this.domNode.replaceWith(w,this.domNode.openTagString(w)+k.trim()+this.domNode.closeTagString(w))}for(var Z=this.parent.editableElement.querySelectorAll("ul:empty, ol:empty"),n=0;n<Z.length;n++)S(Z[n]);for(var G=this.parent.editableElement.querySelectorAll("li:empty"),n=0;n<G.length;n++)S(G[n])},o.prototype.openTag=function(t){return this.domNode.parseHTMLFragment('<span class="e-rte-list-open-'+t.toLowerCase()+'"></span>')},o.prototype.closeTag=function(t){return this.domNode.parseHTMLFragment('<span class="e-rte-list-close-'+t.toLowerCase()+'"></span>')},o}(),re=function(){function o(){}return o.WrapBefore=function(t,e,i){return e.innerText=t.textContent,i?this.AppendBefore(e,t,!0):this.AppendBefore(e,t),t.parentNode&&t.parentNode.removeChild(t),e.childNodes[0]},o.Wrap=function(t,e){return this.AppendBefore(e,t),e.appendChild(t),t},o.unwrap=function(t){for(var e=t.parentNode,i=[];t.firstChild;null)i.push(e.insertBefore(t.firstChild,t));return e.removeChild(t),i},o.AppendBefore=function(t,e,i){return e.parentNode?i?e.parentNode.insertBefore(t,e.nextSibling):e.parentNode.insertBefore(t,e):e},o}(),Jt=function(){function o(){this.enterAction="P",this.position=-1,this.nodeSelection=new Be}return o.prototype.GetSpliceNode=function(t,e){return e=this.SplitNode(t,e,!0),e=this.SplitNode(t,e,!1),e},o.prototype.SplitNode=function(t,e,i){if(e){var n=t.cloneRange(),r=e.parentNode,s=this.nodeSelection.getIndex(e);n.collapse(i),i?n.setStartBefore(e):n.setEndAfter(e);var a=n.extractContents();if(i){if(e=r.childNodes[s],a=this.spliceEmptyNode(a,!1),a&&a.childNodes.length>0){var l=!!(a.childNodes.length===1&&a.childNodes[0].nodeName!=="IMG"&&!(a.querySelectorAll("img").length>0)&&this.isRteElm(a)&&a.textContent==="");if(!l)if(e)re.AppendBefore(a,e);else{r.appendChild(a);var c=document.createElement("div");c.innerHTML="&#65279;&#65279;",e=c.firstChild,r.appendChild(e)}}}else if(e=r.childNodes.length>1?r.childNodes[s]:r.childNodes[0],a=this.spliceEmptyNode(a,!0),a&&a.childNodes.length>0){var l=!!(a.childNodes.length===1&&a.childNodes[0].nodeName!=="IMG"&&this.isRteElm(a)&&a.textContent==="");if(!l)if(e)re.AppendBefore(a,e,!0);else{r.appendChild(a);var c=document.createElement("div");c.innerHTML="&#65279;&#65279;",r.insertBefore(c.firstChild,r.firstChild),e=r.firstChild}}return e}else return null},o.prototype.isRteElm=function(t){var e=!0;if(t.childNodes.length===1&&t.childNodes[0].nodeName!=="IMG")for(var i=t.childNodes[0],n=0;!h(i.childNodes)&&n<i.childNodes.length;n++)(i.childNodes[n].nodeName==="IMG"||i.childNodes[n].nodeName==="SPAN"&&(i.childNodes[n].classList.contains("e-video-wrap")||i.childNodes[n].classList.contains("e-embed-video-wrap")||i.childNodes[n].classList.contains("e-audio-wrap")))&&(e=!1);else e=!0;return e},o.prototype.spliceEmptyNode=function(t,e){var i;return t.childNodes.length===1&&t.childNodes[0].nodeName==="#text"&&t.childNodes[0].textContent===""||t.textContent===""?i=-1:i=t.childNodes.length-1,i>-1&&!e?this.spliceEmptyNode(t.childNodes[i],e):i>-1?this.spliceEmptyNode(t.childNodes[0],e):t.nodeType!==3&&t.nodeType!==11&&t.nodeName!=="IMG"&&!t.classList.contains("e-video-wrap")&&!t.classList.contains("e-audio-wrap")&&t.parentNode.removeChild(t),t},o.prototype.GetCursorStart=function(t,e,i){t=i?t:t.reverse();for(var n=t[0],r=0;r<t.length&&(i?t[r]<e:t[r]>=e);r++)n=t[r];return n},o.prototype.GetCursorRange=function(t,e,i){var n=t.createRange(),r=[];r.push(0);for(var s=this.TrimLineBreak(i.data),a=s.indexOf(" ",0);a!==-1;)r.indexOf(a)<0&&r.push(a),new RegExp("\\s").test(s[a-1])&&r.indexOf(a-1)<0&&r.push(a-1),new RegExp("\\s").test(s[a+1])&&r.push(a+1),a=s.indexOf(" ",a+1);if(r.push(s.length),r.indexOf(e.startOffset)>=0||r.indexOf(e.startOffset-1)>=0&&(e.startOffset!==1||e.startOffset===1&&new RegExp("\\s").test(s[0]))||r[r.length-1]-1===e.startOffset&&e.endOffset!==s.length-1&&!new RegExp("\\s").test(s[0]))n=e,this.position=1;else{var l=this.GetCursorStart(r,e.startOffset,!0);this.position=e.startOffset-l,n.setStart(e.startContainer,l),n.setEnd(e.startContainer,this.GetCursorStart(r,e.startOffset,!1))}return n},o.prototype.GetCursorNode=function(t,e,i){return this.GetSpliceNode(this.GetCursorRange(t,e,i),i)},o.prototype.TrimLineBreak=function(t){return t.replace(/(\r\n\t|\n|\r\t)/gm," ")},o}(),pp=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.observer.on(Da,this.applyFormats,this),this.parent.observer.on(Pi,this.onKeyUp,this),this.parent.observer.on(Oe,this.onKeyDown,this)},o.prototype.getParentNode=function(t){for(;t.parentNode&&t.parentNode!==this.parent.editableElement;null)t=t.parentNode;return t},o.prototype.onKeyUp=function(t){var e=this.parent.nodeSelection.getRange(this.parent.currentDocument),i=e.endContainer,n=i.lastChild;if(t.event.which===13&&e.startContainer===i&&i.nodeType!==3){var r=R("p");if(r.innerHTML="<br>",!h(n)&&n&&n.nodeName==="BR"&&n.previousSibling&&n.previousSibling.nodeName==="TABLE")i.replaceChild(r,n),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0);else{var s=this.parent.nodeSelection.getSelectionNodeCollectionBr(e)[0];!h(s)&&s.nodeName==="BR"&&s.previousSibling&&s.previousSibling.nodeName==="TABLE"&&(i.replaceChild(r,s),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0))}}},o.prototype.onKeyDown=function(t){if(t.event.which===13){var e=this.parent.nodeSelection.getRange(this.parent.currentDocument),i=e.startContainer.textContent.length===0||e.startContainer.nodeName==="PRE"?e.startContainer:e.startContainer.parentElement,n=e.endContainer.textContent.length===0||e.endContainer.nodeName==="PRE"?e.endContainer:e.endContainer.parentElement,r=T(i,"pre"),s=T(n,"pre"),a=!h(r)&&!h(r.parentElement)&&r.parentElement.tagName==="LI";if(a)return;if((h(r)&&!h(s)||!h(r)&&h(s))&&(t.event.preventDefault(),this.deleteContent(e),this.removeCodeContent(e),e=this.parent.nodeSelection.getRange(this.parent.currentDocument),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n,0)),t.event.which===13&&!h(r)&&!h(s)){t.event.preventDefault(),this.deleteContent(e),this.removeCodeContent(e),e=this.parent.nodeSelection.getRange(this.parent.currentDocument);var l=e.startContainer.childNodes[e.endOffset],c=e.startContainer.childNodes[e.endOffset-1],p=e.startContainer;if(!h(l)&&!h(c)&&h(l.nextSibling)&&l.nodeName==="BR"&&c.nodeName==="BR")this.paraFocus(e.startContainer,t.enterAction);else if(p.textContent.charCodeAt(0)===8203&&p.textContent.length===1||p.textContent.length===0){for(;p.parentElement.nodeName!=="PRE"&&(p.textContent.length===1||p.textContent.length===0);)p=p.parentElement;!h(p.previousSibling)&&p.previousSibling.nodeName==="BR"&&h(p.nextSibling)?this.paraFocus(p.parentElement):this.isNotEndCursor(r,e)}else this.isNotEndCursor(r,e)}}},o.prototype.removeCodeContent=function(t){var e=new RegExp(String.fromCharCode(65279),"g");if(!h(t.endContainer.textContent.match(e))){var i=t.endContainer.textContent.charCodeAt(t.endOffset-1)===65279?t.endOffset-2:t.endOffset;t.endContainer.textContent=t.endContainer.textContent.replace(e,""),t.endContainer.textContent===""?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,t.endContainer.parentElement,0):this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,t.endContainer,i)}},o.prototype.deleteContent=function(t){(t.startContainer!==t.endContainer||t.startOffset!==t.endOffset)&&t.deleteContents()},o.prototype.paraFocus=function(t,e){var i;e==="DIV"?(i=R("div"),i.innerHTML="<br>"):e==="BR"?i=R("br"):(i=R("p"),i.innerHTML="<br>"),this.parent.domNode.insertAfter(i,t),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,i,0),S(t.lastChild)},o.prototype.isNotEndCursor=function(t,e){var i=new Jt,n=e.startOffset===t.lastChild.textContent.length&&t.lastChild.textContent===e.startContainer.textContent;if(t.textContent.indexOf(e.startContainer.textContent)===0&&(e.startOffset===0&&e.endOffset===0||e.startContainer.nodeName==="PRE")){this.insertMarker(t,e);var r=R("br");t.childNodes[e.endOffset].parentElement.insertBefore(r,t.childNodes[e.endOffset])}else{var s=i.SplitNode(e,t,!0);this.insertMarker(t,e);var a=t.previousElementSibling;a.tagName==="PRE"&&(a.insertAdjacentHTML("beforeend","<br>"+s.innerHTML),S(t))}this.setCursorPosition(n,t)},o.prototype.setCursorPosition=function(t,e){var i=!1,n=this.parent.editableElement.querySelector(".tempSpan"),r=n.parentElement;if(n.parentNode.textContent===""?i=!0:this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n,0),t)if(i)r===e?(this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n,0),S(n)):this.focusSelectionParent(n,r);else{var s=R("br");this.parent.domNode.insertAfter(s,n),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n,0),S(n)}else i?this.focusSelectionParent(n,r):S(n)},o.prototype.focusSelectionParent=function(t,e){S(t),e.innerHTML="",this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,e,0)},o.prototype.insertMarker=function(t,e){var i=R("span",{className:"tempSpan"});e.startContainer.nodeName==="PRE"?t.childNodes[e.endOffset].parentElement.insertBefore(i,t.childNodes[e.endOffset]):e.startContainer.parentElement.insertBefore(i,e.startContainer)},o.prototype.applyFormats=function(t){var e=this.parent.nodeSelection.getRange(this.parent.currentDocument),i=!1;this.parent.editableElement===e.endContainer&&!h(this.parent.editableElement.children[e.endOffset-1])&&this.parent.editableElement.children[e.endOffset-1].tagName==="TABLE"&&!e.collapsed&&(i=!0);var n=this.parent.nodeSelection.save(e,this.parent.currentDocument);this.parent.domNode.setMarker(n);var r=this.parent.domNode.blockNodes();if(t.enterAction==="BR"){this.setSelectionBRConfig();var s=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),a=this.parent.nodeSelection.getSelectionNodes(s),l=[];a.length===0&&a.push(r[0]);for(var c=0;c<a.length;c++){for(var p=a[c],d=void 0;!this.parent.domNode.isBlockNode(p)&&p!==this.parent.editableElement;)d=p,p=p.parentElement;this.parent.domNode.isBlockNode(p)&&p===this.parent.editableElement&&l.push(d)}for(var c=0;c<l.length;c++)if(!this.parent.domNode.isBlockNode(l[c])){for(var p=l[c],u=p;p===this.parent.editableElement;)u=p,p=p.parentElement;var f=void 0;this.parent.domNode.isBlockNode(u.parentElement)&&u.parentElement===this.parent.editableElement?(f=R("div"),u.parentElement.insertBefore(f,u),f.appendChild(u)):f=u;for(var m=f.previousSibling;!h(m)&&m.nodeName!=="BR"&&!this.parent.domNode.isBlockNode(m);)f.firstChild.parentElement.insertBefore(m,f.firstChild),m=f.previousSibling;!h(m)&&m.nodeName==="BR"&&S(m);for(var v=f.nextSibling;!h(v)&&v.nodeName!=="BR"&&!this.parent.domNode.isBlockNode(v);)f.appendChild(v),v=f.nextSibling;!h(v)&&v.nodeName==="BR"&&S(v)}this.setSelectionBRConfig(),r=this.parent.domNode.blockNodes()}for(var c=0;c<r.length;c++){var y=void 0,L=void 0;if(t.subCommand.toLowerCase()==="blockquote"?(y=this.getParentNode(r[c]),L=this.parent.domNode.isList(y)||y.tagName==="TABLE"?y.outerHTML:y.innerHTML):(y=r[c],L=y.innerHTML),!(t.subCommand.toLowerCase()===y.tagName.toLowerCase()&&(t.subCommand.toLowerCase()!=="pre"||!h(t.exeValue)&&t.exeValue.name==="dropDownSelect")||h(y.parentNode)||y.tagName==="TABLE"&&t.subCommand.toLowerCase()==="pre")){this.cleanFormats(y,t.subCommand);var C=t.subCommand.toLowerCase()==="pre"&&y.tagName.toLowerCase()==="pre"?"p":t.subCommand,w=this.parent.domNode.createTagString(C,y,L.replace(/>\s+</g,"><"));y.tagName==="LI"?(y.innerHTML="",y.insertAdjacentHTML("beforeend",w)):this.parent.domNode.replaceWith(y,w)}}this.preFormatMerge();var k=this.parent.editableElement.querySelector("."+V.startSelection),I=this.parent.editableElement.querySelector("."+V.endSelection);!h(k)&&!h(I)&&(k=k.lastChild,I=I.lastChild),n=this.parent.domNode.saveMarker(n,null),De()&&yt(this.parent.editableElement,t.selector),i?this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,k,I,0,I.textContent.length):n.restore(),t.callBack&&t.callBack({requestType:t.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},o.prototype.setSelectionBRConfig=function(){var t=this.parent.editableElement.querySelector("."+V.startSelection),e=this.parent.editableElement.querySelector("."+V.endSelection);h(e)?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,t,0):this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,t,e,0,0)},o.prototype.preFormatMerge=function(){var t=this.parent.editableElement.querySelectorAll("PRE");if(!h(t))for(var e=0;e<t.length;e++){var i=t[e].previousElementSibling;!h(i)&&i.tagName==="PRE"&&(i.insertAdjacentHTML("beforeend","<br>"+t[e].innerHTML),S(t[e]))}},o.prototype.cleanFormats=function(t,e){var i=["display","font-size","margin-top","margin-bottom","margin-left","margin-right","font-weight"];e=e.toLowerCase();for(var n=0;n<i.length&&e!=="p"&&e!=="blockquote"&&e!=="pre";n++)t.style.removeProperty(i[n])},o}(),Re=function(){function o(){}return o.Insert=function(t,e,i,n,r){var s;if(typeof e=="string"){var a=document.createElement("div");a.innerHTML=e,s=n?a:a.firstChild}else if(n&&!(!h(e)&&!h(e.classList)&&e.classList.contains("pasteContent"))){var a=document.createElement("div");a.appendChild(e),s=a}else s=e;var l=new Be,c=new Jt,p=l.getRange(t);if(p.startContainer===i&&p.startContainer===p.endContainer&&p.startOffset===0&&p.startOffset===p.endOffset&&i.textContent.length===0&&(i.children[0].tagName==="P"||i.children[0].tagName==="DIV"||i.children[0].tagName==="BR")&&(l.setSelectionText(t,p.startContainer.children[0],p.startContainer.children[0],0,0),p=l.getRange(t)),p.startContainer===i&&p.startContainer===p.endContainer&&p.startOffset===0&&p.startOffset===p.endOffset&&i.textContent.trim().length>0){var d=this.findFirstTextNode(p.startContainer);h(d)||(l.setSelectionText(t,d,d,0,0),p=l.getRange(t))}if(p.startContainer.nodeName==="BR"&&p.startOffset===0&&p.startOffset===p.endOffset&&p.startContainer===p.endContainer){var u=Array.prototype.slice.call(p.startContainer.parentElement.childNodes).indexOf(p.startContainer);l.setSelectionText(t,p.startContainer.parentElement,p.startContainer.parentElement,u,u),p=l.getRange(t)}var f=p.startOffset===p.endOffset&&p.startOffset===0&&p.startContainer===p.endContainer,m=p.collapsed,v=this.getNodeCollection(p,l,s),y=s.nodeName.toLowerCase()==="table"?this.closestEle(v[0].parentNode,i):v[0];if(n||!h(s)&&!h(s.classList)&&s.classList.contains("pasteContent")){this.pasteInsertHTML(v,s,p,l,c,t,m,y,i,r);return}if(i!==p.startContainer&&(!m&&!(y.nodeType===Node.ELEMENT_NODE&&mi.indexOf(y.tagName.toLocaleLowerCase())!==-1)||s.nodeName.toLowerCase()==="table"&&y&&mi.indexOf(y.tagName.toLocaleLowerCase())===-1)){var L=c.GetSpliceNode(p,y),C=L.previousSibling,w=L.parentNode;if(v.length===1||s.nodeName.toLowerCase()==="table"&&L.childElementCount===0)l.setSelectionContents(t,L),p=l.getRange(t);else{var k=c.GetSpliceNode(p,v[v.length-1].parentElement);k=h(k)?L:k,l.setSelectionText(t,L,k,0,k.nodeType===3?k.textContent.length:k.childNodes.length),p=l.getRange(t)}p.extractContents(),e.tagName==="TABLE"&&this.removeEmptyElements(i);for(var I=0;I<v.length;I++)if(v[I].nodeType!==3&&v[I].parentNode!=null){if(v[I].nodeName==="IMG")continue;v[I].parentNode.removeChild(v[I])}if(C)re.AppendBefore(s,C,!0);else{for(var P=null;w!==i&&w.firstChild&&w.textContent.trim()==="";){var Z=w.parentNode;P=w,w=Z}P!==null&&(w=P),w.firstChild&&(w!==i||s.nodeName==="TABLE"&&f&&w===p.startContainer&&w===p.endContainer)?w.textContent.trim()===""&&w!==i?(re.AppendBefore(s,w,!1),S(w)):re.AppendBefore(s,w.firstChild,!1):h(L.previousSibling)&&e.tagName==="TABLE"?w.prepend(s):w.appendChild(s)}s.nodeName==="IMG"?this.imageFocus(s,l,t):s.nodeType!==3?l.setSelectionText(t,s,s,0,s.childNodes.length):l.setSelectionText(t,s,s,0,s.textContent.length)}else{if(p.deleteContents(),f&&p.startContainer.textContent===""&&p.startContainer.nodeName!=="BR"&&(p.startContainer.innerHTML=""),D.isIE){var G=t.createDocumentFragment();G.appendChild(s),p.insertNode(G)}else if(p.startContainer.nodeType===1&&p.startContainer.nodeName.toLowerCase()==="hr"&&p.endContainer.nodeName.toLowerCase()==="hr"){var $=p.startContainer.nextElementSibling;$&&($.querySelector("br")&&S($.querySelector("br")),$.appendChild(s))}else p.startContainer.nodeName==="BR"?p.startContainer.parentElement.insertBefore(s,p.startContainer):p.insertNode(s);s.nodeType!==3&&s.childNodes.length>0?l.setSelectionText(t,s,s,1,1):s.nodeName==="IMG"?this.imageFocus(s,l,t):s.nodeType!==3?l.setSelectionContents(t,s):l.setSelectionText(t,s,s,s.textContent.length,s.textContent.length)}},o.findFirstTextNode=function(t){if(t.nodeType===Node.TEXT_NODE)return t;for(var e=0;e<t.childNodes.length;e++){var i=this.findFirstTextNode(t.childNodes[e]);if(!h(i))return i}return null},o.pasteInsertHTML=function(t,e,i,n,r,s,a,l,c,p){var d=i.startOffset===i.endOffset&&i.startContainer===i.endContainer;if(d&&i.startContainer===c&&c.textContent===""){var u=this.getImmediateBlockNode(t[t.length-1],c);n.setSelectionText(s,u,u,0,0),i=n.getRange(s)}var f,m,v,y;c!==i.startContainer&&(!a&&!(l.nodeType===Node.ELEMENT_NODE&&mi.indexOf(l.tagName.toLocaleLowerCase())!==-1)||e.nodeName.toLowerCase()==="table"&&l&&mi.indexOf(l.tagName.toLocaleLowerCase())===-1)&&(y=r.GetSpliceNode(i,l),m=h(y.previousSibling)?y.parentNode.previousSibling:y.previousSibling,t.length===1?(n.setSelectionContents(s,y),i=n.getRange(s),v=!0):(f=r.GetSpliceNode(i,t[t.length-1].parentElement),f=h(f)?y:f,n.setSelectionText(s,y,f,0,f.nodeType===3?f.textContent.length:f.childNodes.length),i=n.getRange(s),v=!1));var L=!1;this.removingComments(e);for(var C=e.childNodes,w=0;w<C.length;w++)if(Nt.indexOf(C[w].nodeName.toLocaleLowerCase())>=0){L=!0;break}var k,I=document.createDocumentFragment();if(L){for(var ae=i.startContainer;!h(ae)&&ae.nodeName!=="PRE"&&ae!==c;)ae=ae.parentElement;if(!h(e)&&!h(ae)&&ae.nodeName==="PRE")i.insertNode(e),k=e.lastChild;else{this.insertTempNode(i,e,t,r,c);var ue=!0,xe=void 0,_=void 0,ee=void 0;for(this.contentsDeleted||i.deleteContents();e.firstChild;){if(e.firstChild.nodeName==="#text"&&e.firstChild.textContent.trim()===""){S(e.firstChild);continue}if(e.firstChild.nodeName==="#text"&&ue||this.inlineNode.indexOf(e.firstChild.nodeName.toLocaleLowerCase())>=0&&ue){if(k=e.firstChild,h(e.previousElementSibling)){var K=p==="DIV"?R("div"):R("p");e.parentElement.insertBefore(K,e)}e.previousElementSibling.nodeName==="BR"?e.parentElement.insertBefore(e.firstChild,e):e.previousElementSibling.appendChild(e.firstChild)}else k=e.firstChild,e.firstChild.nodeName==="#text"||this.inlineNode.indexOf(e.firstChild.nodeName.toLocaleLowerCase())>=0?(xe?(ee.appendChild(e.firstChild),I.appendChild(ee)):(_=p==="DIV"?R("div"):R("p"),_.appendChild(e.firstChild),I.appendChild(_)),ee=_,xe=!0):(I.appendChild(e.firstChild),xe=!1),ue=!1}e.parentNode.replaceChild(I,e)}}else if(d){var P=R("span",{className:"tempSpan"}),Z=T(i.startContainer.parentElement,"a");if(i.startContainer.nodeType===3&&Z&&T(Z,"span")){var G=this.getImmediateBlockNode(i.startContainer,c);G.querySelectorAll("br").length>0&&S(G.querySelector("br"));var $=T(Z,"span");$.appendChild(P)}else i.insertNode(P);for(;e.firstChild;)k=e.firstChild,I.appendChild(e.firstChild);P.parentNode.replaceChild(I,P)}else{for(;e.firstChild;)k=e.firstChild,I.appendChild(e.firstChild);v?y.parentNode.replaceChild(I,y):(i.deleteContents(),h(f)||S(f),h(m)?c.appendChild(I):m.parentNode.appendChild(I))}k.nodeName==="#text"?this.placeCursorEnd(k,e,n,s,c):this.cursorPos(k,e,n,s,c,p)},o.placeCursorEnd=function(t,e,i,n,r){for(t=t.nodeName==="BR"?h(t.previousSibling)?t.parentNode:t.previousSibling:t;!h(t)&&t.nodeName!=="#text"&&t.nodeName!=="IMG"&&t.nodeName!=="BR"&&t.nodeName!=="HR";){if(!h(t.lastChild)&&t.lastChild.nodeName==="P"&&t.lastChild.innerHTML===""){var s=R("br");t.lastChild.appendChild(s)}t=t.lastChild}t=h(t)?e:t,t.nodeName==="IMG"?this.imageFocus(t,i,n):i.setSelectionText(n,t,t,t.textContent.length,t.textContent.length),this.removeEmptyElements(r)},o.getNodeCollection=function(t,e,i){var n=[];return t.startOffset===t.endOffset&&t.startContainer===t.endContainer&&t.startContainer.nodeName!=="BR"&&t.startContainer.childNodes.length>0&&(t.startContainer.nodeName==="TD"||t.startContainer.nodeType!==3&&i.classList&&i.classList.contains("pasteContent"))?n.push(t.startContainer.childNodes[t.endOffset]):n=e.getInsertNodeCollection(t),n},o.insertTempNode=function(t,e,i,n,r){if(t.startContainer===r&&!h(t.startContainer.childNodes[t.endOffset-1])&&t.startContainer.childNodes[t.endOffset-1].nodeName==="TABLE")h(t.startContainer.childNodes[t.endOffset-1].nextSibling)?t.startContainer.appendChild(e):t.startContainer.insertBefore(e,t.startContainer.childNodes[t.endOffset-1].nextSibling);else if(t.startContainer===r&&!h(t.startContainer.childNodes[t.endOffset])&&t.startContainer.childNodes[t.endOffset].nodeName==="TABLE")t.startContainer.insertBefore(e,t.startContainer.childNodes[t.endOffset]);else if(t.startContainer===t.endContainer&&t.startContainer.nodeType!==3&&e.firstChild.nodeName==="HR")t.startContainer.classList.contains("e-content")||t.startContainer.nodeName==="BODY"?t.startContainer.appendChild(e):t.startContainer.parentNode.insertBefore(e,t.startContainer);else{var s=this.getImmediateBlockNode(i[i.length-1],r);if((h(s)||h(s.parentElement))&&t.endContainer.nodeType!==3&&(s=t.endContainer,t.setEnd(s,t.endContainer.textContent.length)),s.nodeName==="BODY"&&t.startContainer===t.endContainer&&t.startContainer.nodeType===1&&(s=t.startContainer),s.closest("LI")&&e&&e.firstElementChild&&(e.firstElementChild.tagName==="OL"||e.firstElementChild.tagName==="UL"))for(var a=void 0;e.firstElementChild.lastElementChild&&e.firstElementChild.lastElementChild.tagName==="LI";)a=e.firstElementChild.lastElementChild,a.style.removeProperty("margin-left"),a.style.removeProperty("margin-top"),a.style.removeProperty("margin-bottom"),e.firstElementChild.insertAdjacentElement("afterend",a);if(s.nodeName==="TD"||s.nodeName==="TH"||s.nodeName==="TR"){var l=R("span",{className:"tempSpan"});t.insertNode(l),l.parentNode.replaceChild(e,l)}else{var c=new Be,p=this.getNodeCollection(t,c,e)[this.getNodeCollection(t,c,e).length-1],d=void 0;if((p.nodeName==="BR"||p.nodeName==="HR"||p.nodeName==="#text"&&!h(p.parentElement)&&p.parentElement.nodeName==="LI")&&!h(p.parentElement)&&p.parentElement.textContent.trim().length===0)d=p,p.parentElement.nodeName==="LI"&&!h(p.nextSibling)&&p.nextSibling.nodeName==="BR"&&S(p.nextSibling);else if((p.nodeName==="#text"||p.nodeName==="BR")&&!h(p.parentElement)&&(p.parentElement.nodeName==="LI"||s===r&&p.parentElement===s)&&p.parentElement.textContent.trim().length>0){d=p,p.parentElement.nodeName==="LI"&&!h(p.nextSibling)&&p.nextSibling.nodeName==="BR"&&S(p.nextSibling),t.collapsed||t.deleteContents(),t.insertNode(e),this.contentsDeleted=!0;return}else d=n.GetSpliceNode(t,s);d.parentNode.replaceChild(e,d)}}},o.cursorPos=function(t,e,i,n,r,s){t.classList.add("lastNode"),r.innerHTML=tp(r.innerHTML,s),t=r.querySelector(".lastNode"),h(t)||(this.placeCursorEnd(t,e,i,n,r),t.classList.remove("lastNode"),t.classList.length===0&&t.removeAttribute("class"))},o.imageFocus=function(t,e,i){var n=document.createTextNode(" ");t.parentNode.insertBefore(n,t.nextSibling),e.setSelectionText(i,t.nextSibling,t.nextSibling,0,0)},o.getImmediateBlockNode=function(t,e){do t=t.parentNode;while(t&&Nt.indexOf(t.nodeName.toLocaleLowerCase())<0);return t},o.removingComments=function(t){var e=t.innerHTML;e=e.replace(/<!--[\s\S]*?-->/g,""),t.innerHTML=e},o.findDetachEmptyElem=function(t){var e;if(h(t.parentElement))e=null;else{var i=t.parentElement.textContent.length>0&&t.parentElement.textContent.match(/\u00a0/g)&&t.parentElement.textContent.match(/\u00a0/g).length>0;!i&&t.parentElement.textContent.trim()===""&&t.parentElement.contentEditable!=="true"&&h(t.parentElement.querySelector("img"))?e=this.findDetachEmptyElem(t.parentElement):e=t}return e},o.removeEmptyElements=function(t){for(var e=t.querySelectorAll(":empty"),i=Array.from(e).filter(function(a){return!a.closest("svg")&&!a.closest("canvas")}),n=0;n<i.length;n++){var r=!0;if(i[n].tagName==="DIV"&&(r=i[n].style.borderBottom==="none"||i[n].style.borderBottom===""),hp.indexOf(i[n].tagName.toLowerCase())<0&&r){var s=this.findDetachEmptyElem(i[n]);h(s)||S(s)}}},o.closestEle=function(t,e){for(var i=t;i&&i.nodeType===1;){if(i.parentNode===e||!h(i.parentNode.tagName)&&tt.indexOf(i.parentNode.tagName.toLocaleLowerCase())!==-1)return i;i=i.parentNode}return null},o.inlineNode=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"],o.contentsDeleted=!1,o}(),dp=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.observer.on(Ha,this.linkCommand,this)},o.prototype.linkCommand=function(t){switch(t.value.toString().toLocaleLowerCase()){case"createlink":case"editlink":this.createLink(t);break;case"openlink":this.openLink(t);break;case"removelink":this.removeLink(t);break}},o.prototype.createLink=function(t){var e=!h(t.item.selectParent)&&t.item.selectParent.length>0&&T(t.item.selectParent[0],"a");if(e=h(e)?!h(t.item.selectParent)&&t.item.selectParent.length>0?t.item.selectParent[0]:null:e,!h(e)&&e.tagName==="A"){var i=e,n="";if(h(t.item.url)||i.setAttribute("href",t.item.url),h(t.item.title)||i.setAttribute("title",t.item.title),!h(t.item.text)&&t.item.text!==""&&(n=i.innerText,i.innerText=t.item.text),h(t.item.target)?(i.removeAttribute("target"),i.removeAttribute("aria-label")):(i.setAttribute("target",t.item.target),i.setAttribute("aria-label",t.item.ariaLabel)),n===t.item.text)t.item.selection.setSelectionText(this.parent.currentDocument,i,i,1,1),t.item.selection.restore();else{var r=t.item.action==="Paste"?i.childNodes[0].textContent.length:0;t.item.selection.setSelectionText(this.parent.currentDocument,i.childNodes[0],i.childNodes[0],r,i.childNodes[0].textContent.length)}}else{var s=new Be,a=s.getRange(this.parent.currentDocument);a.endContainer.nodeName==="#text"&&a.startContainer.textContent.length===a.endOffset+1&&a.endContainer.textContent.charAt(a.endOffset)===" "&&!h(a.endContainer.nextSibling)&&a.endContainer.nextSibling.nodeName==="A"&&(s.setSelectionText(this.parent.currentDocument,a.startContainer,a.endContainer,a.startOffset,a.endOffset+1),a=s.getRange(this.parent.currentDocument));var l=h(t.item.text)?!0:t.item.text.replace(/ /g,"").localeCompare(a.toString().replace(/\n/g," ").replace(/ /g,""))<0;if(t.event&&t.event.type==="keydown"&&(t.event.keyCode===32||t.event.keyCode===13)||t.item.action==="Paste"||a.collapsed||l){var c=this.createAchorNode(t);c.innerText=t.item.text===""?t.item.url:t.item.text;var p=c.innerText,d=p.replace(/  +/g,function(f){return"".repeat(f.length)});if(c.innerText=d,t.item.selection.restore(),Re.Insert(this.parent.currentDocument,c,this.parent.editableElement),t.event&&t.event.type==="keydown"&&(t.event.keyCode===32||t.event.keyCode===13)){var u=t.item.selection.range.startContainer;u.textContent=this.removeText(u.textContent,t.item.text)}else{var r=t.item.action==="Paste"?c.childNodes[0].textContent.length:0;t.item.selection.setSelectionText(this.parent.currentDocument,c.childNodes[0],c.childNodes[0],r,c.childNodes[0].textContent.length)}}else this.createLinkNode(t)}t.callBack&&t.callBack({requestType:"Links",editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},o.prototype.createLinkNode=function(t){for(var e=new Be,i=new Jt,n=e.getRange(this.parent.currentDocument),r=this.getSelectionNodes(e.getNodeCollection(n)),s=e.save(n,this.parent.currentDocument),a=[],l=[],c,p=[],d=[],u=[],f,m=0;m<r.length;m++)r[m]=i.GetSpliceNode(n,r[m]),a[m]=r[m];for(var v=0;v<a.length;v++){var y=!0;for(c=a[v];y===!0;){if(c.parentNode.nodeName==="A"){var L=c.parentNode;c.parentNode.parentNode.insertBefore(L.firstChild,L),c.parentNode.removeChild(L)}this.isBlockNode(c.parentNode)||a.length===0||v===0||v===a.length-1||n.startContainer.nodeType===3?(l[v]=c,y=!1):c=c.parentNode}}for(var v=0,C=0;v<l.length;v++)if(v===0&&(u[C]=l[v]),l.length>1&&v<l.length-1){if(l[v].parentElement===l[v+1].parentElement&&l[v]===l[v+1])continue;u[C+1]=l[v+1],C++}var w=0;d[w]=this.createAchorNode(t);for(var v=0;v<u.length;v++)if(v===0&&(f=u[v].cloneNode(!0),d[v].appendChild(f)),v<u.length-1)if(u[v].parentNode===u[v+1].parentNode){var k=u[v+1].cloneNode(!0);d[w].appendChild(k)}else w=w+1,d[w]=this.createAchorNode(t),f=u[v+1].cloneNode(!0),d[w].appendChild(f);this.parent.nodeSelection.setRange(document,s.range);for(var v=0,I=0,P=0;v<=u.length;v++)v===0&&(u[v].parentNode.insertBefore(d[I],u[v].nextSibling),this.parent.domNode.blockNodes().length===1&&this.parent.nodeSelection.setSelectionNode(this.parent.currentDocument,d[I]),p[P]=u[v],P++),v<u.length-1&&(u[v].parentNode===u[v+1].parentNode?(p[P]=u[v+1],P++):(I=I+1,u[v+1].parentNode.insertBefore(d[I],u[v+1]),p[P]=u[v+1],P++));for(var v=0;v<p.length;v++)p[v].parentNode&&p[v].parentNode.removeChild(p[v])},o.prototype.createAchorNode=function(t){var e=R("a",{className:"e-rte-anchor",attrs:{href:t.item.url,title:h(t.item.title)||t.item.title===""?t.item.url:t.item.title}});return h(t.item.target)||e.setAttribute("target",t.item.target),h(t.item.ariaLabel)||e.setAttribute("aria-label",t.item.ariaLabel),e},o.prototype.getSelectionNodes=function(t){t=t.reverse();for(var e=0;e<t.length;e++)(t[e].nodeType!==3||t[e].textContent.trim()==="")&&t[e].nodeName!=="IMG"&&(t.splice(e,1),e--);return t.reverse()},o.prototype.isBlockNode=function(t){return!!t&&t.nodeType===Node.ELEMENT_NODE&&Nt.indexOf(t.tagName.toLowerCase())>=0},o.prototype.removeText=function(t,e){for(var i=t.split(" "),n=0;n<i.length;n++)i[n]===e&&(i.splice(n,1),n--);return i.join(" ")+" "},o.prototype.openLink=function(t){document.defaultView.open(t.item.url,t.item.target),this.callBack(t)},o.prototype.removeLink=function(t){var e=this.parent.domNode.blockNodes();if(e.length<2){this.parent.domNode.setMarker(t.item.selection);for(var i=T(t.item.selectParent[0],"a"),n=i||t.item.selectParent[0],r=n.parentNode,s=[];n.firstChild;null)s.push(r.insertBefore(n.firstChild,n));r.removeChild(n),s&&s.length===1&&(t.item.selection.startContainer=t.item.selection.getNodeArray(s[s.length-1],!0),t.item.selection.endContainer=t.item.selection.startContainer),t.item.selection=this.parent.domNode.saveMarker(t.item.selection)}else for(var a=0;a<e.length;a++)for(var l=e[a].querySelectorAll("a"),c=0;c<l.length;c++)this.parent.currentDocument.getSelection().containsNode(l[c],!0)&&(l[c].outerHTML=l[c].innerHTML);t.item.selection.restore(),this.callBack(t)},o.prototype.callBack=function(t){t.callBack&&t.callBack({requestType:t.item.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},o}(),up=function(){function o(t){this.alignments={JustifyLeft:"left",JustifyCenter:"center",JustifyRight:"right",JustifyFull:"justify"},this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.observer.on(Ka,this.applyAlignment,this),this.parent.observer.on(Oe,this.onKeyDown,this)},o.prototype.onKeyDown=function(t){switch(t.event.action){case"justify-center":this.applyAlignment({subCommand:"JustifyCenter",callBack:t.callBack}),t.event.preventDefault();break;case"justify-full":this.applyAlignment({subCommand:"JustifyFull",callBack:t.callBack}),t.event.preventDefault();break;case"justify-left":this.applyAlignment({subCommand:"JustifyLeft",callBack:t.callBack}),t.event.preventDefault();break;case"justify-right":this.applyAlignment({subCommand:"JustifyRight",callBack:t.callBack}),t.event.preventDefault();break}},o.prototype.getTableNode=function(t){var e=t.startContainer.nodeType===Node.ELEMENT_NODE?t.startContainer:t.startContainer.parentNode,i=T(e,"td,th");return[i]},o.prototype.applyAlignment=function(t){var e=t.value==="Table",i=this.parent.nodeSelection.getRange(this.parent.currentDocument),n=this.parent.nodeSelection.save(i,this.parent.currentDocument);if(e)Q(this.getTableNode(i)[0],{"text-align":this.alignments[t.subCommand]});else{this.parent.domNode.setMarker(n);for(var r=this.parent.domNode.blockNodes(),s=0;s<r.length;s++){var a=r[s];Q(a,{"text-align":this.alignments[t.subCommand]})}for(var l=this.parent.domNode.getImageTagInSelection(),s=0;s<l.length;s++){var c=[];c.push(l[s]),this.parent.imgObj.imageCommand({item:{selectNode:c},subCommand:t.subCommand,value:t.subCommand,callBack:t.callBack,selector:t.selector})}this.parent.editableElement.focus(),n=this.parent.domNode.saveMarker(n),De()&&yt(this.parent.editableElement,t.selector),n.restore()}t.callBack&&t.callBack({requestType:t.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:e?this.getTableNode(i):this.parent.domNode.blockNodes()})},o}(),fp=function(){function o(t){this.indentValue=20,this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.observer.on(Xa,this.applyIndents,this),this.parent.observer.on(Oe,this.onKeyDown,this)},o.prototype.onKeyDown=function(t){switch(t.event.action){case"indents":this.applyIndents({subCommand:"Indent",callBack:t.callBack}),t.event.preventDefault();break;case"outdents":this.applyIndents({subCommand:"Outdent",callBack:t.callBack}),t.event.preventDefault();break}},o.prototype.applyIndents=function(t){var e=this.parent.editableElement,i=e.classList.contains("e-rtl"),n=this.parent.nodeSelection.getRange(this.parent.currentDocument),r=this.parent.nodeSelection.save(n,this.parent.currentDocument);this.parent.domNode.setMarker(r);for(var s=this.parent.domNode.blockNodes(),a=s.slice(),l=[],c=0;c<a.length;c++)a[c].tagName!=="LI"&&a[c].parentNode.tagName==="LI"?(s.splice(s.indexOf(a[c]),1),l.push(a[c].parentNode)):a[c].tagName==="LI"&&(s.splice(s.indexOf(a[c]),1),l.push(a[c]));l.length>0&&this.parent.observer.notify(Oe,{event:{preventDefault:function(){},stopPropagation:function(){},shiftKey:t.subCommand!=="Indent",which:9,action:"indent"},ignoreDefault:!0});for(var c=0;c<s.length;c++){var p=s[c],d=i?p.style.marginRight:p.style.marginLeft,u=void 0;t.subCommand==="Indent"?(u=d===""?this.indentValue+"px":parseInt(d,null)+this.indentValue+"px",i?p.style.marginRight=u:p.style.marginLeft=u):(u=d===""||d==="0px"?"":parseInt(d,null)-this.indentValue+"px",i?p.style.marginRight=u:p.style.marginLeft=u)}e.focus(),De()&&yt(e,t.selector),r=this.parent.domNode.saveMarker(r),r.restore(),t.callBack&&t.callBack({requestType:t.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},o}(),Je="e-imgright",Ze="e-imgleft",zt="e-imgcenter",mp="e-video-right",gp="e-video-left",vp="e-video-center",Vr="e-imgbreak",bp="e-audio-break",yp="e-video-break",te="e-img-caption",Go="e-caption-inline",Cp="e-imginline",Ko="e-audio-inline",Xo="e-clickelem",nn="e-video-clickelem",Ur="e-rte-audio",qt="e-rte-video",rn="e-audio-wrap",Tp="e-video-wrap",Yo="e-embed-video-wrap",$o="e-audio-focus",Jo="e-video-focus",Zo="e-video-inline",Sp=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.observer.on(Is,this.imageCommand,this)},o.prototype.imageCommand=function(t){switch(t.value.toString().toLowerCase()){case"image":case"replace":this.createImage(t);break;case"insertlink":this.insertImageLink(t);break;case"openimagelink":this.openImageLink(t);break;case"editimagelink":this.editImageLink(t);break;case"removeimagelink":this.removeImageLink(t);break;case"remove":this.removeImage(t);break;case"alttext":this.insertAltTextImage(t);break;case"dimension":this.imageDimension(t);break;case"caption":this.imageCaption(t);break;case"justifyleft":this.imageJustifyLeft(t);break;case"justifycenter":this.imageJustifyCenter(t);break;case"justifyright":this.imageJustifyRight(t);break;case"inline":this.imageInline(t);break;case"break":this.imageBreak(t);break}},o.prototype.createImage=function(t){var e=this,i=!1;if(t.item.url=h(t.item.url)||t.item.url==="undefined"?t.item.src:t.item.url,!h(t.item.selectParent)&&t.item.selectParent[0].tagName==="IMG"){var n=t.item.selectParent[0];i=!0,this.setStyle(n,t,i)}else{var r=R("img");this.setStyle(r,t),h(t.item.selection)||t.item.selection.restore(),!h(t.selector)&&t.selector==="pasteCleanupModule"?t.callBack({requestType:"Images",editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:[r]}):Re.Insert(this.parent.currentDocument,r,this.parent.editableElement)}if(t.callBack&&(h(t.selector)||!h(t.selector)&&t.selector!=="pasteCleanupModule")){var s=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)[0],a=t.value==="Replace"||i?t.item.selectParent[0]:D.isIE?s.previousSibling:s.previousElementSibling;a.addEventListener("load",function(){(t.value!=="Replace"||!i)&&t.callBack({requestType:"Images",editorMode:"HTML",event:t.event,range:e.parent.nodeSelection.getRange(e.parent.currentDocument),elements:[a]})})}t.value==="Replace"&&(t.item.subCommand="Replace",this.callBack(t))},o.prototype.setStyle=function(t,e,i){h(e.item.url)||t.setAttribute("src",e.item.url);var n;if(i)for(var r={"e-imgcenter":"e-imgcenter","e-imgright":"e-imgright","e-imgleft":"e-imgleft"},s=t.classList,a=0;a<s.length;a++)h(r[s[a]])||(n=r[s[a]]);t.setAttribute("class","e-rte-image"+(h(e.item.cssClass)?"":" "+e.item.cssClass)+(h(n)?"":" "+n)),h(e.item.altText)||t.setAttribute("alt",e.item.altText),!h(e.item.width)&&!h(e.item.width.width)&&t.setAttribute("width",this.calculateStyleValue(e.item.width.width)),!h(e.item.height)&&!h(e.item.height.height)&&t.setAttribute("height",this.calculateStyleValue(e.item.height.height)),!h(e.item.width)&&!h(e.item.width.minWidth)&&(t.style.minWidth=this.calculateStyleValue(e.item.width.minWidth)),!h(e.item.width)&&!h(e.item.width.maxWidth)&&(t.style.maxWidth=this.calculateStyleValue(e.item.width.maxWidth)),!h(e.item.height)&&!h(e.item.height.minHeight)&&(t.style.minHeight=this.calculateStyleValue(e.item.height.minHeight)),!h(e.item.height)&&!h(e.item.height.maxHeight)&&(t.style.maxHeight=this.calculateStyleValue(e.item.height.maxHeight))},o.prototype.calculateStyleValue=function(t){var e;return typeof t=="string"&&(t.indexOf("px")||t.indexOf("%")||t.indexOf("auto"))?e=t:e=t+"px",e},o.prototype.insertImageLink=function(t){var e=R("a",{attrs:{href:t.item.url}});t.item.selectNode[0].parentElement.classList.contains("e-img-wrap")&&(t.item.selection.restore(),e.setAttribute("contenteditable","true")),e.appendChild(t.item.selectNode[0]),h(t.item.target)||e.setAttribute("target",t.item.target),h(t.item.ariaLabel)||e.setAttribute("aria-label",t.item.ariaLabel),Re.Insert(this.parent.currentDocument,e,this.parent.editableElement),this.callBack(t)},o.prototype.openImageLink=function(t){document.defaultView.open(t.item.url,t.item.target),this.callBack(t)},o.prototype.removeImageLink=function(t){var e=t.item.selectParent[0];if(e.classList.contains("e-img-caption")){var i=A(".e-img-wrap",e),n=A(".e-img-inner",e),r=n.cloneNode(!0);S(A("a",e)),S(n),i.appendChild(t.item.insertElement),i.appendChild(r)}else S(e),D.isIE&&t.item.selection&&t.item.selection.restore(),Re.Insert(this.parent.currentDocument,t.item.insertElement,this.parent.editableElement);this.callBack(t)},o.prototype.editImageLink=function(t){t.item.selectNode[0].parentElement.href=t.item.url,h(t.item.target)?(t.item.selectNode[0].parentElement.removeAttribute("target"),t.item.selectNode[0].parentElement.removeAttribute("aria-label")):(t.item.selectNode[0].parentElement.target=t.item.target,t.item.selectNode[0].parentElement.ariaLabel=t.item.ariaLabel),this.callBack(t)},o.prototype.removeImage=function(t){T(t.item.selectNode[0],"a")?t.item.selectNode[0].parentElement.nodeName==="A"&&!h(t.item.selectNode[0].parentElement.innerText)?h(T(t.item.selectNode[0],"."+te))?S(t.item.selectNode[0]):S(T(t.item.selectNode[0],"."+te)):S(T(t.item.selectNode[0],"a")):h(T(t.item.selectNode[0],"."+te))?S(t.item.selectNode[0]):S(T(t.item.selectNode[0],"."+te)),this.callBack(t)},o.prototype.insertAltTextImage=function(t){t.item.selectNode[0].setAttribute("alt",t.item.altText),this.callBack(t)},o.prototype.imageDimension=function(t){var e=t.item.selectNode[0];e.style.height="",e.style.width="",t.item.width!=="auto"?e.style.width=H(t.item.width):e.removeAttribute("width"),t.item.height!=="auto"?e.style.height=H(t.item.height):e.removeAttribute("height"),this.callBack(t)},o.prototype.imageCaption=function(t){Re.Insert(this.parent.currentDocument,t.item.insertElement,this.parent.editableElement),this.callBack(t)},o.prototype.imageJustifyLeft=function(t){var e=t.item.selectNode[0];h(e)||(e.removeAttribute("class"),x([e],"e-rte-image"),h(T(e,"."+te))||(O([T(e,"."+te)],Je),x([T(e,"."+te)],Ze)),e.parentElement.nodeName==="A"?(O([e.parentElement],Je),x([e.parentElement],Ze),x([e],Ze)):x([e],Ze),this.callBack(t))},o.prototype.imageJustifyCenter=function(t){var e=t.item.selectNode[0];h(e)||(e.removeAttribute("class"),x([e],"e-rte-image"),h(T(e,"."+te))||(O([T(e,"."+te)],Ze),O([T(e,"."+te)],Je),x([T(e,"."+te)],zt)),e.parentElement.nodeName==="A"?(O([e.parentElement],Ze),O([e.parentElement],Je),x([e.parentElement],zt),x([e],zt)):x([e],zt),this.callBack(t))},o.prototype.imageJustifyRight=function(t){var e=t.item.selectNode[0];h(e)||(e.removeAttribute("class"),x([e],"e-rte-image"),h(T(e,"."+te))||(O([T(e,"."+te)],Ze),x([T(e,"."+te)],Je)),e.parentElement.nodeName==="A"?(O([e.parentElement],Ze),x([e.parentElement],Je),x([e],Je)):x([e],Je),this.callBack(t))},o.prototype.imageInline=function(t){var e=t.item.selectNode[0];e.removeAttribute("class"),x([e],"e-rte-image"),x([e],Cp),h(T(e,"."+te))||(O([T(e,"."+te)],Vr),O([T(e,"."+te)],zt),O([T(e,"."+te)],Ze),O([T(e,"."+te)],Je),x([T(e,"."+te)],Go)),this.callBack(t)},o.prototype.imageBreak=function(t){var e=t.item.selectNode[0];e.removeAttribute("class"),x([e],Vr),x([e],"e-rte-image"),h(T(e,"."+te))||(O([T(e,"."+te)],Go),O([T(e,"."+te)],zt),O([T(e,"."+te)],Ze),O([T(e,"."+te)],Je),x([T(e,"."+te)],Vr)),this.callBack(t)},o.prototype.callBack=function(t){t.callBack&&t.callBack({requestType:t.item.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},o}(),Ep=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.observer.on(Aa,this.audioCommand,this)},o.prototype.audioCommand=function(t){var e,i=t.value.toString().toLowerCase();switch((i==="inline"||i==="break"||i==="audioremove")&&(e=t.item.selectNode[0]),i){case"audio":case"audioreplace":this.createAudio(t);break;case"inline":e.removeAttribute("class"),e.closest("."+rn).style.display="inline-block",x([e],[Ur,Ko,$o]),this.callBack(t);break;case"break":e.removeAttribute("class"),e.closest("."+rn).style.display="block",x([e],[bp,Ur,$o]),this.callBack(t);break;case"audioremove":S(e),this.callBack(t);break}},o.prototype.createAudio=function(t){var e=this,i=!1,n;if(!h(t.item.selectParent)&&t.item.selectParent[0].classList&&(t.item.selectParent[0].classList.contains(Xo)||t.item.selectParent[0].classList.contains(rn))){var r=t.item.selectParent[0].querySelector("source");this.setStyle(r,t),i=!0}else{n=R("span",{className:rn,attrs:{contentEditable:"false",title:t.item.fileName}});var s=R("audio",{className:Ur+" "+Ko,attrs:{controls:""}}),a=R("source"),l=R("span",{className:Xo});if(this.setStyle(a,t),s.appendChild(a),l.appendChild(s),n.appendChild(l),h(t.item.selection)||t.item.selection.restore(),Re.Insert(this.parent.currentDocument,n,this.parent.editableElement),n.nextElementSibling===null){var c=R("br");n.parentNode.insertBefore(c,n.nextSibling)}}if(t.callBack&&(h(t.selector)||!h(t.selector)&&t.selector!=="pasteCleanupModule")){var p=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)[0],d=t.value==="AudioReplace"||i?t.item.selectParent[0].querySelector("audio"):D.isIE?p:p.querySelector("audio");d.addEventListener("loadeddata",function(){(t.value!=="AudioReplace"||!i)&&t.callBack({requestType:"Audios",editorMode:"HTML",event:t.event,range:e.parent.nodeSelection.getRange(e.parent.currentDocument),elements:[d]})}),i&&d.load()}},o.prototype.setStyle=function(t,e){h(e.item.url)||t.setAttribute("src",e.item.url);var i=e.item.fileName?e.item.fileName.split(".").pop().toLowerCase():e.item.url?e.item.url.split(".").pop().toLowerCase():"";i==="opus"?t.type="audio/ogg":i==="m4a"?t.type="audio/mp4":t.type=e.item.fileName&&e.item.fileName.split(".").length>0?"audio/"+e.item.fileName.split(".")[e.item.fileName.split(".").length-1]:e.item.url&&e.item.url.split(".").length>0?"audio/"+e.item.url.split(".")[e.item.url.split(".").length-1]:""},o.prototype.callBack=function(t){t.callBack&&t.callBack({requestType:t.item.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},o}(),Lp=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.observer.on(Pa,this.videoCommand,this)},o.prototype.videoCommand=function(t){var e,i,n,r=t.value.toString().toLowerCase();switch(r!=="video"&&r!=="videoreplace"&&(e=t.item.selectNode[0],i=e.closest("."+Yo),n=e.closest("."+nn)),r){case"video":case"videoreplace":this.createVideo(t);break;case"videodimension":this.videoDimension(t);break;case"inline":e.removeAttribute("class"),i&&(i.style.display="inline-block"),n&&(e.parentElement.style.cssFloat=""),x([e],[qt,Zo,Jo]),this.callBack(t);break;case"break":e.removeAttribute("class"),i&&(i.style.display="block"),n&&(e.parentElement.style.cssFloat=""),x([e],[yp,qt,Jo]),this.callBack(t);break;case"justifyleft":e.removeAttribute("class"),i&&(i.style.display="block"),n&&(e.parentElement.style.cssFloat="left"),x([e],[qt,gp]),this.callBack(t);break;case"justifycenter":e.removeAttribute("class"),i&&(i.style.display="block"),n&&(e.parentElement.style.cssFloat=""),x([e],[qt,vp]),this.callBack(t);break;case"justifyright":e.removeAttribute("class"),i&&(i.style.display="block"),n&&(e.parentElement.style.cssFloat="right"),x([e],[qt,mp]),this.callBack(t);break;case"videoremove":S(e.parentElement),this.callBack(t);break}},o.prototype.createVideo=function(t){var e=this,i=!1,n,r,s;if(t.value==="VideoReplace"&&!h(t.item.selectParent)&&t.item.selectParent[0].tagName==="VIDEO"){var a=t.item.selectParent[0].querySelector("source");this.setStyle(a,t,a),i=!0}else if(t.value==="VideoReplace"&&!h(t.item.selectParent)&&t.item.selectParent[0].classList&&t.item.selectParent[0].classList.contains(nn))t.item.selectParent[0].innerHTML=t.item.fileName,this.setStyle(t.item.selectParent[0].firstElementChild,t,t.item.selectParent[0].firstElementChild);else{if(!t.item.isEmbedUrl)n=R("span",{className:Tp,attrs:{contentEditable:"false",title:t.item.fileName}}),r=R("video",{className:qt+" "+Zo,attrs:{controls:""}}),s=R("source"),this.setStyle(s,t,r),r.appendChild(s),n.appendChild(r);else{n=R("span",{className:Yo,attrs:{contentEditable:"false"}});var l=R("span",{className:nn}),c=R("template");c.innerHTML=t.item.fileName,l.appendChild(c.content),r=s=l.firstElementChild,this.setStyle(s,t,r),n.appendChild(l)}if(h(t.item.selection)||t.item.selection.restore(),Re.Insert(this.parent.currentDocument,n,this.parent.editableElement),n.nextElementSibling===null){var p=R("br");n.parentNode.insertBefore(p,n.nextSibling)}}if(t.callBack&&(h(t.selector)||!h(t.selector)&&t.selector!=="pasteCleanupModule")){var d=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)[0],u=t.value==="VideoReplace"||i?t.item.isEmbedUrl?t.item.selectParent[0].querySelector("iframe"):t.item.selectParent[0]:D.isIE?d:t.item.isEmbedUrl?d.querySelector("iframe"):d.lastElementChild;u.addEventListener(u.tagName!=="IFRAME"?"loadeddata":"load",function(){(t.value!=="VideoReplace"||!i)&&(t.item.isEmbedUrl&&u&&u.classList.add("e-rte-embed-url"),t.callBack({requestType:"Videos",editorMode:"HTML",event:t.event,range:e.parent.nodeSelection.getRange(e.parent.currentDocument),elements:[u]}))}),i&&u.load(),D.userAgent.indexOf("Firefox")!==-1&&(r.addEventListener("play",function(){e.editAreaVideoClick(t)}),r.addEventListener("pause",function(){e.editAreaVideoClick(t)}))}},o.prototype.editAreaVideoClick=function(t){t.callBack({requestType:"VideosPlayPause",editorMode:"HTML",event:t.event})},o.prototype.setStyle=function(t,e,i){e.item.url!==""&&!h(e.item.url)&&t.setAttribute("src",e.item.url),e.item.isEmbedUrl||(t.type=e.item.fileName&&e.item.fileName.split(".").length>0?"video/"+e.item.fileName.split(".")[e.item.fileName.split(".").length-1]:e.item.url&&e.item.url.split(".").length>0?"video/"+e.item.url.split(".")[e.item.url.split(".").length-1]:""),!h(e.item.width)&&!h(e.item.width.width)&&i.setAttribute("width",H(e.item.width.width)),!h(e.item.height)&&!h(e.item.height.height)&&i.setAttribute("height",H(e.item.height.height)),!h(e.item.width)&&!h(e.item.width.minWidth)&&(i.style.minWidth=H(e.item.width.minWidth)),!h(e.item.width)&&!h(e.item.width.maxWidth)&&(i.style.maxWidth=H(e.item.width.maxWidth)),!h(e.item.height)&&!h(e.item.height.minHeight)&&(i.style.minHeight=H(e.item.height.minHeight)),!h(e.item.height)&&!h(e.item.height.maxHeight)&&(i.style.maxHeight=H(e.item.height.maxHeight))},o.prototype.videoDimension=function(t){var e=t.item.selectNode[0].classList.contains(nn)?t.item.selectNode[0].querySelector("iframe"):t.item.selectNode[0];e.style.height="",e.style.width="",t.item.width!=="auto"?e.style.width=H(t.item.width):e.removeAttribute("width"),t.item.height!=="auto"?e.style.height=H(t.item.height):e.removeAttribute("height"),this.callBack(t)},o.prototype.callBack=function(t){t.callBack&&t.callBack({requestType:t.item.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},o}(),wp=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.observer.on(Ia,this.createTable,this),this.parent.observer.on(Fa,this.insertRow,this),this.parent.observer.on(za,this.insertColumn,this),this.parent.observer.on(qa,this.deleteRow,this),this.parent.observer.on(Va,this.deleteColumn,this),this.parent.observer.on(Ua,this.removeTable,this),this.parent.observer.on(ja,this.tableHeader,this),this.parent.observer.on(_a,this.tableVerticalAlign,this),this.parent.observer.on(Wa,this.cellMerge,this),this.parent.observer.on(Ga,this.HorizontalSplit,this),this.parent.observer.on(Qa,this.VerticalSplit,this),this.parent.observer.on(lp,this.tableMove,this)},o.prototype.createTable=function(t){var e=R("table",{className:"e-rte-table"}),i=R("tbody");h(t.item.width.width)||(e.style.width=this.calculateStyleValue(t.item.width.width)),h(t.item.width.minWidth)||(e.style.minWidth=this.calculateStyleValue(t.item.width.minWidth)),h(t.item.width.maxWidth)||(e.style.maxWidth=this.calculateStyleValue(t.item.width.maxWidth));for(var n=parseInt(t.item.width.width,10)>100?100/t.item.columns:parseInt(t.item.width.width,10)/t.item.columns,r=0;r<t.item.rows;r++){for(var s=R("tr"),a=0;a<t.item.columns;a++){var l=R("td");l.appendChild(R("br")),l.style.width=n+"%",s.appendChild(l)}i.appendChild(s)}if(e.appendChild(i),t.item.selection.restore(),Re.Insert(this.parent.currentDocument,e,this.parent.editableElement),t.item.selection.setSelectionText(this.parent.currentDocument,e.querySelector("td"),e.querySelector("td"),0,0),e.nextElementSibling===null){var c=void 0;t.enterAction==="DIV"?(c=R("div"),c.appendChild(R("br"))):t.enterAction==="BR"?c=R("br"):(c=R("p"),c.appendChild(R("br"))),this.insertAfter(c,e)}return e.querySelector("td").classList.add("e-cell-select"),t.callBack&&t.callBack({requestType:"Table",editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:[e]}),e},o.prototype.calculateStyleValue=function(t){var e;return typeof t=="string"&&(t.indexOf("px")>=0||t.indexOf("%")>=0||t.indexOf("auto")>=0)?e=t:e=t+"px",e},o.prototype.insertAfter=function(t,e){e.parentNode.insertBefore(t,e.nextSibling)},o.prototype.getSelectedCellMinMaxIndex=function(t){for(var e=this.curTable.querySelectorAll(".e-cell-select"),i=0,n=t.length,r=0,s=t[0].length,a=0,l=0;i<e.length;i++){var c=this.getCorrespondingIndex(e[i],t),p=this.FindIndex(c[0],c[1],t);n=Math.min(c[0],n),r=Math.max(p[0],r),s=Math.min(c[1],s),a=Math.max(p[1],a)}return{startRow:n,endRow:r,startColumn:s,endColumn:a}},o.prototype.insertRow=function(t){var e=t.item.subCommand!=="InsertRowBefore",i=t.item.selection.range.startContainer;if(i.nodeName==="TH"||i.nodeName==="TD"||(i=T(i.parentElement,"td,th")),!(i.nodeName.toLowerCase()==="th"&&t.item.subCommand==="InsertRowBefore")){if(this.curTable=T(this.parent.nodeSelection.range.startContainer.parentElement,"table"),this.curTable.querySelectorAll(".e-cell-select").length===0){var n=this.curTable.rows[this.curTable.rows.length-1],r=n.cloneNode(!0);r.removeAttribute("rowspan"),this.insertAfter(r,n)}else{for(var s=this.getCorrespondingColumns(),a=this.getSelectedCellMinMaxIndex(s),l=e?a.endRow:a.startRow,c=R("tr"),p=this.curTable.querySelectorAll("th.e-cell-select").length>0,d=0;d<s[l].length;d++)if(e&&l<s.length-1&&s[l][d]===s[l+1][d]||!e&&0<l&&s[l][d]===s[l-1][d])(d===0||0<d&&s[l][d]!==s[l][d-1])&&s[l][d].setAttribute("rowspan",(parseInt(s[l][d].getAttribute("rowspan"),10)+1).toString());else{var u=R("td");u.appendChild(R("br")),c.appendChild(u),u.setAttribute("style",s[p&&e&&s[l+1]?l+1:l][d].getAttribute("style"))}var f=void 0;p&&e?f=this.curTable.querySelector("tbody").childNodes[0]:f=this.curTable.rows[l],t.item.subCommand==="InsertRowBefore"||p?f.parentElement.insertBefore(c,f):this.insertAfter(c,f)}t.item.selection.setSelectionText(this.parent.currentDocument,t.item.selection.range.startContainer,t.item.selection.range.startContainer,0,0),t.callBack&&t.callBack({requestType:t.item.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},o.prototype.insertColumn=function(t){var e=t.item.selection.range.startContainer;e.nodeName==="TH"||e.nodeName==="TD"||(e=T(e.parentElement,"td,th"));for(var i=T(e,"tr"),n,r=T(i,"table").rows,s=Array.prototype.slice.call(i.querySelectorAll(":scope > td, :scope > th")).indexOf(e),a=parseInt(t.item.width,10)/i.querySelectorAll(":scope > td, :scope > th").length,l=parseInt(t.item.width,10)/(i.querySelectorAll(":scope > td, :scope > th").length+1),c=T(i,"table"),p=T(i,"table").querySelectorAll("th,td"),d=0;d<p.length;d++)p[d].dataset.oldWidth=p[d].offsetWidth/c.offsetWidth*100+"%";for(var d=0;d<r.length;d++){n=r[d].querySelectorAll(":scope > td, :scope > th")[s];var u=n.cloneNode(!0);u.innerHTML="",u.appendChild(R("br")),u.removeAttribute("class"),u.removeAttribute("colspan"),u.removeAttribute("rowspan"),t.item.subCommand==="InsertColumnLeft"?n.parentElement.insertBefore(u,n):this.insertAfter(u,n),u.style.width=l.toFixed(4)+"%",delete u.dataset.oldWidth}for(var d=0;d<p.length;d++)p[d].style.width=(Number(p[d].dataset.oldWidth.split("%")[0])*l/a).toFixed(4)+"%",delete p[d].dataset.oldWidth;t.item.selection.setSelectionText(this.parent.currentDocument,e,e,0,0),t.callBack&&t.callBack({requestType:t.item.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},o.prototype.deleteColumn=function(t){var e=t.item.selection.range.startContainer;e.nodeType===3&&(e=T(e.parentElement,"td,th"));var i=T(e,e.tagName==="TH"?"thead":"tbody"),n=i&&Array.prototype.indexOf.call(i.childNodes,e.parentNode);this.curTable=T(e,"table");var r=T(e,"tr");if(r.querySelectorAll("th,td").length===1)t.item.selection.restore(),S(T(e.parentElement,"table"));else{for(var s=void 0,a=this.getCorrespondingColumns(),l=this.getSelectedCellMinMaxIndex(a),c=l.startColumn,p=l.endColumn,d=0;d<a.length;d++)for(var u=a[d],f=0;f<u.length;f++){var m=u[f],v=this.getCorrespondingIndex(m,a),y=parseInt(m.getAttribute("colspan"),10)||1;v[1]+(y-1)>=c&&v[1]<=p&&(y>1?m.setAttribute("colspan",(y-1).toString()):(S(m),s=f,D.isIE&&(t.item.selection.setSelectionText(this.parent.currentDocument,this.curTable.querySelector("td"),this.curTable.querySelector("td"),0,0),this.curTable.querySelector("td, th").classList.add("e-cell-select"))))}if(s>-1){var L=i.children[n],C=L&&L.children[s<=L.children.length-1?s:s-1];C&&(t.item.selection.setSelectionText(this.parent.currentDocument,C,C,0,0),C.classList.add("e-cell-select"))}}if(t.callBack){var w=this.parent.nodeSelection.getRange(this.parent.currentDocument).startContainer;if(w.nodeName!=="TD"){var k=this.parent.nodeSelection.getRange(this.parent.currentDocument).startOffset,I=w.children[k];I&&this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,I,0)}t.callBack({requestType:t.item.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},o.prototype.deleteRow=function(t){var e=t.item.selection.range.startContainer;e.nodeType===3&&(e=T(e.parentElement,"td,th"));var i=Array.prototype.indexOf.call(e.parentNode.childNodes,e);this.curTable=T(e,"table");var n,r=this.getCorrespondingColumns(),s=this.getSelectedCellMinMaxIndex(r),a,l;if(this.curTable.rows.length===1)t.item.selection.restore(),S(T(e.parentElement,"table"));else for(a=s.endRow;a>=s.startRow;a--){for(n=this.curTable.rows[a],l=0;l<r[a].length;l++){if((l===0||r[a][l]!==r[a][l-1])&&1<parseInt(r[a][l].getAttribute("rowspan"),10)){var c=parseInt(r[a][l].getAttribute("rowspan"),10)-1;if(c===1){r[a][l].removeAttribute("rowspan");var p=this.getMergedRow(this.getCorrespondingColumns())[l];if(p){var d=p.cloneNode(!0);d.innerHTML="<br>",p.parentElement&&p.parentElement.insertBefore(d,p)}}else r[a][l].setAttribute("rowspan",c.toString())}if(a<r.length-1&&r[a][l]===r[a+1][l]&&(a===0||r[a][l]!==r[a-1][l])){var u=r[a][l],f=void 0;for(f=l;0<f&&r[a][f]===r[a][f-1];f--)f===0?this.curTable.rows[a+1].prepend(u):r[a+1][f-1].insertAdjacentElement("afterend",u)}}var m=n.rowIndex;this.curTable.deleteRow(m);var v=h(this.curTable.rows[m])?this.curTable.querySelectorAll("tbody tr")[m-1]:this.curTable.querySelectorAll("tbody tr")[m],y=v&&v.querySelectorAll("td")[i];y?(t.item.selection.setSelectionText(this.parent.currentDocument,y,y,0,0),y.classList.add("e-cell-select")):(t.item.selection.setSelectionText(this.parent.currentDocument,this.curTable.querySelector("td"),this.curTable.querySelector("td"),0,0),this.curTable.querySelector("td, th").classList.add("e-cell-select"))}t.callBack&&t.callBack({requestType:t.item.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},o.prototype.getMergedRow=function(t){for(var e,i=0;i<t.length;i++)t[i].length!==this.curTable.rows[0].childNodes.length&&(e=t[i]);return e},o.prototype.removeTable=function(t){var e=t.item.selection.range.startContainer;e=e.nodeType===3?e.parentNode:e;var i=T(e.parentElement,"table");i&&(t.item.selection.restore(),S(i)),t.callBack&&t.callBack({requestType:t.item.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},o.prototype.tableHeader=function(t){var e=!1,i=t.item.selection.range.startContainer;i=i.nodeType===3?i.parentNode:i;var n=T(i.parentElement,"table");if([].slice.call(n.childNodes).forEach(function(u){u.nodeName==="THEAD"&&(e=!0)}),n&&!e){for(var r=n.querySelector("tr").childElementCount,s=0,a=0;a<r;a++)s=s+(parseInt(n.querySelector("tr").children[a].getAttribute("colspan"),10)||1);for(var l=n.createTHead(),c=l.insertRow(0),p=0;p<s;p++){var d=R("th");d.appendChild(R("br")),c.appendChild(d)}}else n.deleteTHead();t.callBack&&t.callBack({requestType:t.item.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},o.prototype.tableVerticalAlign=function(t){var e="";switch(t.item.subCommand){case"AlignTop":e="top";break;case"AlignMiddle":e="middle";break;case"AlignBottom":e="bottom";break}t.item.tableCell.style.verticalAlign=e,e&&e!==""&&t.item.tableCell.getAttribute("valign")&&t.item.tableCell.removeAttribute("valign"),t.callBack&&t.callBack({requestType:t.item.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},o.prototype.cellMerge=function(t){h(this.curTable)&&(this.curTable=T(this.parent.nodeSelection.range.startContainer.parentElement,"table"));var e=this.curTable.querySelectorAll(".e-cell-select");if(!(e.length<2)){this.mergeCellContent();var i=this.getSelectedMinMaxIndexes(this.getCorrespondingColumns()),n=e[0],r=n.parentElement.querySelectorAll(".e-cell-select");i.startColumn<i.endColumn&&n.setAttribute("colspan",(i.endColumn-i.startColumn+1).toString()),i.startRow<i.endRow&&n.setAttribute("rowspan",(i.endRow-i.startRow+1).toString());for(var s=0,a=r.length-1;a>=0;a--)s=s+parseFloat(r[a].style.width);n.style.width=s+"%";for(var l=1;l<=e.length-1;l++)S(e[l]);for(var l=0;l<this.curTable.rows.length;l++)this.curTable.rows[l].innerHTML===""&&S(this.curTable.rows[l]);this.updateRowSpanStyle(i.startRow,i.endRow,this.getCorrespondingColumns()),this.updateColSpanStyle(i.startColumn,i.endColumn,this.getCorrespondingColumns()),t.item.selection.setSelectionText(this.parent.currentDocument,t.item.selection.range.startContainer,t.item.selection.range.startContainer,0,0),this.parent.nodeSelection&&n&&this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n,0),t.callBack&&t.callBack({requestType:t.item.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},o.prototype.updateColSpanStyle=function(t,e,i){var n,r,s,a=0,l,c=0,p=i;if(t<(e=Math.min(e,p[0].length-1))){for(r===t;r<=e;r++)if(!(t<r&&p[0][r]===p[0][r-1])&&1<(a=Math.min(parseInt(p[0][r].getAttribute("colspan"),10)||1,e-t+1))&&p[0][r]===p[0][r+1])for(c=a-1,n=1;n<p.length;n++){if(p[n][r]!==p[n-1][r]){for(s=r;s<r+a;s++)if(1<(l=parseInt(p[n][s].getAttribute("colspan"),10)||1)&&p[n][s]===p[n][s+1])s+=c=Math.min(c,l-1);else if(!(c=Math.max(0,c-1)))break}if(!c)break}c&&this.updateCellAttribute(p,c,"colspan",0,p.length-1,t,e)}},o.prototype.updateRowSpanStyle=function(t,e,i){var n,r,s,a=0,l,c=0,p=i;if(t<(e=Math.min(e,p.length-1))){for(n=t;n<=e;n++)if(!(t<n&&p[n][0]===p[n-1][0])&&p[n][0]&&1<(a=Math.min(parseInt(p[n][0].getAttribute("rowspan"),10)||1,e-t+1))&&p[n][0]===p[n+1][0]){for(c=a-1,r=1;r<p[0].length;r++)if(p[n][r]!==p[n][r-1]){for(s=n;s<n+a;s++)if(1<(l=parseInt(p[s][r].getAttribute("rowspan"),10)||1)&&p[s][r]===p[s+1][r])s+=c=Math.min(c,l-1);else if(!(c=Math.max(0,c-1)))break;if(!c)break}}c&&this.updateCellAttribute(p,c,"rowspan",t,e,0,p[0].length-1)}},o.prototype.updateCellAttribute=function(t,e,i,n,r,s,a){var l,c,p;for(l=n;l<=r;l++)for(c=s;c<=a;c++)n<l&&t[l][c]===t[l-1][c]||s<c&&t[l][c]===t[l][c-1]||1<(p=parseInt(t[l][c].getAttribute(i),10)||1)&&(1<p-e?t[l][c].setAttribute(i,(p-e).toString()):t[l][c].removeAttribute(i))},o.prototype.mergeCellContent=function(){for(var t=this.curTable.querySelectorAll(".e-cell-select"),e=t[0].innerHTML==="<br>"?"":t[0].innerHTML,i=1;i<t.length;i++)t[i].innerHTML!=="<br>"&&(e=e?e+"<br>"+t[i].innerHTML:e+t[i].innerHTML);t[0].innerHTML=e},o.prototype.getSelectedMinMaxIndexes=function(t){var e=this.curTable.querySelectorAll(".e-cell-select");if(0<e.length){for(var i=t.length,n=0,r=t[0].length,s=0,a=0;a<e.length;a++){var l=this.getCorrespondingIndex(e[a],t),c=this.FindIndex(l[0],l[1],t);i=Math.min(l[0],i),n=Math.max(c[0],n),r=Math.min(l[1],r),s=Math.max(c[1],s)}return{startRow:i,endRow:n,startColumn:r,endColumn:s}}return null},o.prototype.HorizontalSplit=function(t){var e=t.item.selection.range.startContainer;if(this.curTable=T(e.parentElement,"table"),!(this.curTable.querySelectorAll(".e-cell-select").length>1)){this.activeCell=this.curTable.querySelector(".e-cell-select");var i=this.activeCell.cloneNode(!0);i.removeAttribute("class"),i.innerHTML="</br>";var n=this.getCorrespondingIndex(this.activeCell,this.getCorrespondingColumns()),r=this.getCorrespondingColumns(),s=this.activeCell.getAttribute("rowspan")?parseInt(this.activeCell.getAttribute("rowspan"),10):1;if(s>1){var a=Math.ceil(s/2);1<a?this.activeCell.setAttribute("rowspan",a.toString()):this.activeCell.removeAttribute("rowspan"),1<s-a?i.setAttribute("rowspan",(s-a).toString()):i.removeAttribute("rowspan");var l=void 0,c=void 0;for(l=n[0]+Math.ceil(s/2),c=n[1]===0?n[1]:n[1]-1;0<=c&&(r[l][c]===r[l][c-1]||0<l&&r[l][c]===r[l-1][c]);)c--;c===-1?this.curTable.rows[l].firstChild?this.curTable.rows[l].prepend(i):this.curTable.appendChild(i):r[l][c].insertAdjacentElement("afterend",i)}else{var p=R("tr");p.appendChild(i);for(var d=r[n[0]],u=0;u<=d.length-1;u++)d[u]!==d[u-1]&&d[u]!==this.activeCell&&d[u].setAttribute("rowspan",((parseInt(d[u].getAttribute("rowspan"),10)?parseInt(d[u].getAttribute("rowspan"),10):1)+1).toString());this.activeCell.parentNode.insertAdjacentElement("afterend",p)}t.callBack&&t.callBack({requestType:t.item.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},o.prototype.VerticalSplit=function(t){var e=t.item.selection.range.startContainer;if(this.curTable=T(e.parentElement,"table"),!(this.curTable.querySelectorAll(".e-cell-select").length>1)){this.activeCell=this.curTable.querySelector(".e-cell-select");var i=this.curTable.rows,n=this.activeCell.cloneNode(!0);n.removeAttribute("class"),n.innerHTML="</br>";var r=parseFloat(this.activeCell.style.width)/2;if(this.activeCell.tagName==="TH"&&isNaN(r)){for(var s=this.curTable.querySelector("tr").childElementCount,a=0,l=0;l<s;l++)a=a+(parseInt(this.curTable.querySelector("tr").children[l].getAttribute("colspan"),10)||1);r=parseFloat((this.activeCell.offsetWidth/2/this.curTable.offsetWidth*100).toFixed(1))}var c=this.getCorrespondingIndex(this.activeCell,this.getCorrespondingColumns()),p=this.getCorrespondingColumns(),d=parseInt(this.activeCell.getAttribute("colspan"),10);if(d>1)1<Math.ceil(d/2)?this.activeCell.setAttribute("colspan",(d/2).toString()):this.activeCell.removeAttribute("colspan"),1<d-d/2?n.setAttribute("colspan",(d-d/2).toString()):n.removeAttribute("colspan");else for(var l=0;l<=i.length-1;l++)if(l===0||p[l][c[1]]!==p[l-1][c[1]]){var u=p[l][c[1]];u!==this.activeCell&&u.setAttribute("colspan",((parseInt(u.getAttribute("colspan"),10)?parseInt(u.getAttribute("colspan"),10):1)+1).toString())}this.activeCell.style.width=r+"%",n.style.width=r+"%",this.activeCell.parentNode.insertBefore(n,this.activeCell.nextSibling),t.callBack&&t.callBack({requestType:t.item.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},o.prototype.getCorrespondingColumns=function(){for(var t=[],e=this,i=0,n=e.curTable.rows,r=0;r<=n.length-1;r++)for(var s=n[r],a=0,l=0;l<=s.children.length-1;l++){for(var c=s.children[l],p=c,d=parseInt(p.getAttribute("colspan"),10)||1,u=parseInt(p.getAttribute("rowspan"),10)||1,f=r;f<r+u;f++)for(var m=a;m<a+d;m++)t[f]||(t[f]=[]),t[f][m]?a++:t[f][m]=c;a+=i}return t},o.prototype.FindIndex=function(t,e,i){var n,r;for(n=t+1,r=e+1;n<i.length;){if(i[n][e]!==i[t][e]){n--;break}n++}for(n===i.length&&n--;r<i[t].length;){if(i[t][r]!==i[t][e]){r--;break}r++}return r===i[t].length&&r--,[n,r]},o.prototype.getCorrespondingIndex=function(t,e){for(var i=0;i<e.length;i++)for(var n=0;n<e[i].length;n++)if(e[i][n]===t)return[i,n];return[]},o.prototype.highlightCells=function(t,e,i,n,r){var s,a,l,c,p=t,d=e,u=i,f=n,m=new kp;for(s=p;s<=d;s++){for(((1<(parseInt(r[s][u].getAttribute("rowspan"),10)||1)||1<(parseInt(r[s][u].getAttribute("colspan"),10)||1))&&(c=this.FindIndex((l=this.getCorrespondingIndex(r[s][u],r))[0],l[1],r))||(1<(parseInt(r[s][f].getAttribute("rowspan"),10)||1)||1<(parseInt(r[s][f].getAttribute("colspan"),10)||1))&&(c=this.FindIndex((l=this.getCorrespondingIndex(r[s][f],r))[0],l[1],r)))&&(p=Math.min(l[0],p),d=Math.max(c[0],d),u=Math.min(l[1],u),f=Math.max(c[1],f)),a=u;a<=f;a++)((1<(parseInt(r[p][a].getAttribute("rowspan"),10)||1)||1<(parseInt(r[p][a].getAttribute("colspan"),10)||1))&&(c=this.FindIndex((l=this.getCorrespondingIndex(r[p][a],r))[0],l[1],r))||(1<(parseInt(r[d][a].getAttribute("rowspan"),10)||1)||1<(parseInt(r[d][a].getAttribute("colspan"),10)||1))&&(c=this.FindIndex((l=this.getCorrespondingIndex(r[d][a],r))[0],l[1],r)))&&(p=Math.min(l[0],p),d=Math.max(c[0],d),u=Math.min(l[1],u),f=Math.max(c[1],f));m=p===t&&d===e&&u===i&&f===n?{startRow:t,endRow:e,startColumn:i,endColumn:n}:this.highlightCells(p,d,u,f,r)}return m},o.prototype.tableMove=function(t){this.activeCell=t.selectNode[0];var e=t.event.target,i=this.activeCell.tagName,n=e.tagName;if(this.curTable=T(e,"table"),this.curTable.querySelectorAll(".e-cell-select").length>1&&this.parent.nodeSelection.Clear(this.parent.currentDocument),!(e.tagName!=="TD"&&e.tagName!=="TH"&&i!==n)){for(var r=Array.prototype.slice.call(this.activeCell.parentElement.parentElement.children).indexOf(this.activeCell.parentElement),s=Array.prototype.slice.call(this.activeCell.parentElement.children).indexOf(this.activeCell),a=Array.prototype.slice.call(e.parentElement.parentElement.children).indexOf(e.parentElement),l=Array.prototype.slice.call(e.parentElement.children).indexOf(e),c=this.curTable.querySelectorAll(".e-cell-select"),p=c.length-1;p>=0;p--)this.activeCell!==c[p]&&c[p].classList.remove("e-cell-select");if(!(r===a&&s===l)){for(var d=this.getCorrespondingColumns(),u=this.getCorrespondingIndex(this.activeCell,d),f=this.getCorrespondingIndex(e,d),m=this.highlightCells(Math.min(u[0],f[0]),Math.max(u[0],f[0]),Math.min(u[1],f[1]),Math.max(u[1],f[1]),d),v=m.startRow;v<=m.endRow;v++)for(var y=m.startColumn;y<=m.endColumn;y++)d[v][y].classList.add("e-cell-select");this.parent.nodeSelection.range&&(this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,this.parent.nodeSelection.range.endContainer,this.parent.nodeSelection.range.endContainer,0,0),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,this.parent.nodeSelection.range.endContainer,0))}}},o}(),kp=function(){function o(){}return o}(),Qe=function(){function o(){}return o.prototype.getFormattedNode=function(t,e,i){var n=this.getFormatParent(t,e,i);return n!==null&&n!==i?n:null},o.prototype.getFormatParent=function(t,e,i){do t=t.parentNode;while(t&&t!==i&&!this.isFormattedNode(t,e));return t},o.prototype.isFormattedNode=function(t,e){switch(e){case"bold":return o.isBold(t);case"italic":return o.isItalic(t);case"underline":return o.isUnderline(t);case"strikethrough":return o.isStrikethrough(t);case"superscript":return o.isSuperscript(t);case"subscript":return o.isSubscript(t);case"fontcolor":return this.isFontColor(t);case"fontname":return this.isFontName(t);case"fontsize":return this.isFontSize(t);case"backgroundcolor":return this.isBackgroundColor(t);default:return!1}},o.isBold=function(t){var e=["strong","b"];return e.indexOf(t.nodeName.toLowerCase())!==-1?!0:!!(this.inlineTags.indexOf(t.nodeName.toLowerCase())!==-1&&t.style&&t.style.fontWeight==="bold")},o.isItalic=function(t){var e=["em","i"];return e.indexOf(t.nodeName.toLowerCase())!==-1?!0:!!(this.inlineTags.indexOf(t.nodeName.toLowerCase())!==-1&&t.style&&t.style.fontStyle==="italic")},o.isUnderline=function(t){var e=["u"];return e.indexOf(t.nodeName.toLowerCase())!==-1?!0:!!(this.inlineTags.indexOf(t.nodeName.toLowerCase())!==-1&&t.style&&(t.style.textDecoration==="underline"||t.style.textDecorationLine==="underline"))},o.isStrikethrough=function(t){var e=["del","strike"];return e.indexOf(t.nodeName.toLowerCase())!==-1?!0:!!(this.inlineTags.indexOf(t.nodeName.toLowerCase())!==-1&&t.style&&(t.style.textDecoration==="line-through"||t.style.textDecorationLine==="line-through"))},o.isSuperscript=function(t){var e=["sup"];return e.indexOf(t.nodeName.toLowerCase())!==-1},o.isSubscript=function(t){var e=["sub"];return e.indexOf(t.nodeName.toLowerCase())!==-1},o.prototype.isFontColor=function(t){var e=t.style&&t.style.color;return o.inlineTags.indexOf(t.nodeName.toLowerCase())!==-1&&e!==null&&e!==""&&e!==void 0},o.prototype.isBackgroundColor=function(t){var e=t.style&&t.style.backgroundColor;return o.inlineTags.indexOf(t.nodeName.toLowerCase())!==-1&&e!==null&&e!==""&&e!==void 0},o.prototype.isFontSize=function(t){var e=t.style&&t.style.fontSize;return o.inlineTags.indexOf(t.nodeName.toLowerCase())!==-1&&e!==null&&e!==""&&e!==void 0},o.prototype.isFontName=function(t){var e=t.style&&t.style.fontFamily;return o.inlineTags.indexOf(t.nodeName.toLowerCase())!==-1&&e!==null&&e!==""&&e!==void 0},o.inlineTags=["a","abbr","acronym","b","bdo","big","cite","code","dfn","em","font","i","kbd","label","q","samp","small","span","strong","sub","sup","tt","u","var","del"],o}(),Hs=function(){function o(){}return o.applyFormat=function(t,e,i,n,r,s,a){this.enterAction=n;var l=["bold","italic","underline","strikethrough","superscript","subscript","uppercase","lowercase","fontcolor","fontname","fontsize","backgroundcolor"];if(l.indexOf(e)>-1||r==="formatPainter"){e==="backgroundcolor"&&r===""&&(r="transparent");var c=new Be,p=new Xn(i,t),d=new Jt,u=new Qe,f=c.getRange(t);if(D.userAgent.indexOf("Firefox")!==-1&&f.startContainer===f.endContainer&&!h(i)&&f.startContainer===i){for(var m=f.startContainer.childNodes,v=m[f.startOffset>0?f.startOffset-1:f.startOffset]||f.startContainer,y=f.endContainer.childNodes[f.endOffset>0?f.endOffset-1:f.endOffset]||f.endContainer,L=y.lastChild.nodeName==="BR"?h(y.lastChild.previousSibling)?y:y.lastChild.previousSibling:y.firstChild;!h(L)&&L.nodeName!=="#text"&&L.nodeName!=="IMG"&&L.nodeName!=="BR"&&L.nodeName!=="HR";)L=L.lastChild;c.setSelectionText(t,v,L,0,0),f=c.getRange(t)}var C=c.save(f,t),w=f.collapsed?c.getSelectionNodeCollection(f):c.getSelectionNodeCollectionBr(f),k=!1,I=!1,P=!1,Z=!1,G=["fontcolor","fontname","fontsize","backgroundcolor"].indexOf(e)>-1;if(f.collapsed){var $=u.getFormattedNode(f.startContainer,e,i),ae=h($)?null:$.getAttribute("style")===null?$.nodeName:$.nodeName+"[style='"+$.getAttribute("style")+"']";if(w.length>0)k=!0,f=d.GetCursorRange(t,f,w[0]);else if(f.startContainer.nodeType===3&&(f.startContainer.parentElement.childElementCount>0&&f.startOffset>0&&f.startContainer.parentElement.firstElementChild.tagName.toLowerCase()!=="br"||!h($)&&$===f.startContainer.parentElement.closest(ae)&&f.startContainer.parentElement.closest(ae).textContent.replace(new RegExp(String.fromCharCode(8203),"g"),"").trim().length!==0))k=!0,f=d.GetCursorRange(t,f,f.startContainer),w.push(f.startContainer);else{var ue=this.insertCursorNode(t,c,f,u,d,e,r,i);c.endContainer=c.startContainer=c.getNodeArray(ue,!0);var xe=ue.nodeName==="BR"&&ue.parentNode.childNodes;!h(xe)&&xe.length===1&&xe[0].nodeName==="BR"&&w.length===0?(c.setSelectionText(t,f.startContainer,f.endContainer,0,0),Z=!0):c.endOffset=c.startOffset=1,ue.nodeName==="BR"&&ue.parentNode.textContent.length===0&&(Z=!0)}}P=f.collapsed;for(var _=!1,ee=0;ee<w.length;ee++){var K=u.getFormattedNode(w[ee],e,i);K===null&&(e==="subscript"?(K=u.getFormattedNode(w[ee],"superscript",i),_=K!==null):e==="superscript"&&(K=u.getFormattedNode(w[ee],"subscript",i),_=K!==null)),ee===0&&K===null&&(I=!0),K!==null&&(!I||G)?w[ee]=this.removeFormat(w,ee,K,P,I,G,f,d,e,r,c,i,p):w[ee]=this.insertFormat(t,w,ee,K,P,I,G,f,d,e,r,a,p,i),c=this.applySelection(w,c,d,ee,k)}De()&&yt(i,s),Z||C.restore(),_&&this.applyFormat(t,e,i,n)}},o.insertCursorNode=function(t,e,i,n,r,s,a,l){var c=e.getNodeCollection(i),p=new Xn(l,t),d=c.length>0?c.length>1&&i.startContainer===i.endContainer?this.getCursorFormat(n,c,s,l):n.getFormattedNode(c[0],s,l):null,u=null;if(d){if(u=c[0],d.firstChild.textContent.charCodeAt(0)===8203&&d.firstChild.nodeType===3){var f=new RegExp(String.fromCharCode(8203),"g"),m=void 0;d.firstChild===u?(u.textContent=d.parentElement&&(p.isBlockNode(d.parentElement)&&d.parentElement.textContent.length<=1?d.parentElement.childElementCount>1:d.childElementCount===0)&&(d.parentElement.textContent.length>1||d.parentElement.firstChild&&d.parentElement.firstChild.nodeType===1)?u.textContent:u.textContent.replace(f,""),m=u):(d.firstChild.textContent=d.firstChild.textContent.replace(f,""),m=d.firstChild);var v=void 0;if(m.textContent.length===0){if(!h(m.previousSibling))u=m.previousSibling,v=m.textContent.length-1,e.setCursorPoint(t,m,v);else if(!h(m.parentElement)&&m.parentElement.textContent.length===0){var y=document.createElement("BR");m.parentElement.appendChild(y),S(m),u=y,e.setCursorPoint(t,u.parentElement,0)}}}["fontcolor","fontname","fontsize","backgroundcolor"].indexOf(s)>-1?(s==="fontcolor"?d.style.color=a:s==="fontname"?d.style.fontFamily=a:s==="fontsize"?d.style.fontSize=a:d.style.backgroundColor=a,u=d):re.unwrap(d)}else c.length>1&&i.startOffset>0&&c[0].firstElementChild&&c[0].firstElementChild.tagName.toLowerCase()==="br"&&(c[0].innerHTML=""),c.length===1&&i.startOffset===0&&(c[0].nodeName==="BR"||!h(c[0].nextSibling)&&c[0].nextSibling.nodeName==="BR")&&S(c[0].nodeName==="#text"?c[0].nextSibling:c[0]),u=this.getInsertNode(t,i,s,a).firstChild;return u},o.getCursorFormat=function(t,e,i,n){for(var r,s=0;s<e.length;s++)r=e[s].lastElementChild?e[s].lastElementChild:e[s];return t.getFormattedNode(r,i,n)},o.removeFormat=function(t,e,i,n,r,s,a,l,c,p,d,u,f){var m=null,v=a.startContainer.nodeName==="#text"?a.startContainer.textContent.substring(a.startOffset,a.startContainer.textContent.length):a.startContainer.textContent,y=t[e].textContent;if(a.startContainer===a.endContainer&&a.startOffset===0&&a.endOffset===a.startContainer.length){if(s&&!t[e].contains(i)&&t[e].nodeType===3&&t[e].textContent!==i.textContent){for(var I=t[e].textContent===t[e].wholeText,P=t[e],Z=this.GetFormatNode(c,p);P&&P.textContent===P.parentElement.textContent;)P=P.parentElement;if(I&&i.textContent!==P.textContent){var G=[],$=this.getPriorityFormatNode(P,u);return $&&$.textContent===P.textContent&&(P=$),G.push(P),this.applyStyles(G,0,Z),t[e]}}}else{var L=[],C=t[e];do L.push(d.getIndex(C)),C=C.parentNode;while(C&&C!==i);if(t[e].nodeName!=="BR"&&(C=m=n&&i.textContent.length-1===a.startOffset?l.SplitNode(a,i,!0):l.GetSpliceNode(a,i)),n){for(var k=m;k.firstChild!==null&&k.firstChild.nodeType!==3;null)k=k.firstChild;k.innerHTML="&#8203;",t[e]=k.firstChild}else{for(;C&&C.childNodes.length>0&&L.length-1>=0&&C.childNodes.length>L[L.length-1];)C=C.childNodes[L[L.length-1]],L.pop();if(t[e].nodeName!=="BR")if(C.nodeType===3&&!(n&&C.nodeValue===""))t[e]=C;else{var w=document.createElement("div");w.innerHTML="&#8203;",C.nodeType!==3?(C.insertBefore(w.firstChild,C.firstChild),t[e]=C.firstChild):(C.parentNode.insertBefore(w.firstChild,C),t[e]=C.previousSibling,C.parentNode.removeChild(C))}}}var ae;c==="backgroundcolor"&&(ae=i.style.fontSize);var ue;if(c==="fontsize"){var xe=T(t[e].parentElement,"span[style*=background-color]");h(xe)||(ue=xe.style.backgroundColor)}var _=i.getAttribute("style"),ee=i.tagName,K;if(ee==="A"&&c==="underline")i.style.textDecoration="none",K=[i];else{K=re.unwrap(i);var F=t[e].parentElement;!h(F)&&F.tagName.toLowerCase()!=="li"&&(F=T(F,"li")),!h(F)&&F.tagName.toLowerCase()==="li"&&F.textContent.trim()===t[e].textContent.trim()&&(c==="bold"?F.style.fontWeight="normal":c==="italic"&&(F.style.fontStyle="normal"))}if(K[0]&&!s)for(var P=K[e]?K[e]:K[0],Pe=P;P&&P.parentElement&&P.parentElement!==u;P=P){var Rt=void 0;if(i.nodeName==="SPAN"?Rt=P.parentElement.tagName.toLocaleLowerCase()===i.tagName.toLocaleLowerCase()&&P.parentElement.getAttribute("style")===_:Rt=P.parentElement.tagName.toLocaleLowerCase()===i.tagName.toLocaleLowerCase(),P.parentElement&&Rt&&(P.parentElement.childElementCount>1||a.startOffset>1)){if(Pe.parentElement&&Pe.parentElement.tagName.toLocaleLowerCase()===i.tagName.toLocaleLowerCase()&&a.startOffset===a.endOffset&&Pe.nodeType!==1&&!h(Pe.textContent)&&Pe.parentElement.childElementCount>1&&(a.setStart(Pe,0),a.setEnd(Pe,Pe.textContent.length),l.SplitNode(a,Pe.parentElement,!1)),P.parentElement.tagName.toLocaleLowerCase()==="span"&&i.style.textDecoration==="underline"&&P.parentElement.style.textDecoration!=="underline"){P=P.parentElement;continue}re.unwrap(P.parentElement),P=!h(P.parentElement)&&!f.isBlockNode(P.parentElement)?Pe:P.parentElement}else P=P.parentElement}if(K.length>0&&s){for(var ne=0;ne<K.length;ne++)if(K[ne].nodeType!==3||K[ne].textContent&&K[ne].textContent.trim().length>0){K[ne]=re.Wrap(K[ne],this.GetFormatNode(c,p,ee,_));var F=t[e].parentElement;!h(F)&&F.tagName.toLowerCase()!=="li"&&(F=T(F,"li")),!h(F)&&F.tagName.toLowerCase()==="li"&&F.textContent.trim()===t[e].textContent.trim()&&c==="fontname"&&(F.style.fontFamily=p),K[ne].textContent===v&&(ne===0?a.setStartBefore(K[ne]):ne===K.length-1&&a.setEndAfter(K[ne]))}var lt=t[e].parentElement;if(!h(ae)&&ae!==""&&(lt.style.fontSize=ae),!h(ue)&&ue!==""&&(lt.style.backgroundColor=ue),c==="backgroundcolor"&&!h(ae)&&ae!==""&&lt.parentElement.innerHTML===lt.outerHTML){var Zt=lt.parentElement;Zt.parentElement.insertBefore(lt,Zt),S(Zt)}if(c==="fontsize"||c==="fontcolor"){for(var F=t[e].parentElement,Ke=t[e].parentElement;!h(Ke)&&Ke.tagName.toLowerCase()!=="li";)Ke=Ke.parentElement,F=Ke;for(var ne=e,zi="";ne>=0&&!h(F)&&F.tagName.toLowerCase()==="li"&&F.textContent.replace("//g","").trim().includes(t[ne].textContent.trim());)zi=" "+t[ne].textContent.trim()+zi,ne--;var tr=!1,js=0,_s=!1;if(!h(F)&&F.childNodes)for(var ir=0;ir<F.childNodes.length;ir++)F.childNodes[ir].nodeName==="OL"&&(js++,tr=!0);if(!h(F)&&F.tagName.toLowerCase()==="li"&&F.textContent.split("").join("").trim()===zi.split("").join("").trim())c==="fontsize"?F.style.fontSize=p:(F.style.color=p,F.style.textDecoration="inherit");else if(!h(F)&&F.tagName.toLowerCase()==="li"&&tr){if(tr&&js>0)for(var nr=0;nr<F.childNodes.length;nr++)t[e].textContent===F.childNodes[nr].textContent&&t[e].textContent===y&&F.textContent.replace("//g","").trim().includes(zi.split("").join("").trim())&&(_s=!0);if(_s){for(var qi=0;qi<F.childNodes.length;qi++)F.childNodes[qi].nodeName==="OL"&&(F.childNodes[qi].style.fontSize="initial");c==="fontsize"?F.style.fontSize=p:(F.style.color=p,F.style.textDecoration="inherit")}}}}return t[e]},o.insertFormat=function(t,e,i,n,r,s,a,l,c,p,d,u,f,m){if(r)if(p!=="uppercase"&&p!=="lowercase"){var v=this.getInsertNode(t,l,p,d);e[i]=v.firstChild,c.position=1}else c.position=l.startOffset;else if(n===null&&s||a){if(e[i].nodeName!=="BR"&&(e[i]=c.GetSpliceNode(l,e[i]),e[i].textContent=c.TrimLineBreak(e[i].textContent)),p==="uppercase"||p==="lowercase")e[i].textContent=p==="uppercase"?e[i].textContent.toLocaleUpperCase():e[i].textContent.toLocaleLowerCase();else if(!(a===!0&&d==="")){var v=this.GetFormatNode(p,d);if(d==="formatPainter"||a){for(var y=e[i].parentElement,L=e[i].parentElement;!h(L)&&L.tagName.toLowerCase()!=="li";)L=L.parentElement,y=L;if(!h(y)&&y.tagName.toLowerCase()==="li"&&y.textContent.trim()===e[i].textContent.trim()&&(p==="fontsize"?y.style.fontSize=d:p==="fontcolor"?(y.style.color=d,y.style.textDecoration="inherit"):p==="fontname"&&(y.style.fontFamily=d)),d==="formatPainter")return this.insertFormatPainterElem(e,i,l,c,u,f);var C=e[i],w=this.getPriorityFormatNode(C,m);if(!h(w)||a){var k=h(w)?C:w;if(k=!h(w)&&w.style.fontSize!==""?k.firstChild:k,h(w)||p==="fontsize")for(;k;){var I=k.parentElement.textContent.trim()===e[i].textContent.trim(),P=k.parentElement;if(!f.isBlockNode(P)&&I&&!(P.nodeName==="SPAN"&&P.classList.contains("e-img-inner")))k=P;else break}var Z=[];if(p==="fontcolor"){var G=T(e[i].parentElement,"A");!h(G)&&G.firstChild.textContent.trim()===e[i].textContent.trim()&&(k=e[i])}e[i].textContent.trim()!==k.textContent.trim()&&(k=e[i]),Z[0]=k,this.applyStyles(Z,0,v)}else e[i]=this.applyStyles(e,i,v)}else{e[i]=this.applyStyles(e,i,v);var y=e[i].parentElement;!h(y)&&y.tagName.toLowerCase()!=="li"&&(y=T(y,"li")),!h(y)&&y.tagName.toLowerCase()==="li"&&y.textContent.trim()===e[i].textContent.trim()&&(p==="bold"?y.style.fontWeight="bold":p==="italic"&&(y.style.fontStyle="italic"))}}}else e[i]=c.GetSpliceNode(l,e[i]);return e[i]},o.applyStyles=function(t,e,i){return t[e].nodeName==="BR"&&this.enterAction==="BR"||(t[e]=e===t.length-1||t[e].nodeName==="BR"?re.Wrap(t[e],i):re.WrapBefore(t[e],i,!0),t[e]=this.getChildNode(t[e],i)),t[e]},o.getPriorityFormatNode=function(t,e){var i=new Qe,n=i.getFormattedNode(t,"fontsize",e),r,s,a;return h(n)?(s=i.getFormattedNode(t,"backgroundcolor",e),h(s)?(a=i.getFormattedNode(t,"fontname",e),h(a)?(r=i.getFormattedNode(t,"fontcolor",e),h(r)?null:r):a):s):n},o.getInsertNode=function(t,e,i,n){var r=this.GetFormatNode(i,n);if(r.innerHTML="&#8203;",D.isIE){var s=t.createDocumentFragment();s.appendChild(r),e.insertNode(s)}else e.insertNode(r);return r},o.getChildNode=function(t,e){return t==null&&(e.innerHTML="&#8203;",t=e.firstChild),t},o.applySelection=function(t,e,i,n,r){return t.length===1&&!r?(e.startContainer=e.getNodeArray(t[n],!0),e.endContainer=e.startContainer,e.startOffset=0,e.endOffset=t[n].textContent.length):t.length===1&&r?(e.startContainer=e.getNodeArray(t[n],!0),e.endContainer=e.startContainer,e.startOffset=i.position,e.endOffset=i.position):n===0?(e.startContainer=e.getNodeArray(t[n],!0),e.startOffset=0):n===t.length-1&&(e.endContainer=e.getNodeArray(t[n],!1),e.endOffset=t[n].textContent.length),e},o.GetFormatNode=function(t,e,i,n){var r;switch(t){case"bold":return document.createElement("strong");case"italic":return document.createElement("em");case"underline":return r=document.createElement("span"),this.updateStyles(r,i,n),r.style.textDecoration="underline",r;case"strikethrough":return r=document.createElement("span"),this.updateStyles(r,i,n),r.style.textDecoration="line-through",r;case"superscript":return document.createElement("sup");case"subscript":return document.createElement("sub");case"fontcolor":return r=document.createElement("span"),this.updateStyles(r,i,n),r.style.color=e,r.style.textDecoration="inherit",r;case"fontname":return r=document.createElement("span"),this.updateStyles(r,i,n),r.style.fontFamily=e,r;case"fontsize":return r=document.createElement("span"),this.updateStyles(r,i,n),r.style.fontSize=e,r;default:return r=document.createElement("span"),this.updateStyles(r,i,n),r.style.backgroundColor=e,r}},o.updateStyles=function(t,e,i){i!==null&&e==="SPAN"&&t.setAttribute("style",i)},o.insertFormatPainterElem=function(t,e,i,n,r,s){var a=s.isBlockNode(t[e].parentElement)?t[e]:t[e].parentElement;if(!s.isBlockNode(a))for(;a.textContent.trim()===a.parentElement.textContent.trim()&&!s.isBlockNode(a.parentElement);)a=a.parentElement;!h(a)&&a.nodeType===1&&!(a.classList.contains("e-rte-img-caption")||a.classList.contains("e-img-inner"))&&this.formatPainterCleanup(e,t,a,i,n,s);var l=r.element;if(!h(l)){var c=l.cloneNode(!0),p=c.querySelectorAll(r.lastChild.nodeName),d=void 0;p.length>0?d=p[p.length-1]:!h(c)&&c.nodeName===r.lastChild.nodeName&&(d=c),d.textContent=t[e].textContent;var u=d.childNodes[0];t[e]=re.Wrap(t[e],c),t[e].textContent="",t[e]=u}return t[e]},o.formatPainterCleanup=function(t,e,i,n,r,s){var a=["A","AUDIO","IMG","VIDEO","IFRAME"];if(t===0&&i.textContent.trim()!==e[t].textContent.trim()){r.SplitNode(n,i,!0);for(var l=e[t].parentElement.childNodes,c=0;c<l.length;c++)if(l[c].textContent.trim()===e[c].textContent.trim()){i.parentNode.insertBefore(l[c],i);break}for(var p=i.parentElement.childNodes,d=0;d<p.length;d++)(p[d].textContent.trim()===""||p[d].textContent.length===0)&&S(p[d])}else if(i.textContent.trim()!==e[t].textContent.trim())i.parentElement.insertBefore(e[t],i);else for(;!h(i)&&i.nodeType!==3&&!s.isBlockNode(i);){for(var u=void 0,c=0;c<i.childNodes.length;c++){var f=i.childNodes[c];f.textContent.trim().length!==0&&f.nodeType!==3&&(u=i.childNodes[c])}a.indexOf(i.tagName)===-1&&re.unwrap(i),i=u}},o.enterAction="P",o}(),xp=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.observer.on(Ya,this.applySelection,this),this.parent.observer.on(Oe,this.keyDownHandler,this)},o.prototype.keyDownHandler=function(t){var e=["bold","italic","underline","strikethrough","superscript","subscript","uppercase","lowercase"];(t.event.ctrlKey||t.event.metaKey)&&e.indexOf(t.event.action)>-1&&(t.event.preventDefault(),Hs.applyFormat(this.parent.currentDocument,t.event.action,this.parent.editableElement,t.enterAction),this.callBack(t,t.event.action))},o.prototype.applySelection=function(t){Hs.applyFormat(this.parent.currentDocument,t.subCommand.toLocaleLowerCase(),this.parent.editableElement,t.enterAction,t.value,t.selector),this.callBack(t,t.subCommand)},o.prototype.callBack=function(t,e){t.callBack&&t.callBack({requestType:e,event:t.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},o}(),Dp=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.observer.on($a,this.applyHtml,this)},o.prototype.applyHtml=function(t){if(Re.Insert(this.parent.currentDocument,t.value,this.parent.editableElement,!0,t.enterAction),t.subCommand==="pasteCleanup"){var e=this.parent.editableElement.querySelectorAll(".pasteContent_RTE"),i=[].slice.call(e),n=this.parent.editableElement.querySelectorAll(".pasteContent_Img"),r=[].slice.call(n);t.callBack({requestType:t.subCommand,editorMode:"HTML",elements:i,imgElem:r})}else t.callBack&&t.callBack({requestType:t.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},o}(),Bp=function(){function o(){}return o.clear=function(t,e,i,n,r){this.domNode=new Xn(e,t),this.defaultTag=i==="P"?this.defaultTag:"div";var s=new Be,a=new Jt,l=s.getRange(t),c=l.collapsed?s.getSelectionNodeCollection(l):s.getSelectionNodeCollectionBr(l),p=s.save(l,t),d=!1;l.collapsed&&r!=="ClearFormat"&&(d=!0,l=a.GetCursorRange(t,l,c[0]));var u=l.collapsed;if(!u){var f=void 0;if(c.length>0&&c[0].nodeName==="BR"&&T(c[0],"table")?f=a.GetSpliceNode(l,T(c[0],"table")):f=a.GetSpliceNode(l,c[c.length>1&&c[0].nodeName==="IMG"?1:0]),c.length===1)s.setSelectionContents(t,f),l=s.getRange(t);else if(c.length>1){for(var m=1,v=c[c.length-m];c.length<=m&&c[c.length-m].nodeName==="BR";)m++,v=c[c.length-m];var y=a.GetSpliceNode(l,v);s.setSelectionText(t,f,y,0,y.nodeType===3?y.textContent.length:y.childNodes.length),l=s.getRange(t)}var L=s.getNodeCollection(l),C=L.slice();this.clearInlines(s.getSelectionNodes(C),C,s.getRange(t),a,e),this.reSelection(t,p,L),l=s.getRange(t),L=s.getNodeCollection(l);var w=L.slice();this.clearBlocks(t,w,e,a,s),De()&&yt(e,n),this.reSelection(t,p,L)}d&&s.setCursorPoint(t,l.endContainer,l.endOffset)},o.reSelection=function(t,e,i){var n=e.getInsertNodes(i);e.startContainer=e.getNodeArray(n[0],!0,t),e.startOffset=0,e.endContainer=e.getNodeArray(n[n.length-1],!1,t);var r=n[n.length-1];e.endOffset=r.nodeType===3?r.textContent.length:r.childNodes.length,e.restore()},o.clearBlocks=function(t,e,i,n,r){for(var s=[],a=0;a<e.length;a++)this.BLOCK_TAGS.indexOf(e[a].nodeName.toLocaleLowerCase())>-1&&s.indexOf(e[a])===-1?s.push(e[a]):this.BLOCK_TAGS.indexOf(e[a].parentNode.nodeName.toLocaleLowerCase())>-1&&s.indexOf(e[a].parentNode)===-1&&i!==e[a].parentNode&&s.push(e[a].parentNode);s=this.spliceParent(s,e)[0],s=this.removeParent(s),this.unWrap(t,s,n,r)},o.spliceParent=function(t,e){for(var i=0;i<t.length;i++)for(var n=t[i].childNodes.length,r=0;r<n;r++)if(e.indexOf(t[i].childNodes[r])>0&&t[i].childNodes[r].childNodes.length>0&&(e=this.spliceParent([t[i].childNodes[r]],e)[1]),e.indexOf(t[i].childNodes[r])<=-1&&t[i].childNodes[r].textContent.trim()!==""){for(var s=0;s<n;s++)e.indexOf(t[i].childNodes[s])>-1&&e.splice(e.indexOf(t[i].childNodes[s]),1);r=t[i].childNodes.length;var a=t.indexOf(t[i].parentNode),l=e.indexOf(t[i].parentNode);a>-1&&t.splice(a,1),l>-1&&e.splice(l,1);var c=e.indexOf(t[i]);c>-1&&e.splice(c,1),t.splice(i,1),i--}return[t,e]},o.removeChild=function(t,e){var i=e.childNodes.length;if(i>0)for(var n=0;n<i;n++)t.indexOf(e.childNodes[n])>-1&&(t=this.removeChild(t,e.childNodes[n]),t.splice(t.indexOf(e.childNodes[n]),1));return t},o.removeParent=function(t){for(var e=0;e<t.length;e++)t.indexOf(t[e].parentNode)>-1&&(t=this.removeChild(t,t[e]),t.splice(e,1),e--);return t},o.unWrap=function(t,e,i,n){for(var r=0;r<e.length;r++)if(this.NONVALID_TAGS.indexOf(e[r].nodeName.toLowerCase())>-1&&e[r].parentNode&&this.NONVALID_PARENT_TAGS.indexOf(e[r].parentNode.nodeName.toLowerCase())>-1&&(n.setSelectionText(t,e[r],e[r],0,e[r].childNodes.length),re.unwrap(i.GetSpliceNode(n.getRange(t),e[r].parentNode))),e[r].nodeName.toLocaleLowerCase()!=="p"){this.NONVALID_PARENT_TAGS.indexOf(e[r].nodeName.toLowerCase())<0&&e[r].parentNode.nodeName.toLocaleLowerCase()!=="p"&&!((e[r].nodeName.toLocaleLowerCase()==="blockquote"||e[r].nodeName.toLocaleLowerCase()==="li")&&this.IGNORE_PARENT_TAGS.indexOf(e[r].childNodes[0].nodeName.toLocaleLowerCase())>-1)&&!(e[r].childNodes.length===1&&e[r].childNodes[0].nodeName.toLocaleLowerCase()==="p")&&re.Wrap(e[r],t.createElement(this.defaultTag));var s=re.unwrap(e[r]);s.length===1&&s[0].parentNode.nodeName.toLocaleLowerCase()==="p"&&(re.Wrap(e[r],t.createElement(this.defaultTag)),re.unwrap(e[r]));for(var a=0;a<s.length;a++)if(this.NONVALID_TAGS.indexOf(s[a].nodeName.toLowerCase())>-1)this.unWrap(t,[s[a]],i,n);else if(this.BLOCK_TAGS.indexOf(s[a].nodeName.toLocaleLowerCase())>-1&&s[a].nodeName.toLocaleLowerCase()!=="p"){var l=this.removeParent([s[a]]);this.unWrap(t,l,i,n)}else this.BLOCK_TAGS.indexOf(s[a].nodeName.toLocaleLowerCase())>-1&&s[a].parentNode.nodeName.toLocaleLowerCase()===s[a].nodeName.toLocaleLowerCase()?re.unwrap(s[a]):this.BLOCK_TAGS.indexOf(s[a].nodeName.toLocaleLowerCase())>-1&&s[a].nodeName.toLocaleLowerCase()==="p"&&(re.Wrap(s[a],t.createElement(this.defaultTag)),re.unwrap(s[a]))}else re.Wrap(e[r],t.createElement(this.defaultTag)),re.unwrap(e[r])},o.clearInlines=function(t,e,i,n,r){for(var s=0;s<t.length;s++){for(var a=t[s],l=void 0;!this.domNode.isBlockNode(a)&&a.parentElement&&!a.parentElement.classList.contains("e-img-inner");)l=a,a=a.parentElement;l&&Qe.inlineTags.indexOf(l.nodeName.toLocaleLowerCase())>-1&&(n.GetSpliceNode(i,l),this.removeInlineParent(l))}},o.removeInlineParent=function(t){for(var e=re.unwrap(t),i=0;i<e.length;i++)e[i].parentNode.childNodes.length===1&&!e[i].parentNode.classList.contains("e-img-inner")&&Qe.inlineTags.indexOf(e[i].parentNode.nodeName.toLocaleLowerCase())>-1?this.removeInlineParent(e[i].parentNode):Qe.inlineTags.indexOf(e[i].nodeName.toLocaleLowerCase())>-1&&this.removeInlineParent(e[i])},o.BLOCK_TAGS=["address","article","aside","blockquote","details","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","li","main","nav","noscript","ol","p","pre","section","ul"],o.NONVALID_PARENT_TAGS=["thead","tbody","ul","ol","table","tfoot","tr"],o.IGNORE_PARENT_TAGS=["ul","ol","table"],o.NONVALID_TAGS=["thead","tbody","figcaption","td","tr","th","tfoot","figcaption","li"],o.defaultTag="p",o}(),Op=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.observer.on(Za,this.applyClear,this),this.parent.observer.on(Oe,this.onKeyDown,this)},o.prototype.onKeyDown=function(t){switch(t.event.action){case"clear-format":this.applyClear({subCommand:"ClearFormat",callBack:t.callBack,enterAction:t.enterAction}),t.event.preventDefault();break}},o.prototype.applyClear=function(t){t.subCommand==="ClearFormat"&&(Bp.clear(this.parent.currentDocument,this.parent.editableElement,t.enterAction,t.selector,t.subCommand),t.callBack&&t.callBack({requestType:t.subCommand,event:t.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)}))},o}(),Np=function(){function o(t,e){this.undoRedoStack=[],this.parent=t,this.undoRedoSteps=h(e)?30:e.undoRedoSteps,this.undoRedoTimer=h(e)?300:e.undoRedoTimer,this.addEventListener()}return o.prototype.addEventListener=function(){var t=Gr(this.keyUp,this.undoRedoTimer);this.parent.observer.on(Pi,t,this),this.parent.observer.on(Oe,this.keyDown,this),this.parent.observer.on(Ms,this.onAction,this),this.parent.observer.on(Kn,this.onPropertyChanged,this)},o.prototype.onPropertyChanged=function(t){for(var e=0,i=Object.keys(t.newProp);e<i.length;e++){var n=i[e];switch(n){case"undoRedoSteps":this.undoRedoSteps=t.newProp.undoRedoSteps;break;case"undoRedoTimer":this.undoRedoTimer=t.newProp.undoRedoTimer;break}}},o.prototype.removeEventListener=function(){this.parent.observer.off(Pi,this.keyUp),this.parent.observer.off(Oe,this.keyDown),this.parent.observer.off(Ms,this.onAction)},o.prototype.onAction=function(t){t.subCommand==="Undo"?this.undo(t):this.redo(t)},o.prototype.destroy=function(){this.removeEventListener()},o.prototype.keyDown=function(t){var e=t.event,i=this;switch(e.action){case"undo":e.preventDefault(),i.undo(t);break;case"redo":e.preventDefault(),i.redo(t);break}},o.prototype.keyUp=function(t){t.event.keyCode!==17&&!t.event.ctrlKey&&this.saveData(t)},o.prototype.getTextContentFromFragment=function(t){for(var e="",i=0;i<t.childNodes.length;i++){var n=t.childNodes[i];n.nodeType===Node.TEXT_NODE?e+=n.textContent:n.nodeType===Node.ELEMENT_NODE&&(e+=this.getTextContentFromFragment(n))}return e},o.prototype.isElementStructureEqual=function(t,e){if(t.childNodes.length!==e.childNodes.length)return!1;for(var i=0;i<t.childNodes.length;i++){var n=t.childNodes[i],r=e.childNodes[i];if(!n||!r||n.nodeType!==r.nodeType||n.outerHTML!==r.outerHTML)return!1}return!0},o.prototype.saveData=function(t){for(var e=new Be().getRange(this.parent.currentDocument),i=this.parent.editableElement===e.startContainer.parentElement?e.startContainer.parentElement:e.startContainer,n=i.childNodes.length-1;n>=0;n--)!h(i.childNodes[n])&&i.childNodes[n].nodeName==="#text"&&i.childNodes[n].textContent.length===0&&i.childNodes[n].nodeName!=="IMG"&&i.childNodes[n].nodeName!=="BR"&&i.childNodes[n].nodeName&&S(i.childNodes[n]);e=new Be().getRange(this.parent.currentDocument);for(var r=new Be().save(e,this.parent.currentDocument),s=this.parent.editableElement.cloneNode(!0),a=document.createDocumentFragment();s.firstChild;)a.appendChild(s.firstChild);var l={text:a,range:r};this.undoRedoStack.length>=this.steps&&(this.undoRedoStack=this.undoRedoStack.slice(0,this.steps+1)),!(this.undoRedoStack.length>1&&this.undoRedoStack[this.undoRedoStack.length-1].range.range.collapsed===e.collapsed&&this.undoRedoStack[this.undoRedoStack.length-1].range.startOffset===r.range.startOffset&&this.undoRedoStack[this.undoRedoStack.length-1].range.endOffset===r.range.endOffset&&this.undoRedoStack[this.undoRedoStack.length-1].range.range.startContainer===r.range.startContainer&&this.getTextContentFromFragment(this.undoRedoStack[this.undoRedoStack.length-1].text).trim()===this.getTextContentFromFragment(l.text).trim()&&this.isElementStructureEqual(this.undoRedoStack[this.undoRedoStack.length-1].text,l.text))&&(this.undoRedoStack.push(l),this.steps=this.undoRedoStack.length-1,this.steps>this.undoRedoSteps&&(this.undoRedoStack.shift(),this.steps--),t&&t.callBack&&t.callBack())},o.prototype.undo=function(t){if(this.steps>0){var e=this.undoRedoStack[this.steps-1].range,i=this.undoRedoStack[this.steps-1].text;this.parent.editableElement.innerHTML="",this.parent.editableElement.appendChild(i.cloneNode(!0)),this.parent.editableElement.focus(),De()&&yt(this.parent.editableElement,t.selector),e.restore(),this.steps--,t.callBack&&t.callBack({requestType:"Undo",editorMode:"HTML",range:e,elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),event:t.event})}},o.prototype.redo=function(t){if(this.undoRedoStack[this.steps+1]!=null){var e=this.undoRedoStack[this.steps+1].range,i=this.undoRedoStack[this.steps+1].text;this.parent.editableElement.innerHTML="",this.parent.editableElement.appendChild(i.cloneNode(!0)),this.parent.editableElement.focus(),De()&&yt(this.parent.editableElement,t.selector),e.restore(),this.steps++,t.callBack&&t.callBack({requestType:"Redo",editorMode:"HTML",range:e,elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),event:t.event})}},o.prototype.getUndoStatus=function(){var t={undo:!1,redo:!1};return this.steps>0&&(t.undo=!0),this.undoRedoStack[this.steps+1]!=null&&(t.redo=!0),t},o}(),Rp=function(){function o(t){this.olData=["decimal","lower-alpha","lower-roman","upper-alpha","upper-roman","lower-greek"],this.ulData=["disc","square","circle","disc","square","circle"],this.ignorableNodes=["A","APPLET","B","BLOCKQUOTE","BR","BUTTON","CENTER","CODE","COL","COLGROUP","DD","DEL","DFN","DIR","DIV","DL","DT","EM","FIELDSET","FONT","FORM","FRAME","FRAMESET","H1","H2","H3","H4","H5","H6","HR","I","IMG","IFRAME","INPUT","INS","LABEL","LI","OL","OPTION","P","PARAM","PRE","Q","S","SELECT","SPAN","STRIKE","STRONG","SUB","SUP","TABLE","TBODY","TD","TEXTAREA","TFOOT","TH","THEAD","TITLE","TR","TT","U","UL"],this.blockNode=["div","p","h1","h2","h3","h4","h5","h6","address","blockquote","button","center","dd","dir","dl","dt","fieldset","frameset","hr","iframe","isindex","li","map","menu","noframes","noscript","object","ol","pre","table","tbody","td","tfoot","th","thead","tr","ul","header","article","nav","footer","section","aside","main","figure","figcaption"],this.borderStyle=["border-top","border-right","border-bottom","border-left"],this.upperRomanNumber=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII","XIII","XIV","XV","XVI","XVII","XVIII","XIX","XX"],this.lowerRomanNumber=["i","ii","iii","iv","v","vi","vii","viii","ix","x","xi","xii","xiii","xiv","xv","xvi","xvii","xviii","xix","xx"],this.lowerGreekNumber=["","","","","","","","","","","","","","","","","","","","","","","",""],this.removableElements=["o:p","style"],this.listContents=[],this.cropImageDimensions=[],this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.observer.on(Oa,this.wordCleanup,this)},o.prototype.wordCleanup=function(t){var e=h(t.allowedStylePropertiesArray)?[]:t.allowedStylePropertiesArray,i=[],n=t.args.clipboardData.getData("text/HTML"),r=t.args.clipboardData.getData("text/rtf"),s=R("p");s.setAttribute("id","MSWord-Content"),s.innerHTML=n;var a=/class='?Mso|style='[^ ]*\bmso-/i,l=/class="?Mso|style="[^ ]*\bmso-/i,c=/(class="?Mso|class='?Mso|class="?Xl|class='?Xl|class=Xl|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument)/gi,p=/style='mso-width-source:/i;if(a.test(n)||l.test(n)||c.test(n)||p.test(n)){var d=this.findSource(s);this.imageConversion(s,r),n=n.replace(/<img[^>]+>/i,""),this.addListClass(s),i=this.cleanUp(s,i),!h(i[0])&&i[0].parentElement.tagName!=="UL"&&i[0].parentElement.tagName!=="OL"&&this.listConverter(i),this.cleanList(s,"UL"),this.cleanList(s,"OL"),this.styleCorrection(s,e),this.removingComments(s),this.removeUnwantedElements(s),this.removeEmptyElements(s),this.removeEmptyAnchorTag(s),this.breakLineAddition(s),this.removeClassName(s),p.test(n)&&this.addTableBorderClass(s),this.processMargin(s),t.callBack(s.innerHTML,this.cropImageDimensions,d)}else t.callBack(s.innerHTML)},o.prototype.cleanList=function(t,e){for(var i=t.querySelectorAll(e+" div"),n=i.length-1;n>=0;n--){for(var r=i[n].parentNode;i[n].firstChild;)r.insertBefore(i[n].firstChild,i[n]);var s=this.findClosestListElem(i[n]);s&&this.insertAfter(i[n],s)}},o.prototype.insertAfter=function(t,e){e.parentNode.insertBefore(t,e.nextSibling)},o.prototype.findClosestListElem=function(t){for(var e;!h(t);)t=!h(t.closest("ul"))&&t.tagName!=="UL"?t.closest("ul"):t.tagName!=="OL"?t.closest("ol"):null,e=h(t)?e:t;return e},o.prototype.addListClass=function(t){for(var e=t.querySelectorAll("*"),i=0;i<e.length;i++)!h(e[i].getAttribute("style"))&&e[i].getAttribute("style").replace(/ /g,"").replace(`
`,"").indexOf("mso-list:l")>=0&&e[i].className.toLowerCase().indexOf("msolistparagraph")===-1&&e[i].tagName.charAt(0)!=="H"&&e[i].tagName!=="LI"&&e[i].tagName!=="OL"&&e[i].tagName!=="UL"&&e[i].classList.add("msolistparagraph")},o.prototype.addTableBorderClass=function(t){for(var e=t.querySelectorAll("table"),i=!1,n=0;n<e.length;n++){for(var r=0;r<this.borderStyle.length;r++)if(e[n].innerHTML.indexOf(this.borderStyle[r])>=0){i=!0;break}i&&(e[n].classList.add("e-rte-table-border"),i=!1)}},o.prototype.imageConversion=function(t,e){this.checkVShape(t);for(var i=t.querySelectorAll("img"),n=0;n<i.length;n++)!h(i[n].getAttribute("v:shapes"))&&i[n].getAttribute("v:shapes").indexOf("Picture")<0&&i[n].getAttribute("v:shapes").indexOf("")<0&&i[n].getAttribute("v:shapes").indexOf("Grafik")<0&&i[n].getAttribute("v:shapes").toLowerCase().indexOf("image")<0&&i[n].getAttribute("v:shapes").indexOf("Graphic")<0&&i[n].getAttribute("v:shapes").indexOf("_x0000_s")<0&&i[n].getAttribute("v:shapes").indexOf("_x0000_i")<0&&S(i[n]);i=t.querySelectorAll("img");var r=[],s=[],a=[],l=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi);if(i.length>0){for(var n=0;n<i.length;n++)r.push(i[n].getAttribute("src")),a.push(i[n].getAttribute("src").split("/")[i[n].getAttribute("src").split("/").length-1].split(".")[0]);for(var c=this.hexConversion(e),n=0;n<c.length;n++)s.push({base64Data:h(c[n].hex)?null:this.convertToBase64(c[n]),isCroppedImage:c[n].isCroppedImage}),c[n].isCroppedImage&&this.cropImageDimensions.push({goalWidth:c[n].goalWidth,goalHeight:c[n].goalHeight,cropLength:c[n].cropLength,cropTop:c[n].cropTop,cropR:c[n].cropR,cropB:c[n].cropB});for(var n=0;n<i.length;n++)r[n].match(l)?i[n].setAttribute("src",r[n]):(!h(s[n])&&!h(s[n].base64Data)?i[n].setAttribute("src",s[n].base64Data):(i[n].removeAttribute("src"),i[n].setAttribute("alt","Unsupported file format")),!h(s[n])&&s[n].isCroppedImage&&i[n].classList.add("e-img-cropped")),i[n].setAttribute("id","msWordImg-"+a[n])}},o.prototype.checkVShape=function(t){for(var e=t.querySelectorAll("*"),i=0;i<e.length;i++)switch(e[i].nodeName){case"V:SHAPETYPE":S(e[i]);break;case"V:SHAPE":if(e[i].firstElementChild.nodeName==="V:IMAGEDATA"){var n=e[i].firstElementChild.getAttribute("src"),r=R("img");r.setAttribute("src",n),e[i].parentElement.insertBefore(r,e[i]),S(e[i])}break}},o.prototype.convertToBase64=function(t){var e=this.conHexStringToBytes(t.hex),i=this.conBytesToBase64(e),n=t.type?"data:"+t.type+";base64,"+i:null;return n},o.prototype.conBytesToBase64=function(t){for(var e="",i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",n=t.length,r=0;r<n;r+=3){var s=t.slice(r,r+3),a=s.length,l=[];if(a<3)for(var c=a;c<3;c++)s[c]=0;l[0]=(s[0]&252)>>2,l[1]=(s[0]&3)<<4|s[1]>>4,l[2]=(s[1]&15)<<2|(s[2]&192)>>6,l[3]=s[2]&63;for(var c=0;c<4;c++)c<=a?e+=i.charAt(l[c]):e+="="}return e},o.prototype.conHexStringToBytes=function(t){for(var e=[],i=t.length/2,n=0;n<i;n++)e.push(parseInt(t.substr(n*2,2),16));return e},o.prototype.hexConversion=function(t){var e=/\{\\pict[\s\S]+?\\bliptag\-?\d+(\\blipupi\-?\d+)?(\{\\\*\\blipuid\s?[\da-fA-F]+)?[\s\}]*?/,i=new RegExp("(?:("+e.source+"))([\\da-fA-F\\s]+)\\}","g"),n=t.match(i),r,s=[];if(!h(n))for(var a=0;a<n.length;a++){var l=!1,c=0,p=0,d=0,u=0,f=0,m=0;if(e.test(n[a])){if(n[a].indexOf("\\pngblip")!==-1)r="image/png";else if(n[a].indexOf("\\jpegblip")!==-1)r="image/jpeg";else if(n[a].indexOf("\\picprop")!==-1)r=null;else continue;l=!!(this.extractCropValue("cropl",n[a])>0&&this.extractCropValue("cropt",n[a])>0||this.extractCropValue("cropr",n[a])>0||this.extractCropValue("cropb",n[a])),l&&(c=this.extractCropValue("wgoal",n[a]),p=this.extractCropValue("hgoal",n[a]),d=this.extractCropValue("cropl",n[a]),u=this.extractCropValue("cropt",n[a]),f=this.extractCropValue("cropr",n[a]),m=this.extractCropValue("cropb",n[a])),s.push({hex:r?n[a].replace(e,"").replace(/[^\da-fA-F]/g,""):null,type:r,isCroppedImage:l,goalWidth:c,goalHeight:p,cropLength:d,cropTop:u,cropR:f,cropB:m})}}return s},o.prototype.extractCropValue=function(t,e){var i=new RegExp("\\\\pic"+t+"(\\-?\\d+)\\\\").exec(e.replace(/\r\n\\/g,"\\").replace(/\n/g,"\\"))[1];return parseInt(i,10)},o.prototype.removeClassName=function(t){for(var e=t.querySelectorAll("*[class]:not(.e-img-cropped)"),i=0;i<e.length;i++)e[i].removeAttribute("class")},o.prototype.breakLineAddition=function(t){for(var e=t.querySelectorAll("*"),i=0;i<e.length;i++)if(e[i].children.length===0&&e[i].innerHTML==="&nbsp;"&&e[i].innerHTML==="&nbsp;"&&!e[i].closest("li")&&!e[i].closest("td")&&(e[i].nodeName!=="SPAN"||e[i].nodeName==="SPAN"&&h(e[i].previousElementSibling)&&h(e[i].nextElementSibling))){var n=this.findDetachElem(e[i]),r=R("br"),s=n.textContent.length>0&&n.textContent.match(/\u00a0/g)&&n.textContent.match(/\u00a0/g).length>0;!s&&!h(n.parentElement)&&(n.parentElement.insertBefore(r,n),S(n))}},o.prototype.findDetachElem=function(t){var e;return!h(t.parentElement)&&t.parentElement.textContent.trim()===""&&t.parentElement.tagName!=="TD"&&h(t.parentElement.querySelector("img"))?e=this.findDetachElem(t.parentElement):e=t,e},o.prototype.removeUnwantedElements=function(t){var e=t.querySelector("style");h(e)||S(e);for(var i=t.innerHTML,n=0;n<this.removableElements.length;n++){var r=new RegExp("<"+this.removableElements[n]+">","g"),s=new RegExp("</"+this.removableElements[n]+">","g");i=i.replace(r,""),i=i.replace(s,"")}t.innerHTML=i,t.querySelectorAll(":empty")},o.prototype.findDetachEmptyElem=function(t){var e;if(h(t.parentElement))e=null;else{var i=t.parentElement.textContent.length>0&&t.parentElement.textContent.match(/\u00a0/g)&&t.parentElement.textContent.match(/\u00a0/g).length>0;!i&&t.parentElement.textContent.trim()===""&&t.parentElement.getAttribute("id")!=="MSWord-Content"&&!this.hasParentWithClass(t,"MsoListParagraph")&&h(t.parentElement.querySelector("img"))?e=this.findDetachEmptyElem(t.parentElement):e=t}return e},o.prototype.hasParentWithClass=function(t,e){for(var i=t.parentElement;!h(i);){if(i.classList.contains(e))return!0;i=i.parentElement}return!1},o.prototype.removeEmptyElements=function(t){for(var e=t.querySelectorAll(":empty"),i=0;i<e.length;i++){!h(e[i].closest("td"))&&!h(e[i].closest("td").querySelector(".MsoNormal"))&&(e[i].innerHTML="-");var n=!0;if(e[i].tagName==="DIV"&&(n=e[i].style.borderBottom==="none"||e[i].style.borderBottom===""),e[i].tagName!=="IMG"&&e[i].tagName!=="BR"&&e[i].tagName!=="IFRAME"&&e[i].tagName!=="TD"&&e[i].tagName!=="HR"&&n){var r=this.findDetachEmptyElem(e[i]);h(r)||S(r)}}},o.prototype.styleCorrection=function(t,e){var i=t.querySelectorAll("style");if(i.length>0){var n=i[0].innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi),r=h(n)?null:this.findStyleObject(n),s=Object.keys(r),a=s.map(function(k){return r[""+k]});a=this.removeUnwantedStyle(a,e),this.filterStyles(t,e);for(var l=void 0,c=!1,p=0;p<s.length;p++){if(s[p].split(".")[0]==="")l=t.getElementsByClassName(s[p].split(".")[1]),c=!0;else{if(s[p].split(".").length===1&&s[p].split(".")[0].indexOf("@")>=0)continue;s[p].split(".").length===1&&s[p].split(".")[0].indexOf("@")<0?l=t.getElementsByTagName(s[p]):l=t.querySelectorAll(s[p])}for(var d=0;d<l.length;d++)if(!(l[d].closest("li")&&s[p]==="p")){var u=l[d].getAttribute("style");if(!h(u)&&u.trim()!==""){var f=a[p].split(";");if(!c)for(var m=0;m<f.length;m++)u.indexOf(f[m].split(":")[0])>=0&&(f.splice(m,1),m--);var v=u+f.join(";")+";";l[d].setAttribute("style",v)}else a[p]=a[p].replace(/text-indent:-(.*?)(?=;|$)/gm,""),l[d].setAttribute("style",a[p])}c=!1}for(var y=["MsoListParagraphCxSpFirst","MsoListParagraphCxSpMiddle","MsoListParagraphCxSpLast"],p=0;p<y.length;p++)if(s.indexOf("li."+y[p])>-1)for(var L=t.querySelectorAll("ol."+y[p]+", ul."+y[p]),d=0;d<L.length;d++){var u=L[d].getAttribute("style");if(!h(u)&&u.trim()!==""&&L[d].style.marginLeft!==""){for(var f=a[s.indexOf("li."+y[p])].split(";"),m=0;m<f.length;m++)if("margin-left".indexOf(f[m].split(":")[0])>=0&&!h(f[m].split(":")[1])&&f[m].split(":")[1].indexOf("in")>=0&&L[d].style.marginLeft.indexOf("in")>=0){var C=parseFloat(f[m].split(":")[1].split("in")[0]),w=parseFloat(L[d].style.marginLeft.split("in")[0]);L[d].style.marginLeft=w-C+"in"}}}}},o.prototype.filterStyles=function(t,e){for(var i=t.querySelectorAll("*[style]"),n=0;n<i.length;n++){for(var r=i[n].getAttribute("style").split(";"),s="",a=0;a<r.length;a++)e.indexOf(r[a].split(":")[0].trim())>=0&&(s+=r[a]+";");i[n].setAttribute("style",s)}},o.prototype.removeUnwantedStyle=function(t,e){for(var i=0;i<t.length;i++){var n=t[i].split(";");t[i]="";for(var r=0;r<n.length;r++)e.indexOf(n[r].split(":")[0])>=0&&(t[i]+=n[r]+";")}return t},o.prototype.findStyleObject=function(t){for(var e={},i=0;i<t.length;i++){var n=t[i],r=n.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),s=n.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");r=r.replace(/^[\s]|[\s]$/gm,""),s=s.replace(/^[\s]|[\s]$/gm,""),r=r.replace(/\n|\r|\n\r/g,""),s=s.replace(/\n|\r|\n\r/g,"");for(var a=r.split(", "),l=0;l<a.length;l++)e[a[l]]=s}return e},o.prototype.removingComments=function(t){var e=t.innerHTML;e=e.replace(/<!--[\s\S]*?-->/g,""),t.innerHTML=e},o.prototype.cleanUp=function(t,e){for(var i=[],n,r=t.querySelectorAll("*"),s=0;s<r.length;s++){if(this.ignorableNodes.indexOf(r[s].nodeName)===-1||r[s].nodeType===3&&r[s].textContent.trim()===""){i.push(r[s]);continue}else r[s].className&&r[s].className.toLowerCase().indexOf("msolistparagraph")!==-1&&!h(r[s].getAttribute("style"))&&r[s].getAttribute("style").indexOf("mso-list:")>=0&&(r[s].className.indexOf("MsoListParagraphCxSpFirst")>=0&&e.length>0&&e[e.length-1]!==null&&e.push(null),e.push(r[s]));n&&this.blockNode.indexOf(r[s].nodeName.toLowerCase())!==-1&&!(r[s].className&&r[s].className.toLowerCase().indexOf("msolistparagraph")!==-1&&!h(r[s].getAttribute("style"))&&r[s].getAttribute("style").indexOf("mso-list:")>=0)&&e.push(null),this.blockNode.indexOf(r[s].nodeName.toLowerCase())!==-1&&(r[s].className&&r[s].className.toLowerCase().indexOf("msolistparagraph")!==-1&&!h(r[s].getAttribute("style"))&&r[s].getAttribute("style").indexOf("mso-list:")>=0?n=!0:n=!1)}return e.length&&e[e.length-1]!==null&&e.push(null),e},o.prototype.listConverter=function(t){for(var e,i=[],n=[],r="",s,a="",l=0;l<t.length;l++){if(t[l]===null){i.push({content:this.makeConversion(n),node:t[l-1]}),n=[];continue}t[l].getAttribute("style")&&t[l].getAttribute("style").indexOf("mso-outline-level")!==-1&&t[l].setAttribute("style",t[l].getAttribute("style").replace("mso-outline-level","mso-outline")),r=t[l].getAttribute("style"),r&&r.indexOf("level")!==-1?e=parseInt(r.charAt(r.indexOf("level")+5),null):e=1,this.listContents=[],this.getListContent(t[l]);var c=void 0,p=void 0,d=void 0,u=void 0;if(!h(this.listContents[0])){if(c=this.listContents[0].trim().length>1?"ol":"ul",p=this.getlistStyleType(this.listContents[0],c),c==="ol"&&(l===0||t[l-1]===null)){var f=this.listContents[0].split(".")[0],m=["A","a","I","i","","1","1-"];m.indexOf(f)===-1&&(p==="decimal"?isNaN(parseInt(f,10))||(d=parseInt(f,10)):p==="upper-alpha"?d=f.split(".")[0].charCodeAt(0)-64:p==="lower-alpha"?d=f.split(".")[0].charCodeAt(0)-96:p==="upper-roman"?d=this.upperRomanNumber.indexOf(this.listContents[0].split(".")[0])+1:p==="lower-roman"?d=this.lowerRomanNumber.indexOf(this.listContents[0].split(".")[0])+1:p==="lower-greek"&&(d=this.lowerGreekNumber.indexOf(this.listContents[0].split(".")[0])+1)),t[l].style.marginLeft!==""&&(u=t[l].style.marginLeft)}for(var v=[],y=1;y<this.listContents.length;y++)v.push(this.listContents[y]);var L=void 0;h(t[l].className)||(L=t[l].className),h(t[l].getAttribute("style"))||(t[l].setAttribute("style",t[l].getAttribute("style").replace("text-align:start;","")),t[l].style.textIndent="",a=t[l].getAttribute("style")),n.push({listType:c,content:v,nestedLevel:e,class:L,listStyle:a,listStyleTypeName:p,start:d,styleMarginLeft:u})}}for(s=t.shift();s;){for(var C=[],w=0;w<i.length;w++)if(i[w].node===s){for(var k=0;k<i[w].content.childNodes.length;k++)C.push(i[w].content.childNodes[k]);for(var k=0;k<C.length;k++)s.parentElement.insertBefore(C[k],s);break}s.remove(),s=t.shift(),s||(s=t.shift())}},o.prototype.getlistStyleType=function(t,e){var i;if(e==="ol"){var n=t.split(".")[0].charCodeAt(0);switch(!0){case this.upperRomanNumber.indexOf(t.split(".")[0])>-1:i="upper-roman";break;case this.lowerRomanNumber.indexOf(t.split(".")[0])>-1:i="lower-roman";break;case this.lowerGreekNumber.indexOf(t.split(".")[0])>-1:i="lower-greek";break;case(n>64&&n<91):i="upper-alpha";break;case(n>96&&n<123):i="lower-alpha";break;default:i="decimal";break}}else switch(t.split(".")[0]){case"o":i="circle";break;case"":i="square";break;default:i="disc";break}return i},o.prototype.makeConversion=function(t){for(var e=R("div"),i,n=1,r,s=0,a,l=0;l<t.length;l++){for(var c=["MsoListParagraphCxSpFirst","MsoListParagraphCxSpMiddle","MsoListParagraphCxSpLast"],p=!1,d=0;d<c.length;d++)if(c[d].indexOf(t[l].class)>=0){p=!0;break}!h(r)&&l!==0&&t[l-1].listType!==t[l].listType&&!p&&(r=null);var u=R("p",{className:"MsoNormal"});if(u.innerHTML=t[l].content.join(" "),t[l].nestedLevel===1&&s===0&&t[l].content)e.appendChild(i=R(t[l].listType,{className:t[l].class})),r=R("li"),r.appendChild(u),i.appendChild(r),i.setAttribute("level",t[l].nestedLevel.toString()),i.style.marginLeft=t[l].styleMarginLeft,i.style.listStyleType=t[l].listStyleTypeName;else if(t[l].nestedLevel===n)!h(r)&&!h(r.parentElement)&&r.parentElement.tagName.toLowerCase()===t[l].listType?(r.parentElement.appendChild(r=R("li")),r.appendChild(u)):h(r)?(i=R(t[l].listType),i.style.listStyleType=t[l].listStyleTypeName,r=R("li"),r.appendChild(u),i.appendChild(r),i.setAttribute("level",t[l].nestedLevel.toString()),e.appendChild(i)):(i=R(t[l].listType),i.style.listStyleType=t[l].listStyleTypeName,r.parentElement.parentElement.appendChild(i),r=R("li"),r.appendChild(u),i.appendChild(r),i.setAttribute("level",t[l].nestedLevel.toString()));else if(t[l].nestedLevel>n)if(h(r))if(t[l].nestedLevel>n&&p){var m=R(t[l].listType);r=R("li"),m.appendChild(r),m.style.listStyleType="none";for(var f=0;f<t[l].nestedLevel-1;f++)r.appendChild(i=R(t[l].listType)),r=R("li"),i.appendChild(r),i.style.listStyleType="none";r.appendChild(u),e.appendChild(m),i.setAttribute("level",t[l].nestedLevel.toString()),i.style.listStyleType=t[l].listStyleTypeName}else e.appendChild(i=R(t[l].listType)),r=R("li"),r.appendChild(u),i.appendChild(r),i.setAttribute("level",t[l].nestedLevel.toString()),i.style.listStyleType=t[l].listStyleTypeName;else{for(var f=0;f<t[l].nestedLevel-n;f++)r.appendChild(i=R(t[l].listType)),r=R("li"),f!==t[l].nestedLevel-n-1&&t[l].nestedLevel-n>1&&(r.style.listStyleType="none"),i.appendChild(r);r.appendChild(u),i.setAttribute("level",t[l].nestedLevel.toString()),i.style.listStyleType=t[l].listStyleTypeName}else if(t[l].nestedLevel===1)e.lastChild.tagName.toLowerCase()===t[l].listType?i=e.lastChild:(e.appendChild(i=R(t[l].listType)),i.style.listStyleType=t[l].listStyleTypeName),r=R("li"),r.appendChild(u),i.appendChild(r),i.setAttribute("level",t[l].nestedLevel.toString());else for(a=r;a.parentElement;)if(a=a.parentElement,a.attributes.getNamedItem("level")){if(parseInt(a.attributes.getNamedItem("level").textContent,null)===t[l].nestedLevel){r=R("li"),r.appendChild(u),a.appendChild(r);break}else if(t[l].nestedLevel>parseInt(a.attributes.getNamedItem("level").textContent,null)){a.appendChild(i=R(t[l].listType)),r=R("li"),r.appendChild(u),i.appendChild(r),i.setAttribute("level",t[l].nestedLevel.toString()),i.style.listStyleType=t[l].listStyleTypeName;break}}r.setAttribute("class",t[l].class),r.setAttribute("style",h(t[l].listStyle)?"":t[l].listStyle),n=t[l].nestedLevel,s++,h(t[l].start)||i.setAttribute("start",t[l].start.toString())}return e},o.prototype.getListContent=function(t){var e="",i=t.firstElementChild;if(i.textContent.trim()===""&&!h(i.firstElementChild)&&i.firstElementChild.nodeName==="IMG")e=t.innerHTML.trim(),this.listContents.push(""),this.listContents.push(e);else if(i.childNodes.length>0){for(var n=i.querySelectorAll('[style*="mso-list"]'),r=0;r<n.length;r++)n[r].setAttribute("style",n[r].getAttribute("style").replace(/\n/g,""));var s=i.querySelector('span[style="mso-list:Ignore"]');h(s)||(this.listContents.push(s.textContent.trim()),S(s),this.removingComments(t),this.removeUnwantedElements(t))}this.listContents.push(t.innerHTML)},o.prototype.processMargin=function(t){var e=t.querySelectorAll("li");if(e.length>0)for(var i=0;i<e.length;i++)h(e[i].style.marginLeft)||(e[i].style.marginLeft="");var n=t.querySelectorAll("table");if(n.length>0)for(var i=0;i<n.length;i++)!h(n[i].style.marginLeft)&&n[i].style.marginLeft.indexOf("-")>=0&&(n[i].style.marginLeft="")},o.prototype.removeEmptyAnchorTag=function(t){for(var e=t.querySelectorAll("a:not([href])"),i=e.length-1;i>=0;i--){for(var n=e[i].parentNode;e[i].firstChild;)n.insertBefore(e[i].firstChild,e[i]);n.removeChild(e[i])}},o.prototype.findSource=function(t){for(var e=t.querySelectorAll("meta"),i=0;i<e.length;i++){var n=e[i],r=n.getAttribute("content"),s=n.getAttribute("name");if(s&&s.toLowerCase().indexOf("generator")>=0&&r&&r.toLowerCase().indexOf("microsoft")>=0){for(var a=0;a<qr.length;a++)if(r.toLowerCase().indexOf(qr[a])>=0)return qr[a]}}return"html"},o}(),Mp=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.observer.on(Ja,this.insertText,this)},o.prototype.insertText=function(t){var e=document.createTextNode(t.value);Re.Insert(this.parent.currentDocument,e,this.parent.editableElement),t.callBack&&t.callBack({requestType:t.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},o}(),jr=ka(),Ap=function(){function o(){}return o.get=function(t,e,i,n,r,s){for(var a=JSON.parse(JSON.stringify(jr)),l=JSON.parse(JSON.stringify(jr)),c=new Be,p=c.getRange(t),d=s?[s]:p.collapsed?c.getNodeCollection(p):c.getSelectionNodeCollectionBr(p),u=d.length,f=!1,m=0;m<d.length;m++){for(;d[m].nodeType===3&&p.startContainer.nodeType===3&&d[m].parentNode&&d[m].parentNode.lastElementChild&&d[m].parentNode.lastElementChild.nodeName!=="BR"&&this.getImmediateBlockNode(d[m].parentNode).textContent.replace(/\u200B/g,"").length===0&&p.startContainer.textContent.replace(/\u200B/g,"").length===0&&c.get(t).toString().replace(/\u200B/g,"").length===0;)d[m]=d[m].parentNode.lastElementChild.firstChild,f=!0;f&&d[m]&&(c.setCursorPoint(t,d[m],d[m].textContent.length),f=!1),(d[m].nodeName!=="BR"&&d[m].nodeType!==3||u>1&&d[m].nodeType===3&&d[m].textContent.trim()==="")&&(d.splice(m,1),m--)}for(var m=0;m<d.length;m++)a=this.getFormatParent(t,a,d[m],e,i,n,r),(m===0&&a.bold||!a.bold)&&(l.bold=a.bold),(m===0&&a.insertcode||!a.insertcode)&&(l.insertcode=a.insertcode),(m===0&&a.italic||!a.italic)&&(l.italic=a.italic),(m===0&&a.underline||!a.underline)&&(l.underline=a.underline),(m===0&&a.strikethrough||!a.strikethrough)&&(l.strikethrough=a.strikethrough),(m===0&&a.superscript||!a.superscript)&&(l.superscript=a.superscript),(m===0&&a.subscript||!a.subscript)&&(l.subscript=a.subscript),(m===0&&a.fontcolor||!a.fontcolor)&&(l.fontcolor=a.fontcolor),m===0&&a.fontname?l.fontname=a.fontname:l.fontname=a.fontname===l.fontname?a.fontname:"empty",m===0&&a.fontsize?l.fontsize=a.fontsize:l.fontsize=a.fontsize===l.fontsize?a.fontsize:"empty",(m===0&&a.backgroundcolor||!a.backgroundcolor)&&(l.backgroundcolor=a.backgroundcolor),(m===0&&a.orderedlist||!a.orderedlist)&&(l.orderedlist=a.orderedlist),(m===0&&a.unorderedlist||!a.unorderedlist)&&(l.unorderedlist=a.unorderedlist),(m===0&&a.alignments||!a.alignments)&&(l.alignments=a.alignments),m===0&&a.formats?l.formats=a.formats:l.formats=a.formats===l.formats?a.formats:"empty",(m===0&&a.createlink||!a.createlink)&&(l.createlink=a.createlink),(m===0&&a.numberFormatList||!a.numberFormatList)&&(l.numberFormatList=a.numberFormatList),(m===0&&a.bulletFormatList||!a.bulletFormatList)&&(l.bulletFormatList=a.bulletFormatList),a=JSON.parse(JSON.stringify(jr));return l},o.getImmediateBlockNode=function(t){do t=t.parentNode;while(t&&Nt.indexOf(t.nodeName.toLocaleLowerCase())<0);return t},o.getFormatParent=function(t,e,i,n,r,s,a){if(n.contains(i)||i.nodeType===3&&n.nodeType!==3&&n.contains(i.parentNode))do e=this.isFormattedNode(t,e,i,r,s,a),i=i.parentNode;while(i&&i!==n);return e},o.isFormattedNode=function(t,e,i,n,r,s){return e.bold||(e.bold=Qe.isBold(i)),e.italic||(e.italic=Qe.isItalic(i)),e.underline||(e.underline=Qe.isUnderline(i)),e.strikethrough||(e.strikethrough=Qe.isStrikethrough(i)),e.superscript||(e.superscript=Qe.isSuperscript(i)),e.subscript||(e.subscript=Qe.isSubscript(i)),e.fontcolor||(e.fontcolor=this.isFontColor(t,i)),e.fontname||(e.fontname=this.isFontName(t,i,s)),e.fontsize||(e.fontsize=this.isFontSize(t,i,r)),e.backgroundcolor||(e.backgroundcolor=this.isBackgroundColor(i)),e.orderedlist||(e.orderedlist=this.isOrderedList(i)),e.unorderedlist||(e.unorderedlist=this.isUnorderedList(i)),e.alignments||(e.alignments=this.isAlignment(i)),e.formats||(e.formats=this.isFormats(i,n),e.formats==="pre"&&(e.insertcode=!0)),e.createlink||(e.createlink=this.isLink(i)),e.numberFormatList||(e.numberFormatList=this.isNumberFormatList(i)),e.bulletFormatList||(e.bulletFormatList=this.isBulletFormatList(i)),e},o.isFontColor=function(t,e){var i=e.style&&e.style.color;return(i==null||i==="")&&e.nodeType!==3&&(i=this.getComputedStyle(t,e,"color")),i!==null&&i!==""&&i!==void 0?i:null},o.isLink=function(t){return t.nodeName.toLocaleLowerCase()==="a"},o.isBackgroundColor=function(t){var e=t.style&&t.style.backgroundColor;return e!==null&&e!==""&&e!==void 0?e:null},o.isFontSize=function(t,e,i){var n=e.style&&e.style.fontSize;return(n==null||n==="")&&e.nodeType!==3&&e.parentElement.classList.contains("e-content")&&(n=this.getComputedStyle(t,e,"font-size")),n!==null&&n!==""&&n!==void 0&&(i==null||i.indexOf(n)>-1)?n:null},o.isFontName=function(t,e,i){var n=e.style&&e.style.fontFamily;(n==null||n==="")&&e.nodeType!==3&&(n=this.getComputedStyle(t,e,"font-family"));var r=null;return n!==null&&n!==""&&n!==void 0&&(i==null||i.filter(function(s,a){var l=new RegExp(n,"i");(s.replace(/"/g,"").replace(/ /g,"").toLowerCase()===n.replace(/"/g,"").replace(/ /g,"").toLowerCase()||s.split(",")[0]&&!h(s.split(",")[0].trim().match(l))&&s.split(",")[0].trim()===s.split(",")[0].trim().match(l)[0])&&(r=a)})&&r!==null)?r!==null?i[r]:n.replace(/"/g,""):null},o.isOrderedList=function(t){return t.nodeName.toLocaleLowerCase()==="ol"},o.isUnorderedList=function(t){return t.nodeName.toLocaleLowerCase()==="ul"},o.isAlignment=function(t){var e=t.style&&t.style.textAlign;return e==="left"?"justifyleft":e==="center"?"justifycenter":e==="right"?"justifyright":e==="justify"?"justifyfull":null},o.isFormats=function(t,e){return e==null&&Nt.indexOf(t.nodeName.toLocaleLowerCase())>-1||e!=null&&e.indexOf(t.nodeName.toLocaleLowerCase())>-1?t.nodeName.toLocaleLowerCase():null},o.getComputedStyle=function(t,e,i){return t.defaultView.getComputedStyle(e,null).getPropertyValue(i)},o.isNumberFormatList=function(t){var e=t.style&&t.style.listStyleType;return e==="lower-alpha"?"Lower Alpha":e==="number"?"Number":e==="upper-alpha"?"Upper Alpha":e==="lower-roman"?"Lower Roman":e==="upper-roman"?"Upper Roman":e==="lower-greek"?"Lower Greek":e==="none"?"None":this.isOrderedList(t)?!0:null},o.isBulletFormatList=function(t){var e=t.style&&t.style.listStyleType;return e==="circle"?"Circle":e==="square"?"Square":e==="none"?"None":e==="disc"?"Disc":this.isUnorderedList(t)?!0:null},o}(),Pp=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.observer.on(Ma,this.emojiInsert,this)},o.prototype.emojiInsert=function(t){for(var e=document.createTextNode(t.value),i=this.parent.currentDocument.getSelection(),n=i.getRangeAt(0),r=n.startOffset,s=r-1;s>=r-15;s--){var a=i.focusNode.textContent.substring(s-1,s),l=/:$/.test(a);if(l){this.beforeApplyFormat(!0);break}}var c=/:$/.test(i.focusNode.textContent.charAt(r-1)),p=i.focusNode.textContent.charAt(r-2),d=/\s/.test(p);c&&(d||i.focusOffset===1)&&this.beforeApplyFormat(!0),Re.Insert(this.parent.currentDocument,e,this.parent.editableElement),t.callBack&&t.callBack({requestType:t.subCommand,editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},o.prototype.beforeApplyFormat=function(t){var e=this.parent.nodeSelection.getRange(this.parent.currentDocument),i=this.parent.nodeSelection.getNodeCollection(e)[0],n=!(i.parentElement.innerHTML.replace(/&nbsp;|<br>/g,"").trim()===":"||i.textContent.trim().indexOf("/")===0),r=i;if(n&&t)for(;r!==this.parent.editableElement;)r=r.parentElement;for(var s=e.startOffset;this.parent.nodeSelection.getRange(document).toString().indexOf(":")===-1;)this.parent.nodeSelection.setSelectionText(document,i,i,s,e.endOffset),s--;var a=this.parent.nodeSelection.getRange(this.parent.currentDocument),l=this.parent.nodeCutter.GetSpliceNode(a,i);l.parentNode.removeChild(l)},o}(),Ip=function(){function o(t,e){this.INVALID_TAGS=["A","AUDIO","IMG","VIDEO","IFRAME"],this.parent=t,this.settings=e,this.addEventListener(),this.setDeniedFormats()}return o.prototype.addEventListener=function(){this.parent.observer.on(Ps,this.actionHandler,this),this.parent.observer.on(Kn,this.onPropertyChanged,this)},o.prototype.onPropertyChanged=function(t){t&&t.module==="formatPainter"&&(h(t.newProp.formatPainterSettings.allowedFormats)||(this.settings.allowedFormats=t.newProp.formatPainterSettings.allowedFormats),h(t.newProp.formatPainterSettings.deniedFormats)||(this.settings.deniedFormats=t.newProp.formatPainterSettings.deniedFormats,this.setDeniedFormats()))},o.prototype.removeEventListener=function(){this.parent.observer.off(Ps,this.actionHandler),this.parent.observer.off(Kn,this.onPropertyChanged)},o.prototype.destroy=function(){this.removeEventListener(),this.INVALID_TAGS=null,this.copyCollection=null,this.deniedFormatsCollection=null,this.newElem=null,this.newElemLastChild=null,this.settings=null,this.parent=null},o.prototype.actionHandler=function(t){if(this.settings.allowedContext=["Text","List","Table"],!h(t)&&!h(t.item)&&!h(t.item.formatPainterAction)){switch(t.item.formatPainterAction){case"format-copy":this.copyAction();break;case"format-paste":this.pasteAction();break;case"escape":this.escapeAction();break}this.callBack(t)}},o.prototype.callBack=function(t){t.callBack&&t.callBack({requestType:"FormatPainter",action:t.item.formatPainterAction,event:t.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},o.prototype.generateElement=function(){var t=this.copyCollection.slice();t.reverse();for(var e=t.length,i=R("div",{className:"e-format-paste-wrapper"}),n,r=0;r<e;r++){var s=t[r],a=s.attrs,l=s.className,c=s.styles,p=s.tagName,d=R(p);l!==""&&(d.className=l);for(var u=0;u<a.length;u++){var f=a[u].name,m=a[u].value;d.setAttribute(f,m)}for(var v=0;v<c.length;v++){var f=c[v].property,m=c[v].value,y=c[v].priority;d.style.setProperty(f,m,y)}i.childElementCount===0?(i.append(d),n=d):(n.append(d),n=d)}for(var L=this.removeDeniedFormats(i),C=L;C;)C.firstChild===null?(n=C,C=void 0):C=C.firstChild;this.newElem=L,this.newElemLastChild=n},o.prototype.pasteAction=function(){if(h(this.copyCollection)||this.copyCollection.length===0){this.paintPlainTextFormat();return}this.insertFormatNode(this.newElem,this.newElemLastChild)},o.prototype.removeDeniedFormats=function(t){if(!h(this.deniedFormatsCollection)&&this.deniedFormatsCollection.length>0)for(var e=this.deniedFormatsCollection,i=e.length,n=0;n<i;n++){var r=e[n].tag;if(e[n].tag)for(var s=t.querySelectorAll(r),a=0;a<s.length;a++){if(e[n].classes.length>0){for(var l=e[n].classes,c=l.length,p=0;p<c;p++)s[a].classList.contains(l[p])&&O([s[a]],l[p].trim());s[a].classList.length===0&&s[a].removeAttribute("class")}if(e[n].styles.length>0){for(var d=e[n].styles,u=d.length,p=0;p<u;p++)s[a].style.removeProperty(d[p].trim());s[a].style.length===0&&s[a].removeAttribute("style")}if(e[n].attributes.length>0)for(var f=e[n].attributes,m=f.length,p=0;p<m;p++)s[a].removeAttribute(f[p].trim())}}return t.firstElementChild},o.prototype.copyAction=function(){var t=[],e=this.parent.nodeSelection.getRange(this.parent.currentDocument),i=this.parent.nodeSelection,n=e.collapsed?i.getSelectionNodeCollection(e):i.getSelectionNodeCollectionBr(e);if(!(n.length===0&&i.getSelectionNodeCollectionBr(e).length===0)){n=n.length===0?i.getSelectionNodeCollectionBr(e):n;for(var r=n[0].parentElement,s=this.findCurrentContext(r),a=this.settings.allowedFormats.indexOf(";")>-1?this.settings.allowedFormats.split(";"):[this.settings.allowedFormats],l=0;l<a.length;l++)a[l]=a[l].trim();var c=this.getRangeParentElem(s,r),p=c[0],d=c[1];if(s===null&&(s=d),!h(s)&&this.settings.allowedContext.indexOf(s)>-1){e.startContainer.nodeName==="#text"&&(r=e.startContainer.parentElement);var u=r;do{if(a.indexOf(r.nodeName.toLowerCase())>-1){for(var f=r.attributes,m=[],l=0;l<f.length;l++)f[l].name!=="class"&&f[l].name!=="style"&&m.push(f[l]);for(var v=r.className,y=r.style,L=[],l=0;l<y.length;l++){var C=y[l],w=y.getPropertyValue(C),k=y.getPropertyPriority(C);L.push({property:C,value:w,priority:k})}t.push({attrs:m,className:v,styles:L,tagName:r.nodeName})}if(p===r?r=void 0:h(r.parentElement)||(r=r.parentElement),u===r)break}while(!h(r)||r===this.parent.editableElement);this.copyCollection=t}this.generateElement()}},o.prototype.getRangeParentElem=function(t,e){var i=e,n;switch(i.nodeType===3&&(i=i.parentElement),t){case"Table":n=T(i,"td"),h(n)&&(n=T(i,"th"));break;case"List":n=T(i,"li");break;case"Text":n=T(i,"p");break}if(h(n)){var r=this.getNearestBlockParentElement(e);!h(r)&&r!=="UL"&&r!=="OL"&&r!=="LI"&&(n=T(i,r),t="Text")}return t==="List"&&(n=n.parentElement),[n,t]},o.prototype.getNearestBlockParentElement=function(t){var e=t;for(e.nodeType===3&&(e=e.parentNode);e&&e!==this.parent.editableElement;){if(!h(e)&&this.isBlockElement(e))return e.nodeName;e=e.parentNode}return null},o.prototype.isBlockElement=function(t){var e=["P","DIV","UL","OL","LI","H1","H2","H3","H4","H5","H6","ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","FIGCAPTION","FIGURE","FOOTER","HEADER","HR","MAIN","NAV","SECTION","SUMMARY","PRE"];return e.indexOf(t.nodeName)>-1},o.prototype.escapeAction=function(){this.copyCollection=[]},o.prototype.paintPlainTextFormat=function(){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument),e=this.parent.nodeSelection,i=t.collapsed?e.getSelectionNodeCollection(t):e.getSelectionNodeCollectionBr(t),n;if(i.length>1)for(var r=0;r<i.length;r++)n=this.validateELementTag(i[r]);else n=this.validateELementTag(t.startContainer)&&this.validateELementTag(t.endContainer);n||this.parent.execCommand("Clear","ClearFormat",null,null)},o.prototype.validateELementTag=function(t){return t.nodeType===3&&(t=t.parentElement),this.INVALID_TAGS.indexOf(t.tagName)>-1},o.prototype.findCurrentContext=function(t){var e=T(t,"p"),i=T(t,"li");return e&&!i?"Text":T(t,"li")?!h(e)&&!h(i)&&e.textContent.trim()!==i.textContent.trim()?"Text":"List":T(t,"td")||T(t,"tr")||T(t,"th")?"Table":null},o.prototype.insertFormatNode=function(t,e){var i=t.cloneNode(!0);if(!this.isBlockElement(t)){var n=R("P");n.appendChild(t),i=n.cloneNode(!0)}for(var r=this.parent.editableElement,s=this.parent.currentDocument,a=i.firstChild,l;a;)if(this.isBlockElement(a))a=a.firstChild;else{l=a.parentNode.removeChild(a);break}var c={element:l,lastChild:e};Hs.applyFormat(s,null,r,"P","formatPainter",null,c);var p=this.parent.nodeSelection.getRange(s),d=p.collapsed,u=this.parent.domNode.blockNodes(),f=!1;u.length===1&&(f=u[0].textContent.trim()===p.toString().trim()),(this.isBlockElement(i)&&d||u.length>1||f)&&this.insertBlockNode(i,p,s,u)},o.prototype.insertBlockNode=function(t,e,i,n){var r=this.parent.nodeSelection,s=r.save(e,i);this.parent.domNode.setMarker(s);var a,l,c=!1;(t.nodeName==="UL"||t.nodeName==="OL")&&(l=t.cloneNode(!0),a=l.firstChild);for(var p=h(l)?t:t.firstChild,d=0;d<n.length;d++)if(!(this.INVALID_TAGS.indexOf(n[d].nodeName)>-1||n[d].querySelectorAll("img,audio,video,iframe").length>0)){for(var u=p.cloneNode(!1);n[d].firstChild;)n[d].textContent.trim().length!==0?u.appendChild(n[d].firstChild):n[d].removeChild(n[d].firstChild);if(n[d].nodeName==="TD"||n[d].nodeName==="TH")if(h(l)){n[d].appendChild(u);continue}else if(d===0&&!h(l)){n[d].appendChild(l),l.appendChild(u);continue}else{n[d].appendChild(u);continue}if(h(l)||(c=this.isSameListType(t,n[d])),u.nodeName==="LI"&&!c?this.insertNewList(e,n,d,l,u):c?this.insertSameList(n,d,l,u):n[d].parentNode.replaceChild(u,n[d]),u.nodeName!=="LI"&&(u.parentElement.nodeName==="OL"||u.parentElement.nodeName==="UL")){var f=u.parentElement;if(this.parent.nodeCutter.SplitNode(e,f,!0),h(f.previousElementSibling))f.parentElement.prepend(u);else if(f.previousElementSibling.after(u),u.childNodes.length>1)for(var m=0;m<u.childNodes.length;m++){var v=u.childNodes[m];(v.nodeName==="OL"||v.nodeName==="UL")&&u.after(v)}}}h(a)||S(a),this.cleanEmptyLists();var y=this.parent.domNode.saveMarker(s,null);y.restore()},o.prototype.insertNewList=function(t,e,i,n,r){if(i===0){var s=e[i].nodeName;e[i]=e[i].parentNode.replaceChild(n,e[i]);var a=s==="LI"?n.parentElement:n;if(this.parent.nodeCutter.SplitNode(t,a,!0),e[i].nodeName==="LI"&&!h(a))n.append(r),h(a.parentNode)||a.parentNode.insertBefore(n,a);else if(h(a))n.append(r);else if(!h(a.previousElementSibling)&&a.previousElementSibling.nodeName===n.nodeName){var l=a.previousElementSibling;for(l.append(r);l.firstChild;)n.append(l.firstChild)}else if(!h(a.nextElementSibling)&&a.nextElementSibling.nodeName===n.nodeName){var l=a.nextElementSibling;for(l.prepend(r);l.firstChild;)n.append(l.firstChild)}else n.append(r)}else n.append(r);this.detachEmptyBlockNodes(e[i])},o.prototype.insertSameList=function(t,e,i,n){if(e===0){if(!h(t[e].parentNode)&&(t[e].parentNode.nodeName==="UL"||t[e].parentNode.nodeName==="OL")){if(t.length===1){for(;n.firstChild;)t[e].append(n.firstChild);for(var r=0;r<t[e].parentNode.childNodes.length;r++){var s=t[e].parentNode.childNodes[r];i.append(s.cloneNode(!0))}}else i.append(n);t[e].parentNode.parentNode.replaceChild(i,t[e].parentNode)}}else i.append(n);this.detachEmptyBlockNodes(t[e])},o.prototype.isSameListType=function(t,e){var i=!1,n=T(e,"ol, ul");return!h(n)&&n.querySelectorAll("li").length>0&&(n.nodeName===t.nodeName?i=!0:i=!1),i},o.prototype.cleanEmptyLists=function(){for(var t=this.parent.editableElement.querySelectorAll("ol, ul"),e=0;e<t.length;e++)t[e].textContent.trim()===""&&S(t[e])},o.prototype.setDeniedFormats=function(){var t=[];if(!(h(this.settings)||h(this.settings.deniedFormats))){for(var e=this.settings.deniedFormats.indexOf(";")>-1?this.settings.deniedFormats.split(";"):[this.settings.deniedFormats],i=e.length,n=0;n<i;n++){var r=e[n];if(r!==""){r.trim();var s=this.makeDeniedFormatsCollection(r);h(s)||t.push(s)}}this.deniedFormatsCollection=t}},o.prototype.detachEmptyBlockNodes=function(t){!h(t)&&t.textContent.trim()===""&&S(t)},o.prototype.makeDeniedFormatsCollection=function(t){var e=t.indexOf("("),i=t.indexOf(")"),n=t.indexOf("["),r=t.indexOf("]"),s=t.indexOf("{"),a=t.indexOf("}"),l=[],c="",p="",d="",u=[],f=[],m=[];e>-1&&i>-1&&(l=t.substring(e+1,i).split(" "),u=l[0].split(")")[0].split(",")),n>-1&&r>-1&&(c=t.substring(n+1,r),f=c.split(",")),s>-1&&a>-1&&(p=t.substring(s+1,a),m=p.split(","));var v=[e,n,s];v=v.filter(function(C){return C>-1});var y=v.length,L;return y===1?L=v[0]:y===2?L=Math.min(v[0],v[1]):y===3&&(L=Math.min(v[0],v[1],v[2])),d=t.substring(0,L),d=d.trim(),{tag:d,styles:m,classes:u,attributes:f}},o}(),Hp=function(){function o(t){this.currentDocument=t.document,this.editableElement=t.editableElement,this.nodeSelection=new Be,this.nodeCutter=new Jt,this.domNode=new Xn(this.editableElement,this.currentDocument),this.observer=new al(this),this.listObj=new cp(this),this.formatObj=new pp(this),this.alignmentObj=new up(this),this.indentsObj=new fp(this),this.linkObj=new dp(this),this.imgObj=new Sp(this),this.audioObj=new Ep(this),this.videoObj=new Lp(this),this.selectionObj=new xp(this),this.inserthtmlObj=new Dp(this),this.insertTextObj=new Mp(this),this.clearObj=new Op(this),this.tableObj=new wp(this),this.undoRedoManager=new Np(this,t.options),this.msWordPaste=new Rp(this),this.formatPainterEditor=new Ip(this,t.formatPainterSettings),this.emojiPickerObj=new Pp(this),this.wireEvents()}return o.prototype.wireEvents=function(){this.observer.on(xa,this.editorKeyDown,this),this.observer.on(Gn,this.editorKeyUp,this),this.observer.on(Gn,this.editorKeyUp,this),this.observer.on(As,this.onPropertyChanged,this),this.observer.on(rp,this.onWordPaste,this),this.observer.on(Na,this.onBegin,this),this.observer.on(sp,this.editorMouseDown,this)},o.prototype.onWordPaste=function(t){this.observer.notify(Oa,t)},o.prototype.onPropertyChanged=function(t){this.observer.notify(Kn,t)},o.prototype.editorKeyDown=function(t){this.observer.notify(Oe,t)},o.prototype.editorKeyUp=function(t){this.observer.notify(Pi,t)},o.prototype.onBegin=function(t){this.observer.notify(Ra,t)},o.prototype.execCommand=function(t,e,i,n,r,s,a,l){switch(t.toLowerCase()){case"lists":this.observer.notify(Ba,{subCommand:e,event:i,callBack:n,selector:a,item:s,enterAction:l});break;case"formats":this.observer.notify(Da,{subCommand:e,event:i,callBack:n,selector:a,exeValue:s,enterAction:l});break;case"alignments":this.observer.notify(Ka,{subCommand:e,event:i,callBack:n,selector:a,value:s});break;case"indents":this.observer.notify(Xa,{subCommand:e,event:i,callBack:n,selector:a});break;case"links":this.observer.notify(Ha,{command:t,value:e,item:s,event:i,callBack:n});break;case"files":this.observer.notify(Is,{command:t,value:"Image",item:s,event:i,callBack:n,selector:a});break;case"images":this.observer.notify(Is,{command:t,value:e,item:s,event:i,callBack:n,selector:a});break;case"audios":this.observer.notify(Aa,{command:t,value:e,item:s,event:i,callBack:n,selector:a});break;case"videos":this.observer.notify(Pa,{command:t,value:e,item:s,event:i,callBack:n,selector:a});break;case"table":switch(e.toString().toLocaleLowerCase()){case"createtable":this.observer.notify(Ia,{item:s,event:i,callBack:n,enterAction:l});break;case"insertrowbefore":case"insertrowafter":this.observer.notify(Fa,{item:s,event:i,callBack:n});break;case"insertcolumnleft":case"insertcolumnright":this.observer.notify(za,{item:s,event:i,callBack:n});break;case"deleterow":this.observer.notify(qa,{item:s,event:i,callBack:n});break;case"deletecolumn":this.observer.notify(Va,{item:s,event:i,callBack:n});break;case"tableremove":this.observer.notify(Ua,{item:s,event:i,callBack:n});break;case"tableheader":this.observer.notify(ja,{item:s,event:i,callBack:n});break;case"aligntop":case"alignmiddle":case"alignbottom":this.observer.notify(_a,{item:s,event:i,callBack:n});break;case"merge":this.observer.notify(Wa,{item:s,event:i,callBack:n});break;case"horizontalsplit":this.observer.notify(Ga,{item:s,event:i,callBack:n});break;case"verticalsplit":this.observer.notify(Qa,{item:s,event:i,callBack:n});break}break;case"font":case"style":case"effects":case"casing":this.observer.notify(Ya,{subCommand:e,event:i,callBack:n,value:r,selector:a,enterAction:l});break;case"inserthtml":this.observer.notify($a,{subCommand:e,callBack:n,value:r,enterAction:l});break;case"inserttext":this.observer.notify(Ja,{subCommand:e,callBack:n,value:r});break;case"clear":this.observer.notify(Za,{subCommand:e,event:i,callBack:n,selector:a,enterAction:l});break;case"actions":this.observer.notify(Ms,{subCommand:e,event:i,callBack:n,selector:a});break;case"formatpainter":this.observer.notify(Ps,{item:s,subCommand:e,event:i,callBack:n});break;case"emojipicker":this.observer.notify(Ma,{item:s,subCommand:e,value:r,event:i,callBack:n})}},o.prototype.editorMouseDown=function(t){t.args.detail===3&&this.tripleClickSelection(t.args)},o.prototype.tripleClickSelection=function(t){var e=this.nodeSelection.getRange(this.currentDocument),i=this.nodeSelection.get(this.currentDocument);if(i.rangeCount>0&&i.toString()!==""){var n=this.getParentBlockNode(e.startContainer),r=this.getParentBlockNode(e.endContainer);if(n&&r&&n===r){var s=this.currentDocument.createRange(),a=this.getFirstTextNode(n),l=this.getLastTextNode(r);a&&l&&(s.setStart(a,0),s.setEnd(l,l.textContent.length),this.nodeSelection.setRange(this.currentDocument,s),t.preventDefault())}}},o.prototype.getParentBlockNode=function(t){var e=this.currentDocument.createTreeWalker(this.editableElement,NodeFilter.SHOW_ELEMENT,{acceptNode:function(n){var r=window.getComputedStyle(n).display;return r.indexOf("inline")<0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});e.currentNode=t;var i=e.parentNode();return i},o.prototype.getLastTextNode=function(t){for(var e=this.currentDocument.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),i=null,n=e.nextNode();n;)i=n,n=e.nextNode();return i},o.prototype.getFirstTextNode=function(t){var e=this.currentDocument.createTreeWalker(t,NodeFilter.SHOW_TEXT,null),i=e.nextNode();return i},o}(),Fp=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),zp=function(o){Fp(t,o);function t(e){var i=o.call(this)||this;return i.initialize(),ot(i,i,e,!0),i.currentDocument&&i.element&&i.updateFormatter(i.element,i.currentDocument,e.options,e.formatPainterSettings),i}return t.prototype.initialize=function(){this.keyConfig=ap},t.prototype.updateFormatter=function(e,i,n,r){e&&i&&(this.editorManager=new Hp({document:i,editableElement:e,options:n,formatPainterSettings:r}))},t}(op),ea=function(){function o(t){this.parent=t,this.toolbarStatus=this.prevToolbarStatus=ka(),this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(_t,this.onRefreshHandler,this),this.parent.on(j,this.removeEventListener,this)},o.prototype.removeEventListener=function(){this.parent.off(_t,this.onRefreshHandler),this.parent.off(j,this.removeEventListener)},o.prototype.onRefreshHandler=function(t){if(!this.parent.readonly){var e=[],i=[],n=[];this.parent.fontSize.items.forEach(function(s){e.push(s.value)}),this.parent.fontFamily.items.forEach(function(s){i.push(s.value)}),this.parent.format.types.forEach(function(s){n.push(s.value.toLocaleLowerCase())}),this.toolbarStatus=Ap.get(this.parent.contentModule.getDocument(),this.parent.contentModule.getEditPanel(),n,e,i,t.documentNode);var r=JSON.stringify(this.toolbarStatus);this.parent.notify(ct,this.toolbarStatus),JSON.stringify(this.prevToolbarStatus)!==r&&(this.parent.notify(bs,{html:JSON.parse(r),markdown:null}),this.prevToolbarStatus=JSON.parse(r))}},o}(),el=function(){function o(t,e){this.parent=t,this.serviceLocator=e}return o.prototype.renderPanel=function(){var t=this.parent,e=this.parent.createElement("div",{className:"e-rte-content",id:this.parent.getID()+"rte-view"}),i=Wn(t.value,t);this.editableElement=this.parent.createElement("div",{className:"e-content",id:this.parent.getID()+"_rte-edit-view",attrs:{contenteditable:"true"},innerHTML:i}),e.appendChild(this.editableElement),this.setPanel(e),t.element.appendChild(e)},o.prototype.getPanel=function(){return this.contentPanel},o.prototype.getEditPanel=function(){return this.editableElement},o.prototype.getText=function(){var t=this.getEditPanel().innerText;return t===`
`?"":t},o.prototype.setPanel=function(t){this.contentPanel=t},o.prototype.getDocument=function(){return this.getEditPanel().ownerDocument},o}(),qp=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Vp=`
<!DOCTYPE html> 
    <html>
         <head>
            <meta charset='utf-8' /> 
            <style>
                @charset "UTF-8";
                body {
                    font-family: "Roboto", sans-serif;
                    font-size: 14px;
                }
                html, body{height: 100%;margin: 0;}
                body.e-cursor{cursor:default}
                span.e-selected-node	{background-color: #939393;color: white;}
                span.e-selected-node.e-highlight {background-color: #1d9dd8;}
                body{color:#333;word-wrap:break-word;padding: 8px;box-sizing: border-box;}
                .e-rte-image, .e-rte-audio, .e-rte-video  {border: 0;cursor: pointer;display:
                    block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}
                .e-rte-image.e-imginline, .e-rte-audio.e-audio-inline, .e-rte-video.e-video-inline {display: inline-block;float: none;max-width: calc(100% - (2 * 5px));padding: 1px;vertical-align: bottom;}
                .e-rte-image.e-imgcenter, .e-rte-video.e-video-center {cursor: pointer;display: block;float: none;margin: 5px auto;max-width: 100%;position: relative;}
                .e-rte-image.e-imgright, .e-rte-video.e-video-right { float: right; margin: 0 auto;margin-left: 5px;text-align: right;}
                .e-rte-image.e-imgleft, .e-rte-video.e-video-left {float: left;margin: 0 auto;margin-right: 5px;text-align: left;}
                .e-img-caption { display: inline-block; float: none; margin: 5px auto; max-width: 100%;position: relative;}
                .e-img-caption.e-caption-inline {display: inline-block;float: none;
                    margin: 5px auto;margin-left: 5px;margin-right: 5px;max-width: calc(100% - (2 * 5px));
                    position: relativetext-align: center;vertical-align: bottom;}
                .e-img-inner {box-sizing: border-box;display: block;font-size: 16px;font-weight: initial;
                    margin: auto;opacity: .9;text-align: center;width: 100%;}
                .e-img-wrap {display: inline-block;margin: auto;padding: 0;text-align: center;width: 100%;}
                .e-imgleft, .e-video-left {float: left;margin: 0 5px 0 0;text-align: left;}
                .e-imgright, .e-video-right {float: right;margin: 0 0 0 5px;text-align: right;}
                .e-imgcenter, .e-video-center {cursor: pointer;display: block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}
                .e-control img:not(.e-resize) {border: 2px solid transparent; z-index: 1000}
                .e-imginline , .e-audio-inline, .e-video-inline {display: inline-block;float: none;margin-left: 5px;margin-right: 5px;
                    max-width: calc(100% - (2 * 5px));vertical-align: bottom;}
                .e-imgbreak, .e-audio-break, .e-video-break {border: 0;cursor: pointer;
                    display: block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}
                .e-rte-image.e-img-focus:not(.e-resize), .e-audio-focus:not(.e-resize), .e-video-focus:not(.e-resize) {border: solid 2px #4a90e2;}
                img.e-img-focus::selection, audio.e-audio-focus::selection, .e-video-focus::selection { background: transparent;color: transparent;}
                span.e-rte-imageboxmark {  width: 10px; height: 10px; position: absolute; display: block;
                    background: #4a90e2; border: 1px solid #fff; z-index: 1000;}
                .e-mob-rte.e-mob-span span.e-rte-imageboxmark { background: #4a90e2; border: 1px solid #fff; }
                .e-mob-rte span.e-rte-imageboxmark { background: #fff; border: 1px solid #4a90e2;
                    border-radius: 15px; height: 20px; width: 20px; }
                .e-mob-rte.e-mob-span span.e-rte-imageboxmark { background: #4a90e2; border: 1px solid #fff; }
                .e-rte-content .e-content img.e-resize, .e-rte-content .e-content video.e-resize { z-index: 1000; }
                .e-img-caption .e-img-inner { outline: 0; }
                .e-img-caption a:focus-visible { outline: none; }
                .e-img-caption .e-rte-image.e-imgright, .e-img-caption .e-rte-image.e-imgleft { float: none; margin: 0;}
                body{box-sizing: border-box;min-height: 100px;outline: 0 solid transparent;
                    overflow-x: auto;padding: 16px;position: relative;text-align: inherit;z-index: 2;}
                p{margin: 0 0 10px;margin-bottom: 10px;}
                li{margin-bottom: 10px;}
                h1{font-size: 2.17em;font-weight: 400;line-height: 1;margin: 10px 0;}
                h2{font-size: 1.74em;font-weight: 400;margin: 10px 0;}
                h3{font-size: 1.31em;font-weight: 400;margin: 10px 0;}
                h4{font-size: 16px;font-weight: 400;line-height: 1.5;margin: 0;}
                h5{font-size: 00.8em;font-weight: 400;margin: 0;}
                h6{font-size: 00.65em;font-weight: 400;margin: 0;}
                blockquote{margin: 10px 0;margin-left: 0;padding-left: 5px;border-left: solid 2px #5c5c5c;}
                pre{background-color: inherit;border: 0;border-radius: 0;color: #333;
                    font-size: inherit;line-height: inherit;margin: 0 0 10px;overflow: visible;padding: 0;
                    white-space: pre-wrap;word-break: inherit;word-wrap: break-word;}
                strong, b{font-weight: 700;}
                a{text-decoration: none;user-select: auto;}
                a:hover{text-decoration: underline;};
                p:last-child, pre:last-child, blockquote:last-child{margin-bottom: 0;}
                h3+h4, h4+h5, h5+h6{margin-top: 00.6em;}
                ul:last-child{margin-bottom: 0;}
                table { border-collapse: collapse; empty-cells: show;}
                table td,table th {border: 1px solid #BDBDBD; height: 20px; padding: 2px 5px; vertical-align: middle;}
                table.e-alternate-border tbody tr:nth-child(2n) {background-color: #F5F5F5;}
                table th {background-color: #E0E0E0;}
                table.e-dashed-border td,table.e-dashed-border th { border: 1px dashed #BDBDBD} 
                table .e-cell-select {border: 1px double #4a90e2;}
                span.e-table-box { cursor: nwse-resize; display: block; height: 10px; position: absolute; width: 10px; }
                span.e-table-box.e-rmob {height: 14px;width: 14px;}
                .e-row-resize, .e-column-resize { background-color: transparent; background-repeat: repeat;
                    bottom: 0;cursor: col-resize;height: 1px;overflow: visible;position: absolute;width: 1px; }
                .e-row-resize { cursor: row-resize; height: 1px;}
                .e-table-rhelper { cursor: col-resize; opacity: .87;position: absolute;}
                .e-table-rhelper.e-column-helper { width: 1px; }
                .e-table-rhelper.e-row-helper {height: 1px;}
                .e-reicon::before { border-bottom: 6px solid transparent; border-right: 6px solid;
                    border-top: 6px solid transparent; content: ''; display: block; height: 0;
                    position: absolute; right: 4px; top: 4px; width: 20px; }
                .e-reicon::after { border-bottom: 6px solid transparent; border-left: 6px solid;
                    border-top: 6px solid transparent; content: ''; display: block;
                    height: 0; left: 4px; position: absolute; top: 4px; width: 20px; z-index: 3; }
                .e-row-helper.e-reicon::after { top: 10px; transform: rotate(90deg); }
                .e-row-helper.e-reicon::before { left: 4px; top: -20px; transform: rotate(90deg); }
                span.e-table-box { background-color: #ffffff; border: 1px solid #BDBDBD; }
                span.e-table-box.e-rbox-select { background-color: #BDBDBD; border: 1px solid #BDBDBD; }
                .e-table-rhelper { background-color: #4a90e2;}
                .e-rtl { direction: rtl; }
                .e-rte-placeholder::before { content: attr(placeholder); opacity: 0.54; overflow: hidden; padding-top: 16px; position: absolute; text-align: start; top: 0; z-index: 1; }
            </style>
        </head>`,Up=function(o){qp(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return t.prototype.renderPanel=function(){var e=this.parent,i=Wn(e.value,e),n='<body spellcheck="false" autocorrect="off" contenteditable="true">'+i+"</body></html>",r=Vp+n,s=this.parent.createElement("iframe",{id:this.parent.getID()+"_rte-view",className:"e-rte-content",styles:"display:block;",attrs:{srcdoc:r}});this.setPanel(s),e.element.appendChild(s),s.contentDocument.body.id=this.parent.getID()+"_rte-edit-view",s.contentDocument.body.setAttribute("aria-owns",this.parent.getID()),s.contentDocument.open(),r=this.setThemeColor(r,{color:"#333"}),s.contentDocument.write(r),s.contentDocument.close(),e.enableRtl&&this.contentPanel.contentDocument.body.setAttribute("class","e-rtl")},t.prototype.setThemeColor=function(e,i){var n=getComputedStyle(this.parent.element,".e-richtexteditor").getPropertyValue("color");return e.replace(i.color,n)},t.prototype.getEditPanel=function(){var e;return h(this.contentPanel.contentDocument)?e=this.parent.inputElement:e=this.contentPanel.contentDocument.body,e},t.prototype.getDocument=function(){return this.getEditPanel().ownerDocument},t}(el),jp=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(Ri,this.enableXhtmlValidation,this),this.parent.on(j,this.removeEventListener,this)},o.prototype.removeEventListener=function(){this.parent.off(Ri,this.enableXhtmlValidation),this.parent.off(j,this.removeEventListener)},o.prototype.enableXhtmlValidation=function(){this.parent.enableXhtml&&(h(this.parent.inputElement)?this.currentElement=this.parent.element:this.currentElement=this.parent.inputElement,this.clean(this.currentElement),this.ImageTags(),this.removeTags(),this.RemoveUnsupported(),this.currentElement.innerHTML=this.selfEncloseValidation(this.currentElement.innerHTML,this.currentElement.innerText===`
`?this.currentElement.innerText.length:this.currentElement.innerText.trim().length),this.parent.setProperties({value:this.currentElement.innerHTML},!0))},o.prototype.selfEncloseValidation=function(t,e){if(e===0&&t.indexOf("table")<0&&t.indexOf("img")<0&&t.includes("&nbsp;")){var i=t.split("&nbsp;");i[i.length-1]="&#8203;"+i[i.length-1],t=i.join("")}t=t.replace(/<br>/g,"<br/>").replace(/<hr>/g,"<hr/>").replace(/ /g," ");for(var n,r=[],s=[],a=[/<img(.*?)>/gi,/<area(.*?)>/gi,/<base(.*?)>/gi,/<col (.*?)>/gi,/<embed(.*?)>/gi,/<input(.*?)>/gi,/<link(.*?)>/gi,/<meta(.*?)>/gi,/<param(.*?)>/gi,/<source(.*?)>/gi,/<track(.*?)>/gi,/<wbr(.*?)>/gi],l=0;l<a.length;l++){for(n=a[l].exec(t);n!==null;)r.push(n[0].toString()),n=a[l].exec(t);s=r.slice(0);for(var c=0;c<r.length;c++)(r[c].indexOf("/")===-1||r[c].lastIndexOf("/")!==r[c].length-2)&&(r[c]=r[c].substr(0,r[c].length-1)+" /"+r[c].substr(r[c].length-1,r[c].length));for(var p=0;p<=r.length-1;p++)t=t.replace(s[p],r[p])}return t},o.prototype.clean=function(t){for(var e=0;e<t.childNodes.length;e++){var i=t.childNodes[e];i.nodeType===8||i.nodeName==="V:IMAGE"?(t.removeChild(i),e--):i.nodeType===1&&this.clean(i)}return this.currentElement.innerHTML},o.prototype.ImageTags=function(){for(var t=this.currentElement.querySelectorAll("IMG"),e=t.length-1;e>=0;e--)if(!t[e].hasAttribute("alt")){var i=t[e];i.setAttribute("alt","")}},o.prototype.removeTags=function(){for(var t=[["br","ul"],["br","ol"],["table","span"],["div","span"],["p","span"]],e=0;e<t.length;e++)this.RemoveElementNode(t[e][0],t[e][1])},o.prototype.RemoveElementNode=function(t,e){for(var i=this.currentElement.querySelectorAll(e),n=0;n<i.length;n++)for(var r=i[n].querySelectorAll(t),s=r.length;s>0;s--)S(r[s-1])},o.prototype.RemoveUnsupported=function(){for(var t=this.currentElement.querySelectorAll("u"),e=t.length-1;e>=0;e--){var i=this.parent.createElement("span");i.style.textDecoration="underline",i.innerHTML=t[e].innerHTML,t[e].parentNode.insertBefore(i,t[e]),S(t[e])}for(var n=this.currentElement.querySelectorAll("strong"),e=n.length-1;e>=0;e--){var r=this.parent.createElement("b");r.innerHTML=n[e].innerHTML,n[e].parentNode.insertBefore(r,n[e]),S(n[e])}for(var s=["language","role","target","contenteditable","cellspacing","cellpadding","border","valign","colspan"],e=0;e<=s.length;e++)this.RemoveAttributeByName(s[e])},o.prototype.RemoveAttributeByName=function(t){if(this.currentElement.firstChild!==null&&this.currentElement.firstChild.nodeType!==3)for(var e=0;e<this.currentElement.childNodes.length;e++){var i=this.currentElement.childNodes[e];if(i.nodeType!==3&&i.nodeName!=="TABLE"&&i.nodeName!=="TBODY"&&i.nodeName!=="THEAD"&&i.nodeName!=="TH"&&i.nodeName!=="TR"&&i.nodeName!=="TD"&&(i.hasAttribute(t)&&i.removeAttribute(t),i.hasChildNodes()))for(var n=0;n<i.childNodes.length;n++){var r=i.childNodes[n];if(r.nodeType!==3&&r.nodeName!=="TABLE"&&r.nodeName!=="TBODY"&&r.nodeName!=="THEAD"&&r.nodeName!=="TH"&&r.nodeName!=="TR"&&r.nodeName!=="TD"&&r.hasAttribute(t)&&!r.classList.contains("e-mention-chip")&&r.removeAttribute(t),r.hasChildNodes())for(var s=0;s<r.childNodes.length;s++)r.childNodes[s].nodeType!==3&&r.childNodes[s].nodeName!=="TABLE"&&r.childNodes[s].nodeName!=="TBODY"&&r.childNodes[s].nodeName!=="THEAD"&&r.childNodes[s].nodeName!=="TH"&&r.childNodes[s].nodeName!=="TR"&&r.childNodes[s].nodeName!=="TD"&&r.childNodes[s].hasAttribute(t)&&r.childNodes[s].removeAttribute(t)}}},o}(),_p=function(){function o(t,e){this.rangeCollection=[],this.isImageDelete=!1,this.parent=t,this.locator=e,this.renderFactory=this.locator.getService("rendererFactory"),this.xhtmlValidation=new jp(t),this.addEventListener()}return o.prototype.destroy=function(){this.removeEventListener()},o.prototype.sanitizeHelper=function(t){return t=mc(t,this.parent),t},o.prototype.addEventListener=function(){this.parent.isDestroyed||(this.nodeSelectionObj=new Be,this.colorPickerModule=new wa(this.parent,this.locator),this.parent.on(Yr,this.instantiateRenderer,this),this.parent.on(Jr,this.onToolbarClick,this),this.parent.on(Ne,this.onKeyDown,this),this.parent.on(at,this.onKeyUp,this),this.parent.on(Hn,this.renderColorPicker,this),this.parent.on(Me,this.render,this),this.parent.on(be,this.onPropertyChanged,this),this.parent.on(j,this.destroy,this),this.parent.on(cs,this.selectAll,this),this.parent.on(zn,this.selectRange,this),this.parent.on(ps,this.getSelectedHtml,this),this.parent.on(nt,this.onSelectionSave,this),this.parent.on(rt,this.onSelectionRestore,this),this.parent.on(fs,this.updateReadOnly,this),this.parent.on(Oi,this.onPaste,this),this.parent.on(Ei,this.isTableClassAdded,this),this.parent.on(ca,this.onHandleFontsizeChange,this))},o.prototype.updateReadOnly=function(){this.parent.readonly?(ce(this.parent.contentModule.getEditPanel(),{contenteditable:"false"}),x([this.parent.element],xs)):(ce(this.parent.contentModule.getEditPanel(),{contenteditable:"true"}),O([this.parent.element],xs))},o.prototype.onSelectionSave=function(){var t=this.contentRenderer.getDocument(),e=this.nodeSelectionObj.getRange(t);this.saveSelection=this.nodeSelectionObj.save(e,t)},o.prototype.onSelectionRestore=function(t){this.parent.isBlur=!1,(h(this.saveSelection)||h(T(this.saveSelection.range.startContainer.parentElement,".e-img-caption"))||T(this.saveSelection.range.startContainer.parentElement,".e-img-caption").getAttribute("contenteditable")!="false")&&this.contentRenderer.getEditPanel().focus(),(h(t.items)||t.items)&&this.saveSelection.restore()},o.prototype.isTableClassAdded=function(){for(var t=this.parent.inputElement.querySelectorAll("table"),e=0;e<t.length;e++)!t[e].classList.contains("e-rte-table")&&!t[e].classList.contains("e-rte-paste-table")&&t[e].classList.add("e-rte-table")},o.prototype.onHandleFontsizeChange=function(t){var e=t.args,i={name:"dropDownSelect"};i.item={command:"Font",subCommand:"FontSize"};var n=this.parent.fontSize.items,r;if(this.parent.toolbarModule&&this.parent.toolbarModule.dropDownModule&&this.parent.toolbarModule.dropDownModule.fontSizeDropDown&&!h(this.parent.toolbarModule.dropDownModule.fontSizeDropDown.activeElem[0].textContent)&&this.parent.toolbarModule.dropDownModule.fontSizeDropDown.activeElem[0].textContent!=="")r=this.parent.toolbarModule.dropDownModule.fontSizeDropDown.activeElem[0].textContent;else{var s=void 0,a=this.parent.contentModule.getDocument().getSelection();a&&a.focusNode&&a.focusNode.parentElement?s=document.defaultView.getComputedStyle(a.focusNode.parentElement,null).getPropertyValue("font-size"):s=this.parent.fontSize.width,s=h(s)?this.parent.fontSize.width:s;var l=s.match(/^([\d.]+)(\D+)$/),c=parseInt(l[1],10),p=l[2],d=n[0].value.match(/^([\d.]+)(\D+)$/);if(d[2]===p){var u=n.findIndex(function(C){var w=C.value;return parseInt(w,10)>=c});r=n[u].text}else{var f=this.convertFontSize(c,p,d[2]),u=n.findIndex(function(w){var k=w.value;return parseInt(k,10)>=f});r=n[u].text}}var m=n.findIndex(function(C){return C.text===r});if(e.action==="increase-fontsize"&&m!==-1)if(m>=n.length-1){var v=n[m].value.match(/^([\d.]+)(\D+)$/);if(v){var y=parseInt(v[1],10),p=v[2],L=y%10===0?Math.ceil((y+1)/10)*10:Math.ceil(y/10)*10;i.item.value=L.toLocaleString()+p,i.item.text=L.toLocaleString()+" "+p}this.parent.fontSize.items.push(i.item)}else i.item.value=n[m+1].value,i.item.text=n[m+1].text;else e.action==="decrease-fontsize"&&m!==-1&&m>0?(i.item.value=n[m-1].value,i.item.text=n[m-1].text):m>=0&&m<n.length&&n[m]&&(i.item.value=n[m].value,i.item.text=n[m].text);this.parent.formatter.process(this.parent,i,e)},o.prototype.convertFontSize=function(t,e,i){(io.indexOf(e)!==-1||io.indexOf(i)!==-1)&&(e="px");var n=t*dh[e][i];return n},o.prototype.onKeyUp=function(t){var e=t.args,i=[8,9,13,16,17,18,20,27,37,38,39,40,44,45,46,91,112,113,114,115,116,117,118,119,120,121,122,123],n=this.parent.getRange(),r=new RegExp(String.fromCharCode(8203),"g"),s,a=!1;if(i.indexOf(e.keyCode)<0&&!e.shiftKey&&!e.ctrlKey&&!e.altKey){if(s=n.startOffset,n.startContainer.nodeName==="#text"?n.startContainer.parentElement!==this.parent.inputElement?n.startContainer.parentElement.classList.add("currentStartMark"):a=!0:n.startContainer.classList.add("currentStartMark"),n.startContainer.textContent.charCodeAt(0)===8203){var l=n.startContainer.textContent.length,c=n.startOffset;n.startContainer.textContent=n.startContainer.textContent.replace(r,""),s=c===0?c:c-(l-n.startContainer.textContent.length),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),n.startContainer,s)}var p=this.parent.inputElement.innerHTML.length,d=this.parent.inputElement.innerHTML.replace(r,"").length,u=n.startContainer;if(p>d&&!a){if(u.textContent.trim().length!==0&&u.previousSibling){var f=document.createElement("span");f.className="tempSpan",n.insertNode(f)}for(var m=this.parent.inputElement.firstChild;!h(m)&&m.textContent.replace(r,"").trim().length>0;)m.innerHTML=m.innerHTML.replace(r,""),m=m.nextElementSibling;var v=this.parent.inputElement.querySelector(".tempSpan");if(v&&v.previousSibling&&u.textContent.trim().length!==0){u=v.previousSibling,s=v.previousSibling.textContent.length;var y=v.parentNode;y.removeChild(v),v=null}var L=this.parent.inputElement.querySelector(".currentStartMark").childNodes;if(L.length>1)for(var C=0;C<L.length;C++)L[C].nodeName==="#text"&&L[C].textContent.length===0&&(S(L[C]),C--),!h(L[C])&&u.textContent.replace(r,"")===L[C].textContent&&(s=u.textContent.length>1?u.textContent===L[C].textContent?s:s-(u.textContent.length-u.textContent.replace(r,"").length):u.textContent.length,u=L[C]);else L.length===1&&u.textContent.replace(r,"")===L[0].textContent&&(u=L[0]);this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),u,s)}var w=this.parent.inputElement.querySelector(".currentStartMark");h(w)||(w.classList.remove("currentStartMark"),w.getAttribute("class").trim()===""&&w.removeAttribute("class")),!h(n.startContainer.previousSibling)&&!h(n.startContainer.previousSibling.parentElement)&&n.startContainer.parentElement===n.startContainer.previousSibling.parentElement&&n.startContainer.previousSibling.textContent.charCodeAt(0)===8203&&n.startContainer.previousSibling.textContent.length<=1&&(n.startContainer.previousSibling.textContent=n.startContainer.previousSibling.textContent.replace(r,"")),n.endContainer.textContent.charCodeAt(n.endOffset)===8203&&(s=n.startOffset,n.endContainer.textContent=n.endContainer.textContent.replace(r,""),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),n.startContainer,s))}},o.prototype.onKeyDown=function(t){var e=this,i,n=t.args;if(D.info.name==="chrome"&&(i=this.parent.getRange(),this.backSpaceCleanup(t,i),this.deleteCleanup(t,i)),n.keyCode===9&&this.parent.enableTabKey&&!h(n.target)&&h(T(n.target,".e-rte-toolbar"))){var r=this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()),s=this.nodeSelectionObj.getParentNodeCollection(r);if(!((s[0].nodeName==="LI"||T(s[0],"li")||T(s[0],"table"))&&r.startOffset===0)){if(n.preventDefault(),!n.shiftKey)Re.Insert(this.contentRenderer.getDocument(),"&nbsp;&nbsp;&nbsp;&nbsp;"),this.rangeCollection.push(this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()));else if(this.rangeCollection.length>0&&this.rangeCollection[this.rangeCollection.length-1].startContainer.textContent.length===4){var a=this.rangeCollection[this.rangeCollection.length-1].startContainer;this.nodeSelectionObj.setSelectionText(this.contentRenderer.getDocument(),a,a,0,a.textContent.length),Re.Insert(this.contentRenderer.getDocument(),document.createTextNode("")),this.rangeCollection.pop()}}}if((t.args.action==="space"||t.args.action==="enter"||t.args.keyCode===13)&&(this.spaceLink(t.args),this.parent.editorMode==="HTML"&&!this.parent.readonly)){var l=this.parent.getText().trim().replace(/(\r\n|\n|\r|\t)/gm,"").replace(/\u200B/g,"").length,c=this.parent.getSelection().length,p=l-c+1;if(!(this.parent.maxLength===-1||p<=this.parent.maxLength)&&t.args.keyCode===13){t.args.preventDefault();return}else{this.parent.notify(ms,{args:t.args});var d=this.parent.getRange();!h(d.startContainer)&&d.startContainer===this.parent.inputElement.lastChild&&d.startContainer.nodeName!=="#text"&&this.parent.height!=="auto"&&d.startContainer.scrollIntoView({block:"end",inline:"nearest"})}}if(t.args.action==="space"){var u=this.parent.getRange(),f=u.startContainer.textContent.slice(0,u.startOffset),m=this.isOrderedList(f),v=this.isUnOrderedList(f);if(m&&!v||v&&!m){var y={callBack:null,event:t.args,name:"keydown-handler"},L={cancel:!1,item:{command:"Lists",subCommand:m?"OL":"UL"},name:"actionBegin",originalEvent:t.args,requestType:m?"OL":"UL"};this.parent.trigger(Ae,L,function(C){C.cancel||(e.parent.formatter.editorManager.observer.notify(Na,y),e.parent.trigger(Ge,{editorMode:e.parent.editorMode,elements:e.parent.formatter.editorManager.domNode.blockNodes(),event:t.args,name:Ge,range:e.parent.getRange(),requestType:m?"OL":"UL"}))})}}D.info.name==="chrome"&&(!h(this.rangeElement)&&!h(this.oldRangeElement)||!h(this.deleteRangeElement)&&!h(this.deleteOldRangeElement))&&i.startContainer.parentElement.tagName!=="TD"&&i.startContainer.parentElement.tagName!=="TH"&&(this.rangeElement=null,this.oldRangeElement=null,this.deleteRangeElement=null,this.deleteOldRangeElement=null,this.isImageDelete||n.preventDefault(),n.preventDefault())},o.prototype.isOrderedList=function(t){t=t.replace(/\u200B/g,"");var e=[/^[1]+[.]+$/,/^[i]+[.]+$/,/^[a]+[.]+$/];if(!h(t)){for(var i=0;i<e.length;i++)if(e[i].test(t))return!0}return!1},o.prototype.isUnOrderedList=function(t){t=t.replace(/\u200B/g,"");var e=[/^[*]$/,/^[-]$/];if(!h(t)){for(var i=0;i<e.length;i++)if(e[i].test(t))return!0}return!1},o.prototype.backSpaceCleanup=function(t,e){var i=!1,n=!0;if(!h(e.startContainer.previousSibling)&&e.startContainer.previousSibling.nodeName==="SPAN"&&(n=e.startContainer.previousSibling.contentEditable!=="false"),t.args.code==="Backspace"&&t.args.keyCode===8&&e.startOffset===0&&e.endOffset===0&&this.parent.getSelection().length===0&&e.startContainer.textContent.length>0&&e.startContainer.parentElement.tagName!=="TD"&&e.startContainer.parentElement.tagName!=="TH"&&n){var r=e.startContainer.nodeName==="#text"?e.startContainer.parentElement:e.startContainer;if(!this.parent.formatter.editorManager.domNode.isBlockNode(r)&&!h(r.previousSibling)&&r.previousSibling.nodeName==="BR"||!h(e.startContainer.previousSibling)&&e.startContainer.previousSibling.nodeName==="BR")return;if(this.rangeElement=this.getRootBlockNode(e.startContainer),this.rangeElement.tagName==="OL"||this.rangeElement.tagName==="UL"){var s=this.getRangeLiNode(e.startContainer);s.previousElementSibling&&s.previousElementSibling.childElementCount>0&&(this.oldRangeElement=s.previousElementSibling.lastElementChild.nodeName==="BR"?s.previousElementSibling:s.previousElementSibling.lastElementChild,!h(s.lastElementChild)&&s.lastElementChild.nodeName!=="BR"?(this.rangeElement=s.lastElementChild,i=!0):this.rangeElement=s)}else{if(this.rangeElement===this.parent.inputElement||this.rangeElement.tagName==="TABLE"||!h(this.rangeElement.previousElementSibling)&&this.rangeElement.previousElementSibling.tagName==="TABLE")return;this.oldRangeElement=this.rangeElement.previousElementSibling}if(h(this.oldRangeElement))return;(this.oldRangeElement.tagName==="OL"||this.oldRangeElement.tagName==="UL")&&(this.oldRangeElement=this.oldRangeElement.lastElementChild.lastElementChild?this.oldRangeElement.lastElementChild.lastElementChild:this.oldRangeElement.lastElementChild);for(var a=this.oldRangeElement.lastChild;a.nodeType!==3&&a.nodeName!=="#text"&&a.nodeName!=="BR";)a=a.lastChild;if(this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),a,a.textContent.length),this.oldRangeElement.querySelectorAll("BR").length===1&&S(this.oldRangeElement.querySelector("BR")),!h(this.rangeElement)&&this.oldRangeElement!==this.rangeElement){for(;this.rangeElement.firstChild;)this.oldRangeElement.appendChild(this.rangeElement.childNodes[0]);i?S(this.rangeElement.parentElement):S(this.rangeElement),this.oldRangeElement.normalize()}}},o.prototype.deleteCleanup=function(t,e){var i=!1,n,r;if(t.args.code==="Delete"&&t.args.keyCode===46&&this.parent.contentModule.getText().trim().replace(/(\r\n|\n|\r|\t)/gm,"").replace(/\u200B/g,"").length!==0&&this.parent.getSelection().length===0&&e.startContainer.parentElement.tagName!=="TD"&&e.startContainer.parentElement.tagName!=="TH"){if(this.deleteRangeElement=r=this.getRootBlockNode(e.startContainer),this.deleteRangeElement.tagName==="OL"||this.deleteRangeElement.tagName==="UL")n=this.getRangeLiNode(e.startContainer),n.nextElementSibling&&n.nextElementSibling.childElementCount>0&&!n.nextElementSibling.querySelector("BR")?h(n.lastElementChild)?this.deleteRangeElement=n:(this.deleteRangeElement=n.lastElementChild,i=!0):this.deleteRangeElement=this.getRangeElement(n);else if(this.deleteRangeElement.nodeType===3||this.deleteRangeElement.tagName==="TABLE"||!h(this.deleteRangeElement.nextElementSibling)&&this.deleteRangeElement.nextElementSibling.tagName==="TABLE")return;if(this.getCaretIndex(e,this.deleteRangeElement)===this.deleteRangeElement.textContent.length){if(h(n)?this.deleteOldRangeElement=this.deleteRangeElement.nextElementSibling:i||!h(n.nextElementSibling)?this.deleteOldRangeElement=this.getRangeElement(n.nextElementSibling):this.deleteOldRangeElement=r.nextElementSibling,h(this.deleteOldRangeElement))return;e.startOffset===0&&e.endOffset===1&&this.deleteRangeElement.childNodes[0].nodeName==="IMG"?(this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.parent.contentModule.getDocument(),this.deleteRangeElement,this.deleteRangeElement,0,1),this.isImageDelete=!0):(this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),this.deleteRangeElement,this.deleteRangeElement.childNodes.length),this.isImageDelete=!1);var s=this.deleteRangeElement.querySelector("BR");if(s&&s.classList.contains("e-rte-image-remove-focus")){O([s],["e-rte-image-focus"]);return}else s&&S(s);if(!h(this.deleteRangeElement)&&this.deleteOldRangeElement.tagName!=="OL"&&this.deleteOldRangeElement.tagName!=="UL"&&this.deleteOldRangeElement!==this.deleteRangeElement){for(;this.deleteOldRangeElement.firstChild;)this.deleteRangeElement.appendChild(this.deleteOldRangeElement.childNodes[0]);i?S(this.deleteOldRangeElement.parentElement):S(this.deleteOldRangeElement),this.deleteRangeElement.normalize()}else this.deleteRangeElement=null,this.deleteOldRangeElement=null}else this.deleteRangeElement=null}},o.prototype.getCaretIndex=function(t,e){var i=0;if(this.parent.contentModule.getDocument().getSelection().rangeCount!==0){var n=t.cloneRange();n.selectNodeContents(e),n.setEnd(t.endContainer,t.endOffset),i=n.toString().length}return i},o.prototype.getRangeElement=function(t){var e=t.lastElementChild?t.lastElementChild.tagName==="BR"?t.lastElementChild.previousElementSibling?t.lastElementChild.previousElementSibling:t:t.lastElementChild:t;return e},o.prototype.getRootBlockNode=function(t){for(;t&&this.parent&&this.parent.inputElement!==t&&t.parentElement!==this.parent.inputElement;t=t)t=t.parentElement;return t},o.prototype.getRangeLiNode=function(t){for(var e=t.parentElement;e!==this.parent.inputElement&&!(e.nodeType===1&&e.tagName==="LI");)e=e.parentElement;return e},o.prototype.onPaste=function(t){var e=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi);if(t.text.match(e)){if(t.isWordPaste)return;t.args.preventDefault();var i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());this.parent.formatter.editorManager.nodeSelection.save(i,this.parent.contentModule.getDocument());for(var n=new RegExp(/([^\S]|^)(((https?\:\/\/)))/gi),r=new RegExp(/([^\S]|^)(((www\.))(\S+))/gi),s=t.text.split(`
`),a="",l=0;l<s.length;l++)if(s[l].trim()==="")a+=ba(this.parent);else{for(var c="",p=!0,d=s[l].split(" "),u=0;u<d.length;u++)d[u].trim()===""?c+=p?"&nbsp;":" ":(p=!1,c+=d[u]+" ");l===0?a+="<span>"+c.trim()+"</span>":a+="<p>"+c.trim()+"</p>"}var f=this.parent.createElement("div");f.setAttribute("class","pasteContent"),f.style.display="inline",f.innerHTML=a.replace("&para","&amp;para");for(var m=f.querySelectorAll("span, p"),l=0;l<m.length;l++){for(var v=m[l].innerHTML.split(" "),y="",u=0;u<v.length;u++)v[u].match(n)||v[u].match(r)?y+='<a class="e-rte-anchor" href="'+v[u]+'" title="'+v[u]+'" target="_blank" aria-label="'+this.parent.serviceLocator.getService("rteLocale").getConstant("linkAriaLabel")+'">'+v[u]+" </a>":y+=v[u]+" ";m[l].innerHTML=y.trim()}h(this.parent.pasteCleanupModule)?this.parent.formatter.editorManager.execCommand("insertHTML",null,null,null,f):t.callBack(f.innerHTML)}},o.prototype.spaceLink=function(t){var e=this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()),i=this.nodeSelectionObj.getParentNodeCollection(e),n=e.startContainer.textContent.substr(0,e.endOffset),r=n.split(" "),s=r[r.length-1],a=e.startOffset-(n.length-r[r.length-1].length);s=s.slice(0,a);var l=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi);if(i[0].nodeName!=="A"&&s.match(l)){var c=this.nodeSelectionObj.save(e,this.parent.contentModule.getDocument()),p=s.indexOf("http")>-1?s:"http://"+s,d=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(e),u={url:p,selection:c,selectParent:d,text:s,title:"",target:"_blank"};this.parent.formatter.process(this.parent,{item:{command:"Links",subCommand:"CreateLink"}},t,u)}},o.prototype.mouseOutHandler=function(){if(!h(this.tooltipTargetEle))this.tooltipTargetEle.setAttribute("title",this.tooltipTargetEle.getAttribute("data-title"));else{var t=this.parent.iframeSettings.enable?this.parent.contentModule.getPanel().ownerDocument:this.parent.contentModule.getDocument();this.tooltipTargetEle=t.querySelector("[data-title]"),this.tooltipTargetEle.setAttribute("title",this.tooltipTargetEle.getAttribute("data-title"))}this.tooltipTargetEle.removeAttribute("data-title"),b.remove(this.tooltipTargetEle,"mouseout",this.mouseOutHandler)},o.prototype.onToolbarClick=function(t){var e=this,i,n,r,s=t.item,a=T(t.originalEvent.target,".e-rte-quick-popup"),l=this.parent.iframeSettings.enable?this.parent.contentModule.getPanel().ownerDocument:this.parent.contentModule.getDocument();if(this.tooltipTargetEle=T(t.originalEvent.target,"[data-tooltip-id]"),!h(this.tooltipTargetEle)&&this.parent.showTooltip&&!h(l.querySelector(".e-tooltip-wrap"))&&(this.parent.notify(Mi,{args:event}),this.tooltipTargetEle.setAttribute("data-title",this.tooltipTargetEle.getAttribute("title")),this.tooltipTargetEle.removeAttribute("title"),b.add(this.tooltipTargetEle,"mouseout",this.mouseOutHandler,this)),s.command!=="FormatPainter")if(a&&!a.classList.contains("e-rte-inline-popup")&&!a.classList.contains("e-rte-text-popup")){if(!(s.subCommand==="SourceCode"||s.subCommand==="Preview"||s.subCommand==="FontColor"||s.subCommand==="BackgroundColor")){De()&&s.command==="Images"&&this.nodeSelectionObj.restore();var c=this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument());i=this.nodeSelectionObj.save(c,this.parent.contentModule.getDocument()),n=this.nodeSelectionObj.getNodeCollection(c),r=this.nodeSelectionObj.getParentNodeCollection(c)}s.command==="Images"&&this.parent.notify(ss,{member:"image",args:t,selectNode:n,selection:i,selectParent:r}),s.command==="Audios"&&this.parent.notify(Ml,{member:"audio",args:t,selectNode:n,selection:i,selectParent:r}),s.command==="Videos"&&this.parent.notify(Al,{member:"video",args:t,selectNode:n,selection:i,selectParent:r}),s.command==="Links"&&this.parent.notify(os,{member:"link",args:t,selectNode:n,selection:i,selectParent:r}),s.command==="Table"&&this.parent.notify(jl,{member:"table",args:t,selectNode:n,selection:i,selectParent:r})}else{var p=document.getElementById(this.parent.getID()+"_rtelink"),d=document.getElementById(this.parent.getID()+"_image");if(!(s.subCommand==="SourceCode"||s.subCommand==="Preview"||s.subCommand==="FontColor"||s.subCommand==="BackgroundColor")){var c=this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument());h(p)&&h(d)&&(i=this.nodeSelectionObj.save(c,this.parent.contentModule.getDocument())),n=this.nodeSelectionObj.getNodeCollection(c),r=this.nodeSelectionObj.getParentNodeCollection(c)}switch(s.subCommand){case"Maximize":this.parent.notify(ts,{args:t});break;case"Minimize":this.parent.notify(is,{args:t});break;case"CreateLink":this.parent.notify(ls,{member:"link",args:t,selectNode:n,selection:i,selectParent:r});break;case"RemoveLink":this.parent.notify(pn,{member:"link",args:t,selectNode:n,selection:i,selectParent:r});break;case"Print":this.parent.print();break;case"Image":this.parent.notify(dn,{member:"image",args:t,selectNode:n,selection:i,selectParent:r});break;case"Audio":this.parent.notify(zl,{member:"audio",args:t,selectNode:n,selection:i,selectParent:r});break;case"Video":this.parent.notify(ql,{member:"video",args:t,selectNode:n,selection:i,selectParent:r});break;case"CreateTable":this.parent.notify(Vl,{member:"table",args:t,selection:i});break;case"SourceCode":this.parent.notify(Gt,{member:"viewSource",args:t});break;case"Preview":this.parent.notify(xi,{member:"updateSource",args:t});break;case"FontColor":case"BackgroundColor":break;case"File":this.parent.notify(la,{member:"fileManager",args:t,selectNode:n,selection:i,selectParent:r});break;case"EmojiPicker":this.parent.notify(ha,{member:"emojiPicker",args:t});break;default:this.parent.formatter.process(this.parent,t,t.originalEvent,null);break}}else t.originalEvent.detail===1?(clearTimeout(this.clickTimeout),this.clickTimeout=setTimeout(function(){e.parent.notify(ah,{member:"formatPainter",args:t})},200)):(clearTimeout(this.clickTimeout),this.parent.notify(lh,{member:"formatPainter",args:t}))},o.prototype.renderColorPicker=function(t){this.colorPickerModule.renderColorPickerInput(t)},o.prototype.instantiateRenderer=function(){this.parent.iframeSettings.enable?this.renderFactory.addRenderer(U.Content,new Up(this.parent,this.locator)):this.renderFactory.addRenderer(U.Content,new el(this.parent,this.locator))},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(Me,this.render),this.parent.off(be,this.onPropertyChanged),this.parent.off(Jr,this.onToolbarClick),this.parent.off(Hn,this.renderColorPicker),this.parent.off(j,this.destroy),this.parent.off(Ne,this.onKeyDown),this.parent.off(Yr,this.instantiateRenderer),this.parent.off(cs,this.selectAll),this.parent.off(zn,this.selectRange),this.parent.off(ps,this.getSelectedHtml),this.parent.off(nt,this.onSelectionSave),this.parent.off(rt,this.onSelectionRestore),this.parent.off(fs,this.updateReadOnly),this.parent.off(Oi,this.onPaste),this.parent.off(Ei,this.isTableClassAdded))},o.prototype.render=function(){this.contentRenderer=this.renderFactory.getRenderer(U.Content);var t=this.contentRenderer.getEditPanel(),e={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};if(h(this.parent.formatter)){var i=new zp({currentDocument:this.contentRenderer.getDocument(),element:t,options:e,formatPainterSettings:this.parent.formatPainterSettings});this.parent.setProperties({formatter:i},!0)}else this.parent.formatter.updateFormatter(t,this.contentRenderer.getDocument(),e);this.parent.enableXhtml&&this.parent.notify(Ri,{}),this.parent.toolbarSettings.enable&&(this.toolbarUpdate=new ea(this.parent)),this.parent.inlineMode.enable&&(h(this.parent.fontFamily.default)||(t.style.fontFamily=this.parent.fontFamily.default),h(this.parent.fontSize.default)||(t.style.fontSize=this.parent.fontSize.default)),this.parent.notify($r,{})},o.prototype.onPropertyChanged=function(t){if(!h(t)&&!h(t.newProp.toolbarSettings)&&!h(t.newProp.toolbarSettings.enable)&&(this.toolbarUpdate=new ea(this.parent)),!h(t.newProp.formatter)){var e=this.contentRenderer.getEditPanel(),i={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};this.parent.formatter.updateFormatter(e,this.contentRenderer.getDocument(),i)}},o.prototype.getModuleName=function(){return"htmlEditor"},o.prototype.selectAll=function(){var t=va(this.parent.contentModule.getDocument(),this.parent.contentModule.getEditPanel());t.length>0&&this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.parent.contentModule.getDocument(),t[0],t[t.length-1],0,t[t.length-1].textContent.length)},o.prototype.selectRange=function(t){this.parent.formatter.editorManager.nodeSelection.setRange(this.parent.contentModule.getDocument(),t.range)},o.prototype.getSelectedHtml=function(t){t.callBack(this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()).toString())},o}(),Wp=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),sn=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},Qp=function(o){Wp(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return sn([g(null)],t.prototype,"downloadUrl",void 0),sn([g(null)],t.prototype,"getImageUrl",void 0),sn([g(null)],t.prototype,"uploadUrl",void 0),sn([g(null)],t.prototype,"url",void 0),t}(W),tl=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),de=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},Gp=["NewFolder","Upload","Cut","Copy","Paste","Delete","Download","Rename","SortBy","Refresh","Selection","View","Details"],Kp=function(o){tl(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return de([g(Gp)],t.prototype,"items",void 0),de([g(!0)],t.prototype,"visible",void 0),t}(W);(function(o){tl(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return de([g("")],t.prototype,"id",void 0),de([g("")],t.prototype,"text",void 0),de([g("auto")],t.prototype,"width",void 0),de([g("")],t.prototype,"cssClass",void 0),de([g(!1)],t.prototype,"showAlwaysInPopup",void 0),de([g(!1)],t.prototype,"disabled",void 0),de([g("")],t.prototype,"prefixIcon",void 0),de([g("")],t.prototype,"suffixIcon",void 0),de([g(!0)],t.prototype,"visible",void 0),de([g("None")],t.prototype,"overflow",void 0),de([g("")],t.prototype,"template",void 0),de([g("Button")],t.prototype,"type",void 0),de([g("Both")],t.prototype,"showTextOn",void 0),de([g(null)],t.prototype,"htmlAttributes",void 0),de([g("")],t.prototype,"tooltipText",void 0),de([g("Left")],t.prototype,"align",void 0),de([g(-1)],t.prototype,"tabIndex",void 0),de([g()],t.prototype,"name",void 0),t})(W);var Xp=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),on=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},Yp=function(o){Xp(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return on([g(!0)],t.prototype,"allowSearchOnTyping",void 0),on([g("contains")],t.prototype,"filterType",void 0),on([g(!0)],t.prototype,"ignoreCase",void 0),on([g(null)],t.prototype,"placeholder",void 0),t}(W),$p=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ta=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},Jp=[{field:"name",headerText:"Name",minWidth:120,isPrimaryKey:!0,template:Nn(function(o){return'<span class="e-fe-text">'+o.name+"</span>"}),customAttributes:{class:"e-fe-grid-name"}},{field:"_fm_modified",headerText:"DateModified",type:"dateTime",format:"MMMM dd, yyyy HH:mm",minWidth:120,width:"190"},{field:"size",headerText:"Size",minWidth:90,width:"110",template:Nn(function(o){return'<span class="e-fe-size">'+o.size+"</span>"}),format:"n2"}],Zp=function(o){$p(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ta([g(!0)],t.prototype,"columnResizing",void 0),ta([g(Jp)],t.prototype,"columns",void 0),t}(W),ed=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),an=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},td=["Open","|","Cut","Copy","|","Delete","Download","Rename","|","Details"],id=["Open","|","Cut","Copy","Paste","|","Delete","Rename","Download","|","Details"],nd=["SortBy","View","Refresh","|","Paste","|","NewFolder","Upload","|","Details","|","SelectAll"],rd=function(o){ed(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return an([g(td)],t.prototype,"file",void 0),an([g(id)],t.prototype,"folder",void 0),an([g(nd)],t.prototype,"layout",void 0),an([g(!0)],t.prototype,"visible",void 0),t}(W),sd=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ln=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},od=function(o){sd(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ln([g("650px")],t.prototype,"maxWidth",void 0),ln([g("240px")],t.prototype,"minWidth",void 0),ln([g(!0)],t.prototype,"visible",void 0),ln([g("None")],t.prototype,"sortOrder",void 0),t}(W),ad=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Vt=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},ld=function(o){ad(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Vt([g("")],t.prototype,"allowedExtensions",void 0),Vt([g(!0)],t.prototype,"autoUpload",void 0),Vt([g(!1)],t.prototype,"autoClose",void 0),Vt([g(!1)],t.prototype,"directoryUpload",void 0),Vt([g(0)],t.prototype,"minFileSize",void 0),Vt([g(3e7)],t.prototype,"maxFileSize",void 0),t}(W),hd=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.showFullScreen=function(t){var e=this;if(this.parent.toolbarSettings.enable===!0&&this.parent.editorMode!=="Markdown"&&!h(this.parent.quickToolbarModule)&&this.parent.quickToolbarModule.hideQuickToolbars(),this.parent.showTooltip&&!h(document.querySelector(".e-tooltip-wrap"))&&this.parent.notify(Mi,{args:t}),this.scrollableParent=Xr(this.parent.element),!this.parent.element.classList.contains(ei)){var i={cancel:!1,requestType:"Maximize",targetItem:"Maximize",args:t};this.parent.trigger(Ae,i,function(n){if(!n.cancel){e.parent.toolbarSettings.enableFloating&&!e.parent.inlineMode.enable&&e.parent.toolbarSettings.enable&&(e.parent.getToolbarElement().style.width="100%",e.parent.getToolbarElement().style.top="0px"),e.parent.element.classList.add(ei),e.toggleParentOverflow(!0);var r=e.parent.element.querySelectorAll(".e-toolbar-extended.e-popup-open").length>0;e.parent.setContentHeight(null,r),e.parent.toolbarModule&&(e.parent.getBaseToolbarObject().toolbarObj.items[0].properties||e.parent.getBaseToolbarObject().toolbarObj.removeItems(0),D.isDevice&&e.parent.toolbarModule.removeFixedTBarClass(),e.parent.toolbarModule.updateItem({targetItem:"Maximize",updateItem:"Minimize",baseToolbar:e.parent.getBaseToolbarObject()})),e.parent.refreshUI(),e.parent.trigger(Ge,{requestType:"Maximize",targetItem:"Maximize",args:t})}})}},o.prototype.hideFullScreen=function(t){var e=this;if(this.parent.toolbarSettings.enable===!0&&this.parent.editorMode!=="Markdown"&&!h(this.parent.quickToolbarModule)&&this.parent.quickToolbarModule.hideQuickToolbars(),this.parent.showTooltip&&!h(document.querySelector(".e-tooltip-wrap"))&&this.parent.notify(Mi,{args:t}),this.parent.element.classList.contains(ei)){var i={cancel:!1,requestType:"Minimize",targetItem:"Minimize",args:t};this.parent.trigger(Ae,i,function(n){if(!n.cancel){e.parent.element.classList.remove(ei);for(var r=document.querySelectorAll(".e-rte-overflow"),s=0;s<r.length;s++)O([r[s]],["e-rte-overflow"]);var a=e.parent.element.querySelectorAll(".e-toolbar-extended.e-popup-open").length>0;e.parent.setContentHeight(null,a),e.parent.toolbarModule&&(e.parent.getBaseToolbarObject().toolbarObj.items[0].properties||e.parent.getBaseToolbarObject().toolbarObj.removeItems(0),e.parent.toolbarModule.updateItem({targetItem:"Minimize",updateItem:"Maximize",baseToolbar:e.parent.getBaseToolbarObject()}),D.isDevice&&e.parent.inlineMode.enable&&e.parent.toolbarModule.addFixedTBarClass()),e.parent.refreshUI(),e.parent.trigger(Ge,{requestType:"Minimize",targetItem:"Minimize",args:t})}})}},o.prototype.toggleParentOverflow=function(t){if(!h(this.scrollableParent))for(var e=0;e<this.scrollableParent.length;e++)if(this.scrollableParent[e].nodeName==="#document"){var i=document.querySelector("body");x([i],["e-rte-overflow"])}else{var i=this.scrollableParent[e];x([i],["e-rte-overflow"])}},o.prototype.onKeyDown=function(t){var e=t.args;switch(e.action){case"full-screen":this.showFullScreen(t.args),e.preventDefault();break;case"escape":this.hideFullScreen(t.args),e.preventDefault();break}},o.prototype.addEventListener=function(){this.parent.on(Ne,this.onKeyDown,this),this.parent.on(j,this.destroy,this),this.parent.on(fe,this.moduleDestroy,this)},o.prototype.removeEventListener=function(){this.parent.off(Ne,this.onKeyDown),this.parent.off(j,this.destroy),this.parent.off(fe,this.moduleDestroy)},o.prototype.destroy=function(){if(!h(this.parent)){this.parent.element.classList.contains(ei)&&this.toggleParentOverflow(!1);for(var t=document.querySelectorAll(".e-rte-overflow"),e=0;e<t.length;e++)O([t[e]],["e-rte-overflow"]);this.removeEventListener()}},o.prototype.moduleDestroy=function(){this.parent=null},o}();function _r(o,t,e,i){var n;if(e){var r=t.contentModule.getDocument();n=r.querySelector("body")}else n=t.element;if(Object.keys(o).length)for(var s=0,a=Object.keys(o);s<a.length;s++){var l=a[s];if(l==="class")n.classList.add(o[""+l]);else if(l==="disabled"&&o[""+l]==="disabled")t.enabled=!1,t.setEnable();else if(l==="readonly"&&o[""+l]==="readonly")t.readonly=!0,t.setReadOnly(i);else if(l==="style")n.setAttribute("style",o[""+l]);else if(l==="tabindex")t.inputElement.setAttribute("tabindex",o[""+l]);else if(l==="placeholder")t.placeholder=o[""+l],t.setPlaceHolder();else{var c=["name","required"];c.indexOf(l)>-1?t.valueContainer.setAttribute(l,o[""+l]):n.setAttribute(l,o[""+l])}}}var cd=function(){function o(t,e){this.parent=t,this.locator=e,this.renderer=this.locator.getService("rendererFactory"),this.addEventListener()}return o.prototype.render=function(){this.parent,this.contentRenderer=this.renderer.getRenderer(U.Content),this.contentRenderer.renderPanel()},o.prototype.refresh=function(t){t===void 0&&(t={requestType:"refresh"}),this.parent.notify(t.requestType+"-begin",t)},o.prototype.destroy=function(){h(this.parent)||this.removeEventListener()},o.prototype.moduleDestroy=function(){this.parent=null},o.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(be,this.refresh,this),this.parent.on(at,this.keyUp,this),this.parent.on(fe,this.moduleDestroy,this))},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(be,this.refresh),this.parent.off(at,this.keyUp),this.parent.off(fe,this.moduleDestroy))},o.prototype.keyUp=function(t){if(this.parent.editorMode==="HTML")switch(t.args.which){case 46:case 8:var e=this.parent.contentModule.getEditPanel().childNodes;if(e.length===0||e.length===1&&e[0].childNodes.length===0&&(e[0].tagName==="BR"||(e[0].tagName==="P"||e[0].tagName==="DIV")&&e[0].textContent==="")){var i=this.parent.contentModule.getEditPanel();this.parent.enterKey==="DIV"?i.innerHTML="<div><br/></div>":this.parent.enterKey==="BR"?i.innerHTML="<br/>":i.innerHTML="<p><br/></p>",this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),i.childNodes[0],0)}break}},o}(),pd=function(){function o(t,e){this.parent=t,this.rteID=t.element.id,this.i10n=e.getService("rteLocale"),this.addEventListener(),this.serviceLocator=e,this.rendererFactory=e.getService("rendererFactory"),this.dialogRenderObj=e.getService("dialogRenderObject")}return o.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(ls,this.linkDialog,this),this.parent.on(ys,this.showDialog,this),this.parent.on(Cs,this.closeDialog,this),this.parent.on(Ne,this.onKeyDown,this),this.parent.on(ki,this.showLinkQuickToolbar,this),this.parent.on(Ni,this.clearDialogObj,this),this.parent.on(os,this.onToolbarAction,this),this.parent.on(pt,this.onIframeMouseDown,this),this.parent.on(pn,this.removeLink,this),this.parent.on(or,this.editLink,this),this.parent.on(Ui,this.openLink,this),this.parent.on(Kt,this.editAreaClickHandler,this),this.parent.on(we,this.setCssClass,this),this.parent.on(j,this.destroy,this),this.parent.on(fe,this.moduleDestroy,this))},o.prototype.onToolbarAction=function(t){var e=t.args.item;switch(e.subCommand){case"OpenLink":this.parent.notify(Ui,t);break;case"EditLink":this.parent.notify(or,t);break;case"RemoveLink":this.parent.notify(pn,t);break}},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ls,this.linkDialog),this.parent.off(ys,this.showDialog),this.parent.off(Cs,this.closeDialog),this.parent.off(Ne,this.onKeyDown),this.parent.off(ki,this.showLinkQuickToolbar),this.parent.off(Ni,this.clearDialogObj),this.parent.off(os,this.onToolbarAction),this.parent.off(pn,this.removeLink),this.parent.off(pt,this.onIframeMouseDown),this.parent.off(or,this.editLink),this.parent.off(Ui,this.openLink),this.parent.off(Kt,this.editAreaClickHandler),this.parent.off(we,this.setCssClass),this.parent.off(j,this.destroy),this.parent.off(fe,this.moduleDestroy))},o.prototype.onIframeMouseDown=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},o.prototype.updateCss=function(t,e){t&&e.cssClass&&(h(e.oldCssClass)?t.setProperties({cssClass:(t.cssClass+" "+e.cssClass).trim()}):t.setProperties({cssClass:(t.cssClass.replace(e.oldCssClass,"").trim()+" "+e.cssClass).trim()}))},o.prototype.setCssClass=function(t){this.updateCss(this.checkBoxObj,t),this.updateCss(this.dialogObj,t)},o.prototype.showLinkQuickToolbar=function(t){if(!h(t.args)&&t.args.action!=="enter"&&t.args.action!=="space"){var e=void 0,i=void 0;if(t.type!=="Links"||h(this.parent.quickToolbarModule)||h(this.parent.quickToolbarModule.linkQTBar))return;this.quickToolObj=this.parent.quickToolbarModule;var n=this.parent.element.getBoundingClientRect().top,r=this.parent.element.getBoundingClientRect().left,s=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),a;if([].forEach.call(t.elements,function(m,v){v===0&&(a=m.nodeName==="#text"?m.parentNode:m)}),t.isNotify){var l=this.parent.toolbarModule.getToolbarElement(),c=a.getBoundingClientRect().top,p=a.getBoundingClientRect().left,d=c-n,u=l?l.offsetHeight+this.parent.toolbarModule.getExpandTBarPopHeight():0;e=this.parent.iframeSettings.enable?r+p:a.getBoundingClientRect().left,i=window.pageYOffset+(this.parent.iframeSettings.enable?n+u+c:n+d)}else{var f=void 0;f=t.args.touches?t.args.changedTouches[0]:f=t.args,e=this.parent.iframeSettings.enable?window.pageXOffset+r+f.clientX:f.pageX,i=this.parent.iframeSettings.enable?window.pageYOffset+n+f.clientY:f.pageY}this.quickToolObj.linkQTBar&&this.quickToolObj.linkQTBar.showPopup(e,i,s.endContainer,"link")}},o.prototype.hideLinkQuickToolbar=function(){this.quickToolObj&&this.quickToolObj.linkQTBar&&document.body.contains(this.quickToolObj.linkQTBar.element)&&this.quickToolObj.linkQTBar.hidePopup()},o.prototype.editAreaClickHandler=function(t){if(this.parent.readonly){this.hideLinkQuickToolbar();return}var e=t.args,i=this.parent.quickToolbarSettings.showOnRightClick;if(!(e.which===2||i&&e.which===1||!i&&e.which===3)&&this.parent.editorMode==="HTML"&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.linkQTBar){this.quickToolObj=this.parent.quickToolbarModule;var n=e.target;n=this.getAnchorNode(n),this.contentModule=this.rendererFactory.getRenderer(U.Content);var r=this.quickToolObj.linkQTBar.element.classList.contains("e-rte-pop");if(n.nodeName==="A"&&n.childNodes.length>0&&n.childNodes[0].nodeName!=="IMG"&&t.args.target.nodeName!=="IMG"&&!h(T(this.parent.getRange().startContainer.parentElement,"A"))&&!h(T(this.parent.getRange().endContainer.parentElement,"A"))){if(r)return;if(t.args.ctrlKey===!1)this.showLinkQuickToolbar({args:e,isNotify:!1,type:"Links",elements:[e.target]});else{var s=this.parent.formatter.editorManager.nodeSelection,a=s.getRange(this.parent.contentModule.getDocument()),l={args:{item:{subCommand:"OpenLink",command:"Links",name:""},originalEvent:t.args},selectNode:s.getNodeCollection(a),selectParent:s.getParentNodeCollection(a),selection:s.save(a,this.parent.contentModule.getDocument())};this.parent.notify(Ui,l)}}else this.hideLinkQuickToolbar()}},o.prototype.onKeyDown=function(t){var e=t.args;switch(e.action){case"escape":h(this.dialogObj)||this.dialogObj.close();break;case"insert-link":this.openDialog(!0,t),e.preventDefault();break}},o.prototype.openDialog=function(t,e){if(t||this.parent.contentModule.getEditPanel().focus(),this.parent.editorMode==="HTML"){var i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),n=this.parent.formatter.editorManager.nodeSelection.save(i,this.parent.contentModule.getDocument()),r=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(i),s=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(i),a={args:e?e.args:{item:{command:"Links",subCommand:"CreateLink"},originalEvent:void 0,name:t?null:"showDialog"},selectNode:r,selection:n,selectParent:s};this.linkDialog(a)}else{var l=this.parent.contentModule.getEditPanel();this.parent.formatter.editorManager.markdownSelection.save(l.selectionStart,l.selectionEnd),this.linkDialog({args:{item:{command:"Links",subCommand:"Link"},originalEvent:e&&e.args},member:"link",text:this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()),module:"Markdown",name:"insertLink"})}},o.prototype.showDialog=function(){this.openDialog(!1),this.setCssClass({cssClass:this.parent.getCssClass()})},o.prototype.closeDialog=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},o.prototype.clearDialogObj=function(){this.dialogObj&&(this.dialogObj.destroy(),S(this.dialogObj.element),this.dialogObj=null)},o.prototype.linkDialog=function(t,e){var i=this;if(this.dialogObj){this.dialogObj.hide({returnValue:!0});return}if(this.parent.editorMode==="HTML"&&t.selectParent.length>0&&!h(t.selectParent[0].classList)&&t.selectParent[0].classList.contains("e-rte-anchor")&&h(e)){this.editLink(t);return}var n=this.i10n.getConstant("linkWebUrl"),r=this.i10n.getConstant("linkText"),s=this.i10n.getConstant("linkTooltipLabel"),a=this.i10n.getConstant("linkurl"),l=this.i10n.getConstant("textPlaceholder"),c=this.i10n.getConstant("linkTitle"),p=this.parent.createElement("div",{className:"e-rte-link-dialog"+this.parent.getCssClass(!0),id:this.rteID+"_rtelink"});this.parent.element.appendChild(p);var d=this.parent.createElement("div",{className:"e-rte-linkcontent"+this.parent.getCssClass(!0),id:this.rteID+"_linkContent"}),u=this.parent.editorMode==="HTML"?"<label>"+s+'</label></div><div class="e-rte-field'+this.parent.getCssClass(!0)+'"><input type="text" data-role ="none" spellcheck="false" placeholder = "'+c+'"aria-label="'+this.i10n.getConstant("linkTitle")+'" class="e-input e-rte-linkTitle'+this.parent.getCssClass(!0)+'"></div><div class="e-rte-label'+this.parent.getCssClass(!0)+'"></div><div class="e-rte-field'+this.parent.getCssClass(!0)+'"><input type="checkbox" class="e-rte-linkTarget'+this.parent.getCssClass(!0)+'"  data-role ="none"></div>':"",f='<div class="e-rte-label'+this.parent.getCssClass(!0)+'"><label>'+n+'</label></div><div class="e-rte-field'+this.parent.getCssClass(!0)+'"><input type="text" data-role ="none" spellcheck="false" placeholder="'+a+'"aria-label="'+this.i10n.getConstant("linkWebUrl")+'" class="e-input e-rte-linkurl'+this.parent.getCssClass(!0)+'"/></div><div class="e-rte-label'+this.parent.getCssClass(!0)+'"><label>'+r+'</label></div><div class="e-rte-field'+this.parent.getCssClass(!0)+'"> <input type="text" data-role ="none" spellcheck="false" class="e-input e-rte-linkText'+this.parent.getCssClass(!0)+'"aria-label="'+this.i10n.getConstant("linkText")+'" placeholder="'+l+'"></div><div class="e-rte-label'+this.parent.getCssClass(!0)+'">'+u,m=On(f);d.appendChild(m);var v=d.querySelector(".e-rte-linkTarget"),y=d.querySelector(".e-rte-linkurl"),L=d.querySelector(".e-rte-linkText"),C=d.querySelector(".e-rte-linkTitle"),w=this.i10n.getConstant("linkOpenInNewWindow");this.checkBoxObj=new oa({label:w,checked:!0,enableRtl:this.parent.enableRtl,cssClass:this.parent.getCssClass()}),this.checkBoxObj.isStringTemplate=!0,this.checkBoxObj.createElement=this.parent.createElement,this.checkBoxObj.appendTo(v);var k=this.parent.editorMode==="HTML"?t.selection.getRange(this.parent.contentModule.getDocument()).toString():t.text,I=this.i10n.getConstant("dialogInsert"),P=this.i10n.getConstant("dialogCancel"),Z=t.selection,G={selfLink:this,selection:t.selection,selectParent:t.selectParent,args:t.args},$={header:this.i10n.getConstant("linkHeader"),content:d,cssClass:Ce+this.parent.getCssClass(!0),enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:D.isDevice?"290px":"310px",isModal:D.isDevice,buttons:[{click:this.insertlink.bind(G),buttonModel:{content:I,cssClass:"e-flat e-insertLink"+this.parent.getCssClass(!0),isPrimary:!0}},{click:this.cancelDialog.bind(G),buttonModel:{cssClass:"e-flat"+this.parent.getCssClass(!0),content:P}}],target:D.isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:function(ae){i.parent.isBlur=!1,ae&&ae.event.returnValue&&(i.parent.editorMode==="HTML"?Z.restore():i.parent.formatter.editorManager.markdownSelection.restore(i.parent.contentModule.getEditPanel())),i.dialogObj.destroy(),S(i.dialogObj.element);var ue=i.dialogObj;i.dialogRenderObj.close(ue),i.dialogObj=null}};this.dialogObj=this.dialogRenderObj.render($),this.dialogObj.createElement=this.parent.createElement,this.dialogObj.appendTo(p),p.style.maxHeight="inherit",!h(this.dialogObj)&&(h(e)||(y.value=e.url,L.value=e.text,C.value=e.title,e.target?this.checkBoxObj.checked=!0:this.checkBoxObj.checked=!1,this.dialogObj.header=e.header,this.dialogObj.element.querySelector(".e-insertLink").textContent=e.btnText),this.checkUrl(!1),(this.parent.editorMode==="HTML"&&h(e)&&(!h(k)&&k!==""&&t.selection.range.startOffset===0||t.selection.range.startOffset!==t.selection.range.endOffset)||t.module==="Markdown")&&(L.value=k),b.add(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick,this),this.quickToolObj&&(this.hideLinkQuickToolbar(),this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup(),this.quickToolObj.textQTBar&&this.parent.element.ownerDocument.body.contains(this.quickToolObj.textQTBar.element)&&this.quickToolObj.textQTBar.hidePopup()))},o.prototype.insertlink=function(t){var e=this.selfLink.dialogObj.element,i=e.querySelector(".e-rte-linkurl").value,n=e.querySelector(".e-rte-linkText").value,r;this.selfLink.parent.editorMode==="HTML"&&(r=e.querySelector(".e-rte-linkTitle").value);var s=this.selfLink.checkBoxObj.checked?"_blank":null,a=this.selfLink.checkBoxObj.checked?this.selfLink.i10n.getConstant("linkAriaLabel"):null;if(this.selfLink.parent.editorMode==="Markdown"&&i===""&&(i="http://"),i===""){this.selfLink.checkUrl(!0);return}this.selfLink.isUrl(i)?this.selfLink.checkUrl(!1):(this.selfLink.parent.editorMode==="Markdown"?n=n!==""?n:"":n=n===""?i:n,this.selfLink.parent.enableAutoUrl?i=i:i=i.indexOf("http")>-1?i:"http://"+i);var l=this.selfLink;if(l.parent.editorMode==="HTML"&&h(T(this.selection.range.startContainer.parentNode,"[id='"+l.parent.contentModule.getPanel().id+"']"))){l.parent.contentModule.getEditPanel().focus(),D.isIE&&l.parent.iframeSettings.enable&&this.selection.restore();var c=l.parent.formatter.editorManager.nodeSelection.getRange(l.parent.contentModule.getDocument());this.selection=l.parent.formatter.editorManager.nodeSelection.save(c,l.parent.contentModule.getDocument()),this.selectParent=l.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(c)}var p={url:i,text:n,title:r,target:s,ariaLabel:a,selection:this.selection,selectParent:this.selectParent};document.body.contains(l.dialogObj.element)&&this.selfLink.dialogObj.hide({returnValue:!1}),De()&&l.parent.iframeSettings.enable&&A("iframe",l.parent.element).contentWindow.focus(),l.parent.editorMode==="HTML"&&this.selection.restore(),l.parent.formatter.getUndoRedoStack().length===0&&l.parent.formatter.saveData();var d;if(!h(this.args)&&this.args.code==="KeyK"){var u=this.args;ot(this.args,{item:{command:"Links",subCommand:"CreateLink"},originalEvent:u},!0);var f={item:{command:"Links",subCommand:"CreateLink"},originalEvent:u};d=f}else d=this.args;this.selfLink.parent.formatter.process(this.selfLink.parent,d,!h(this.args)&&this.args.originalEvent,p),this.selfLink.parent.contentModule.getEditPanel().focus()},o.prototype.isUrl=function(t){var e=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi;return e.test(t)},o.prototype.checkUrl=function(t){var e=this.dialogObj.element,i=e.querySelector(".e-rte-linkurl");t?(x([i],"e-error"),i.setSelectionRange(0,i.value.length),i.focus()):O([i],"e-error")},o.prototype.removeLink=function(t){this.parent.formatter.getUndoRedoStack().length===0&&this.parent.formatter.saveData();var e=this.getAnchorNode(t.selectParent[0]);this.parent.formatter.process(this.parent,t.args,t.args,{selectNode:t.selectNode,selectParent:t.selectParent,selection:t.selection,text:e.innerText,subCommand:t.args.item.subCommand}),De()&&this.parent.iframeSettings.enable?A("iframe",this.parent.element).contentWindow.focus():this.parent.contentModule.getEditPanel().focus(),this.hideLinkQuickToolbar()},o.prototype.openLink=function(t){var e=this.getAnchorNode(t.selectParent[0]);(e.classList.contains("e-rte-anchor")||e.tagName==="A")&&this.parent.formatter.process(this.parent,t.args,t.args,{url:e.href,text:e.innerText,target:e.target===""?"_self":"_blank",selectNode:t.selectNode,subCommand:t.args.item.subCommand})},o.prototype.getAnchorNode=function(t){var e=T(t,"a");return e||t},o.prototype.editLink=function(t){var e=this.getAnchorNode(t.selectNode[0]),i=this.getAnchorNode(t.selectParent[0]);if(i=e.nodeName==="A"?e:i,i.classList.contains("e-rte-anchor")||i.tagName==="A"){var n=this.i10n.getConstant("dialogUpdate"),r={url:i.getAttribute("href"),text:i.innerText,title:i.title,target:i.target,header:this.i10n.getConstant("editLink"),btnText:n};this.linkDialog(t,r)}},o.prototype.cancelDialog=function(t){this.selfLink.parent.isBlur=!1,this.selfLink.dialogObj.hide({returnValue:!0}),De()?this.selection.restore():this.selfLink.parent.contentModule.getEditPanel().focus()},o.prototype.onDocumentClick=function(t){var e=t.target;!h(this.dialogObj)&&(!T(e,"[id='"+this.dialogObj.element.id+"']")&&this.parent.toolbarSettings.enable&&this.parent.getToolbarElement()&&!this.parent.getToolbarElement().contains(t.target)||(this.parent.getToolbarElement()&&this.parent.getToolbarElement().contains(t.target)||this.parent.inlineMode.enable&&!T(e,"#"+this.dialogObj.element.id))&&!T(e,"#"+this.parent.getID()+"_toolbar_CreateLink")&&!e.querySelector("#"+this.parent.getID()+"_toolbar_CreateLink"))&&(this.parent.notify(qn,{closedBy:"outside click"}),this.dialogObj.hide({returnValue:!0}),b.remove(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick),this.parent.isBlur=!0,Zn(this.parent.element,"focusout"))},o.prototype.destroy=function(){h(this.parent)||this.removeEventListener()},o.prototype.moduleDestroy=function(){this.parent=null},o.prototype.getModuleName=function(){return"link"},o}(),dd=function(){function o(t,e){this.isImgUploaded=!1,this.isAllowedTypes=!0,this.pageX=null,this.pageY=null,this.mouseX=null,this.deletedImg=[],this.parent=t,this.rteID=t.element.id,this.i10n=e.getService("rteLocale"),this.rendererFactory=e.getService("rendererFactory"),this.dialogRenderObj=e.getService("dialogRenderObject"),this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(Ne,this.onKeyDown,this),this.parent.on(at,this.onKeyUp,this),this.parent.on(dn,this.insertImage,this),this.parent.on(Ts,this.showDialog,this),this.parent.on(Ss,this.closeDialog,this),this.parent.on(as,this.onWindowResize,this),this.parent.on(ki,this.showImageQuickToolbar,this),this.parent.on(Ni,this.clearDialogObj,this),this.parent.on(ss,this.onToolbarAction,this),this.parent.on(cr,this.caption,this),this.parent.on(hr,this.deleteImg,this),this.parent.on(ar,this.insertImgLink,this),this.parent.on(lr,this.insertAltText,this),this.parent.on(Kt,this.editAreaClickHandler,this),this.parent.on(pt,this.onIframeMouseDown,this),this.parent.on(pr,this.imageSize,this),this.parent.on(wi,this.alignmentSelect,this),this.parent.on(Me,this.afterRender,this),this.parent.on(vs,this.afterRender,this),this.parent.on(Oi,this.imagePaste,this),this.parent.on(we,this.setCssClass,this),this.parent.on(j,this.removeEventListener,this),this.parent.on(fe,this.moduleDestroy,this))},o.prototype.removeEventListener=function(){if(!this.parent.isDestroyed){this.parent.off(Ne,this.onKeyDown),this.parent.off(at,this.onKeyUp),this.parent.off(as,this.onWindowResize),this.parent.off(dn,this.insertImage),this.parent.off(Ts,this.showDialog),this.parent.off(Ss,this.closeDialog),this.parent.off(ki,this.showImageQuickToolbar),this.parent.off(Ni,this.clearDialogObj),this.parent.off(cr,this.caption),this.parent.off(ss,this.onToolbarAction),this.parent.off(hr,this.deleteImg),this.parent.off(ar,this.insertImgLink),this.parent.off(lr,this.insertAltText),this.parent.off(Kt,this.editAreaClickHandler),this.parent.off(pt,this.onIframeMouseDown),this.parent.off(pr,this.imageSize),this.parent.off(wi,this.alignmentSelect),this.parent.off(Me,this.afterRender),this.parent.off(vs,this.afterRender),this.parent.off(Oi,this.imagePaste),this.parent.off(we,this.setCssClass),this.parent.off(j,this.removeEventListener),this.parent.off(fe,this.moduleDestroy);var t=this.parent.iframeSettings.enable?this.parent.inputElement.ownerDocument:this.parent.inputElement;t.removeEventListener("drop",this.dragDrop.bind(this),!0),t.removeEventListener("dragstart",this.dragStart.bind(this),!0),t.removeEventListener("dragenter",this.dragEnter.bind(this),!0),t.removeEventListener("dragover",this.dragOver.bind(this),!0),h(this.contentModule)||(b.remove(this.contentModule.getEditPanel(),D.touchEndEvent,this.imageClick),this.parent.formatter.editorManager.observer.off(us,this.undoStack),this.parent.insertImageSettings.resize&&(b.remove(this.parent.contentModule.getEditPanel(),D.touchStartEvent,this.resizeStart),b.remove(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick),b.remove(this.contentModule.getEditPanel(),"cut",this.onCutHandler),b.remove(this.contentModule.getDocument(),D.touchMoveEvent,this.resizing)))}},o.prototype.updateCss=function(t,e){t&&e.cssClass&&(h(e.oldCssClass)?t.setProperties({cssClass:(t.cssClass+" "+e.cssClass).trim()}):t.setProperties({cssClass:(t.cssClass.replace(e.oldCssClass,"").trim()+" "+e.cssClass).trim()}))},o.prototype.setCssClass=function(t){this.popupObj&&t.cssClass&&(h(t.oldCssClass)?x([this.popupObj.element],t.cssClass):(O([this.popupObj.element],t.oldCssClass),x([this.popupObj.element],t.cssClass))),this.updateCss(this.checkBoxObj,t),this.updateCss(this.widthNum,t),this.updateCss(this.heightNum,t),this.updateCss(this.uploadObj,t),this.updateCss(this.dialogObj,t)},o.prototype.onIframeMouseDown=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},o.prototype.afterRender=function(){this.contentModule=this.rendererFactory.getRenderer(U.Content),b.add(this.contentModule.getEditPanel(),D.touchEndEvent,this.imageClick,this),this.parent.insertImageSettings.resize&&(b.add(this.parent.contentModule.getEditPanel(),D.touchStartEvent,this.resizeStart,this),b.add(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick,this),b.add(this.contentModule.getEditPanel(),"cut",this.onCutHandler,this));var t=this.parent.iframeSettings.enable?this.parent.inputElement.ownerDocument:this.parent.inputElement;t.addEventListener("drop",this.dragDrop.bind(this),!0),t.addEventListener("dragstart",this.dragStart.bind(this),!0),t.addEventListener("dragenter",this.dragOver.bind(this),!0),t.addEventListener("dragover",this.dragOver.bind(this),!0)},o.prototype.undoStack=function(t){if(t.subCommand.toLowerCase()==="undo"||t.subCommand.toLowerCase()==="redo")for(var e=0;e<this.parent.formatter.getUndoRedoStack().length;e++){var i=this.parent.createElement("div"),n=this.parent.formatter.getUndoRedoStack()[e].text;i.appendChild(n.cloneNode(!0));var r=i.querySelectorAll("img");if(i.querySelector(".e-img-resize")&&r.length>0){for(var s=0;s<r.length;s++)r[s].style.outline="";S(i.querySelector(".e-img-resize"));for(var a=i.cloneNode(!0),l=document.createDocumentFragment();a.firstChild;)l.appendChild(a.firstChild);this.parent.formatter.getUndoRedoStack()[e].text=l}}},o.prototype.resizeEnd=function(t){this.resizeBtnInit(),this.imgEle.parentElement.style.cursor="auto",D.isDevice&&O([t.target.parentElement],"e-mob-span");var e={event:t,requestType:"images"};this.parent.trigger(Hl,e),this.getPointX(t),this.parent.iframeSettings.enable?window.pageYOffset+this.parent.element.getBoundingClientRect().top+t.clientY:t.pageY,this.parent.formatter.editorManager.observer.on(us,this.undoStack,this),this.parent.formatter.saveData()},o.prototype.resizeStart=function(t,e){var i=this;if(!this.parent.readonly){var n=e||t.target;if(this.prevSelectedImgEle=this.imgEle,n.tagName==="IMG"){this.parent.preventDefaultResize(t);var r=n;this.imgResizeDiv&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&S(this.imgResizeDiv),this.imageResize(r)}if(n.classList.contains("e-rte-imageboxmark")){if(this.parent.formatter.getUndoRedoStack().length===0&&this.parent.formatter.saveData(),this.pageX=this.getPointX(t),this.pageY=this.getPointY(t),t.preventDefault(),t.stopImmediatePropagation(),this.resizeBtnInit(),this.quickToolObj&&this.quickToolObj.imageQTBar.hidePopup(),n.classList.contains("e-rte-topLeft")&&(this.resizeBtnStat.topLeft=!0),n.classList.contains("e-rte-topRight")&&(this.resizeBtnStat.topRight=!0),n.classList.contains("e-rte-botLeft")&&(this.resizeBtnStat.botLeft=!0),n.classList.contains("e-rte-botRight")&&(this.resizeBtnStat.botRight=!0),D.isDevice&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&!this.imgResizeDiv.classList.contains("e-mob-span"))x([this.imgResizeDiv],"e-mob-span");else{var s={event:t,requestType:"images"};this.parent.trigger(Pl,s,function(a){a.cancel&&i.cancelResizeAction()})}b.add(this.contentModule.getDocument(),D.touchEndEvent,this.resizeEnd,this)}}},o.prototype.imageClick=function(t){D.isDevice&&(t.target.tagName==="IMG"&&t.target.parentElement.tagName==="A"||t.target.tagName==="IMG"?(this.contentModule.getEditPanel().setAttribute("contenteditable","false"),t.target.focus()):this.parent.readonly||this.contentModule.getEditPanel().setAttribute("contenteditable","true")),t.target.tagName==="IMG"&&t.target.parentElement.tagName==="A"&&t.preventDefault()},o.prototype.onCutHandler=function(){this.imgResizeDiv&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&this.cancelResizeAction()},o.prototype.imageResize=function(t){this.resizeBtnInit(),this.imgEle=t,x([this.imgEle],"e-resize"),this.imgResizeDiv=this.parent.createElement("span",{className:"e-img-resize"+this.parent.getCssClass(!0),id:this.rteID+"_imgResize"}),this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-topLeft"+this.parent.getCssClass(!0),styles:"cursor: nwse-resize"})),this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-topRight"+this.parent.getCssClass(!0),styles:"cursor: nesw-resize"})),this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-botLeft"+this.parent.getCssClass(!0),styles:"cursor: nesw-resize"})),this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-botRight"+this.parent.getCssClass(!0),styles:"cursor: nwse-resize"})),D.isDevice&&x([this.imgResizeDiv],"e-mob-rte"),t.style.outline="2px solid #4a90e2",this.imgResizePos(t,this.imgResizeDiv),this.resizeImgDupPos(t),this.contentModule.getEditPanel().appendChild(this.imgResizeDiv),b.add(this.contentModule.getDocument(),D.touchMoveEvent,this.resizing,this)},o.prototype.getPointX=function(t){return t.touches&&t.touches.length?t.touches[0].pageX:t.pageX},o.prototype.getPointY=function(t){return t.touches&&t.touches.length?t.touches[0].pageY:t.pageY},o.prototype.imgResizePos=function(t,e){var i=this.calcPos(t),n=i.top,r=i.left,s=t.getBoundingClientRect().width,a=t.getBoundingClientRect().height,l=D.isDevice?4*parseInt(t.style.outline.slice(-3),10)+2:2*parseInt(t.style.outline.slice(-3),10)+2,c=D.isDevice?0:2;e.querySelector(".e-rte-botLeft").style.left=r-l+"px",e.querySelector(".e-rte-botLeft").style.top=a-l+n+"px",e.querySelector(".e-rte-botRight").style.left=s-(l-c)+r+"px",e.querySelector(".e-rte-botRight").style.top=a-l+n+"px",e.querySelector(".e-rte-topRight").style.left=s-(l-c)+r+"px",e.querySelector(".e-rte-topRight").style.top=n-l+"px",e.querySelector(".e-rte-topLeft").style.left=r-l+"px",e.querySelector(".e-rte-topLeft").style.top=n-l+"px"},o.prototype.calcPos=function(t){for(var e=["TD","TH","TABLE","A"],i={top:0,left:0},n,r=t.ownerDocument,s=(t.offsetParent&&(t.offsetParent.classList.contains("e-img-caption")||e.indexOf(t.offsetParent.tagName)>-1)?T(t,"#"+this.parent.getID()+"_rte-edit-view"):t.offsetParent)||r.documentElement;s&&(s===r.body||s===r.documentElement)&&s.style.position==="static";)s=s.parentNode;return s&&s!==t&&s.nodeType===1&&(i=s.getBoundingClientRect()),t.offsetParent&&t.offsetParent.classList.contains("e-img-caption")?(n=t.getBoundingClientRect(),{top:n.top-i.top,left:n.left-i.left}):{top:t.offsetTop,left:t.offsetLeft}},o.prototype.setAspectRatio=function(t,e,i,n){if(!h(t.width)){var r=t.style.width!==""?t.style.width.match(/^\d+(\.\d*)?%$/g)?parseFloat(t.style.width):parseInt(t.style.width,10):t.width,s=t.style.height!==""?parseInt(t.style.height,10):t.height;if(r>s)if(t.style.minWidth=this.parent.insertImageSettings.minWidth===0?"20px":H(this.parent.insertImageSettings.minWidth),this.parent.insertImageSettings.resizeByPercent){if(parseInt(""+t.getBoundingClientRect().width,10)!==0&&parseInt(""+r,10)!==0){var a=t.offsetWidth+this.mouseX,l=a/t.offsetWidth*(parseFloat(t.style.width).toString()==="NaN"?t.offsetWidth/parseFloat(getComputedStyle(this.parent.element).width)*100:parseFloat(t.style.width));t.style.width=(l>3?l:3)+"%"}else t.style.width=this.pixToPerc(r/s*i,t.previousElementSibling||t.parentElement)+"%";t.style.height=null,t.removeAttribute("height")}else if(t.style.width===""&&t.style.height!=="")t.style.height=i+"px";else if(t.style.width!==""&&t.style.height===""){var c=r/s*i+r/s<this.parent.inputElement.getBoundingClientRect().right-32?r/s*i+r/s:this.parent.inputElement.getBoundingClientRect().right-32;t.style.width=c.toString()+"px",t.style.height=i+"px"}else if(t.style.width!==""){var c=r/s*i<this.parent.inputElement.getBoundingClientRect().right-32?r/s*i:this.parent.inputElement.getBoundingClientRect().right-32;t.style.width=c+"px",t.style.height=i+"px"}else if(this.parent.iframeSettings.enable)t.setAttribute("width",(t.width+this.mouseX).toString());else{var c=t.offsetWidth===0?t.width+this.mouseX+parseInt(t.style.outlineWidth.split("p")[0],10):t.offsetWidth+this.mouseX;t.setAttribute("width",c.toString())}else if(s>r)if(this.parent.insertImageSettings.resizeByPercent){if(parseInt(""+t.getBoundingClientRect().width,10)!==0&&parseInt(""+r,10)!==0){var a=t.offsetWidth+this.mouseX,l=a/t.offsetWidth*(parseFloat(t.style.width).toString()==="NaN"?t.offsetWidth/parseFloat(getComputedStyle(this.parent.element).width)*100:parseFloat(t.style.width));t.style.width=(l>3?l:3)+"%"}else t.style.width=this.pixToPerc(e/s*i,t.previousElementSibling||t.parentElement)+"%";t.style.height=null,t.removeAttribute("height")}else t.style.width!==""?(t.style.width=e+"px",t.style.height=s/r*e+"px"):t.setAttribute("width",this.resizeBtnStat.botRight?(this.getPointX(n.event)-t.getBoundingClientRect().left).toString():e.toString());else this.parent.insertImageSettings.resizeByPercent?(t.style.width=this.pixToPerc(e,t.previousElementSibling||t.parentElement)+"%",t.style.height=null,t.removeAttribute("height")):(t.style.width=(e>=15?e:15)+"px",t.style.height=(e>=15?e:15)+"px")}},o.prototype.pixToPerc=function(t,e){return t/parseFloat(getComputedStyle(e).width)*100},o.prototype.imgDupMouseMove=function(t,e,i){var n=this,r={event:i,requestType:"images"};this.parent.trigger(Il,r,function(s){if(s.cancel)n.cancelResizeAction();else{if(parseInt(n.parent.insertImageSettings.minWidth,10)>=parseInt(t,10)||parseInt(n.parent.getInsertImgMaxWidth(),10)<=parseInt(t,10)&&h(n.imgEle.style.width)||!n.parent.insertImageSettings.resizeByPercent&&(parseInt(n.parent.insertImageSettings.minHeight,10)>=parseInt(e,10)||parseInt(n.parent.insertImageSettings.maxHeight,10)<=parseInt(e,10)))return;n.imgEle.parentElement.style.cursor="pointer",n.setAspectRatio(n.imgEle,parseInt(t,10),parseInt(e,10),r),n.resizeImgDupPos(n.imgEle),n.imgResizePos(n.imgEle,n.imgResizeDiv)}})},o.prototype.resizing=function(t){if(!this.parent){this.cancelResizeAction();return}this.imgEle.offsetWidth>=this.parent.getInsertImgMaxWidth()?this.imgEle.style.maxHeight=this.imgEle.offsetHeight+"px":h(this.parent.insertImageSettings.maxHeight)&&(this.imgEle.style.maxHeight=""),this.imgEle.style.maxWidth=(T(this.imgEle,"ol,ul")!=null?this.parent.getInsertImgMaxWidth()-parseInt(getComputedStyle(T(this.imgEle,"ol,ul")).paddingLeft,0):this.parent.getInsertImgMaxWidth())+"px";var e=this.getPointX(t),i=this.getPointY(t),n=this.resizeBtnStat.botLeft||this.resizeBtnStat.topLeft?-(e-this.pageX):e-this.pageX,r=this.resizeBtnStat.botLeft||this.resizeBtnStat.topLeft?-(i-this.pageY):i-this.pageY,s=parseInt(this.imgDupPos.width,10)+n,a=parseInt(this.imgDupPos.height,10)+r;this.mouseX=n,this.pageX=e,this.pageY=i,this.resizeBtnStat.botRight?this.imgDupMouseMove(s+"px",a+"px",t):this.resizeBtnStat.botLeft?this.imgDupMouseMove(s+"px",a+"px",t):this.resizeBtnStat.topRight?this.imgDupMouseMove(s+"px",a+"px",t):this.resizeBtnStat.topLeft&&this.imgDupMouseMove(s+"px",a+"px",t)},o.prototype.cancelResizeAction=function(){b.remove(this.contentModule.getDocument(),D.touchMoveEvent,this.resizing),b.remove(this.contentModule.getDocument(),D.touchEndEvent,this.resizeEnd),this.imgEle&&this.imgResizeDiv&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&(S(this.imgResizeDiv),this.imgEle.style.outline="",this.imgResizeDiv=null,this.pageX=null,this.pageY=null)},o.prototype.resizeImgDupPos=function(t){this.imgDupPos={width:t.style.width!==""&&this.parent.insertImageSettings&&!this.parent.insertImageSettings.resizeByPercent?this.imgEle.style.width:t.width+"px",height:t.style.height!==""?this.imgEle.style.height:t.height+"px"}},o.prototype.resizeBtnInit=function(){return this.resizeBtnStat={botLeft:!1,botRight:!1,topRight:!1,topLeft:!1}},o.prototype.onToolbarAction=function(t){De()&&this.parent.notify(rt,{});var e=t.args.item;switch(e.subCommand){case"Replace":this.parent.fileManagerSettings.enable?this.parent.notify(la,t):this.parent.notify(dn,t);break;case"Caption":this.parent.notify(cr,t);break;case"InsertLink":this.parent.notify(ar,t);break;case"AltText":this.parent.notify(lr,t);break;case"Remove":this.parent.notify(hr,t);break;case"Dimension":this.parent.notify(pr,t);break;case"OpenImageLink":this.openImgLink(t);break;case"EditImageLink":this.editImgLink(t);break;case"RemoveImageLink":this.removeImgLink(t);break}},o.prototype.openImgLink=function(t){var e=t.selectParent[0].parentNode.target===""?"_self":"_blank";this.parent.formatter.process(this.parent,t.args,t.args,{url:t.selectParent[0].parentNode.href,target:e,selectNode:t.selectNode,subCommand:t.args.item.subCommand})},o.prototype.editImgLink=function(t){var e=t.selectParent[0].parentNode,i=this.i10n.getConstant("dialogUpdate"),n={url:e.href,target:e.target,header:"Edit Link",btnText:i};this.insertImgLink(t,n)},o.prototype.removeImgLink=function(t){D.isIE&&this.contentModule.getEditPanel().focus(),t.selection.restore();var e=!!(this.contentModule.getEditPanel().contains(this.captionEle)&&A("a",this.captionEle)),i=e?[this.captionEle]:[t.selectNode[0].parentElement];this.parent.formatter.process(this.parent,t.args,t.args,{insertElement:t.selectNode[0],selectParent:i,selection:t.selection,subCommand:t.args.item.subCommand}),this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),h(t.selectParent)||O([t.selectParent[0]],"e-img-focus")),e&&A(".e-img-inner",this.captionEle).focus()},o.prototype.onKeyDown=function(t){var e=t.args,i,n,r,s;this.deletedImg=[];var a,l=[27,112,113,114,115,116,117,118,119,120,121,122,123,44,45,9,16,17,18,19,20,33,34,35,36,37,38,39,40,91,92,93,144,145,182,183];if(this.parent.editorMode==="HTML"&&(i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),a=i.startContainer===i.endContainer&&i.startOffset===i.endOffset),!a&&this.parent.editorMode==="HTML"&&l.indexOf(e.which)<0)for(var c=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(i),p=0;p<c.length;p++)c[p].nodeName==="IMG"&&this.deletedImg.push(c[p]);if(this.parent.editorMode==="HTML"&&(e.which===8&&e.code==="Backspace"||e.which===46&&e.code==="Delete")){var d=i.startContainer===i.endContainer&&i.startOffset===i.endOffset;e.which===8&&e.code==="Backspace"&&d?this.checkImageBack(i):e.which===46&&e.code==="Delete"&&d&&this.checkImageDel(i)}if(!h(this.parent.formatter.editorManager.nodeSelection)&&e.code!=="KeyK"&&(i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),r=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(i),s=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(i),!e.ctrlKey&&e.key&&(e.key.length===1||e.action==="enter")&&!h(s[0])&&s[0].tagName==="IMG"&&s[0].parentElement)){var u=s[0].parentElement.childNodes[0];this.contentModule.getEditPanel().querySelector(".e-img-resize")&&this.removeResizeEle(),this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),u,u,u.textContent.length,u.textContent.length),O([s[0]],"e-img-focus"),this.quickToolObj.imageQTBar.hidePopup()}if(e.ctrlKey&&(e.keyCode===89||e.keyCode===90)&&this.undoStack({subCommand:e.keyCode===90?"undo":"redo"}),e.keyCode===8||e.keyCode===46){if(r&&r[0].nodeName==="IMG"&&r.length<1){h(this.parent.formatter.editorManager.nodeSelection)||(n=this.parent.formatter.editorManager.nodeSelection.save(i,this.parent.contentModule.getDocument())),e.preventDefault();var f={selectNode:r,selection:n,selectParent:s,args:{item:{command:"Images",subCommand:"Remove"},originalEvent:e}};this.deleteImg(f,e.keyCode)}this.parent.contentModule.getEditPanel().querySelector(".e-img-resize")&&this.removeResizeEle()}switch(e.code==="Backspace"&&(e.action="backspace"),e.action){case"escape":h(this.dialogObj)||this.dialogObj.close();break;case"backspace":case"delete":for(var p=0;p<this.deletedImg.length;p++){var m=this.deletedImg[p].src;this.imageRemovePost(m)}if(this.parent.editorMode!=="Markdown"){if(i.startContainer.nodeType===3)e.code==="Backspace"?i.startContainer.previousElementSibling&&i.startOffset===0&&i.startContainer.previousElementSibling.classList.contains(He)&&i.startContainer.previousElementSibling.classList.contains(ti)&&S(i.startContainer.previousElementSibling):i.startContainer.nextElementSibling&&i.endContainer.textContent.length===i.endOffset&&i.startContainer.nextElementSibling.classList.contains(He)&&i.startContainer.nextElementSibling.classList.contains(ti)&&S(i.startContainer.nextElementSibling);else if(i.startContainer.nodeType===1){if(i.startContainer.querySelector("."+He+"."+ti))S(i.startContainer.querySelector("."+He+"."+ti));else if(i.startContainer.querySelector("."+He+"."+ft))S(i.startContainer.querySelector("."+He+"."+ft));else if(i.startContainer.classList.contains("e-img-wrap")&&T(i.startContainer,"."+He)){var v=i.startContainer.parentElement.parentElement;if(S(T(i.startContainer,"."+He)),v&&v.textContent.trim()===""){var y=this.parent.createElement("br");y.classList.add("e-rte-image-remove-focus"),v.appendChild(y)}}}}break;case"insert-image":h(this.parent.formatter.editorManager.nodeSelection)||(n=this.parent.formatter.editorManager.nodeSelection.save(i,this.parent.contentModule.getDocument())),this.openDialog(!0,e,n,r,s),e.preventDefault();break}e.ctrlKey&&e.key==="a"&&this.handleSelectAll()},o.prototype.handleSelectAll=function(){this.cancelResizeAction();var t=this.parent.inputElement.querySelectorAll("."+gn);O(t,gn)},o.prototype.openDialog=function(t,e,i,n,r){var s,a,l,c;!t&&!h(this.parent.formatter.editorManager.nodeSelection)?(s=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),a=this.parent.formatter.editorManager.nodeSelection.save(s,this.parent.contentModule.getDocument()),l=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(s),c=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(s)):(a=i,l=n,c=r),this.parent.editorMode==="HTML"?this.insertImage({args:{item:{command:"Images",subCommand:"Image"},originalEvent:e,name:t?null:"showDialog"},selectNode:l,selection:a,selectParent:c}):this.insertImage({args:{item:{command:"Images",subCommand:"Image"},originalEvent:e,name:t?null:"showDialog"},member:"image",text:this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()),module:"Markdown",name:"insertImage"})},o.prototype.showDialog=function(){this.openDialog(!1),this.setCssClass({cssClass:this.parent.getCssClass()})},o.prototype.closeDialog=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},o.prototype.onKeyUp=function(t){if(!h(this.deletedImg)&&this.deletedImg.length>0)for(var e=0;e<this.deletedImg.length;e++){var i={element:this.deletedImg[e],src:this.deletedImg[e].getAttribute("src")};this.parent.trigger(Js,i)}},o.prototype.checkImageBack=function(t){t.startContainer.nodeName==="#text"&&t.startOffset===0&&!h(t.startContainer.previousSibling)&&t.startContainer.previousSibling.nodeName==="IMG"?this.deletedImg.push(t.startContainer.previousSibling):t.startContainer.nodeName!=="#text"&&!h(t.startContainer.childNodes[t.startOffset-1])&&t.startContainer.childNodes[t.startOffset-1].nodeName==="IMG"&&this.deletedImg.push(t.startContainer.childNodes[t.startOffset-1])},o.prototype.checkImageDel=function(t){t.startContainer.nodeName==="#text"&&t.startOffset===t.startContainer.textContent.length&&!h(t.startContainer.nextSibling)&&t.startContainer.nextSibling.nodeName==="IMG"?this.deletedImg.push(t.startContainer.nextSibling):t.startContainer.nodeName!=="#text"&&!h(t.startContainer.childNodes[t.startOffset])&&t.startContainer.childNodes[t.startOffset].nodeName==="IMG"&&this.deletedImg.push(t.startContainer.childNodes[t.startOffset])},o.prototype.alignmentSelect=function(t){var e=t.item;if(!(!document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))||e.command!=="Images")){var i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),n=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(i);n=n[0].nodeName==="IMG"?n:[this.imgEle];var r={args:t,selectNode:n};switch(this.parent.formatter.getUndoRedoStack().length===0&&this.parent.formatter.saveData(),e.subCommand){case"JustifyLeft":this.alignImage(r,"JustifyLeft");break;case"JustifyCenter":this.alignImage(r,"JustifyCenter");break;case"JustifyRight":this.alignImage(r,"JustifyRight");break;case"Inline":this.inline(r);break;case"Break":this.break(r);break}this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),O([n[0]],"e-img-focus")),this.cancelResizeAction()}},o.prototype.imageWithLinkQTBarItemUpdate=function(){for(var t=this.quickToolObj.imageQTBar.toolbarElement.querySelectorAll(".e-toolbar-item"),e=0;e<t.length;e++)t[e].getAttribute("title")===this.i10n.getConstant("openLink")||t[e].getAttribute("title")===this.i10n.getConstant("editLink")||t[e].getAttribute("title")===this.i10n.getConstant("removeLink")?(x([t[e]],"e-link-groups"),t[e].style.display="none"):t[e].getAttribute("title")==="Insert Link"?t[e].style.display="":t[e].classList.contains("e-rte-horizontal-separator")&&(t[e],S(t[e]));var i=this.quickToolObj.imageQTBar.toolbarElement.querySelectorAll(".e-toolbar-item:not(.e-link-groups)");this.quickToolObj.imageQTBar.addQTBarItem(["-"],Math.round(i.length/2))},o.prototype.showImageQuickToolbar=function(t){var e=this;if(!(t.type!=="Images"||h(this.parent.quickToolbarModule)||h(this.parent.quickToolbarModule.imageQTBar)||h(t.args))){this.quickToolObj=this.parent.quickToolbarModule;var i=t.args,n=t.elements;[].forEach.call(t.elements,function(a,l){l===0&&(n=a)}),n&&!T(n,"a")&&this.imageWithLinkQTBarItemUpdate(),n.nodeName==="IMG"&&x([n],["e-img-focus"]);var r=this.parent.iframeSettings.enable?window.pageYOffset+this.parent.element.getBoundingClientRect().top+i.clientY:i.pageY;if(this.parent.quickToolbarModule.imageQTBar)if(t.isNotify)setTimeout(function(){e.parent.formatter.editorManager.nodeSelection.Clear(e.contentModule.getDocument()),e.parent.formatter.editorManager.nodeSelection.setSelectionContents(e.contentModule.getDocument(),n),e.quickToolObj.imageQTBar.showPopup(i.pageX,r,n),e.resizeStart(t.args,n)},400);else{var s=n.getBoundingClientRect();this.quickToolObj.imageQTBar.showPopup(s.left,s.top,n,"Image")}}},o.prototype.hideImageQuickToolbar=function(){h(this.contentModule.getEditPanel().querySelector(".e-img-focus"))||(O([this.contentModule.getEditPanel().querySelector(".e-img-focus")],"e-img-focus"),this.quickToolObj&&this.quickToolObj.imageQTBar&&document.body.contains(this.quickToolObj.imageQTBar.element)&&this.quickToolObj.imageQTBar.hidePopup())},o.prototype.editAreaClickHandler=function(t){if(this.parent.readonly){this.hideImageQuickToolbar();return}var e=t.args,i=this.parent.quickToolbarSettings.showOnRightClick;if(e.which===2||i&&e.which===1||!i&&e.which===3){i&&e.which===1&&!h(e.target)&&e.target.tagName==="IMG"&&(this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(),e.target));return}if(this.parent.editorMode==="HTML"&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.imageQTBar){this.quickToolObj=this.parent.quickToolbarModule;var n=e.target;this.contentModule=this.rendererFactory.getRenderer(U.Content);var r=this.quickToolObj.imageQTBar.element.classList.contains("e-rte-pop");if(n.nodeName==="IMG"&&this.parent.quickToolbarModule){if(r)return;this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(),n),De()&&this.parent.notify(nt,t),x([n],"e-img-focus");var s=this.quickToolObj.imageQTBar.toolbarElement.querySelectorAll(".e-toolbar-item");if(T(n,"a")){for(var a=0;a<s.length;a++)s[a].getAttribute("title")===this.i10n.getConstant("openLink")||s[a].getAttribute("title")===this.i10n.getConstant("editLink")||s[a].getAttribute("title")===this.i10n.getConstant("removeLink")?(s[a].style.display="",O([s[a]],"e-link-groups")):s[a].getAttribute("title")==="Insert Link"?s[a].style.display="none":s[a].classList.contains("e-rte-horizontal-separator")&&(s[a],S(s[a]));var l=this.quickToolObj.imageQTBar.toolbarElement.querySelectorAll(".e-toolbar-item:not(.e-link-groups)");this.quickToolObj.imageQTBar.addQTBarItem(["-"],Math.round(l.length/2))}else T(n,"a")||this.imageWithLinkQTBarItemUpdate();this.showImageQuickToolbar({args:e,type:"Images",elements:[e.target]})}else this.hideImageQuickToolbar()}},o.prototype.insertImgLink=function(t,e){var i=this;if(t.selectNode[0].nodeName==="IMG"&&(this.imagDialog(t),!h(this.dialogObj))){var n=this.parent.createElement("div",{className:"e-img-linkwrap"+this.parent.getCssClass(!0)}),r=this.i10n.getConstant("linkurl"),s='<div class="e-rte-field'+this.parent.getCssClass(!0)+'"><input type="text" data-role ="none" class="e-input e-img-link'+this.parent.getCssClass(!0)+'" spellcheck="false" placeholder="'+r+'"/></div><div class="e-rte-label"></div><div class="e-rte-field"><input type="checkbox" class="e-rte-linkTarget'+this.parent.getCssClass(!0)+'"  data-role ="none"></div>',a=On(s);n.appendChild(a);var l=n.querySelector(".e-rte-linkTarget"),c=n.querySelector(".e-img-link"),p=this.i10n.getConstant("linkOpenInNewWindow");this.checkBoxObj=new oa({label:p,checked:!0,enableRtl:this.parent.enableRtl,cssClass:this.parent.getCssClass(),change:function(v){v.checked?d="_blank":d=null}}),this.checkBoxObj.isStringTemplate=!0,this.checkBoxObj.createElement=this.parent.createElement,this.checkBoxObj.appendTo(l);var d=this.checkBoxObj.checked?"_blank":null,u=this.checkBoxObj.checked?this.i10n.getConstant("ImageLinkAriaLabel"):null,f=this.i10n.getConstant("dialogUpdate"),m={args:t.args,selfImage:this,selection:t.selection,selectNode:t.selectNode,selectParent:t.selectParent,link:c,target:d,ariaLabel:u};this.dialogObj.setProperties({height:"inherit",width:"290px",header:this.parent.localeObj.getConstant("imageInsertLinkHeader"),content:n,buttons:[{click:function(v){i.insertlink(m)},buttonModel:{content:f,cssClass:"e-flat e-update-link"+this.parent.getCssClass(!0),isPrimary:!0}}],cssClass:this.dialogObj.cssClass+" e-rte-img-link-dialog"}),h(this.parent.cssClass)||this.dialogObj.setProperties({cssClass:this.parent.cssClass}),h(e)||(c.value=e.url,e.target?this.checkBoxObj.checked=!0:this.checkBoxObj.checked=!1,this.dialogObj.header=e.header),this.dialogObj.element.style.maxHeight="inherit",this.dialogObj.content.querySelector("input").focus()}},o.prototype.insertAltText=function(t){var e=this;if(t.selectNode[0].nodeName==="IMG"){this.imagDialog(t);var i=this.i10n.getConstant("altText");if(!h(this.dialogObj)){var n=this.parent.createElement("div",{className:"e-img-altwrap"+this.parent.getCssClass(!0)}),r=this.i10n.getConstant("alternateHeader"),s=this.i10n.getConstant("dialogUpdate"),a=t.selectNode[0].getAttribute("alt")===null?"":t.selectNode[0].getAttribute("alt"),l='<div class="e-rte-field'+this.parent.getCssClass(!0)+'"><input type="text" spellcheck="false"  class="e-input e-img-alt'+this.parent.getCssClass(!0)+'" placeholder="'+i+'"/></div>',c=On(l);c.querySelector("input").setAttribute("value",a),n.appendChild(c);var p=n.querySelector(".e-img-alt"),d={args:t.args,selfImage:this,selection:t.selection,selectNode:t.selectNode,alt:p};this.dialogObj.setProperties({height:"inherit",width:"290px",header:r,content:n,buttons:[{click:function(u){e.insertAlt(d)},buttonModel:{content:s,cssClass:"e-flat e-update-alt"+this.parent.getCssClass(!0),isPrimary:!0}}],cssClass:this.dialogObj.cssClass+" e-rte-img-alt-dialog"}),h(this.parent.cssClass)||this.dialogObj.setProperties({cssClass:this.parent.cssClass}),this.dialogObj.element.style.maxHeight="inherit",this.dialogObj.content.querySelector("input").focus()}}},o.prototype.insertAlt=function(t){if(!h(t.alt)){t.selection.restore(),this.parent.formatter.getUndoRedoStack().length===0&&this.parent.formatter.saveData();var e=t.alt.value;this.parent.formatter.process(this.parent,t.args,t.args,{altText:e,selectNode:t.selectNode,subCommand:t.args.item.subCommand}),this.dialogObj.hide({returnValue:!1})}},o.prototype.insertlink=function(t){if(t.selectNode[0].nodeName==="IMG"){var e=t.link.value;if(e===""){x([t.link],"e-error"),t.link.setSelectionRange(0,e.length),t.link.focus();return}this.isUrl(e)?O([t.link],"e-error"):e="http://"+e;var i=t.selfImage;if(i.parent.editorMode==="HTML"&&t.selection.restore(),i.parent.formatter.getUndoRedoStack().length===0&&i.parent.formatter.saveData(),t.selectNode[0].parentElement.nodeName==="A"){i.parent.formatter.process(i.parent,t.args,t.args,{url:e,target:i.checkBoxObj.checked?"_blank":null,ariaLabel:i.checkBoxObj.checked?this.i10n.getConstant("ImageLinkAriaLabel"):null,selectNode:t.selectNode,subCommand:t.args.item.subCommand}),i.dialogObj.hide({returnValue:!0});return}i.parent.formatter.process(i.parent,t.args,t.args,{url:e,target:i.checkBoxObj.checked?"_blank":null,ariaLabel:i.checkBoxObj.checked?this.i10n.getConstant("ImageLinkAriaLabel"):null,selectNode:t.selectNode,subCommand:t.args.item.subCommand,selection:t.selection});var n=T(t.selectNode[0],".e-img-caption");n&&A(".e-img-inner",n).focus(),n&&A(".e-img-inner",n).focus(),i.dialogObj.hide({returnValue:!1})}},o.prototype.isUrl=function(t){var e=/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi;return e.test(t)},o.prototype.deleteImg=function(t,e){if(t.selectNode[0].nodeName==="IMG"){var i={element:t.selectNode[0],src:t.selectNode[0].getAttribute("src")};this.parent.formatter.getUndoRedoStack().length===0&&this.parent.formatter.saveData(),t.selection.restore(),this.contentModule.getEditPanel().querySelector(".e-img-resize")&&this.removeResizeEle(),this.parent.formatter.process(this.parent,t.args,t.args,{selectNode:t.selectNode,captionClass:He,subCommand:t.args.item.subCommand}),this.imageRemovePost(i.src),this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&this.quickToolObj.imageQTBar.hidePopup(),this.cancelResizeAction(),h(e)&&this.parent.trigger(Js,i)}},o.prototype.imageRemovePost=function(t){var e=this,i="";if(!(h(this.parent.insertImageSettings.removeUrl)||this.parent.insertImageSettings.removeUrl==="")){t.indexOf("http://")>-1||t.indexOf("https://")>-1?i=t:i=new URL(t,document.baseURI).href,this.removingImgName=i.replace(/^.*[\\/]/,"");var n=new XMLHttpRequest;n.addEventListener("readystatechange",function(){this.readyState===4&&this.status===200&&e.triggerPost(this.response)}),n.open("GET",i),n.responseType="blob",n.send()}},o.prototype.triggerPost=function(t){var e=this.parent.insertImageSettings.removeUrl;if(!(h(e)||e==="")){var i=new File([t],this.removingImgName),n=new Ut(e,"POST",!0,null),r=new FormData;r.append("UploadFiles",i),n.send(r)}},o.prototype.caption=function(t){var e=t.selectNode[0];if(e.nodeName==="IMG"){t.selection.restore(),this.parent.formatter.getUndoRedoStack().length===0&&this.parent.formatter.saveData(),this.cancelResizeAction(),x([e],"e-rte-image");var i=t.args.item?t.args.item.subCommand:"Caption";if(!h(T(e,"."+He)))S(T(e,"."+He)),D.isIE&&(this.contentModule.getEditPanel().focus(),t.selection.restore()),e.parentElement.tagName==="A"?this.parent.formatter.process(this.parent,t.args,t.args,{insertElement:e.parentElement,selectNode:t.selectNode,subCommand:i}):this.parent.formatter.process(this.parent,t.args,t.args,{insertElement:e,selectNode:t.selectNode,subCommand:i});else{this.captionEle=this.parent.createElement("span",{className:He+" "+vh+this.parent.getCssClass(!0),attrs:{contenteditable:"false",draggable:"false",style:"width:"+this.parent.insertImageSettings.width}});var n=this.parent.createElement("span",{className:"e-img-wrap"+this.parent.getCssClass(!0)}),r=this.parent.createElement("span",{className:"e-img-inner"+this.parent.getCssClass(!0),attrs:{contenteditable:"true"}}),s=t.selectNode[0].parentElement;s.tagName==="A"&&s.setAttribute("contenteditable","true"),n.appendChild(s.tagName==="A"?s:t.selectNode[0]),n.appendChild(r);var a=this.i10n.getConstant("imageCaption");r.innerHTML=a,this.captionEle.appendChild(n),e.classList.contains(kt)&&x([this.captionEle],ti),e.classList.contains(ft)&&x([this.captionEle],ft),e.classList.contains(fo)&&x([this.captionEle],fo),e.classList.contains(uo)&&x([this.captionEle],uo),e.classList.contains(mo)&&x([this.captionEle],mo),this.parent.formatter.process(this.parent,t.args,t.args,{insertElement:this.captionEle,selectNode:t.selectNode,subCommand:i}),this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),r.childNodes[0],r.childNodes[0],0,r.childNodes[0].textContent.length)}this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),O([e],"e-img-focus"))}},o.prototype.imageSize=function(t){var e=this;if(t.selectNode[0].nodeName==="IMG"&&(this.imagDialog(t),!h(this.dialogObj))){var i=this.i10n.getConstant("imageSizeHeader"),n=this.i10n.getConstant("dialogUpdate"),r=this.imgsizeInput(t),s={args:t.args,selfImage:this,selection:t.selection,selectNode:t.selectNode};this.dialogObj.setProperties({height:D.isDevice?"300px":"inherit",width:"290px",header:i,content:r,buttons:[{click:function(a){e.insertSize(s)},buttonModel:{content:n,cssClass:"e-flat e-update-size"+this.parent.getCssClass(!0),isPrimary:!0}}],cssClass:this.dialogObj.cssClass+" e-rte-img-size-dialog"}),h(this.parent.cssClass)||this.dialogObj.setProperties({cssClass:this.parent.cssClass}),this.dialogObj.element.style.maxHeight="inherit",this.dialogObj.content.querySelector("input").focus()}},o.prototype.break=function(t){if(t.selectNode[0].nodeName==="IMG"){var e=t.args.item?t.args.item.subCommand:"Break";this.parent.formatter.process(this.parent,t.args,t.args,{selectNode:t.selectNode,subCommand:e})}},o.prototype.inline=function(t){if(t.selectNode[0].nodeName==="IMG"){var e=t.args.item?t.args.item.subCommand:"Inline";this.parent.formatter.process(this.parent,t.args,t.args,{selectNode:t.selectNode,subCommand:e})}},o.prototype.alignImage=function(t,e){var i=t.args.item?t.args.item.subCommand:e;this.parent.formatter.process(this.parent,t.args,t.args,{selectNode:t.selectNode,subCommand:i})},o.prototype.clearDialogObj=function(){this.dialogObj&&(this.dialogObj.destroy(),S(this.dialogObj.element),this.dialogObj=null)},o.prototype.imagDialog=function(t){var e=this;if(this.dialogObj){this.dialogObj.hide({returnValue:!0});return}var i=this.parent.createElement("div",{className:"e-rte-img-dialog"+this.parent.getCssClass(!0),id:this.rteID+"_image"});this.parent.element.appendChild(i);var n=this.i10n.getConstant("dialogInsert"),r=this.i10n.getConstant("dialogCancel"),s=this.i10n.getConstant("imageHeader"),a=t.selection,l={selfImage:this,selection:t.selection,args:t.args,selectParent:t.selectParent},c={header:s,cssClass:Ce+this.parent.getCssClass(!0),enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:D.isDevice?"290px":"340px",isModal:D.isDevice,buttons:[{click:this.insertImageUrl.bind(l),buttonModel:{content:n,cssClass:"e-flat e-insertImage"+this.parent.getCssClass(!0),isPrimary:!0,disabled:this.parent.editorMode!=="Markdown"}},{click:function(f){e.cancelDialog(f)},buttonModel:{cssClass:"e-flat e-cancel"+this.parent.getCssClass(!0),content:r}}],target:D.isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:function(f){e.isImgUploaded&&e.uploadObj.removing(),e.parent.isBlur=!1,f&&f.event.returnValue&&(e.parent.editorMode==="HTML"?a.restore():e.parent.formatter.editorManager.markdownSelection.restore(e.parent.contentModule.getEditPanel())),e.dialogObj.destroy(),S(e.dialogObj.element),e.dialogRenderObj.close(f),e.dialogObj=null}},p=this.parent.createElement("div",{className:"e-img-content"+this.parent.getCssClass(!0)});(!h(this.parent.insertImageSettings.path)&&this.parent.editorMode==="Markdown"||this.parent.editorMode==="HTML")&&p.appendChild(this.imgUpload(t));var d=this.parent.createElement("div",{className:"e-linkheader"+this.parent.getCssClass(!0)}),u=this.i10n.getConstant("imageLinkHeader");this.parent.editorMode==="HTML"?d.innerHTML=u:d.innerHTML=this.i10n.getConstant("mdimageLink"),p.appendChild(d),p.appendChild(this.imageUrlPopup(t)),t.selectNode&&t.selectNode[0].nodeName==="IMG"&&(c.header=this.parent.localeObj.getConstant("editImageHeader")),c.content=p,this.dialogObj=this.dialogRenderObj.render(c),this.dialogObj.createElement=this.parent.createElement,this.dialogObj.appendTo(i),!h(this.dialogObj)&&(t.selectNode&&t.selectNode[0].nodeName==="IMG"&&t.name==="insertImage"&&(this.dialogObj.element.querySelector(".e-insertImage").textContent=this.parent.localeObj.getConstant("dialogUpdate")),i.style.maxHeight="inherit",this.quickToolObj&&(this.quickToolObj.imageQTBar&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),h(t.selectParent)||O([t.selectParent[0]],"e-img-focus")),this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup(),this.quickToolObj.textQTBar&&this.parent.element.ownerDocument.body.contains(this.quickToolObj.textQTBar.element)&&this.quickToolObj.textQTBar.hidePopup()))},o.prototype.cancelDialog=function(t){this.parent.isBlur=!1,this.dialogObj.hide({returnValue:!0}),this.isImgUploaded&&this.uploadObj.removing()},o.prototype.onDocumentClick=function(t){var e=t.target;if(e.nodeName==="IMG"&&(this.imgEle=e),!!this.parent&&(e.nodeName!=="#document"&&(this.parent.currentTarget=t.target),!h(this.dialogObj)&&(!T(e,"[id='"+this.dialogObj.element.id+"']")&&this.parent.toolbarSettings.enable&&this.parent.getToolbarElement()&&!this.parent.getToolbarElement().contains(t.target)||this.parent.getToolbarElement()&&this.parent.getToolbarElement().contains(t.target)&&!T(e,"#"+this.parent.getID()+"_toolbar_Image")&&!e.querySelector("#"+this.parent.getID()+"_toolbar_Image"))&&(t.offsetX>t.target.clientWidth||t.offsetY>t.target.clientHeight||(this.parent.notify(qn,{closedBy:"outside click"}),this.dialogObj.hide({returnValue:!0}),this.parent.isBlur=!0,Zn(this.parent.element,"focusout"))),!(this.parent.iframeSettings.enable&&!h(this.parent.currentTarget)&&this.parent.currentTarget.nodeName==="IMG")&&t.target.tagName!=="IMG"&&this.imgResizeDiv&&!(this.quickToolObj&&this.quickToolObj.imageQTBar&&this.quickToolObj.imageQTBar.element.contains(t.target))&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&this.cancelResizeAction(),this.contentModule.getEditPanel().querySelector(".e-img-resize")&&!(this.parent.iframeSettings.enable&&this.parent.currentTarget.nodeName==="IMG")&&(e.tagName!=="IMG"&&this.removeResizeEle(),e.tagName!=="IMG"&&!h(this.imgEle)?this.imgEle.style.outline="":!h(this.prevSelectedImgEle)&&this.prevSelectedImgEle!==e&&(this.prevSelectedImgEle.style.outline="")),e.tagName!=="IMG"))for(var i=this.contentModule.getEditPanel().querySelectorAll("img"),n=0;n<i.length;n++)O([i[n]],"e-img-focus"),O([i[n]],"e-resize"),i[n].style.maxWidth=""},o.prototype.removeResizeEle=function(){b.remove(this.contentModule.getDocument(),D.touchMoveEvent,this.resizing),b.remove(this.contentModule.getDocument(),D.touchEndEvent,this.resizeEnd),S(this.contentModule.getEditPanel().querySelector(".e-img-resize"))},o.prototype.onWindowResize=function(){!h(this.contentModule)&&!h(this.contentModule.getEditPanel().querySelector(".e-img-resize"))&&this.cancelResizeAction()},o.prototype.imageUrlPopup=function(t){var e=this,i=this.parent.createElement("div",{className:"imgUrl"+this.parent.getCssClass(!0)}),n=this.i10n.getConstant("imageUrl");if(this.inputUrl=this.parent.createElement("input",{className:"e-input e-img-url"+this.parent.getCssClass(!0),attrs:{placeholder:n,spellcheck:"false","aria-label":this.i10n.getConstant("imageLinkHeader")}}),this.inputUrl.addEventListener("input",function(){h(e.inputUrl)||(e.inputUrl.value.length===0?e.dialogObj.getButtons(0).element.disabled=!0:e.dialogObj.getButtons(0).element.removeAttribute("disabled"))}),t.selectNode&&t.selectNode[0].nodeName==="IMG"){var r=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi);this.inputUrl.value=t.selectNode[0].src.match(r)?t.selectNode[0].src:""}return i.appendChild(this.inputUrl),i},o.prototype.insertImageUrl=function(t){var e=this.selfImage;e.isImgUploaded=!1;var i=e.inputUrl.value;if(e.parent.editorMode==="Markdown"&&i===""&&(i="http://"),e.parent.formatter.getUndoRedoStack().length===0&&e.parent.formatter.saveData(),!h(e.uploadUrl)&&e.uploadUrl.url!=="")e.uploadUrl.cssClass=e.parent.insertImageSettings.display==="inline"?kt:ft,e.dialogObj.hide({returnValue:!1}),e.parent.formatter.process(e.parent,this.args,this.args.originalEvent,e.uploadUrl),e.uploadUrl.url="",e.contentModule.getEditPanel().querySelector(".e-img-resize")&&(e.imgEle.style.outline="",e.removeResizeEle());else if(i!==""){if(e.parent.editorMode==="HTML"&&h(T(this.selection.range.startContainer.parentNode,"[id='"+e.contentModule.getPanel().id+"']"))){e.contentModule.getEditPanel().focus();var n=e.parent.formatter.editorManager.nodeSelection.getRange(e.contentModule.getDocument());this.selection=e.parent.formatter.editorManager.nodeSelection.save(n,e.contentModule.getDocument()),this.selectParent=e.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(n)}var r=/[\w-]+.(jpg|png|jpeg|gif)/g,s=!h(i.match(r))&&e.parent.editorMode==="HTML"?i.match(r)[0]:"",a={cssClass:e.parent.insertImageSettings.display==="inline"?kt:ft,url:i,selection:this.selection,altText:s,selectParent:this.selectParent,width:{width:e.parent.insertImageSettings.width,minWidth:e.parent.insertImageSettings.minWidth,maxWidth:e.parent.getInsertImgMaxWidth()},height:{height:e.parent.insertImageSettings.height,minHeight:e.parent.insertImageSettings.minHeight,maxHeight:e.parent.insertImageSettings.maxHeight}};e.parent.formatter.process(e.parent,this.args,this.args.originalEvent,a),e.dialogObj.hide({returnValue:!1})}},o.prototype.imgsizeInput=function(t){var e=this,i=t.selectNode[0],n=this.i10n.getConstant("imageHeight"),r=this.i10n.getConstant("imageWidth"),s=this.parent.createElement("div",{className:"e-img-sizewrap"+this.parent.getCssClass(!0)}),a=h(this.changedWidthValue)&&(i.style.width.toString()==="auto"||i.style.width!=="")?i.style.width:h(this.changedWidthValue)?parseInt(i.getClientRects()[0].width.toString(),10).toString():this.changedWidthValue,l=h(this.changedHeightValue)&&(i.style.height.toString()==="auto"||i.style.height!=="")?i.style.height:h(this.changedHeightValue)?parseInt(i.getClientRects()[0].height.toString(),10).toString():this.changedHeightValue;this.changedWidthValue=null,this.changedHeightValue=null;var c='<div class="e-rte-label'+this.parent.getCssClass(!0)+'"><label>'+r+'</label></div><div class="e-rte-field'+this.parent.getCssClass(!0)+'"><input type="text" id="imgwidth" class="e-img-width'+this.parent.getCssClass(!0)+'"/></div><div class="e-rte-label'+this.parent.getCssClass(!0)+'"><label>'+n+'</label></div><div class="e-rte-field'+this.parent.getCssClass(!0)+'"> <input type="text" id="imgheight" class="e-img-height'+this.parent.getCssClass(!0)+'"/></div>',p=On(c);return p.getElementById("imgwidth").setAttribute("value",a),p.getElementById("imgheight").setAttribute("value",l),s.appendChild(p),this.widthNum=new Wo({value:H(a),enableRtl:this.parent.enableRtl,cssClass:this.parent.getCssClass(),input:function(d){e.inputWidthValue=H(e.inputValue(d.value))}}),this.widthNum.createElement=this.parent.createElement,this.widthNum.appendTo(s.querySelector("#imgwidth")),this.heightNum=new Wo({value:H(l),enableRtl:this.parent.enableRtl,cssClass:this.parent.getCssClass(),input:function(d){e.inputHeightValue=H(e.inputValue(d.value))}}),this.heightNum.createElement=this.parent.createElement,this.heightNum.appendTo(s.querySelector("#imgheight")),s},o.prototype.inputValue=function(t){return t==="auto"||t.indexOf("%")!==-1||t.indexOf("px")!==-1||t.match(/(\d+)/)?t:"auto"},o.prototype.insertSize=function(t){t.selection.restore();var e=t.selfImage;e.parent.formatter.getUndoRedoStack().length===0&&e.parent.formatter.saveData();var i=e.dialogObj.element;this.changedWidthValue=this.inputWidthValue,this.changedHeightValue=this.inputHeightValue;var n=i.querySelector(".e-img-width").value,r=i.parentElement.querySelector(".e-img-height").value;e.parent.formatter.process(this.parent,t.args,t.args,{width:n,height:r,selectNode:t.selectNode,subCommand:t.args.item.subCommand}),this.imgResizeDiv&&e.imgResizePos(t.selectNode[0],this.imgResizeDiv),e.dialogObj.hide({returnValue:!0})},o.prototype.insertImage=function(t){if(this.imagDialog(t),!h(this.dialogObj)){this.dialogObj.element.style.maxHeight="inherit";var e=this.dialogObj.element.querySelector(".e-img-content");!h(this.parent.insertImageSettings.path)&&this.parent.editorMode==="Markdown"||this.parent.editorMode==="HTML"?document.getElementById(this.rteID+"_insertImage").focus():e.querySelector(".e-img-url").focus()}},o.prototype.imgUpload=function(t){var e=this,i,n,r=this,s=r.parent.iframeSettings.enable;if(r.parent.editorMode==="HTML"&&(!s&&h(T(t.selection.range.startContainer.parentNode,"[id='"+this.parent.contentModule.getPanel().id+"']"))||s&&!he(t.selection.range.startContainer.parentNode.ownerDocument.querySelector("body"),"e-lib"))){this.contentModule.getEditPanel().focus();var a=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());i=this.parent.formatter.editorManager.nodeSelection.save(a,this.parent.contentModule.getDocument()),n=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(a)}else i=t.selection,n=t.selectParent;var l=this.parent.createElement("div",{className:"e-img-uploadwrap e-droparea"+this.parent.getCssClass(!0)}),c=this.i10n.getConstant("imageDeviceUploadMessage"),p=this.i10n.getConstant("imageUploadMessage"),d=this.parent.createElement("span",{className:"e-droptext"+this.parent.getCssClass(!0)}),u=this.parent.createElement("span",{className:"e-rte-upload-text"+this.parent.getCssClass(!0),innerHTML:D.isDevice?c:p});d.appendChild(u);var f=this.parent.createElement("button",{className:"e-browsebtn"+this.parent.getCssClass(!0),id:this.rteID+"_insertImage",attrs:{autofocus:"true",type:"button"}});d.appendChild(f),l.appendChild(d);var m=this.i10n.getConstant("browse");this.browseButton=new zs({content:m,enableRtl:this.parent.enableRtl}),this.browseButton.isStringTemplate=!0,this.browseButton.createElement=this.parent.createElement,this.browseButton.appendTo(f);var v=D.isDevice?d:f;b.add(v,"click",this.fileSelect,this);var y=this.parent.createElement("input",{id:this.rteID+"_upload",attrs:{type:"File",name:"UploadFiles"},className:this.parent.getCssClass()});l.appendChild(y);var L,C;return this.uploadObj=new Io({asyncSettings:{saveUrl:this.parent.insertImageSettings.saveUrl,removeUrl:this.parent.insertImageSettings.removeUrl},dropArea:d,multiple:!1,enableRtl:this.parent.enableRtl,cssClass:this.parent.getCssClass(),allowedExtensions:this.parent.insertImageSettings.allowedTypes.toString(),selected:function(w){r.isImgUploaded=!0,C=w,w.filesData,e.parent.trigger(Jl,C,function(k){if(!k.cancel&&(e.checkExtension(k.filesData[0]),L=k.filesData[0].name,e.parent.editorMode==="HTML"&&h(e.parent.insertImageSettings.path))){var I=new FileReader;I.addEventListener("load",function(P){var Z=e.parent.insertImageSettings.saveFormat==="Base64"?I.result:URL.createObjectURL(wr(I.result));r.uploadUrl={url:Z,selection:i,altText:L,selectParent:n,width:{width:r.parent.insertImageSettings.width,minWidth:r.parent.insertImageSettings.minWidth,maxWidth:r.parent.getInsertImgMaxWidth()},height:{height:r.parent.insertImageSettings.height,minHeight:r.parent.insertImageSettings.minHeight,maxHeight:r.parent.insertImageSettings.maxHeight}},r.inputUrl.setAttribute("disabled","true"),h(r.parent.insertImageSettings.saveUrl)&&e.isAllowedTypes&&!h(e.dialogObj)&&e.dialogObj.getButtons(0).element.removeAttribute("disabled")}),I.readAsDataURL(k.filesData[0].rawFile)}})},beforeUpload:function(w){e.parent.trigger(Zs,w)},uploading:function(w){e.parent.isServerRendered||e.parent.trigger(Xs,w)},success:function(w){e.parent.trigger(Ys,w,function(k){if(!h(e.parent.insertImageSettings.path)){var I=e.parent.insertImageSettings.path+k.file.name;r.uploadUrl={url:I,selection:i,altText:L,selectParent:n,width:{width:r.parent.insertImageSettings.width,minWidth:r.parent.insertImageSettings.minWidth,maxWidth:r.parent.getInsertImgMaxWidth()},height:{height:r.parent.insertImageSettings.height,minHeight:r.parent.insertImageSettings.minHeight,maxHeight:r.parent.insertImageSettings.maxHeight}},r.inputUrl.setAttribute("disabled","true")}k.operation==="upload"&&!h(e.dialogObj)&&e.dialogObj.getButtons(0).element.removeAttribute("disabled")})},failure:function(w){e.parent.trigger($s,w)},removing:function(w){e.parent.trigger(Zl,w,function(k){r.isImgUploaded=!1,e.dialogObj.getButtons(0).element.disabled=!0,r.inputUrl.removeAttribute("disabled"),r.uploadUrl&&(r.uploadUrl.url="")})}}),this.uploadObj.isStringTemplate=!0,this.uploadObj.createElement=this.parent.createElement,this.uploadObj.appendTo(y),l},o.prototype.checkExtension=function(t){this.uploadObj.allowedExtensions&&(this.uploadObj.allowedExtensions.toLocaleLowerCase().indexOf(("."+t.type).toLocaleLowerCase())===-1?(this.dialogObj.getButtons(0).element.setAttribute("disabled","disabled"),this.isAllowedTypes=!1):this.isAllowedTypes=!0)},o.prototype.fileSelect=function(){return this.dialogObj.element.getElementsByClassName("e-file-select-wrap")[0].querySelector("button").click(),!1},o.prototype.dragStart=function(t){if(t.target.nodeName==="IMG")this.parent.trigger(Ae,t,function(e){e.cancel?t.preventDefault():(t.dataTransfer.effectAllowed="copyMove",t.target.classList.add(ji))});else return!0},o.prototype.dragEnter=function(t){t.dataTransfer.dropEffect="copy",t.preventDefault()},o.prototype.dragOver=function(t){if(D.info.name==="edge"&&t.dataTransfer.items[0].type.split("/")[0].indexOf("image")>-1||D.isIE&&t.dataTransfer.types[0]==="Files")t.preventDefault();else return!0},o.prototype.dragDrop=function(t){var e=this;this.parent.trigger(eh,t,function(i){var n=e.parent.inputElement.ownerDocument.querySelector("."+ji),r=n&&n.tagName==="IMG"||i.dataTransfer.files.length>0;!i.cancel&&r?e.parent.trigger(Ae,i,function(s){if(s.cancel)i.preventDefault();else{if(T(i.target,"#"+e.parent.getID()+"_toolbar")||e.parent.inputElement.contentEditable==="false"){i.preventDefault();return}e.parent.element.querySelector("."+qh)&&S(e.imgResizeDiv),i.preventDefault();var a=void 0;e.contentModule.getDocument().caretRangeFromPoint?a=e.contentModule.getDocument().caretRangeFromPoint(i.clientX,i.clientY):i.rangeParent?(a=e.contentModule.getDocument().createRange(),a.setStart(i.rangeParent,i.rangeOffset)):a=e.getDropRange(i.clientX,i.clientY),e.parent.notify(zn,{range:a});var l=e.parent.element.querySelector("."+Vh);if(l)return;e.insertDragImage(i)}}):r&&i.preventDefault()})},o.prototype.getDropRange=function(t,e){var i=this.contentModule.getDocument().createRange();this.parent.formatter.editorManager.nodeSelection.setRange(this.contentModule.getDocument(),i);var n=this.contentModule.getDocument().elementFromPoint(t,e),r=n.childNodes.length>0?n.childNodes[0]:n,s=0;if(this.parent.inputElement.firstChild.innerHTML==="<br>")i.setStart(r,s),i.setEnd(r,s);else{var a=void 0;do s++,i.setStart(r,s),i.setEnd(r,s+1),a=i.getBoundingClientRect();while(a.left<t&&s<r.length-1)}return i},o.prototype.insertDragImage=function(t){var e=this;t.preventDefault();var i=this.parent.element.querySelector(""+yo);this.parent.notify(gs,{args:t}),i&&i.classList.add(ui);var n=this.parent.inputElement.ownerDocument.querySelector("."+ji);if(t.dataTransfer.files.length>0&&n===null){if(t.dataTransfer.files.length>1)return;for(var r=t.dataTransfer.files,s=r[0].name,a=s.substring(s.lastIndexOf(".")),l=this.parent.insertImageSettings.allowedTypes,c=0;c<l.length;c++)if(a.toLocaleLowerCase()===l[c].toLowerCase())if(this.parent.insertImageSettings.saveUrl)this.onSelect(t);else{var p={args:t,text:"",file:r[0]};t.preventDefault(),this.imagePaste(p)}}else{var d=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());if(n&&n.tagName==="IMG"){n.nextElementSibling&&n.nextElementSibling.classList.contains(Uh)?d.insertNode(n.parentElement.parentElement):d.insertNode(n),n.classList.remove(ji);var u={elements:[n]};n.addEventListener("load",function(){e.parent.trigger(Ge,u)}),this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument());var p=t;this.resizeStart(p,n),this.hideImageQuickToolbar()}}},o.prototype.onSelect=function(t){var e=this,i=this,n=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),r=this.parent.createElement("ul",{className:jh});this.parent.element.appendChild(r);var s={name:"",size:0,status:"",statusCode:"",type:"",rawFile:t.dataTransfer.files[0],validationMessages:{}},a=this.parent.createElement("IMG");a.style.opacity="0.5",a.classList.add(Ds),a.classList.add(kt),a.classList.add(Ih);var l=s.rawFile,c=new FileReader;c.addEventListener("load",function(){var d=URL.createObjectURL(wr(c.result));a.src=i.parent.insertImageSettings.saveFormat==="Blob"?d:c.result}),l&&c.readAsDataURL(l),n.insertNode(a),this.uploadMethod(t,a);var p={elements:[a]};a.addEventListener("load",function(){e.parent.trigger(Ge,p)}),S(r)},o.prototype.uploadMethod=function(t,e){var i=this,n=!1,r=this,s=this.parent.createElement("div");this.parent.element.appendChild(s);var a=this.parent.createElement("input",{id:this.rteID+"_upload",attrs:{type:"File",name:"UploadFiles"}}),l=this.parent.iframeSettings.enable?-50:-90;this.popupObj=new Hi(s,{relateTo:e,height:"85px",width:"300px",offsetY:l,content:a,viewPortElement:this.parent.element,position:{X:"center",Y:"top"},enableRtl:this.parent.enableRtl,zIndex:10001,close:function(d){i.parent.isBlur=!1,i.popupObj.destroy(),S(i.popupObj.element),i.popupObj=null,i.parent.inlineMode.enable||i.parent.toolbarModule.baseToolbar.toolbarObj.disable(!1)}}),this.popupObj.element.style.display="none",x([this.popupObj.element],yo),x([this.popupObj.element],zh),h(this.parent.cssClass)||x([this.popupObj.element],this.parent.cssClass);var c=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),p=t.dataTransfer.files[0].size>1e6?300:100;setTimeout(function(){r.refreshPopup(e)},p),this.uploadObj=new Io({asyncSettings:{saveUrl:this.parent.insertImageSettings.saveUrl,removeUrl:this.parent.insertImageSettings.removeUrl},cssClass:_h+this.parent.getCssClass(!0),dropArea:this.parent.element,allowedExtensions:this.parent.insertImageSettings.allowedTypes.toString(),removing:function(){i.parent.inputElement.contentEditable="true",n=!1,S(e),i.popupObj.close()},canceling:function(){i.parent.inputElement.contentEditable="true",n=!1,S(e),i.popupObj.close(),i.quickToolObj.imageQTBar.hidePopup(),setTimeout(function(){i.uploadObj.destroy()},900)},beforeUpload:function(d){i.parent.trigger(Zs,d),i.parent.inlineMode.enable||i.parent.toolbarModule.baseToolbar.toolbarObj.disable(!0)},uploading:function(d){i.parent.isServerRendered||(n=!0,i.parent.trigger(Xs,d,function(u){u.cancel?(h(e)||S(e),h(i.popupObj.element)||S(i.popupObj.element)):i.parent.inputElement.contentEditable="false"}))},selected:function(d){n&&(d.cancel=!0)},failure:function(d){n=!1,i.parent.inputElement.contentEditable="true";var u={args:t,type:"Images",isNotify:void 0,elements:e};setTimeout(function(){i.uploadFailure(e,u,d)},900)},success:function(d){if(d.operation!=="cancel"){n=!1,i.parent.inputElement.contentEditable="true";var u={args:t,type:"Images",isNotify:void 0,elements:e};setTimeout(function(){i.uploadSuccess(e,t,u,d)},900)}}}),this.uploadObj.appendTo(this.popupObj.element.childNodes[0]),this.popupObj.element.querySelector(".e-rte-dialog-upload .e-file-select-wrap").style.display="none",c.selectNodeContents(e),this.parent.formatter.editorManager.nodeSelection.setRange(this.contentModule.getDocument(),c)},o.prototype.refreshPopup=function(t){var e=this.parent.iframeSettings.enable?this.parent.element.offsetTop+t.offsetTop:t.offsetTop,i=this.parent.element.offsetTop+this.parent.element.offsetHeight;e>i?(this.popupObj.relateTo=this.parent.inputElement,this.popupObj.offsetY=this.parent.iframeSettings.enable?-30:-65,this.popupObj.element.style.display="block"):this.popupObj&&(this.popupObj.refreshPosition(t),this.popupObj.element.style.display="block")},o.prototype.uploadFailure=function(t,e,i){S(t),this.popupObj&&this.popupObj.close(),this.parent.trigger($s,i),this.uploadObj.destroy()},o.prototype.uploadSuccess=function(t,e,i,n){var r=this;t.style.opacity="1",t.classList.add(gn),n.element=t,this.parent.trigger(Ys,n,function(s){if(!h(r.parent.insertImageSettings.path)){var a=r.parent.insertImageSettings.path+s.file.name;t.src=a,t.setAttribute("alt",s.file.name)}}),this.popupObj&&(this.popupObj.close(),this.uploadObj.destroy()),this.showImageQuickToolbar(i),this.resizeStart(e,t)},o.prototype.imagePaste=function(t){var e=this;if(t.text.length===0&&!h(t.file)){var i=this,n=new FileReader;t.args.preventDefault(),n.addEventListener("load",function(r){var s={cssClass:i.parent.insertImageSettings.display==="inline"?kt:ft,url:e.parent.insertImageSettings.saveFormat==="Base64"||!h(t.callBack)?n.result:URL.createObjectURL(wr(n.result)),width:{width:i.parent.insertImageSettings.width,minWidth:i.parent.insertImageSettings.minWidth,maxWidth:i.parent.getInsertImgMaxWidth()},height:{height:i.parent.insertImageSettings.height,minHeight:i.parent.insertImageSettings.minHeight,maxHeight:i.parent.insertImageSettings.maxHeight}};if(h(t.callBack))i.parent.formatter.process(i.parent,{item:{command:"Images",subCommand:"Image"}},t.args,s),e.showPopupToolBar(t,s);else{t.callBack(s);return}}),n.readAsDataURL(t.file)}},o.prototype.showPopupToolBar=function(t,e){var i=this,n='img[src="'+e.url+'"]',r=this.parent.inputElement.querySelector(n);this.parent.quickToolbarModule.createQTBar("Image","MultiRow",this.parent.quickToolbarSettings.image,U.ImageToolbar);var s={args:t.args,type:"Images",isNotify:void 0,elements:r};r&&setTimeout(function(){i.showImageQuickToolbar(s),i.resizeStart(t.args,r)},0)},o.prototype.destroy=function(){h(this.parent)||(this.prevSelectedImgEle=void 0,this.removeEventListener())},o.prototype.moduleDestroy=function(){this.parent=null},o.prototype.getModuleName=function(){return"image"},o}(),ud=function(){function o(t,e){this.parent=t;var i=e;this.rendererFactory=i.getService("rendererFactory"),this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(Gt,this.sourceCode,this),this.parent.on(Me,this.onInitialEnd,this),this.parent.on(xi,this.updateSourceCode,this),this.parent.on(j,this.destroy,this),this.parent.on(fe,this.moduleDestroy,this)},o.prototype.onInitialEnd=function(){this.parent.formatter.editorManager.observer.on(Oe,this.onKeyDown,this)},o.prototype.removeEventListener=function(){this.unWireEvent(),this.parent.off(Gt,this.sourceCode),this.parent.off(xi,this.updateSourceCode),this.parent.off(Me,this.onInitialEnd),this.parent.off(j,this.destroy),this.parent.off(fe,this.moduleDestroy),this.parent.formatter.editorManager.observer.off(Oe,this.onKeyDown)},o.prototype.getSourceCode=function(){return this.parent.createElement("textarea",{className:bt+this.parent.getCssClass(!0)})},o.prototype.wireEvent=function(t){this.keyboardModule=new Rs(t,{keyAction:this.previewKeyDown.bind(this),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"}),b.add(this.previewElement,"mousedown",this.mouseDownHandler,this)},o.prototype.unWireEvent=function(){this.keyboardModule&&this.keyboardModule.destroy(),this.previewElement&&b.remove(this.previewElement,"mousedown",this.mouseDownHandler)},o.prototype.wireBaseKeyDown=function(){this.parent.keyboardModule=new Rs(this.contentModule.getEditPanel(),{keyAction:this.parent.keyDown.bind(this.parent),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"})},o.prototype.unWireBaseKeyDown=function(){this.parent.keyboardModule.destroy()},o.prototype.mouseDownHandler=function(t){this.parent.notify(Di,{args:t})},o.prototype.previewKeyDown=function(t){switch(t.action){case"html-source":this.updateSourceCode(t),t.preventDefault();break;case"toolbar-focus":if(this.parent.toolbarSettings.enable&&this.parent.getToolbarElement()){var e=this.parent.getToolbarElement().querySelector(".e-toolbar-item:not(.e-overlay)[title]");e.firstElementChild.removeAttribute("tabindex"),e.firstElementChild.focus()}break}},o.prototype.onKeyDown=function(t){switch(t.event.action){case"html-source":t.event.preventDefault(),this.sourceCode(t),t.callBack({requestType:"SourceCode",editorMode:"HTML",event:t.event});break}},o.prototype.sourceCode=function(t){var e=this;this.parent.notify(Es,{}),this.parent.isBlur=!1,this.parent.trigger(Ae,{requestType:"SourceCode",targetItem:"SourceCode",args:t});var i=Te("."+gt,this.parent.element);if(this.contentModule=this.rendererFactory.getRenderer(U.Content),this.parent.notify(vi,{targetItem:"SourceCode",updateItem:"Preview",baseToolbar:this.parent.getBaseToolbarObject()}),h(this.previewElement)&&(this.previewElement=this.getSourceCode()),this.parent.updateValueData(),this.parent.iframeSettings.enable){var n=void 0;h(this.parent.element.querySelector("#"+this.parent.getID()+"_source-view"))?n=this.parent.createElement("div",{className:"e-source-content",id:this.parent.getID()+"_source-view"}):n=this.parent.element.querySelector("#"+this.parent.getID()+"_source-view"),n.appendChild(this.previewElement),this.parent.element.appendChild(n),n.style.height=this.contentModule.getPanel().style.height,n.style.marginTop=this.contentModule.getPanel().style.marginTop,this.getPanel().value=this.getTextAreaValue(),this.contentModule.getPanel().style.display="none",n.style.display="block",this.getPanel().style.display="block"}else{var r=this.parent.inputElement.offsetHeight;this.contentModule.getPanel().appendChild(this.previewElement),this.getPanel().value=this.getTextAreaValue(),this.previewElement.style.height=r+"px",this.contentModule.getEditPanel().style.display="none",this.previewElement.style.display="block"}if(this.parent.isBlur=!1,this.parent.disableToolbarItem(this.parent.toolbarSettings.items),this.parent.enableToolbarItem("SourceCode"),this.parent.getToolbar()&&O([this.parent.getToolbar()],[Dt]),O(i,[Wt]),this.parent.setContentHeight("sourceCode",!0),this.wireEvent(this.previewElement),this.unWireBaseKeyDown(),this.previewElement.focus(),this.parent.updateValue(),!h(this.parent.placeholder)&&!this.parent.iframeSettings.enable){var s=this.parent.element.querySelector(".rte-placeholder.e-rte-placeholder");s.style.display="none"}this.parent.trigger(Ge,{requestType:"SourceCode",targetItem:"SourceCode",args:t}),this.parent.invokeChangeEvent(),!h(this.parent.saveInterval)&&this.parent.saveInterval>0&&this.parent.autoSaveOnIdle&&(this.codeViewTimeInterval=setInterval(function(){e.parent.notify(Ls,{})},this.parent.saveInterval))},o.prototype.updateSourceCode=function(t){this.parent.isBlur=!1,this.parent.trigger(Ae,{requestType:"Preview",targetItem:"Preview",args:t});var e=this.getPanel();this.parent.notify(vi,{targetItem:"Preview",updateItem:"SourceCode",baseToolbar:this.parent.getBaseToolbarObject()});var i=this.parent.serializeValue(e.value),n;if(i===null||i===""?this.parent.enterKey==="DIV"?n="<div><br/></div>":this.parent.enterKey==="BR"?n="<br/>":n="<p><br/></p>":n=i,this.parent.iframeSettings.enable?(e.parentElement.style.display="none",e.style.display="none",this.contentModule.getPanel().style.display="block",this.contentModule.getEditPanel().innerHTML=n):(e.style.display="none",this.contentModule.getEditPanel().style.display="block",this.contentModule.getEditPanel().innerHTML=n),this.parent.isBlur=!1,this.parent.enableToolbarItem(this.parent.toolbarSettings.items),this.parent.getToolbar()&&O([this.parent.getToolbar()],[Dt]),this.parent.setContentHeight("preview",!0),this.unWireEvent(),this.wireBaseKeyDown(),this.contentModule.getEditPanel().focus(),this.parent.updateValue(),!h(this.parent.placeholder)&&this.contentModule.getEditPanel().innerText.length===0){var r=this.parent.element.querySelector(".rte-placeholder.e-rte-placeholder");r.style.display="block"}this.parent.trigger(Ge,{requestType:"Preview",targetItem:"Preview",args:t}),this.parent.formatter.enableUndo(this.parent),this.parent.addAudioVideoWrapper(),clearTimeout(this.codeViewTimeInterval),this.parent.invokeChangeEvent(),this.parent.notify(Ei,{})},o.prototype.getTextAreaValue=function(){return this.contentModule.getEditPanel().innerHTML==="<p><br></p>"||this.contentModule.getEditPanel().innerHTML==="<div><br></div>"||this.contentModule.getEditPanel().innerHTML==="<br>"||this.contentModule.getEditPanel().childNodes.length===1&&this.contentModule.getEditPanel().childNodes[0].tagName==="P"&&this.contentModule.getEditPanel().innerHTML.length===7||this.contentModule.getEditPanel().childNodes[0].tagName==="DIV"&&this.contentModule.getEditPanel().innerHTML.length===11?"":this.parent.value},o.prototype.getPanel=function(){return this.parent.element&&this.parent.element.querySelector(".e-rte-srctextarea")},o.prototype.getViewPanel=function(){return this.parent.iframeSettings.enable&&this.getPanel()?this.getPanel().parentElement:this.getPanel()},o.prototype.destroy=function(){h(this.parent)||this.removeEventListener()},o.prototype.moduleDestroy=function(){this.parent=null},o}(),fd=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(fe,this.moduleDestroy,this),this.parent.on(j,this.removeEventListener,this),this.parent.on(qn,this.documentClickClosedBy,this))},o.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(j,this.removeEventListener),this.parent.off(fe,this.moduleDestroy),this.parent.off(qn,this.documentClickClosedBy))},o.prototype.render=function(t){var e;return t.beforeOpen=this.beforeOpen.bind(this),t.open=this.open.bind(this),t.position={X:"center",Y:this.getDialogPosition()},h(t.close)&&(t.close=this.close.bind(this)),t.beforeClose=this.beforeClose.bind(this),e=new bl(t),e.isStringTemplate=!0,e},o.prototype.beforeOpen=function(t){if(t.element.classList.contains("e-dialog")){var e=T(t.target,"form");h(e)||(this.dialogEle=t.element,this.dialogEle.addEventListener("keydown",this.handleEnterKeyDown))}this.parent.trigger(Wl,t,this.beforeOpenCallback.bind(this,t))},o.prototype.handleEnterKeyDown=function(t){t.code==="Enter"&&t.preventDefault()},o.prototype.beforeOpenCallback=function(t){t.cancel&&this.parent.notify(Ni,null)},o.prototype.open=function(t){this.parent.trigger(Ql,t)},o.prototype.documentClickClosedBy=function(t){this.outsideClickClosedBy=t.closedBy},o.prototype.beforeClose=function(t){this.dialogEle&&this.dialogEle.removeEventListener("keydown",this.handleEnterKeyDown),t.closedBy=this.outsideClickClosedBy==="outside click"?this.outsideClickClosedBy:t.closedBy,this.parent.trigger(Gl,t,function(e){e.cancel||e.container.classList.contains("e-popup-close")&&(e.cancel=!0)}),this.outsideClickClosedBy=""},o.prototype.getDialogPosition=function(){var t=this.parent.element.getBoundingClientRect().top;if(t<0){for(var e=0,i=this.parent.element;i.nodeName!=="BODY";){var n=i.getBoundingClientRect().top;n>0&&(e=n),i=i.parentElement}return t=Math.abs(t)+e,t.toString()}else return"top"},o.prototype.close=function(t){this.parent.trigger(Kl,t)},o.prototype.moduleDestroy=function(){this.parent=null},o}(),md={bold:{command:"Style",subCommand:"Bold",value:"strong"},italic:{command:"Style",subCommand:"Italic",value:"em"},underline:{command:"Style",subCommand:"Underline",value:"span"},strikeThrough:{command:"Style",subCommand:"StrikeThrough",value:"span"},insertCode:{command:"Formats",subCommand:"Pre",value:"pre"},superscript:{command:"Effects",subCommand:"SuperScript",value:"sup"},subscript:{command:"Effects",subCommand:"SubScript",value:"sub"},uppercase:{command:"Casing",subCommand:"UpperCase"},lowercase:{command:"Casing",subCommand:"LowerCase"},fontColor:{command:"font",subCommand:"fontcolor",value:"#ff0000"},fontName:{command:"font",subCommand:"fontname",value:"Segoe UI"},fontSize:{command:"font",subCommand:"fontsize",value:"10pt"},backColor:{command:"font",subCommand:"backgroundcolor",value:"#ffff00"},justifyCenter:{command:"Alignments",subCommand:"JustifyCenter"},justifyFull:{command:"Alignments",subCommand:"JustifyFull"},justifyLeft:{command:"Alignments",subCommand:"JustifyLeft"},justifyRight:{command:"Alignments",subCommand:"JustifyRight"},undo:{command:"Actions",subCommand:"Undo"},redo:{command:"Actions",subCommand:"Redo"},createLink:{command:"Links",subCommand:"createLink"},editLink:{command:"Links",subCommand:"createLink"},createImage:{command:"Images",subCommand:"Images"},formatBlock:{command:"Formats",value:"P"},heading:{command:"Formats",value:"H1"},indent:{command:"Indents",subCommand:"Indent"},outdent:{command:"Indents",subCommand:"Outdent"},insertHTML:{command:"InsertHTML",subCommand:"InsertHTML",value:""},insertText:{command:"InsertText",subCommand:"InsertText",value:""},insertHorizontalRule:{command:"InsertHTML",subCommand:"InsertHTML",value:"<hr/>"},insertImage:{command:"Images",subCommand:"Image"},insertAudio:{command:"Audios",subCommand:"Audio"},insertVideo:{command:"Videos",subCommand:"Video"},editImage:{command:"Images",subCommand:"Image"},insertTable:{command:"Table",subCommand:"CreateTable"},insertBrOnReturn:{command:"InsertHTML",subCommand:"InsertHTML",value:"<br/>"},insertOrderedList:{command:"Lists",value:"OL"},insertUnorderedList:{command:"Lists",value:"UL"},insertParagraph:{command:"Formats",value:"P"},removeFormat:{command:"Clear",subCommand:"ClearFormat"},copyFormatPainter:{command:"FormatPainter",value:"format-copy"},applyFormatPainter:{command:"FormatPainter",value:"format-paste"},escapeFormatPainter:{command:"FormatPainter",value:"escape"}},Se=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),B=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},gd=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([g(!0)],t.prototype,"enable",void 0),B([g(!0)],t.prototype,"enableFloating",void 0),B([g(Le.Expand)],t.prototype,"type",void 0),B([g(rc)],t.prototype,"items",void 0),B([g({})],t.prototype,"itemConfigs",void 0),t}(W),vd=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([g([".jpeg",".jpg",".png"])],t.prototype,"allowedTypes",void 0),B([g("inline")],t.prototype,"display",void 0),B([g("Blob")],t.prototype,"saveFormat",void 0),B([g("auto")],t.prototype,"width",void 0),B([g("auto")],t.prototype,"height",void 0),B([g(null)],t.prototype,"saveUrl",void 0),B([g(null)],t.prototype,"path",void 0),B([g(!0)],t.prototype,"resize",void 0),B([g(null)],t.prototype,"removeUrl",void 0),B([g(0)],t.prototype,"minWidth",void 0),B([g(null)],t.prototype,"maxWidth",void 0),B([g(0)],t.prototype,"minHeight",void 0),B([g(null)],t.prototype,"maxHeight",void 0),B([g(!1)],t.prototype,"resizeByPercent",void 0),t}(W),bd=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([g([".wav",".mp3",".m4a",".wma"])],t.prototype,"allowedTypes",void 0),B([g("Inline")],t.prototype,"layoutOption",void 0),B([g("Blob")],t.prototype,"saveFormat",void 0),B([g(null)],t.prototype,"saveUrl",void 0),B([g(null)],t.prototype,"removeUrl",void 0),B([g(null)],t.prototype,"path",void 0),t}(W),yd=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([g([".mp4",".mov",".wmv",".avi"])],t.prototype,"allowedTypes",void 0),B([g("Inline")],t.prototype,"layoutOption",void 0),B([g("Blob")],t.prototype,"saveFormat",void 0),B([g("auto")],t.prototype,"width",void 0),B([g("auto")],t.prototype,"height",void 0),B([g(null)],t.prototype,"saveUrl",void 0),B([g(null)],t.prototype,"path",void 0),B([g(!0)],t.prototype,"resize",void 0),B([g(null)],t.prototype,"removeUrl",void 0),B([g(0)],t.prototype,"minWidth",void 0),B([g(null)],t.prototype,"maxWidth",void 0),B([g(0)],t.prototype,"minHeight",void 0),B([g(null)],t.prototype,"maxHeight",void 0),B([g(!1)],t.prototype,"resizeByPercent",void 0),t}(W),Cd=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([N()],t.prototype,"beforeSend",void 0),B([X({getImageUrl:null,url:null,uploadUrl:null},Qp)],t.prototype,"ajaxSettings",void 0),B([g(!1)],t.prototype,"allowDragAndDrop",void 0),B([X({visible:!0,file:["Open","|","Cut","Copy","|","Delete","Rename","|","Details"],folder:["Open","|","Cut","Copy","Paste","|","Delete","Rename","|","Details"],layout:["SortBy","View","Refresh","|","Paste","|","NewFolder","Upload","|","Details","|","SelectAll"]},rd)],t.prototype,"contextMenuSettings",void 0),B([g("")],t.prototype,"cssClass",void 0),B([X({},Zp)],t.prototype,"detailsViewSettings",void 0),B([g(!1)],t.prototype,"enable",void 0),B([X({maxWidth:"650px",minWidth:"240px",visible:!0},od)],t.prototype,"navigationPaneSettings",void 0),B([g("/")],t.prototype,"path",void 0),B([g(null)],t.prototype,"rootAliasName",void 0),B([X({},Yp)],t.prototype,"searchSettings",void 0),B([g(!0)],t.prototype,"showFileExtension",void 0),B([g(!1)],t.prototype,"showHiddenItems",void 0),B([g(!0)],t.prototype,"showThumbnail",void 0),B([g("Ascending")],t.prototype,"sortOrder",void 0),B([X({visible:!0,items:["NewFolder","Upload","Cut","Copy","Paste","Delete","Download","Rename","SortBy","Refresh","Selection","View","Details"]},Kp)],t.prototype,"toolbarSettings",void 0),B([X({autoUpload:!0,minFileSize:0,maxFileSize:3e7,allowedExtensions:"",autoClose:!1},ld)],t.prototype,"uploadSettings",void 0),B([g("LargeIcons")],t.prototype,"view",void 0),t}(W),Td=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([g("100%")],t.prototype,"width",void 0),B([g(En)],t.prototype,"styles",void 0),B([g(!0)],t.prototype,"resize",void 0),B([g(0)],t.prototype,"minWidth",void 0),B([g(null)],t.prototype,"maxWidth",void 0),t}(W),Sd=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([g(!0)],t.prototype,"enable",void 0),B([g(!1)],t.prototype,"showOnRightClick",void 0),B([g("hide")],t.prototype,"actionOnScroll",void 0),B([g(["Open","Edit","UnLink"])],t.prototype,"link",void 0),B([g(["Replace","Align","Caption","Remove","-","InsertLink","OpenImageLink","EditImageLink","RemoveImageLink","Display","AltText","Dimension"])],t.prototype,"image",void 0),B([g(["AudioReplace","AudioRemove","AudioLayoutOption"])],t.prototype,"audio",void 0),B([g(["VideoReplace","VideoAlign","VideoRemove","VideoLayoutOption","VideoDimension"])],t.prototype,"video",void 0),B([g(null)],t.prototype,"text",void 0),B([g(["TableHeader","TableRows","TableColumns","BackgroundColor","-","TableRemove","Alignments","TableCellVerticalAlign","Styles"])],t.prototype,"table",void 0),t}(W),Ed=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([g("b; em; font; sub; sup; kbd; i; s; u; code; strong; span; p; div; h1; h2; h3; h4; h5; h6; blockquote; ol; ul; li; pre;")],t.prototype,"allowedFormats",void 0),B([g(null)],t.prototype,"deniedFormats",void 0),t}(W),Ld=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([g(hc)],t.prototype,"iconsSet",void 0),B([g(!0)],t.prototype,"showSearchBox",void 0),t}(W),wd=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([g(!1)],t.prototype,"prompt",void 0),B([g(null)],t.prototype,"deniedAttrs",void 0),B([g(["background","background-color","border","border-bottom","border-left","border-radius","border-right","border-style","border-top","border-width","clear","color","cursor","direction","display","float","font","font-family","font-size","font-weight","font-style","height","left","line-height","list-style-type","margin","margin-top","margin-left","margin-right","margin-bottom","max-height","max-width","min-height","min-width","overflow","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","position","right","table-layout","text-align","text-decoration","text-indent","top","vertical-align","visibility","white-space","width"])],t.prototype,"allowedStyleProps",void 0),B([g(null)],t.prototype,"deniedTags",void 0),B([g(!0)],t.prototype,"keepFormat",void 0),B([g(!1)],t.prototype,"plainText",void 0),t}(W),kd=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([g(null)],t.prototype,"default",void 0),B([g("65px")],t.prototype,"width",void 0),B([g(Ln)],t.prototype,"items",void 0),t}(W),xd=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([g(null)],t.prototype,"default",void 0),B([g("35px")],t.prototype,"width",void 0),B([g(sc)],t.prototype,"items",void 0),t}(W),Dd=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([g(null)],t.prototype,"default",void 0),B([g("65px")],t.prototype,"width",void 0),B([g(wn)],t.prototype,"types",void 0),t}(W),Bd=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([g("#ff0000")],t.prototype,"default",void 0),B([g("Palette")],t.prototype,"mode",void 0),B([g(10)],t.prototype,"columns",void 0),B([g(oc)],t.prototype,"colorCode",void 0),B([g(!1)],t.prototype,"modeSwitcher",void 0),t}(W),Od=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([g("#ffff00")],t.prototype,"default",void 0),B([g("Palette")],t.prototype,"mode",void 0),B([g(10)],t.prototype,"columns",void 0),B([g(ac)],t.prototype,"colorCode",void 0),B([g(!1)],t.prototype,"modeSwitcher",void 0),t}(W),Nd=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([g(kn)],t.prototype,"types",void 0),t}(W),Rd=function(o){Se(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return B([g(xn)],t.prototype,"types",void 0),t}(W),il=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Ti=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},Md=function(o){il(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ti([g([])],t.prototype,"styles",void 0),Ti([g([])],t.prototype,"scripts",void 0),t}(W),Ad=function(o){il(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return Ti([g(!1)],t.prototype,"enable",void 0),Ti([g(null)],t.prototype,"attributes",void 0),Ti([X({},Md)],t.prototype,"resources",void 0),t}(W),Pd=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),ia=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},Id=function(o){Pd(t,o);function t(){return o!==null&&o.apply(this,arguments)||this}return ia([g(!1)],t.prototype,"enable",void 0),ia([g(!0)],t.prototype,"onSelection",void 0),t}(W),Hd=function(){function o(t){this.parent=t,this.addEventListener()}return o.prototype.addEventListener=function(){this.parent.on(ms,this.enterHandler,this),this.parent.on(j,this.destroy,this),this.parent.on(fe,this.moduleDestroy,this)},o.prototype.destroy=function(){h(this.parent)||this.removeEventListener()},o.prototype.moduleDestroy=function(){this.parent=null},o.prototype.removeEventListener=function(){this.parent.off(ms,this.enterHandler),this.parent.off(j,this.destroy),this.parent.off(fe,this.moduleDestroy)},o.prototype.getRangeNode=function(){this.range=this.parent.getRange(),this.startNode=this.range.startContainer.nodeName==="#text"?this.range.startContainer.parentElement:this.range.startContainer,this.endNode=this.range.endContainer.nodeName==="#text"?this.range.endContainer.parentElement:this.range.endContainer},o.prototype.enterHandler=function(t){var e=this;this.getRangeNode();var i=!0;if(this.formatTags=["h1","h2","h3","h4","h5","h6","blockquote"],!h(this.startNode.closest("TABLE"))&&!h(this.endNode.closest("TABLE"))){i=!1;for(var n=this.startNode,r=n;!this.parent.formatter.editorManager.domNode.isBlockNode(n);)n=n.parentElement,r=n;i=!(r.tagName==="TD"||r.tagName==="TBODY")}if(t.args.which===13&&!t.args.ctrlKey&&(D.isDevice?t.args.key==="Enter":t.args.code==="Enter")&&h(this.startNode.closest("LI, UL, OL"))&&h(this.endNode.closest("LI, UL, OL"))&&i&&h(this.startNode.closest("PRE"))&&h(this.endNode.closest("PRE"))){var s=t.args.shiftKey,a={cancel:!1,name:Ae,requestType:s?"ShiftEnterAction":"EnterAction",originalEvent:t.args};this.parent.trigger(Ae,a,function(l){if(!l.cancel){if(!(e.range.startOffset===e.range.endOffset&&e.range.startContainer===e.range.endContainer)){if(e.range.startContainer.nodeName==="SPAN"&&(e.range.startContainer.classList.contains("e-video-wrap")||e.range.startContainer.classList.contains("e-audio-wrap"))||e.range.deleteContents(),e.range.startContainer.nodeName==="#text"&&e.range.startContainer.textContent.length===0&&e.range.startContainer.parentElement!==e.parent.inputElement)e.parent.enterKey==="BR"?e.range.startContainer.parentElement.innerHTML="&#8203;":e.range.startContainer.parentElement.innerHTML="<br>";else if(e.range.startContainer===e.parent.inputElement&&e.range.startContainer.innerHTML===""){e.range.startContainer.innerHTML="<br>";var c=e.range.startContainer.childNodes[e.range.startOffset];e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),c,0)}else if(e.parent.inputElement===e.range.startContainer){var c=e.range.startContainer.childNodes[e.range.startOffset];if(c.nodeName==="#text"&&c.textContent.length===0)e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),c,c.textContent.length===0?0:c.previousSibling.textContent.length);else if(e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),c,c.textContent.length>=0?0:1),c.previousSibling.textContent.length===0){if(S(c.previousSibling),!s){for(var p=h(c.lastChild)?c:c.lastChild;!h(p)&&p.nodeName!=="#text"&&p.nodeName!=="BR";)p=p.lastChild;p.nodeName!=="BR"&&p.parentElement.textContent.length===0&&p.parentElement.innerHTML.length===0&&p.parentElement.nodeName!=="BR"&&p.parentElement.appendChild(e.parent.createElement("BR")),e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),p.nodeName==="BR"?p:p.parentElement,p.parentElement.textContent.length>=0||p.nodeName==="BR"?0:1)}}else if(c.textContent.length===0){for(var p=c.previousSibling.nodeName==="#text"?c.previousSibling:c.previousSibling.lastChild;!h(p)&&p.nodeName!=="#text";)p=p.lastChild;e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),p,p.textContent.length),S(c)}else if(e.parent.enterKey!=="BR"&&c.previousSibling.textContent.length!==0&&c.textContent.length!==0){t.args.preventDefault();return}e.getRangeNode()}}if(e.range.startContainer===e.range.endContainer&&e.range.startOffset===e.range.endOffset&&e.range.startContainer===e.parent.inputElement){if(!(e.parent.inputElement.childNodes.length===1&&e.parent.inputElement.childNodes[0].nodeName==="TABLE"))if(h(e.range.startContainer.childNodes[e.range.startOffset])){for(var d=e.range.startContainer.childNodes[e.range.startOffset-1];d.lastChild!==null&&d.nodeName!=="#text";)d=d.lastChild;e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),d,d.nodeName==="BR"?0:d.textContent.length)}else e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),e.range.startContainer.childNodes[e.range.startOffset],0);e.getRangeNode()}if(e.parent.enterKey==="P"&&!s||e.parent.enterKey==="DIV"&&!s||e.parent.shiftEnterKey==="P"&&s||e.parent.shiftEnterKey==="DIV"&&s){if(e.range.startOffset===1&&e.parent.inputElement.childNodes.length===1&&e.parent.inputElement.childNodes[0].nodeName==="TABLE"){var u=e.createInsertElement(s);u.appendChild(e.parent.createElement("BR")),e.parent.inputElement.appendChild(u),e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),u,0)}else{var f=void 0;i&&e.parent.formatter.editorManager.domNode.isBlockNode(e.startNode)?f=e.startNode:f=e.parent.formatter.editorManager.domNode.blockParentNode(e.startNode);var m=!1,v=!1;if(e.range.startOffset!==0&&e.range.endOffset!==0&&e.range.startContainer===e.range.endContainer&&!(!h(f.childNodes[0])&&(f.childNodes[0].nodeName==="IMG"||f.querySelectorAll("img, audio, video").length>0))){var y=e.range.startContainer.textContent,L=y.substring(0,e.range.startOffset);L.charCodeAt(e.range.startOffset-1)!==160&&L.trim().length===0&&(v=!0)}else e.range.startOffset===0&&e.range.endOffset===0&&(v=!0);e.removeBRElement(f);var C=D.userAgent.indexOf("Firefox")!==-1&&e.range.startOffset===0&&e.range.startContainer===e.range.endContainer&&e.range.startContainer.nodeName==="#text"&&!e.parent.formatter.editorManager.domNode.isBlockNode(e.range.startContainer.previousSibling)&&e.range.startContainer.parentElement===e.range.startContainer.previousSibling.parentElement;if(!C&&(e.range.startOffset===0&&e.range.endOffset===0||v)&&!(!h(e.range.startContainer.previousSibling)&&(e.range.startContainer.previousSibling.nodeName==="IMG"||e.range.startContainer.previousSibling.nodeName==="BR"))){var w=void 0,u=void 0;!h(e.range.startContainer.childNodes)&&(e.range.startContainer.textContent.length===0||e.range.startContainer.nodeName!=="#text"&&!h(e.range.startContainer.querySelector(".e-video-clickelem"))&&e.range.startContainer.querySelector(".e-video-clickelem").textContent.length===0)&&(e.range.startContainer.querySelectorAll("img, audio, video").length>0||!h(e.range.startContainer.querySelector(".e-video-clickelem"))||e.range.startContainer.nodeName==="IMG"||e.range.startContainer.nodeName==="TABLE")?(u=e.createInsertElement(s),m=!0,w=!1):f.textContent.trim().length!==0||f.childNodes[0].nodeName==="IMG"||f.textContent.trim()===""&&f.querySelectorAll("img, audio, video").length>0?(e.range.startOffset===e.range.endOffset&&e.range.startOffset!==0?u=e.parent.formatter.editorManager.nodeCutter.SplitNode(e.range,f,!1).cloneNode(!0):(u=e.parent.formatter.editorManager.nodeCutter.SplitNode(e.range,f,!0).cloneNode(!0),m=!0),w=!1):(u=e.parent.formatter.editorManager.nodeCutter.SplitNode(e.range,f,!0).cloneNode(!0),w=!0);var k=void 0;for(e.formatTags.indexOf(u.nodeName.toLocaleLowerCase())<0?k=e.createInsertElement(s):k=e.parent.createElement(u.nodeName);u.firstChild;)k.appendChild(u.firstChild);if(f.parentElement.insertBefore(k,f),!w){var p=k,I=void 0;if(e.range.startOffset===e.range.endOffset&&e.range.startOffset!==0)for(;!h(p)&&p.nodeName!=="#text"&&p.nodeName!=="BR";)I=p,p=p.lastChild;else I=p;I.innerHTML="<br>",m||S(f)}e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),k.nextElementSibling,0)}else if(f.textContent.length===0&&!(!h(f.childNodes[0])&&f.childNodes[0].nodeName==="IMG"||f.querySelectorAll("video").length>0||f.querySelectorAll("audio").length>0||f.querySelectorAll("img").length>0))if(!h(f.children[0])&&f.children[0].tagName!=="BR"){var u=e.parent.formatter.editorManager.nodeCutter.SplitNode(e.range,f,!1).cloneNode(!0);e.parent.formatter.editorManager.domNode.insertAfter(u,f),e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),u,u.textContent.length>=0?0:1)}else{var k=e.createInsertElement(s);k.innerHTML="<br>",e.parent.formatter.editorManager.domNode.insertAfter(k,f),e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),k,0)}else if(e.range.startContainer===e.range.endContainer&&e.range.startContainer.nodeName==="SPAN"&&(e.range.startContainer.classList.contains("e-video-wrap")||e.range.startContainer.classList.contains("e-audio-wrap"))){if(f.textContent.trim().length>0){for(var u=e.parent.formatter.editorManager.nodeCutter.SplitNode(e.range,f,!0),P=h(u.previousSibling.querySelector(".e-video-wrap"))?u.previousSibling.querySelector(".e-audio-wrap"):u.previousSibling.querySelector(".e-video-wrap"),Z=!1,G=P.previousSibling;!h(G)&&G.nodeName!=="#text";)G=G.lastChild;if(h(G)){var $=e.parent.createElement("br");P.parentElement.appendChild($),Z=!0}Z?e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),P.parentElement,0):e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),G,G.textContent.length),S(P)}else{for(var u=e.parent.formatter.editorManager.nodeCutter.SplitNode(e.range,f,!0),c=u.previousSibling;!h(c.firstChild);)S(c.firstChild);var $=e.parent.createElement("br");c.appendChild($),e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),c,0)}h(e.parent.audioModule)||e.parent.audioModule.hideAudioQuickToolbar(),h(e.parent.videoModule)||e.parent.videoModule.hideVideoQuickToolbar()}else{var u=e.parent.formatter.editorManager.nodeCutter.SplitNode(e.range,f,!0);if(!h(u.childNodes[0])&&u.childNodes[0].nodeName==="#text"&&u.childNodes[0].textContent.length===0&&S(u.childNodes[0]),u.textContent.trim().length===0){var $=e.parent.createElement("br");if(e.startNode.nodeName==="A"){var ae=e.startNode.parentElement;e.startNode.parentElement.insertBefore($,e.startNode),S(e.startNode),e.startNode=ae}else e.startNode.nodeName!=="BR"&&e.startNode.appendChild($);u.childNodes[0].textContent===`
`&&S(u.childNodes[0]),e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),e.startNode,0)}if((e.parent.enterKey==="P"||e.parent.enterKey==="DIV")&&!s||(e.parent.shiftEnterKey==="DIV"||e.parent.shiftEnterKey==="P")&&s){var ue=e.formatTags.indexOf(u.nodeName.toLocaleLowerCase());if(ue<0||ue>=0&&u.textContent.trim().length===0){for(var xe=e.createInsertElement(s);u.firstChild;)xe.appendChild(u.firstChild);e.parent.formatter.editorManager.domNode.insertAfter(xe,u),S(u),e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),e.parent.formatter.editorManager.domNode.isBlockNode(e.startNode)?xe:e.startNode,0)}}}}t.args.preventDefault()}if(e.parent.enterKey==="BR"&&!s||e.parent.shiftEnterKey==="BR"&&s){var _=void 0;if(e.parent.formatter.editorManager.domNode.isBlockNode(e.startNode))_=e.startNode;else{for(var ee=e.startNode,K=ee;!e.parent.formatter.editorManager.domNode.isBlockNode(ee);)K=ee,ee=ee.parentElement;_=ee===e.parent.inputElement?K:ee}e.removeBRElement(_);for(var F=_.lastChild;!h(F)&&!(F.nodeName==="#text"||F.nodeName==="BR"||F.nodeName==="IMG");)F=F.lastChild;var Pe=e.range.startContainer===F?e.range.startContainer.textContent.length:_.textContent.length,Rt=e.range.startContainer.nodeName==="IMG"||e.range.startContainer.childNodes.length>0&&e.range.startContainer.childNodes[e.range.startOffset].nodeName==="IMG";if(_!==e.parent.inputElement&&e.parent.formatter.editorManager.domNode.isBlockNode(_)&&e.range.startOffset===e.range.endOffset&&(e.range.startOffset===Pe||_.textContent.trim().length===0&&Rt)){var ne=e.parent.createElement("br");if(e.range.startOffset===0&&e.range.startContainer.nodeName==="TABLE")e.range.startContainer.parentElement.insertBefore(ne,e.range.startContainer);else if(F.nodeName==="BR"&&_.textContent.length===0)e.parent.formatter.editorManager.domNode.insertAfter(ne,F);else if(e.range.startOffset===0&&e.range.endOffset===0&&Rt){var lt=e.range.startContainer.nodeName==="IMG"?e.range.startContainer:e.range.startContainer.childNodes[e.range.startOffset];_.insertBefore(ne,lt),ne=lt}else{var Zt=e.parent.createElement("br");e.parent.formatter.editorManager.domNode.insertAfter(ne,e.range.startContainer),e.parent.formatter.editorManager.domNode.insertAfter(Zt,e.range.startContainer)}e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),ne,0)}else if(!h(_)&&_!==e.parent.inputElement&&_.nodeName!=="BR")if(_.textContent.trim().length===0||_.textContent.trim().length===1&&_.textContent.charCodeAt(0)===8203){var u=e.parent.formatter.editorManager.nodeCutter.SplitNode(e.range,_,!0).cloneNode(!0);e.parent.formatter.editorManager.domNode.insertAfter(u,_);var Ke=e.parent.createElement("br");u.parentElement.insertBefore(Ke,u),e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),u,0)}else{var u=void 0,Ke=e.parent.createElement("br");if(e.range.startOffset===0&&e.range.endOffset===0&&!h(_.previousSibling)&&_.previousSibling.nodeName==="BR"&&_.nodeName!=="P"&&_.nodeName!=="DIV"){u=e.parent.formatter.editorManager.nodeCutter.SplitNode(e.range,_,!1).cloneNode(!0),e.parent.formatter.editorManager.domNode.insertAfter(Ke,_),e.insertFocusContent();for(var p=Ke.nextSibling;!h(p)&&p.nodeName!=="#text";)p=p.lastChild;e.parent.formatter.editorManager.nodeSelection.setCursorPoint(e.parent.contentModule.getDocument(),p,0)}else e.insertBRElement()}else e.insertBRElement();t.args.preventDefault()}e.parent.trigger(Ge,{requestType:s?"ShiftEnterAction":"EnterAction",args:t.args})}})}},o.prototype.removeBRElement=function(t){D.userAgent.indexOf("Firefox")!==-1&&this.range.endOffset===t.textContent.length&&(t.textContent.length!==0||t.querySelectorAll("BR").length>1)&&!h(t.lastChild)&&t.lastChild.nodeName==="BR"&&S(t.lastChild)},o.prototype.insertBRElement=function(){var t=!1,e=!0;this.range.endContainer.textContent.length===0&&this.range.startContainer.nodeName==="BR"&&(e=!1);var i=this.parent.createElement("br");if(this.startNode.nodeName==="BR"&&this.endNode.nodeName==="BR"&&this.range.startOffset===0&&this.range.startOffset===this.range.endOffset?(this.parent.formatter.editorManager.domNode.insertAfter(i,this.startNode),t=!0):(this.startNode===this.parent.inputElement&&!h(this.range.startContainer.previousSibling)&&this.range.startContainer.previousSibling.nodeName==="BR"&&this.range.startContainer.textContent.length===0&&(t=!0),this.range.insertNode(i)),t||!h(i.nextElementSibling)&&i.nextElementSibling.tagName==="BR"||!h(i.nextSibling)&&i.nextSibling.textContent.length>0)this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),!h(i.nextSibling)&&e?i.nextSibling:i,0),t=!1;else{var n=this.parent.createElement("br");this.range.insertNode(n),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),i,0)}},o.prototype.insertFocusContent=function(){this.range.startContainer.textContent.length===0&&(this.range.startContainer.nodeName==="#text"?this.range.startContainer.parentElement.innerHTML="&#8203;":this.range.startContainer.innerHTML="&#8203;")},o.prototype.createInsertElement=function(t){var e;this.parent.enterKey==="DIV"&&!t||this.parent.shiftEnterKey==="DIV"&&t?e=this.parent.createElement("div"):(this.parent.enterKey==="P"&&!t||this.parent.shiftEnterKey==="P"&&t)&&(e=this.parent.createElement("p"));var i=this.parent.formatter.editorManager.domNode.blockNodes()[0].previousSibling,n=this.parent.formatter.editorManager.domNode.blockNodes()[0].nextSibling;return!h(i)&&i.hasAttribute("style")&&e.setAttribute("style",i.getAttribute("style")),h(i)&&!h(n)&&n.hasAttribute("style")&&e.setAttribute("style",n.getAttribute("style")),e},o}(),Fd=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),Fs=globalThis&&globalThis.__assign||function(){return Fs=Object.assign||function(o){for(var t,e=1,i=arguments.length;e<i;e++){t=arguments[e];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(o[n]=t[n])}return o},Fs.apply(this,arguments)},M=globalThis&&globalThis.__decorate||function(o,t,e,i){var n=arguments.length,r=n<3?t:i===null?i=Object.getOwnPropertyDescriptor(t,e):i,s;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")r=Reflect.decorate(o,t,e,i);else for(var a=o.length-1;a>=0;a--)(s=o[a])&&(r=(n<3?s(r):n>3?s(t,e,r):s(t,e))||r);return n>3&&r&&Object.defineProperty(t,e,r),r},zd=function(o){Fd(t,o);function t(e,i){var n=o.call(this,e,i)||this;return n.needsID=!0,n}return t.prototype.requiredModules=function(){var e=[];return this.toolbarSettings.enable&&(e.push({member:"toolbar",args:[this,this.serviceLocator]}),e.push({member:"link",args:[this,this.serviceLocator]}),e.push({member:"table",args:[this,this.serviceLocator]}),e.push({member:"image",args:[this,this.serviceLocator]}),this.quickToolbarSettings.enable&&e.push({member:"quickToolbar",args:[this,this.serviceLocator]})),this.showCharCount&&e.push({member:"count",args:[this,this.serviceLocator]}),this.editorMode==="Markdown"&&e.push({member:"markdownEditor",args:[this,this.serviceLocator]}),this.editorMode==="HTML"&&(e.push({member:"htmlEditor",args:[this,this.serviceLocator]}),e.push({member:"pasteCleanup",args:[this,this.serviceLocator]}),e.push({member:"audio",args:[this,this.serviceLocator]}),e.push({member:"video",args:[this,this.serviceLocator]}),e.push({member:"formatPainter",args:[this]}),e.push({member:"emojiPicker",args:[this,this.serviceLocator]})),this.fileManagerSettings.enable&&e.push({member:"fileManager",args:[this,this.serviceLocator]}),this.enableResize&&e.push({member:"resize",args:[this]}),e},t.prototype.updateEnable=function(){this.enabled?(O([this.element],ur),this.element.setAttribute("aria-disabled","false"),h(this.htmlAttributes.tabindex)?this.inputElement.setAttribute("tabindex","0"):this.inputElement.setAttribute("tabindex",this.htmlAttributes.tabindex)):(this.getToolbar()&&(O(this.getToolbar().querySelectorAll("."+Wt),Wt),O([this.getToolbar()],[ws,ks])),x([this.element],ur),this.element.tabIndex=-1,this.element.setAttribute("aria-disabled","true"),this.inputElement.setAttribute("tabindex","-1"))},t.prototype.setEnable=function(){this.updateEnable(),this.enabled?this.eventInitializer():this.unWireEvents()},t.prototype.initializeValue=function(){this.isFocusOut=!1,this.isRTE=!1,this.isBlur=!0,this.defaultResetValue=null,this.isResizeInitialized=!1},t.prototype.preRender=function(){this.initializeValue(),this.onBlurHandler=this.blurHandler.bind(this),this.onFocusHandler=this.focusHandler.bind(this),this.onResizeHandler=this.resizeHandler.bind(this),this.clickPoints={clientX:0,clientY:0},this.initialValue=this.value,this.serviceLocator=new Ea,this.initializeServices(),this.setContainer(),this.persistData(),Q(this.element,{width:H(this.width)}),ce(this.element,{role:"application","aria-label":"Rich Text Editor"})},t.prototype.persistData=function(){if(this.enablePersistence&&this.originalElement.tagName==="TEXTAREA"){this.element.id=this.originalElement.id+"_wrapper";var e=window.localStorage.getItem(this.getModuleName()+this.element.id);h(e)||e===""||this.setProperties(JSON.parse(e),!0)}},t.prototype.setContainer=function(){this.originalElement=this.element.cloneNode(!0),(this.value===null||this.valueTemplate!==null)&&this.setValue(),this.element.hasAttribute("tabindex")&&(this.htmlAttributes={tabindex:this.element.getAttribute("tabindex")},this.element.removeAttribute("tabindex")),this.element.innerHTML="";for(var e=["class","style","id","ejs-for"],i={},n=0;n<this.element.attributes.length;n++)e.indexOf(this.element.attributes[n].name)===-1&&!/^data-val/.test(this.element.attributes[n].name)&&(i[this.element.attributes[n].name]=this.element.getAttribute(this.element.attributes[n].name));if(ot(i,this.htmlAttributes,i),this.setProperties({htmlAttributes:i},!0),h(this.htmlAttributes.id)||(this.element.id=this.htmlAttributes.id),this.element.tagName==="TEXTAREA"){var r=this.createElement("div",{className:this.element.getAttribute("class")});this.element.innerHTML="",this.element.parentElement.insertBefore(r,this.element),this.valueContainer=this.element,O([this.valueContainer],this.element.getAttribute("class").split(" ")),this.element=r}else this.valueContainer=this.createElement("textarea",{id:this.getID()+"-value",attrs:{"aria-labelledby":this.getID()}});if(this.valueContainer.name=this.getID(),x([this.valueContainer],bo),!h(this.cssClass))for(var s=this.cssClass.split(" "),a=0;a<s.length;a++)x([this.valueContainer],s[a]);this.element.appendChild(this.valueContainer)},t.prototype.getPersistData=function(){return this.addOnPersist(["value"])},t.prototype.focusIn=function(){this.enabled&&(this.inputElement.focus(),this.focusHandler({}))},t.prototype.focusOut=function(){this.enabled&&(this.inputElement.blur(),this.blurHandler({}))},t.prototype.selectAll=function(){this.notify(cs,{})},t.prototype.selectRange=function(e){this.notify(zn,{range:e})},t.prototype.getSelection=function(){var e="";return this.notify(ps,{callBack:function(i){e=i}}),e},t.prototype.showEmojiPicker=function(e,i){this.readonly||this.notify(ha,{x:e,y:i})},t.prototype.executeCommand=function(e,i,n){i=this.htmlPurifier(e,i);var r;if(this.editorMode==="HTML"){var s=this.getRange();this.iframeSettings.enable&&this.formatter.editorManager.nodeSelection.Clear(this.element.ownerDocument);var a=this.iframeSettings.enable&&s.startContainer===this.inputElement?!0:!this.inputElement.contains(s.startContainer);a&&this.focusIn()}var l=md[""+e];if(n&&n.undo&&n.undo&&this.formatter.getUndoRedoStack().length===0&&this.formatter.saveData(),this.maxLength!==-1&&!h(l.command)){var c=0;if(l.command==="Links"&&(c=i.text.length===0?i.url.length:i.text.length),(l.command==="Images"||l.command==="Table"||l.command==="Files")&&(c=1),l.command==="InsertHTML")if(h(i))!h(l.value)&&(l.value==="<hr/>"||l.value==="<br/>")&&(c=1);else{var p=this.createElement("div");p.innerHTML=i,c=p.textContent.length}l.command==="InsertText"&&(c=i.length);var d=this.getText().trim().replace(/(\r\n|\n|\r|\t)/gm,"").replace(/\u200B/g,"").length,u=this.getSelection().length,f=d-u+c;if(!(this.maxLength===-1||f<=this.maxLength))return}r=i,l.command==="FormatPainter"&&(h(i)||(this.formatPainterSettings=i),r={formatPainterAction:l.value}),this.formatter.editorManager.execCommand(l.command,l.subCommand?l.subCommand:r||l.value,null,null,r||l.value,r||l.value),n&&n.undo&&(this.formatter.saveData(),this.formatter.enableUndo(this)),this.setPlaceHolder(),this.notify(gi,{})},t.prototype.htmlPurifier=function(e,i){if(this.editorMode==="HTML")switch(e){case"insertHTML":this.enableHtmlSanitizer&&(typeof i=="string"?i=this.htmlEditorModule.sanitizeHelper(i):i=this.htmlEditorModule.sanitizeHelper(i.outerHTML));break;case"insertTable":h(i.width)&&(i.width={minWidth:this.tableSettings.minWidth,maxWidth:this.tableSettings.maxWidth,width:this.tableSettings.width});break;case"insertImage":{var n=this.createElement("img",{attrs:{src:i.url}}),r=n.outerHTML;this.enableHtmlSanitizer&&(r=this.htmlEditorModule.sanitizeHelper(n.outerHTML));var s=r!==""&&this.createElement("div",{innerHTML:r}).firstElementChild.getAttribute("src")||null;s=h(s)?"":s,i.url=s,h(i.width)&&(i.width={minWidth:this.insertImageSettings.minWidth,maxWidth:this.insertImageSettings.maxWidth,width:this.insertImageSettings.width}),h(i.height)&&(i.height={minHeight:this.insertImageSettings.minHeight,maxHeight:this.insertImageSettings.maxHeight,height:this.insertImageSettings.height});break}case"insertAudio":{var a=this.createElement("audio",{attrs:{controls:""}}),n=this.createElement("source",{attrs:{src:i.url,type:i.url&&i.url.split(".").length>0?"audio/"+i.url.split(".")[i.url.split(".").length-1]:""}});a.appendChild(n);var l=a.outerHTML;this.enableHtmlSanitizer&&(l=this.htmlEditorModule.sanitizeHelper(a.outerHTML));var s=l!==""&&this.createElement("div",{innerHTML:l}).firstElementChild.firstElementChild.getAttribute("src")||null;s=h(s)?"":s,i.url=s;break}case"insertVideo":{var a=this.createElement("video",{attrs:{controls:""}}),n=this.createElement("source",{attrs:{src:i.url,type:i.url&&i.url.split(".").length>0?"video/"+i.url.split(".")[i.url.split(".").length-1]:""}});a.appendChild(n);var l=a.outerHTML;this.enableHtmlSanitizer&&(l=this.htmlEditorModule.sanitizeHelper(n.outerHTML));var s=l!==""&&this.createElement("div",{innerHTML:l}).firstElementChild.getAttribute("src")||null;s=h(s)?"":s,i.url=s,h(i.width)&&(i.width={minWidth:this.insertVideoSettings.minWidth,maxWidth:this.insertVideoSettings.maxWidth,width:this.insertVideoSettings.width}),h(i.height)&&(i.height={minHeight:this.insertVideoSettings.minHeight,maxHeight:this.insertVideoSettings.maxHeight,height:this.insertVideoSettings.height});break}case"createLink":{var c=this.createElement("a",{attrs:{href:i.url}}),p=c.outerHTML;this.enableHtmlSanitizer&&(p=this.htmlEditorModule.sanitizeHelper(c.outerHTML));var d=p!==""&&this.createElement("div",{innerHTML:p}).firstElementChild.getAttribute("href")||null;d=h(d)?"":d,i.url=d;break}}return i},t.prototype.encode=function(e){var i=this.createElement("div");return i.innerText=e.trim(),i.innerHTML.replace(/<br\s*[\/]?>/gi,`
`)},t.prototype.render=function(){this.value=this.editorMode!=="Markdown"&&!h(this.value)?this.addAnchorAriaLabel(this.value):this.value,this.value&&!this.valueTemplate&&this.setProperties({value:this.serializeValue(this.value)},!0),this.renderModule=new cd(this,this.serviceLocator),this.sourceCodeModule=new ud(this,this.serviceLocator),this.notify(Yr,{}),this.trigger(Bl),this.RTERender(),new np(this),this.notify(Me,{}),this.enableXhtml&&this.setProperties({value:this.getXhtml()},!0),this.toolbarSettings.enable&&(this.toolbarSettings.type==="Expand"||this.toolbarSettings.type==="MultiRow"||this.toolbarSettings.type==="Scrollable")&&!h(this.getToolbar())&&this.toolbarSettings.items.indexOf("Undo")>-1&&this.toolbarSettings.items.indexOf("Redo")>-1&&this.disableToolbarItem(["Undo","Redo"]),this.setContentHeight(),this.value!==null&&(this.valueContainer.defaultValue=this.value),this.enabled&&!this.readonly?this.eventInitializer():this.unWireEvents(),this.notify(we,{cssClass:this.getCssClass()}),this.addAudioVideoWrapper(),this.notify(Ei,{}),this.renderComplete()},t.prototype.addAudioVideoWrapper=function(){for(var e=this,i,n=this.element.querySelectorAll("audio"),r=0;r<n.length;r++)if(n[r].classList.contains("e-rte-audio")||(n[r].classList.add("e-rte-audio"),n[r].classList.add(bh)),!n[r].parentElement.classList.contains(fi)&&!n[r].parentElement.classList.contains(mn)){var s=this.createElement("span",{className:mn});s.setAttribute("style","width:300px; margin:0 auto;"),s.contentEditable="false";var a=this.createElement("span",{className:fi});s.appendChild(a),n[r].parentNode.insertBefore(s,n[r].nextSibling),a.appendChild(n[r]),s.nextElementSibling===null&&(i=this.createElement("br"),s.parentNode.insertBefore(i,s.nextSibling))}for(var l=this.element.querySelectorAll("video"),r=0;r<l.length;r++){if(l[r].classList.contains("e-rte-video")||(l[r].classList.add("e-rte-video"),l[r].classList.add(yh)),!l[r].parentElement.classList.contains(fi)&&!l[r].parentElement.classList.contains(yr)){var c=this.createElement("span",{className:yr});c.contentEditable="false",l[r].parentNode.insertBefore(c,l[r].nextSibling),c.appendChild(l[r]),c.nextElementSibling===null&&(i=this.createElement("br"),c.parentNode.insertBefore(i,c.nextSibling))}D.userAgent.indexOf("Firefox")!==-1&&(l[r].addEventListener("play",function(d){e.notify(_e,{args:d}),e.notify("editAreaClick",{args:d})}),l[r].addEventListener("pause",function(d){e.notify(_e,{args:d}),e.notify("editAreaClick",{args:d})}))}},t.prototype.eventInitializer=function(){this.wireEvents()},t.prototype.cleanList=function(e){var i=this.getRange(),n=i.startContainer,r=i.endContainer,s=i.startOffset,a=n===r;r.textContent.length;var l=i.endContainer.nodeName==="#text"?i.endContainer.parentElement:i.endContainer,c=T(l,"LI"),p=!1,d=i.endOffset;if(r.nodeType===Node.TEXT_NODE&&r.textContent.charAt(d-1)==="\uFEFF"&&d--,!h(c)&&l.textContent.trim().length===d&&!i.collapsed&&h(l.nextElementSibling)){for(var u=0;u<c.childNodes.length;u++)c.childNodes[u].nodeName==="#text"&&c.childNodes[u].textContent.trim().length===0&&(S(c.childNodes[u]),p=!0,u--);for(var f=c;f.lastChild!==null&&f.nodeName!=="#text";)f=f.lastChild;if(p){var m=f.nodeName==="BR"&&!h(f.previousSibling)?f.previousSibling:f;this.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),a?m:n,m,s,m.nodeName==="BR"?0:m.textContent.length)}}},t.prototype.keyDown=function(e){if(this.notify(Ne,{member:"keydown",args:e}),this.restrict(e),this.editorMode==="HTML"&&this.cleanList(e),this.editorMode==="HTML"&&(e.which===8&&e.code==="Backspace"||e.which===46&&e.code==="Delete")){var i=this.getRange(),n=i.startContainer.nodeName==="#text"?i.startContainer.parentElement:i.startContainer;if(T(n,"pre")&&e.which===8&&i.startContainer.textContent.charCodeAt(i.startOffset-1)===8203||e.which===46&&i.startContainer.textContent.charCodeAt(i.startOffset)===8203){var r=new RegExp(String.fromCharCode(8203),"g"),s=e.which===8?i.startOffset-1:i.startOffset;i.startContainer.textContent=i.startContainer.textContent.replace(r,""),this.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),i.startContainer,s)}else if(e.code==="Backspace"&&e.which===8&&i.startContainer.textContent.charCodeAt(0)===8203&&i.collapsed){var a=i.startContainer.parentElement,l=void 0,c=void 0;for(c=0;c<a.childNodes.length;c++)a.childNodes[c]===i.startContainer&&(l=c);var p=!0,d=[];for(c=l;c>=0;c--)a.childNodes[c].nodeType===3&&a.childNodes[c].textContent.charCodeAt(0)===8203&&p?d.push(c):p=!1;if(d.length>0)for(c=d.length-1;c>0;c--)a.childNodes[d[c]].textContent="";this.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),i.startContainer,i.startOffset)}}var u=h(e.action)?!0:e.action!=="format-copy";if(this.formatter.getUndoRedoStack().length===0&&u&&!(e.altKey||e.shiftKey||e.altKey&&e.shiftKey&&e.which==67)&&this.formatter.saveData(),e.action!=="insert-link"&&e.action!=="format-copy"&&e.action!=="format-paste"&&(!e.target||!(e.target.classList.contains("e-mention")&&!h(document.querySelector("#"+e.target.id+"_popup.e-popup-open"))&&e.code==="Tab"))&&(e.action&&e.action!=="paste"&&e.action!=="space"||e.which===9||e.code==="Backspace"&&e.which===8)){var f=!1;switch(h(this.formatPainterModule)||(f=this.formatPainterModule.previousAction==="escape"),f||(this.editorMode==="HTML"&&(e.action==="increase-fontsize"||e.action==="decrease-fontsize")?this.notify(ca,{member:"onHandleFontsizeChange",args:e}):this.formatter.process(this,null,e)),e.action){case"toolbar-focus":if(this.toolbarSettings.enable&&this.getToolbarElement()){var m=this.getToolbarElement().querySelector(".e-toolbar-item:not(.e-overlay)[title]");m.firstElementChild.removeAttribute("tabindex"),m.firstElementChild.focus()}break;case"escape":this.contentModule.getEditPanel().focus();break}}h(this.placeholder)||(!h(this.placeHolderWrapper)&&this.inputElement.textContent.length!==1?this.placeHolderWrapper.style.display="none":this.iframeSettings.enable&&this.inputElement.classList.contains("e-rte-placeholder")?O([this.inputElement],"e-rte-placeholder"):this.setPlaceHolder()),this.notify(hh,{member:"afterKeyDown",args:e}),this.autoResize()},t.prototype.keyUp=function(e){if(this.editorMode==="HTML"){var i=this.getRange();if(D.userAgent.indexOf("Firefox")!==-1&&i.startContainer.nodeName==="#text"&&i.startContainer.parentElement===this.inputElement&&this.enterKey!=="BR"){var n=this.getRange(),r=this.createElement(this.enterKey);n.startContainer.parentElement.insertBefore(r,n.startContainer),r.appendChild(n.startContainer),this.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),r.childNodes[0],r.childNodes[0],r.childNodes[0].textContent.length,r.childNodes[0].textContent.length)}}this.notify(at,{member:"keyup",args:e}),(e.keyCode===39||e.keyCode===37)&&this.notify(Nl,{member:"tableModulekeyUp",args:e}),e.code==="KeyX"&&e.which===88&&e.keyCode===88&&e.ctrlKey&&(this.inputElement.innerHTML===""||this.inputElement.innerHTML==="<br>")&&(this.inputElement.innerHTML=Wn(ba(this),this));var s=e.which===32||e.which===13||e.which===8||e.which===46,a=e.key==="C"&&e.altKey&&e.shiftKey,l=e.key==="V"&&e.altKey&&e.shiftKey;(!a&&!l&&(e.key!=="shift"&&!e.ctrlKey&&e.key&&e.key.length===1||s)||this.editorMode==="Markdown"&&(e.key!=="shift"&&!e.ctrlKey&&e.key&&e.key.length===1||s)||this.autoSaveOnIdle&&D.isDevice&&!this.inlineMode.enable)&&this.formatter.onKeyHandler(this,e),(this.inputElement&&this.inputElement.textContent.length!==0||this.element.querySelectorAll(".e-toolbar-item.e-active").length>0||this.formatter.getUndoRedoStack().length>0)&&this.notify(_t,{args:e}),h(this.placeholder)||!(e.key==="Enter"&&e.keyCode===13)&&(this.inputElement.innerHTML==="<p><br></p>"||this.inputElement.innerHTML==="<div><br></div>"||this.inputElement.innerHTML==="<br>")&&this.setPlaceHolder()},t.prototype.serializeValue=function(e){return this.editorMode==="HTML"&&!h(e)&&(this.enableHtmlEncode?(e=this.htmlEditorModule.sanitizeHelper(et(e)),e=this.encode(e)):(e=this.htmlEditorModule.sanitizeHelper(e),e=this.enableXhtml?this.htmlEditorModule.xhtmlValidation.selfEncloseValidation(e):e)),e},t.prototype.sanitizeHtml=function(e){return this.serializeValue(e)},t.prototype.updateValue=function(e){if(h(e)){var i=this.inputElement.innerHTML;this.setProperties({value:fc(i)?null:i})}else this.setProperties({value:e})},t.prototype.triggerEditArea=function(e){if(!ie())this.notify(Kt,{member:"editAreaClick",args:e});else{var i=e.touches?e.changedTouches[0]:e;this.clickPoints.clientX===i.clientX&&this.clickPoints.clientY===i.clientY&&this.notify(Kt,{member:"editAreaClick",args:e})}},t.prototype.notifyMouseUp=function(e){var i=e.touches?e.changedTouches[0]:e;this.notify(es,{member:"mouseUp",args:e,touchData:{prevClientX:this.clickPoints.clientX,prevClientY:this.clickPoints.clientY,clientX:i.clientX,clientY:i.clientY}}),(this.inputElement&&(this.editorMode==="HTML"&&this.inputElement.textContent.length!==0||this.editorMode==="Markdown"&&this.inputElement.value.length!==0)||e.target&&(e.target.nodeName==="VIDEO"||e.target.querySelectorAll("."+yr).length>0)||e.target&&e.target.nodeName!=="BR"&&(e.target.classList.contains(mn)||e.target.classList.contains(fi)||e.target.classList.contains(da)))&&this.notify(_t,{args:e}),this.triggerEditArea(e)},t.prototype.mouseUp=function(e){if(this.quickToolbarSettings.showOnRightClick&&D.isDevice){var i=e.target,n=T(i,"table");if(i&&i.nodeName==="A"||i.nodeName==="IMG"||i.nodeName==="TD"||i.nodeName==="TH"||i.nodeName==="TABLE"||n&&this.contentModule.getEditPanel().contains(n))return}this.notifyMouseUp(e)},t.prototype.ensureModuleInjected=function(e){return this.getInjectedModules().indexOf(e)>=0},t.prototype.onCopy=function(){this.contentModule.getDocument().execCommand("copy",!1,null)},t.prototype.onCut=function(){this.contentModule.getDocument().execCommand("cut",!1,null)},t.prototype.onPaste=function(e){var i=this,n={originalEvent:e,cancel:!1,requestType:"Paste"};this.trigger(Ae,n,function(r){var s=i.getText().replace(/(\r\n|\n|\r|\t)/gm,"").replace(/\u200B/g,"").length,a=i.getSelection().length,l=h(e)||h(e.clipboardData)?0:e.clipboardData.getData("text/plain").replace(/(\r\n|\n|\r|\t)/gm,"").replace(/\u200B/g,"").length,c=s-a+l;if(i.editorMode==="Markdown"){var p={requestType:"Paste",editorMode:i.editorMode,event:e};setTimeout(function(){i.formatter.onSuccess(i,p)},0),i.maxLength===-1||c<=i.maxLength||e.preventDefault();return}if(!r.cancel&&i.inputElement.contentEditable==="true"&&(i.maxLength===-1||c<=i.maxLength))if(!h(i.pasteCleanupModule))i.notify(_l,{args:e});else{var d={requestType:"Paste",editorMode:i.editorMode,event:e},u=null,f=!1;e&&!h(e.clipboardData)&&(u=e.clipboardData.getData("text/plain"),f=e.clipboardData.getData("text/html").indexOf("MsoNormal")>0);var m=e&&e.clipboardData&&e.clipboardData.items.length>0?e.clipboardData.items[0].getAsFile():null;u!==null&&i.notify(Oi,{file:m,args:e,text:u,isWordPaste:f}),setTimeout(function(){i.formatter.onSuccess(i,d)},0)}else e.preventDefault()})},t.prototype.clipboardAction=function(e,i){switch(e.toLowerCase()){case"cut":this.onCut(),this.formatter.onSuccess(this,{requestType:"Cut",editorMode:this.editorMode,event:i});break;case"copy":this.onCopy(),this.formatter.onSuccess(this,{requestType:"Copy",editorMode:this.editorMode,event:i});break;case"paste":this.onPaste(i);break}},t.prototype.destroy=function(){if(!(this.isDestroyed||!this.isRendered)){if(h(this.timeInterval)||(clearInterval(this.timeInterval),this.timeInterval=null),this.element.offsetParent===null){h(this.toolbarModule)||this.toolbarModule.destroy(),this.notify(fe,{}),o.prototype.destroy.call(this),this.isRendered=!1;return}if(this.notify(j,{}),this.destroyDependentModules(),this.unWireEvents(),this.originalElement.tagName==="TEXTAREA"){this.element.parentElement.insertBefore(this.valueContainer,this.element),this.valueContainer.id=this.getID(),this.valueContainer.removeAttribute("name"),S(this.element),this.originalElement.innerHTML.trim()!==""?(this.valueContainer.value=this.originalElement.innerHTML.trim(),this.setProperties({value:h(this.initialValue)?null:this.initialValue},!0)):this.valueContainer.value=this.valueContainer.defaultValue,this.element=this.valueContainer;for(var e=0;e<this.originalElement.classList.length;e++)x([this.element],this.originalElement.classList[e]);if(!h(this.cssClass))for(var i=this.cssClass.split(" "),e=0;e<i.length;e++)x([this.element],i[e]);O([this.element],bo)}else this.originalElement.innerHTML.trim()!==""?(this.element.innerHTML=this.originalElement.innerHTML.trim(),this.setProperties({value:h(this.initialValue)?null:this.initialValue},!0)):this.element.innerHTML="";if(this.placeholder&&this.placeHolderWrapper&&(this.placeHolderWrapper=null),!h(this.cssClass))for(var n=this.cssClass.split(" "),e=0;e<n.length;e++)n[e].trim()!==""&&O([this.element],n[e]);this.removeHtmlAttributes(),this.removeAttributes(),o.prototype.destroy.call(this),this.isRendered=!1}},t.prototype.removeHtmlAttributes=function(){if(this.htmlAttributes)for(var e=Object.keys(this.htmlAttributes),i=0;i<e.length&&this.element.hasAttribute(e[i]);i++)this.element.removeAttribute(e[i])},t.prototype.removeAttributes=function(){this.enabled||O([this.element],ur),this.enableRtl&&O([this.element],wt),this.readonly&&O([this.element],xs),this.element.style.width!==""&&this.originalElement.style.width===""&&this.element.style.removeProperty("width"),this.element.style.height!==""&&this.originalElement.style.height===""&&this.element.style.removeProperty("height"),this.element.removeAttribute("aria-disabled"),this.element.removeAttribute("role"),this.element.removeAttribute("tabindex")},t.prototype.destroyDependentModules=function(){this.renderModule.destroy(),this.formatter.editorManager.undoRedoManager.destroy(),this.sourceCodeModule.destroy()},t.prototype.getContent=function(){return this.contentModule.getPanel()},t.prototype.getText=function(){return this.contentModule.getText()},t.prototype.getSelectedHtml=function(){var e,i=this.createElement("div"),n=this.contentModule.getDocument().getSelection();if(n.rangeCount>0){e=n.getRangeAt(0);var r=e.cloneContents();i.appendChild(r)}return i.innerHTML},t.prototype.showInlineToolbar=function(){if(this.inlineMode.enable){var e=this.getRange(),i=e.endContainer.nodeName==="#text"?e.endContainer.parentElement:e.endContainer,n=e.getClientRects()[0].left,r=e.getClientRects()[0].top;this.quickToolbarModule.showInlineQTBar(n,r,i)}},t.prototype.hideInlineToolbar=function(){this.quickToolbarModule.hideInlineQTBar()},t.prototype.getModuleName=function(){return"richtexteditor"},t.prototype.onPropertyChanged=function(e,i){for(var n=0,r=Object.keys(e);n<r.length;n++){var s=r[n];switch(s){case"enterKey":case"value":{var a=void 0;s==="enterKey"?this.value===null||this.value==="<div><br></div>"||this.value==="<p><br></p>"||this.value==="<br>"?a=null:a=this.value:a=e[s],a=this.serializeValue(a);var l=this.editorMode==="HTML"?Wn(a,this):a;(!h(a)&&a!==""||s==="enterKey")&&this.setProperties({value:this.enableHtmlEncode?this.encode(et(l)):l},!0),this.updatePanelValue(),this.inputElement&&this.notify(Ei,{}),this.setPlaceHolder(),this.notify(Ri,{module:"XhtmlValidation",newProp:e,oldProp:i}),this.enableXhtml&&this.setProperties({value:this.getXhtml()},!0),this.showCharCount&&this.countModule.refresh(),this.addAudioVideoWrapper();break}case"valueTemplate":this.setValue(!0),this.showCharCount&&this.countModule.refresh();break;case"width":this.setWidth(e[s]),this.toolbarSettings.enable&&!this.inlineMode.enable&&(this.toolbarModule.refreshToolbarOverflow(),this.resizeHandler());break;case"height":this.setHeight(e[s]),this.setContentHeight(),this.autoResize();break;case"readonly":this.setReadOnly(!1);break;case"cssClass":this.element.classList.remove(i[s]),this.setCssClass(e[s]),this.notify(we,{cssClass:e[s],oldCssClass:i[s]});break;case"enabled":this.setEnable();break;case"enableRtl":this.updateRTL();break;case"placeholder":this.placeholder=e[s],this.setPlaceHolder();break;case"htmlAttributes":_r(this.htmlAttributes,this,!1,!1);break;case"iframeSettings":{var c=i[s];if(c.resources){var p=this.contentModule.getDocument(),d=p.querySelector("head"),u=void 0;c.resources.scripts&&(u=d.querySelectorAll("."+no),this.removeSheets(u)),c.resources.styles&&(u=d.querySelectorAll("."+ro),this.removeSheets(u))}this.setIframeSettings();break}case"locale":o.prototype.refresh.call(this);break;case"inlineMode":this.notify(be,{module:"quickToolbar",newProp:e,oldProp:i}),this.setContentHeight();break;case"toolbarSettings":this.notify(be,{module:"toolbar",newProp:e,oldProp:i}),this.setContentHeight();break;case"maxLength":this.showCharCount&&this.countModule.refresh();break;case"showCharCount":e[s]&&this.countModule?this.countModule.renderCount():e[s]===!1&&this.countModule&&this.countModule.destroy();break;case"enableHtmlEncode":this.updateValueData(),this.updatePanelValue(),this.setPlaceHolder(),this.showCharCount&&this.countModule.refresh();break;case"undoRedoSteps":case"undoRedoTimer":this.formatter.editorManager.observer.notify(As,{newProp:e,oldProp:i});break;case"enableXhtml":this.notify(Ri,{module:"XhtmlValidation",newProp:e,oldProp:i});break;case"quickToolbarSettings":e.quickToolbarSettings.showOnRightClick?this.wireContextEvent():this.unWireContextEvent(),this.notify(be,{newProp:e,oldProp:i});break;case"formatPainterSettings":this.formatter.editorManager.observer.notify(As,{module:"formatPainter",newProp:e});break;default:this.notify(be,{newProp:e,oldProp:i});break}}},t.prototype.updateValueData=function(){this.enableHtmlEncode?this.setProperties({value:this.encode(et(this.inputElement.innerHTML))},!0):this.setProperties({value:/<[a-z][\s\S]*>/i.test(this.inputElement.innerHTML)?this.inputElement.innerHTML:et(this.inputElement.innerHTML)})},t.prototype.removeSheets=function(e){var i;for(i=0;i<e.length;i++)S(e[i])},t.prototype.updatePanelValue=function(){var e=this.value;e=this.enableHtmlEncode&&this.value?et(e):e;var i=this.element.querySelector("."+bt);e?(i&&i.style.display==="block"&&(i.value=this.value),this.valueContainer&&(this.valueContainer.value=this.enableHtmlEncode?this.value:e),this.editorMode==="HTML"&&this.inputElement&&this.inputElement.innerHTML.replace("&amp;","&").trim()!==e.trim()?this.inputElement.innerHTML=e:this.editorMode==="Markdown"&&this.inputElement&&this.inputElement.value.trim()!==e.trim()&&(this.inputElement.value=e)):(i&&i.style.display==="block"&&(i.value=""),this.editorMode==="HTML"?this.enterKey==="DIV"?this.inputElement.innerHTML="<div><br/></div>":this.enterKey==="BR"?this.inputElement.innerHTML="<br/>":(this.inputElement.innerHTML="<p><br/></p>",e===""&&this.formatter&&this.inputElement&&this.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),this.inputElement.firstElementChild,this.inputElement.firstElementChild.childElementCount)):this.inputElement.value="",this.valueContainer&&(this.valueContainer.value="")),this.showCharCount&&this.countModule.refresh()},t.prototype.setHeight=function(e){e!=="auto"?this.element.style.height=H(e):this.element.style.height="auto",this.toolbarSettings.type==="Expand"&&(typeof this.height=="string"&&this.height.indexOf("px")>-1||typeof this.height=="number")?this.element.classList.add(Co):this.element.classList.remove(Co)},t.prototype.setPlaceHolder=function(){this.inputElement&&this.placeholder&&this.iframeSettings.enable!==!0&&(this.editorMode!=="Markdown"?(this.placeHolderWrapper||(this.placeHolderWrapper=this.createElement("span",{className:"rte-placeholder e-rte-placeholder "+this.cssClass}),this.inputElement&&this.inputElement.parentElement.insertBefore(this.placeHolderWrapper,this.inputElement),ce(this.placeHolderWrapper,{style:"font-size: 14px; margin-left: 0px; margin-right: 0px;"})),this.placeHolderWrapper.innerHTML=this.placeholder,this.inputElement.textContent.length===0&&this.inputElement.childNodes.length<2&&!h(this.inputElement.firstChild)&&(this.inputElement.firstChild.nodeName==="BR"||(this.inputElement.firstChild.nodeName==="P"||this.inputElement.firstChild.nodeName==="DIV")&&!h(this.inputElement.firstChild.firstChild)&&this.inputElement.firstChild.firstChild.nodeName==="BR")?this.placeHolderWrapper.style.display="block":this.placeHolderWrapper.style.display="none"):this.inputElement.setAttribute("placeholder",this.placeholder)),this.placeholder&&this.iframeSettings.enable&&(this.inputElement.textContent.length===0&&this.inputElement.childNodes.length<2&&!h(this.inputElement.firstChild)&&(this.inputElement.firstChild.nodeName==="BR"||(this.inputElement.firstChild.nodeName==="P"||this.inputElement.firstChild.nodeName==="DIV")&&!h(this.inputElement.firstChild.firstChild)&&this.inputElement.firstChild.firstChild.nodeName==="BR")?(x([this.inputElement],"e-rte-placeholder"),this.inputElement.setAttribute("placeholder",this.placeholder)):O([this.inputElement],"e-rte-placeholder"))},t.prototype.setWidth=function(e){e!=="auto"?Q(this.element,{width:H(this.width)}):this.element.style.width="auto"},t.prototype.setCssClass=function(e){if(!h(e))for(var i=e.split(" "),n=0;n<i.length;n++)i[n].trim()!==""&&this.element.classList.add(i[n])},t.prototype.updateRTL=function(){this.notify(dt,{enableRtl:this.enableRtl}),this.enableRtl?(this.element.classList.add(wt),this.inputElement.classList.add(wt)):(this.element.classList.remove(wt),this.inputElement.classList.remove(wt))},t.prototype.updateReadOnly=function(){this.notify(fs,{editPanel:this.inputElement,mode:this.readonly})},t.prototype.setReadOnly=function(e){this.updateReadOnly(),e||(this.readonly&&this.enabled?(this.unbindEvents(),this.unWireEvents()):this.enabled&&this.wireEvents())},t.prototype.print=function(){var e=this,i,n={element:this.inputElement,requestType:"print",cancel:!1};this.trigger(Ae,n,function(r){if(i=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth),D.info.name==="msie"&&i.resizeTo(screen.availWidth,screen.availHeight),i=ll(e.inputElement,i),!r.cancel){var s={requestType:"print"};e.trigger(Ge,s)}})},t.prototype.refreshUI=function(){this.renderModule.refresh()},t.prototype.showFullScreen=function(){this.fullScreenModule.showFullScreen()},t.prototype.enableToolbarItem=function(e,i){this.toolbarModule.enableTBarItems(this.getBaseToolbarObject(),e,!0,i)},t.prototype.disableToolbarItem=function(e,i){this.toolbarModule.enableTBarItems(this.getBaseToolbarObject(),e,!1,i)},t.prototype.removeToolbarItem=function(e){this.toolbarModule.removeTBarItems(e)},t.prototype.getRange=function(){return this.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument())},t.prototype.initializeServices=function(){this.serviceLocator.register("rendererFactory",new La),this.serviceLocator.register("rteLocale",this.localeObj=new Ii(this.getModuleName(),jn,this.locale)),this.serviceLocator.register("dialogRenderObject",new fd(this))},t.prototype.RTERender=function(){var e=this.serviceLocator.getService("rendererFactory");this.contentModule=e.getRenderer(U.Content),this.fullScreenModule=new hd(this),this.enterKeyModule=new Hd(this),this.renderModule.render(),this.inputElement=this.contentModule.getEditPanel(),this.setHeight(this.height),_r(this.htmlAttributes,this,!1,!0),this.iframeSettings&&this.setIframeSettings(),this.setCssClass(this.cssClass),this.updateEnable(),this.setPlaceHolder(),this.updateRTL(),this.updateReadOnly(),this.updatePanelValue(),this.enableHtmlEncode&&!h(this.value)&&this.setProperties({value:this.encode(et(this.value))})},t.prototype.setIframeSettings=function(){if(this.iframeSettings.resources){var e=this.iframeSettings.resources.styles,i=this.iframeSettings.resources.scripts;this.iframeSettings.resources.scripts.length>0&&this.InjectSheet(!0,i),this.iframeSettings.resources.styles.length>0&&this.InjectSheet(!1,e)}this.iframeSettings.attributes&&_r(this.iframeSettings.attributes,this,!0,!1)},t.prototype.InjectSheet=function(e,i){try{if(i&&i.length>0)for(var n=this.contentModule.getDocument(),r=n.querySelector("head"),s=0;s<i.length;s++)if(e){var a=this.createScriptElement();a.src=i[s],r.appendChild(a)}else{var l=this.createStyleElement();l.href=i[s],r.appendChild(l)}}catch{return}},t.prototype.createScriptElement=function(){var e=this.createElement("script",{className:no});return e.type="text/javascript",e},t.prototype.createStyleElement=function(){var e=this.createElement("link",{className:ro});return e.rel="stylesheet",e},t.prototype.setValue=function(e){var i=this;if(this.valueTemplate){var n=new RegExp(/<(?=.*? .*?\/ ?>|br|hr|input|!--|wbr)[a-z]+.*?>|<([a-z]+).*?<\/\1>/i);if(typeof this.valueTemplate=="string"&&n.test(this.valueTemplate))this.setProperties({value:this.valueTemplate});else{var r=hn(this.valueTemplate)("",this,"valueTemplate");if(typeof this.valueTemplate!="string"&&this.isReact){this.displayTempElem=this.createElement("div");for(var s=0;s<r.length;s++){var a=r[s];ve([a],this.displayTempElem)}this.renderTemplates(function(){i.inputElement.innerHTML=i.displayTempElem.childNodes[0].innerHTML,i.setProperties({value:i.inputElement.innerHTML.trim()})})}else{var l=this.element;e&&(this.inputElement.innerHTML="",l=this.inputElement);for(var s=0;s<r.length;s++){var a=r[s];ve([a],l)}this.setProperties({value:l.innerHTML.trim()}),this.renderReactTemplates()}}}else{var c=!h(this.element.innerHTML)&&this.element.innerHTML.replace(/<(\/?|\!?)(!--!--)>/g,"").trim();c!==""&&(this.element.tagName==="TEXTAREA"?this.setProperties({value:et(c)}):this.setProperties({value:c}))}},t.prototype.renderTemplates=function(e){this.renderReactTemplates(e)},t.prototype.updateResizeFlag=function(){this.isResizeInitialized=!0},t.prototype.getInsertImgMaxWidth=function(){var e=this.insertImageSettings.maxWidth,i=12,n=2,r=this.contentModule.getEditPanel(),s=window.getComputedStyle(r),a=r.offsetWidth-(i+n+parseFloat(s.paddingLeft.split("px")[0])+parseFloat(s.paddingRight.split("px")[0])+parseFloat(s.marginLeft.split("px")[0])+parseFloat(s.marginRight.split("px")[0]));return h(e)?a:e},t.prototype.getInsertVidMaxWidth=function(){var e=this.insertVideoSettings.maxWidth,i=12,n=2,r=this.contentModule.getEditPanel(),s=window.getComputedStyle(r),a=r.offsetWidth-(i+n+parseFloat(s.paddingLeft.split("px")[0])+parseFloat(s.paddingRight.split("px")[0])+parseFloat(s.marginLeft.split("px")[0])+parseFloat(s.marginRight.split("px")[0]));return h(e)?a:e},t.prototype.setContentHeight=function(e,i){var n,r=0,s,a=typeof this.height=="string"&&this.height.indexOf("%")>-1,l=this.sourceCodeModule.getPanel()&&this.sourceCodeModule.getPanel().parentElement.style.display==="block"?this.sourceCodeModule.getPanel().parentElement:this.contentModule.getPanel(),c=this.element.offsetHeight;c===0&&this.height!=="auto"&&!this.getToolbar()&&(c=parseInt(this.height,10),a&&(s=this.height));var p=this.getToolbar()?this.toolbarModule.getToolbarHeight():0,d=this.element.querySelector("."+Ph),u=this.enableResize?h(d)?0:d.offsetHeight+8:0,f=this.getToolbar()?this.toolbarModule.getExpandTBarPopHeight():0;if(this.toolbarSettings.type===Le.Expand&&i?(n=this.height==="auto"&&u===0?"auto":c-(p+f+u)+"px",r=this.toolbarSettings.enableFloating?0:f):this.height==="auto"&&!this.element.classList.contains("e-rte-full-screen")&&!this.isResizeInitialized?n="auto":n=a&&s?s:c-(p+u)+"px",(e!=="windowResize"||a)&&(this.iframeSettings.enable?n!=="auto"&&Q(l,{height:n,marginTop:r+"px"}):(e==="windowResize"&&a&&(n=parseInt(n,10)-2+"px"),Q(l,{height:n,marginTop:r+"px"}))),this.iframeSettings.enable&&e==="sourceCode"){var m=A("."+pa,this.element);Q(m,{height:n,marginTop:r+"px"})}if(this.toolbarSettings.enableFloating&&this.getToolbar()&&!this.inlineMode.enable){var v=(i?p+f:p)+"px";Q(this.getToolbar().parentElement,{height:v})}u===0&&this.autoResize()},t.prototype.getHtml=function(){var e=this.removeResizeElement(this.contentModule.getEditPanel().innerHTML);return this.enableXhtml&&(e==="<p><br></p>"||e==="<div><br></div>"||e==="<br>")?null:this.serializeValue(e)},t.prototype.getXhtml=function(){var e=this.removeResizeElement(this.value);return!h(e)&&this.enableXhtml&&(e=this.htmlEditorModule.xhtmlValidation.selfEncloseValidation(e)),e},t.prototype.showSourceCode=function(){this.readonly||this.notify(Gt,{})},t.prototype.getCharCount=function(){var e=this.editorMode==="Markdown"?this.inputElement.value.trim():this.inputElement.textContent.trim(),i;return this.editorMode!=="Markdown"&&e.indexOf("")!==-1?i=e.replace(/\u200B/g,"").length:i=e.length,i},t.prototype.showDialog=function(e){e===Ve.InsertLink?this.notify(ys,{}):e===Ve.InsertImage?this.notify(Ts,{}):e===Ve.InsertAudio?this.notify(th,{}):e===Ve.InsertVideo?this.notify(ih,{}):e===Ve.InsertTable&&this.notify(sh,{})},t.prototype.closeDialog=function(e){e===Ve.InsertLink?this.notify(Cs,{}):e===Ve.InsertImage?this.notify(Ss,{}):e===Ve.InsertAudio?this.notify(nh,{}):e===Ve.InsertVideo?this.notify(rh,{}):e===Ve.InsertTable&&this.notify(oh,{})},t.prototype.getBaseToolbarObject=function(){var e;return this.inlineMode.enable&&(!D.isDevice||ie())?e=this.quickToolbarModule&&this.quickToolbarModule.getInlineBaseToolbar():e=this.toolbarModule&&this.toolbarModule.getBaseToolbar(),e},t.prototype.getToolbar=function(){return this.toolbarModule?this.toolbarModule.getToolbarElement():null},t.prototype.getToolbarElement=function(){return this.toolbarModule&&this.toolbarModule.getToolbarElement()},t.prototype.getID=function(){return this.originalElement.tagName==="TEXTAREA"?this.valueContainer.id:this.element.id},t.prototype.getCssClass=function(e){return h(this.cssClass)?"":e?" "+this.cssClass:this.cssClass},t.prototype.mouseDownHandler=function(e){var i=e.touches?e.changedTouches[0]:e;x([this.element],[br]),this.preventDefaultResize(e),this.notify(_e,{args:e}),this.formatter.editorManager.observer.notify(_e,{args:e}),this.clickPoints={clientX:i.clientX,clientY:i.clientY}},t.prototype.preventImgResize=function(e){e.target.nodeName.toLocaleLowerCase()==="img"&&e.preventDefault()},t.prototype.preventDefaultResize=function(e){D.info.name==="msie"?this.contentModule.getEditPanel().addEventListener("mscontrolselect",this.preventImgResize):D.info.name==="mozilla"&&(this.contentModule.getDocument().execCommand("enableObjectResizing",!1,"false"),this.contentModule.getDocument().execCommand("enableInlineTableEditing",!1,"false"))},t.prototype.defaultResize=function(e){D.info.name==="msie"?this.contentModule.getEditPanel().removeEventListener("mscontrolselect",this.preventImgResize):D.info.name==="mozilla"&&(this.contentModule.getDocument().execCommand("enableObjectResizing",!0,"true"),this.contentModule.getDocument().execCommand("enableInlineTableEditing",!0,"true"))},t.prototype.resizeHandler=function(){var e=!1;if(!document.body.contains(this.element)){document.defaultView.removeEventListener("resize",this.onResizeHandler,!0);return}this.toolbarSettings.enable&&!this.inlineMode.enable&&(this.toolbarModule.refreshToolbarOverflow(),e=this.toolbarModule.baseToolbar.toolbarObj.element.classList.contains(Dt)),this.iframeSettings.enable!==!0&&(this.contentModule.getPanel().style.borderBottom="none"),this.setContentHeight("windowResize",e),this.notify(as,null)},t.prototype.scrollHandler=function(e){this.element&&this.notify(xt,{args:e})},t.prototype.contentScrollHandler=function(e){this.notify(pi,{args:e})},t.prototype.focusHandler=function(e){if(!this.isRTE||this.isFocusOut){this.isRTE=!this.isFocusOut,this.isFocusOut=!1,x([this.element],[br]),this.editorMode==="HTML"?this.cloneValue=this.inputElement.innerHTML==="<p><br></p>"||this.inputElement.innerHTML==="<div><br></div>"||this.inputElement.innerHTML==="<br>"?null:this.enableHtmlEncode?this.encode(et(this.inputElement.innerHTML)):this.inputElement.innerHTML:this.cloneValue=this.inputElement.value===""?null:this.inputElement.value;var i=document.activeElement;if((i===this.element||i===this.getToolbarElement()||i===this.contentModule.getEditPanel()||this.iframeSettings.enable&&i===this.contentModule.getPanel()&&e.target&&!e.target.classList.contains("e-img-inner")&&e.target&&e.target.parentElement&&!e.target.parentElement.classList.contains("e-img-wrap")||T(i,".e-rte-toolbar")===this.getToolbarElement())&&(this.contentModule.getEditPanel().focus(),!h(this.getToolbarElement()))){this.getToolbarElement().setAttribute("tabindex","-1");for(var n=this.getToolbarElement().querySelectorAll('[tabindex="0"]'),r=0;r<n.length;r++)n[r].setAttribute("tabindex","-1")}this.preventDefaultResize(e),this.trigger("focus",{event:e,isInteracted:Object.keys(e).length!==0}),!h(this.saveInterval)&&this.saveInterval>0&&!this.autoSaveOnIdle&&(this.timeInterval=setInterval(this.updateValueOnIdle.bind(this),this.saveInterval)),b.add(document,"mousedown",this.onDocumentClick,this)}if(!this.readonly){var s=this.getCurrentFocus(e);(s==="editArea"||s==="textArea"||s==="sourceCode")&&this.resetToolbarTabIndex()}},t.prototype.getUpdatedValue=function(){var e,i=this.element.querySelector("."+bt);return this.editorMode==="HTML"?(e=this.inputElement.innerHTML==="<p><br></p>"||this.inputElement.innerHTML==="<div><br></div>"||this.inputElement.innerHTML==="<br>"?null:this.enableHtmlEncode?this.encode(et(this.removeResizeElement(this.inputElement.innerHTML))):this.inputElement.innerHTML,i&&i.style.display==="block"&&(e=i.value)):e=this.inputElement.value===""?null:this.inputElement.value,e!=null&&!this.enableHtmlEncode&&(e=this.removeResizeElement(e)),e},t.prototype.updateValueOnIdle=function(){!h(this.tableModule)&&!h(this.inputElement.querySelector(".e-table-box.e-rbox-select"))||(this.setProperties({value:this.getUpdatedValue()},!0),this.valueContainer.value=this.value,this.isValueChangeBlurhandler=!1,this.invokeChangeEvent())},t.prototype.updateIntervalValue=function(){clearTimeout(this.idleInterval),this.idleInterval=setTimeout(this.updateValueOnIdle.bind(this),0)},t.prototype.cleanupResizeElements=function(e){var i=this.removeResizeElement(e.value);e.callBack(i)},t.prototype.addAnchorAriaLabel=function(e){var i=document.createElement("div");i.innerHTML=e;var n=i.querySelectorAll("a");if(n.length>0)for(var r=0;r<n.length;r++)n[r].hasAttribute("target")&&n[r].getAttribute("target")==="_blank"?n[r].setAttribute("aria-label",this.serviceLocator.getService("rteLocale").getConstant("linkAriaLabel")):n[r];return i.innerHTML},t.prototype.removeResizeElement=function(e){var i=document.createElement("div");i.innerHTML=e;var n=i.querySelectorAll(".e-column-resize, .e-row-resize, .e-table-box, .e-table-rhelper, .e-img-resize");if(n.length>0)for(var r=0;r<n.length;r++)S(n[r]);return this.removeSelectionClassStates(i),i.innerHTML},t.prototype.updateStatus=function(e){if(!h(e.html)||!h(e.markdown)){var i=this.formatter.editorManager.undoRedoManager.getUndoStatus(),n={undo:i.undo,redo:i.redo,html:e.html,markdown:e.markdown};this.trigger(Fl,n)}},t.prototype.onDocumentClick=function(e){var i=e.target,n=T(i,"."+Vn);!this.element.contains(e.target)&&document!==e.target&&n!==this.element&&!T(i,'[aria-owns="'+this.getID()+'"]')&&(this.isBlur=!0,this.isRTE=!1),this.notify(Ul,{args:e}),D.info.name!=="msie"&&e.detail>3&&e.preventDefault()},t.prototype.blurHandler=function(e){var i=e.relatedTarget;if(i){var n=T(i,"."+Vn);n&&n===this.element?(this.isBlur=!1,i===this.getToolbarElement()&&i.setAttribute("tabindex","-1")):T(i,'[aria-owns="'+this.getID()+'"]')||T(i,"."+Ce)?this.isBlur=!1:(this.isBlur=!0,i=null)}if(this.isBlur&&h(i)){O([this.element],[br]),this.removeSelectionClassStates(this.inputElement),this.notify(Bi,{});var r=this.getUpdatedValue();this.setProperties({value:r}),this.valueContainer.value=this.value,this.notify(_t,{args:e,documentNode:document}),this.isValueChangeBlurhandler=!0,this.invokeChangeEvent(),this.isFocusOut=!0,this.isBlur=!1,Zn(this.valueContainer,"focusout"),this.defaultResize(e),this.trigger("blur",{event:e,isInteracted:Object.keys(e).length!==0}),h(this.timeInterval)||(clearInterval(this.timeInterval),this.timeInterval=null),!h(this.placeHolderWrapper)&&this.element.querySelector("[title = Preview]")&&(this.placeHolderWrapper.style.display="none"),b.remove(document,"mousedown",this.onDocumentClick)}else this.isRTE=!0;!this.readonly&&this.getCurrentFocus(e)==="outside"&&this.resetToolbarTabIndex()},t.prototype.contentChanged=function(){this.autoSaveOnIdle&&(h(this.saveInterval)||(clearTimeout(this.timeInterval),this.timeInterval=setTimeout(this.updateIntervalValue.bind(this),this.saveInterval)))},t.prototype.invokeChangeEvent=function(){var e;this.enableXhtml?e=this.getXhtml():e=this.value;var i={value:e,isInteracted:this.isValueChangeBlurhandler};this.value!==this.cloneValue&&(this.trigger("change",i),this.cloneValue=this.value)},t.prototype.wireScrollElementsEvents=function(){this.scrollParentElements=Xr(this.element);for(var e=0,i=this.scrollParentElements;e<i.length;e++){var n=i[e];b.add(n,"scroll",this.scrollHandler,this)}this.iframeSettings.enable||b.add(this.inputElement,"scroll",this.contentScrollHandler,this)},t.prototype.wireContextEvent=function(){this.quickToolbarSettings.showOnRightClick&&(b.add(this.inputElement,"contextmenu",this.contextHandler,this),D.isDevice&&(this.touchModule=new hl(this.inputElement,{tapHold:this.touchHandler.bind(this),tapHoldThreshold:500})))},t.prototype.unWireContextEvent=function(){b.remove(this.inputElement,"contextmenu",this.contextHandler),D.isDevice&&this.touchModule&&this.touchModule.destroy()},t.prototype.unWireScrollElementsEvents=function(){this.scrollParentElements=Xr(this.element);for(var e=0,i=this.scrollParentElements;e<i.length;e++){var n=i[e];b.remove(n,"scroll",this.scrollHandler)}this.iframeSettings.enable||b.remove(this.inputElement,"scroll",this.contentScrollHandler)},t.prototype.touchHandler=function(e){this.notifyMouseUp(e.originalEvent),this.triggerEditArea(e.originalEvent)},t.prototype.contextHandler=function(e){var i=T(e.target,"a, table, img");(this.inlineMode.onSelection===!1||!h(i)&&this.inputElement.contains(i)&&(i.tagName==="IMG"||i.tagName==="TABLE"||i.tagName==="A"))&&e.preventDefault()},t.prototype.resetHandler=function(){var e=this.valueContainer.defaultValue.trim();this.setProperties({value:e===""?null:e})},t.prototype.autoResize=function(){var e=this;if(this.height==="auto"){if(this.editorMode==="Markdown")setTimeout(function(){e.setAutoHeight(e.inputElement)},0);else if(this.iframeSettings.enable){var i=this.element.querySelector("#"+this.getID()+"_rte-view");setTimeout(function(){e.setAutoHeight(i)},100),this.inputElement.style.overflow="hidden"}}else this.inputElement.style.overflow=null},t.prototype.setAutoHeight=function(e){h(e)||(e.style.height=this.inputElement.scrollHeight+"px",e.style.overflow="hidden")},t.prototype.wireEvents=function(){this.element.addEventListener("focusin",this.onFocusHandler,!0),this.element.addEventListener("focusout",this.onBlurHandler,!0),this.on(gi,this.contentChanged,this),this.on(eo,this.updateResizeFlag,this),this.on(bs,this.updateStatus,this),this.on(to,this.cleanupResizeElements,this),this.on(Ls,this.updateValueOnIdle,this),!(this.readonly&&this.enabled)&&this.bindEvents()},t.prototype.restrict=function(e){if(this.maxLength>=0){var i=this.editorMode==="Markdown"?this.contentModule.getText():this.getText().replace(/(\r\n|\n|\r|\t)/gm,"").replace(/\u200B/g,"");if(!i)return;for(var n=[8,16,17,37,38,39,40,46,65],r=void 0,s=0;s<=n.length-1;s++)if(e.which===n[s]){if(e.ctrlKey&&e.which===65)return;if(e.which!==65){r=n[s];return}}i.length>=this.maxLength&&this.maxLength!==-1&&e.which!==r&&e.preventDefault()}},t.prototype.bindEvents=function(){this.keyboardModule=new Rs(this.inputElement,{keyAction:this.keyDown.bind(this),keyConfigs:Fs({},this.formatter.keyConfig,this.keyConfig),eventName:"keydown"});var e=T(this.valueContainer,"form");e&&b.add(e,"reset",this.resetHandler,this),b.add(this.inputElement,"keyup",this.keyUp,this),b.add(this.inputElement,"paste",this.onPaste,this),b.add(this.inputElement,"content-changed",this.contentChanged,this),b.add(this.inputElement,D.touchEndEvent,Gr(this.mouseUp,30),this),b.add(this.inputElement,D.touchStartEvent,this.mouseDownHandler,this),this.wireContextEvent(),this.formatter.editorManager.observer.on(Oe,this.editorKeyDown,this),this.element.ownerDocument.defaultView.addEventListener("resize",this.onResizeHandler,!0),this.iframeSettings.enable&&(b.add(this.inputElement,"focusin",this.focusHandler,this),b.add(this.inputElement,"focusout",this.blurHandler,this),b.add(this.inputElement.ownerDocument,"scroll",this.contentScrollHandler,this),b.add(this.inputElement.ownerDocument,D.touchStartEvent,this.onIframeMouseDown,this)),this.wireScrollElementsEvents()},t.prototype.onIframeMouseDown=function(e){this.isBlur=!1,this.currentTarget=e.target,this.notify(pt,e)},t.prototype.editorKeyDown=function(e){switch(e.event.action){case"copy":this.onCopy();break;case"cut":this.onCut();break;case"tab":this.iframeSettings.enable&&(this.isBlur=!0);break}e.callBack&&(e.event.action==="copy"||e.event.action==="cut"||e.event.action==="delete")&&e.callBack({requestType:e.event.action,editorMode:"HTML",event:e.event})},t.prototype.unWireEvents=function(){this.element.removeEventListener("focusin",this.onFocusHandler,!0),this.element.removeEventListener("focusout",this.onBlurHandler,!0),this.off(gi,this.contentChanged),this.off(eo,this.updateResizeFlag),this.off(bs,this.updateStatus),this.off(to,this.cleanupResizeElements),this.off(Ls,this.updateValueOnIdle),!(this.readonly&&this.enabled)&&this.unbindEvents()},t.prototype.unbindEvents=function(){this.keyboardModule&&this.keyboardModule.destroy();var e=T(this.valueContainer,"form");e&&b.remove(e,"reset",this.resetHandler),b.remove(this.inputElement,"keyup",this.keyUp),b.remove(this.inputElement,"paste",this.onPaste),b.remove(this.inputElement,"content-changed",this.contentChanged),b.remove(this.inputElement,D.touchEndEvent,Gr(this.mouseUp,30)),b.remove(this.inputElement,D.touchStartEvent,this.mouseDownHandler),this.unWireContextEvent(),this.formatter&&this.formatter.editorManager.observer.off(Oe,this.editorKeyDown),this.element.ownerDocument.defaultView.removeEventListener("resize",this.onResizeHandler,!0),this.iframeSettings.enable&&(b.remove(this.inputElement,"focusin",this.focusHandler),b.remove(this.inputElement,"focusout",this.blurHandler),b.remove(this.inputElement.ownerDocument,"scroll",this.contentScrollHandler),b.remove(this.inputElement.ownerDocument,D.touchStartEvent,this.onIframeMouseDown)),this.unWireScrollElementsEvents()},t.prototype.getCurrentFocus=function(e){return e.target===this.inputElement&&document.activeElement===this.inputElement?"editArea":e.target===this.getToolbarElement()||!h(e.relatedTarget)&&T(e.relatedTarget,".e-rte-toolbar")===this.getToolbarElement()?"toolbar":e.target===this.valueContainer&&document.activeElement===this.valueContainer?"textArea":!h(e.target)&&e.target.classList.contains(bt)&&document.activeElement===e.target?"sourceCode":"outside"},t.prototype.resetToolbarTabIndex=function(){if(this.getToolbarElement())for(var e=this.getToolbarElement().querySelectorAll("input,select,button,a,[tabindex]"),i=0;i<e.length;i++)!e[i].classList.contains("e-rte-dropdown-btn")&&!e[i].classList.contains("e-insert-table-btn")&&(!e[i].hasAttribute("tabindex")||e[i].getAttribute("tabindex")!=="-1")&&e[i].setAttribute("tabindex","-1")},t.prototype.removeSelectionClassStates=function(e){for(var i=[gn,Ah,Fh,Hh],n=0;n<i.length;n++){var r=e.querySelectorAll("."+i[n]);if(O(r,i[n]),r.length!==0)for(var s=0;s<r.length;s++)r[s].classList.length===0&&r[s].removeAttribute("class")}},M([X({},gd)],t.prototype,"toolbarSettings",void 0),M([X({},Sd)],t.prototype,"quickToolbarSettings",void 0),M([X({},wd)],t.prototype,"pasteCleanupSettings",void 0),M([X({},Ed)],t.prototype,"formatPainterSettings",void 0),M([X({},Ld)],t.prototype,"emojiPickerSettings",void 0),M([X({},Ad)],t.prototype,"iframeSettings",void 0),M([X({},vd)],t.prototype,"insertImageSettings",void 0),M([X({},bd)],t.prototype,"insertAudioSettings",void 0),M([X({},yd)],t.prototype,"insertVideoSettings",void 0),M([X({},Td)],t.prototype,"tableSettings",void 0),M([g(0)],t.prototype,"floatingToolbarOffset",void 0),M([X({},Id)],t.prototype,"inlineMode",void 0),M([X({},Cd)],t.prototype,"fileManagerSettings",void 0),M([g("100%")],t.prototype,"width",void 0),M([g(!1)],t.prototype,"enablePersistence",void 0),M([g(!0)],t.prototype,"showTooltip",void 0),M([g(!1)],t.prototype,"enableResize",void 0),M([g({})],t.prototype,"htmlAttributes",void 0),M([g(null)],t.prototype,"placeholder",void 0),M([g(!1)],t.prototype,"autoSaveOnIdle",void 0),M([g(!1)],t.prototype,"readonly",void 0),M([g(!0)],t.prototype,"enabled",void 0),M([g(!0)],t.prototype,"enableHtmlSanitizer",void 0),M([g(!1)],t.prototype,"enableHtmlEncode",void 0),M([g(!1)],t.prototype,"enableXhtml",void 0),M([g("auto")],t.prototype,"height",void 0),M([g(null)],t.prototype,"cssClass",void 0),M([g(null)],t.prototype,"value",void 0),M([g("P")],t.prototype,"enterKey",void 0),M([g("BR")],t.prototype,"shiftEnterKey",void 0),M([g(30)],t.prototype,"undoRedoSteps",void 0),M([g(300)],t.prototype,"undoRedoTimer",void 0),M([g("HTML")],t.prototype,"editorMode",void 0),M([g(null)],t.prototype,"keyConfig",void 0),M([g(!1)],t.prototype,"showCharCount",void 0),M([g(!1)],t.prototype,"enableTabKey",void 0),M([g(!1)],t.prototype,"enableAutoUrl",void 0),M([g(-1)],t.prototype,"maxLength",void 0),M([X({},Dd)],t.prototype,"format",void 0),M([X({},Nd)],t.prototype,"numberFormatList",void 0),M([X({},Rd)],t.prototype,"bulletFormatList",void 0),M([X({},kd)],t.prototype,"fontFamily",void 0),M([X({},xd)],t.prototype,"fontSize",void 0),M([X({},Bd)],t.prototype,"fontColor",void 0),M([X({},Od)],t.prototype,"backgroundColor",void 0),M([g(null)],t.prototype,"valueTemplate",void 0),M([g(1e4)],t.prototype,"saveInterval",void 0),M([N()],t.prototype,"actionBegin",void 0),M([N()],t.prototype,"actionComplete",void 0),M([N()],t.prototype,"beforeDialogOpen",void 0),M([N()],t.prototype,"dialogOpen",void 0),M([N()],t.prototype,"beforeDialogClose",void 0),M([N()],t.prototype,"dialogClose",void 0),M([N()],t.prototype,"beforeQuickToolbarOpen",void 0),M([N()],t.prototype,"quickToolbarOpen",void 0),M([N()],t.prototype,"quickToolbarClose",void 0),M([N()],t.prototype,"toolbarStatusUpdate",void 0),M([N()],t.prototype,"updatedToolbarStatus",void 0),M([N()],t.prototype,"imageSelected",void 0),M([N()],t.prototype,"beforeImageUpload",void 0),M([N()],t.prototype,"imageUploading",void 0),M([N()],t.prototype,"imageUploadSuccess",void 0),M([N()],t.prototype,"imageUploadFailed",void 0),M([N()],t.prototype,"imageRemoving",void 0),M([N()],t.prototype,"afterImageDelete",void 0),M([N()],t.prototype,"fileSelected",void 0),M([N()],t.prototype,"beforeFileUpload",void 0),M([N()],t.prototype,"fileUploading",void 0),M([N()],t.prototype,"fileUploadSuccess",void 0),M([N()],t.prototype,"fileUploadFailed",void 0),M([N()],t.prototype,"fileRemoving",void 0),M([N()],t.prototype,"afterMediaDelete",void 0),M([N()],t.prototype,"created",void 0),M([N()],t.prototype,"destroyed",void 0),M([N()],t.prototype,"beforeSanitizeHtml",void 0),M([N()],t.prototype,"blur",void 0),M([N()],t.prototype,"toolbarClick",void 0),M([N()],t.prototype,"focus",void 0),M([N()],t.prototype,"change",void 0),M([N()],t.prototype,"resizing",void 0),M([N()],t.prototype,"resizeStart",void 0),M([N()],t.prototype,"resizeStop",void 0),M([N()],t.prototype,"beforePasteCleanup",void 0),M([N()],t.prototype,"afterPasteCleanup",void 0),M([N()],t.prototype,"beforeImageDrop",void 0),M([g(null)],t.prototype,"formatter",void 0),t=M([Ct],t),t}($t),qd=globalThis&&globalThis.__extends||function(){var o=function(t,e){return o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,n){i.__proto__=n}||function(i,n){for(var r in n)n.hasOwnProperty(r)&&(i[r]=n[r])},o(t,e)};return function(t,e){o(t,e);function i(){this.constructor=t}t.prototype=e===null?Object.create(e):(i.prototype=e.prototype,new i)}}(),nl=function(o){qd(t,o);function t(e){var i=o.call(this,e)||this;return i.initRenderCalled=!1,i.checkInjectedModules=!0,i.statelessTemplateProps=["valueTemplate"],i.templateProps=null,i.immediateRender=!1,i.portals=[],i}return t.prototype.render=function(){if((this.element&&!this.initRenderCalled||this.refreshing)&&!this.isReactForeceUpdate)o.prototype.render.call(this),this.initRenderCalled=!0;else return Si.createElement("div",this.getDefaultAttributes(),[].concat(this.props.children,this.portals))},t}(zd);yl(nl,[Cl,Si.Component]);const Vd=["Bold","Italic","Underline","StrikeThrough","FontName","FontSize","FontColor","BackgroundColor","LowerCase","UpperCase","|","Formats","Alignments","OrderedList","UnorderedList","Outdent","Indent","|","CreateLink","Image","|","ClearFormat","Print","SourceCode","FullScreen","|","Undo","Redo"],Ud={image:["Replace","Align","Caption","Remove","InsertLink","OpenImageLink","-","EditImageLink","RemoveImageLink","Display","AltText","Dimension"]},jd={allowedStyleProps:["background","background-color","border","border-bottom","border-left","border-radius","border-right","border-style","border-top","border-width","clear","color","cursor","direction","display","float","font","font-family","font-size","font-weight","font-style","text-align","text-decoration","text-indent","height","left","line-height","top","width","margin","margin-top","margin-left","margin-right","margin-bottom","max-height","max-width","min-height","min-width","overflow","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","position","right","table-layout","vertical-align","visibility","white-space"],deniedAttrs:["class","title","id"],deniedTags:["a"],keepFormat:!1,plainText:!1,prompt:!0},_d={enable:!0},Wd=["ar"],Qd=o=>Wd.includes(o),Gd=({id:o,name:t,value:e,onBlur:i,label:n,error:r,languageCode:s="en",maxLength:a=100})=>{var p;const l=Si.useRef(null),c={type:Le.MultiRow,items:Vd,enableFloating:!1};return Bt.useEffect(()=>{var u;const d=f=>{var m;i(((m=l.current)==null?void 0:m.value)||"")};(u=l.current)==null||u.addEventListener("blur",d)},[(p=l.current)==null?void 0:p.value]),Y.jsxs("div",{className:"py-[16px]",children:[Y.jsx(dl,{children:n}),Y.jsx(nl,{className:"cke-box-shadow",height:450,id:o,name:t,toolbarSettings:c,quickToolbarSettings:Ud,enableRtl:Qd(s),value:e,ref:l,iframeSettings:_d,pasteCleanupSettings:jd,showCharCount:!0,maxLength:a,children:Y.jsx(Tl,{services:[_p,dd,pd,Jc,Gc,Zc]})})]})},na=({name:o="",controlName:t="",control:e,id:i="",label:n="",placeholder:r="",multiline:s=!1,rows:a=1,adornment:l="",methods:c=void 0,errors:p="",languageCode:d="",maxLength:u=100,...f})=>Y.jsx(sa,{name:t,control:(c==null?void 0:c.control)||e,render:({field:{value:m,onChange:v,onBlur:y,ref:L},fieldState:{error:C}})=>{const w=k=>{c==null||c.setValue(t,k)};return Y.jsxs(Ot,{children:[Y.jsx(Gd,{id:i,name:o,value:m,onBlur:w,placeholder:r,label:n,inputRef:L,error:C,languageCode:d,maxLength:u}),Y.jsx(ra,{sx:{color:"error.main",marginLeft:"8px",marginRight:"8px"},children:(C==null?void 0:C.message)??p})]})}}),nu=({methods:o,category:t,maxLength:e=2e3})=>{const{languages:i}=cl().props.settings,n=Yn.get(pl);return Y.jsx(Ot,{children:i.map((r,s)=>Y.jsxs(Ot,{children:[Y.jsx(ul,{controlName:n.generateControllerName("translations")+r.code+".name",name:r.code+"-name",id:r.code+"-name",label:`${r.name} ${t} Name`,placeholder:`${r.name} ${t} Name`,control:o.control}),Y.jsx(na,{controlName:n.generateControllerName("translations")+r.code+".brief",methods:o,name:r.code+"-brief",id:r.code+"-brief",label:`${r.name} ${t} Brief`,placeholder:`${r.name} ${t} Brief`,control:o.control,multiline:!0,rows:4,languageCode:r.code,maxLength:e}),Y.jsx(na,{controlName:n.generateControllerName("translations")+r.code+".description",methods:o,name:r.code+"-description",id:r.code+"-description",label:`${r.name} ${t} Description`,placeholder:`${r.name} ${t} Description`,control:o.control,multiline:!0,rows:4,languageCode:r.code,maxLength:e})]},s))})};export{nu as B,iu as V};
